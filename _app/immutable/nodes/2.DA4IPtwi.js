import{A as vh,O as $u,P as ao,s as St,p as D,k,n as Xe,i as P,x as R,e as Ue,t as Qx,d as He,f as ke,h as Jx,v as X,Q as Fn,l as ii,R as si,m as e$,S as ku,T as Su,D as t$,U as KC,V as UC,W as DT,X as OT,b as wi,j as _i,r as fh,o as In,Y as RT,Z as wt,_ as HC,$ as bi,a0 as n$,a1 as Wl,a2 as i$,a3 as Rf,w as Ye,a4 as kp,c as mn,u as vn,g as fn,a as wn,a5 as Ee,F as jT,a6 as NT,a7 as BT,a8 as IT,a9 as s$}from"../chunks/scheduler.CxgH4FLg.js";import{a as y,t as b,S as Lt,i as At,b as fe,d as we,m as _e,g as Bi,c as Ii,e as be,f as xe}from"../chunks/index.hVPezGh9.js";import{w as ci}from"../chunks/index.DlMBz-N2.js";const FT=typeof window<"u"?window:typeof globalThis<"u"?globalThis:global;function Dr(n){return(n==null?void 0:n.length)!==void 0?n:Array.from(n)}function r$(n,e){y(n,1,1,()=>{e.delete(n.key)})}function o$(n,e,t,i,s,r,o,l,a,u,h,c){let d=n.length,p=r.length,v=d;const m={};for(;v--;)m[n[v].key]=v;const f=[],w=new Map,g=new Map,L=[];for(v=p;v--;){const O=c(s,r,v),E=t(O);let Ge=o.get(E);Ge?L.push(()=>Ge.p(O,e)):(Ge=u(E,O),Ge.c()),w.set(E,f[v]=Ge),E in m&&g.set(E,Math.abs(v-m[E]))}const ye=new Set,C=new Set;function qe(O){b(O,1),O.m(l,h),o.set(O.key,O),h=O.first,p--}for(;d&&p;){const O=f[p-1],E=n[d-1],Ge=O.key,ti=E.key;O===E?(h=O.first,d--,p--):w.has(ti)?!o.has(Ge)||ye.has(Ge)?qe(O):C.has(ti)?d--:g.get(Ge)>g.get(ti)?(C.add(Ge),qe(O)):(ye.add(ti),d--):(a(E,o),d--)}for(;d--;){const O=n[d];w.has(O.key)||a(O,o)}for(;p;)qe(f[p-1]);return vh(L),f}function Bo(n,e){const t={},i={},s={$$scope:1};let r=n.length;for(;r--;){const o=n[r],l=e[r];if(l){for(const a in o)a in l||(i[a]=1);for(const a in l)s[a]||(t[a]=l[a],s[a]=1);n[r]=l}else for(const a in o)s[a]=1}for(const o in i)o in t||(t[o]=void 0);return t}function va(n){return typeof n=="object"&&n!==null?n:{}}const l$=Symbol("treeview-context"),KT=()=>{$u(l$,{selectedNode:ci(),toggledNode:ci(),focusedNode:ci(),dragNode:ci(),dragMap:new Map,dragging:ci(!1),pointerDown:ci({x:0,y:0})})},fa=()=>ao(l$),UT=(n,e)=>{const t={...n,children:void 0,parent:e};return t.children=a$(n.children??[],t),t},a$=(n,e=null)=>{const{selectedNode:t}=fa();return n.map(i=>{const s=UT(i,e);return s.selected&&t.set(s),s})},Lu=(n,e)=>{for(const t of n)e(t),t.children.length>0&&Lu(t.children,e)},Vv=(n,e)=>{var s;const t=(s=n.parent)==null?void 0:s.children;if(t===void 0)return;const i=t.indexOf(n);if(i!==void 0)return t[i+e]},HT=n=>{var i;if(console.log("hi",n),n.expanded&&n.children.length>0)return(i=n.children)==null?void 0:i[0];let e=Vv(n,1);if(e)return e;let{parent:t}=n;for(;t;){if(e=Vv(t,1),e)return e;t=t.parent}},zT=n=>{const e=Vv(n,-1);if(e!=null&&e.expanded&&e.children.length>0){let t=e.children.at(-1);if(t!==void 0&&t.children.length>0)for(;t.children.length>0;)t=t.children.at(-1);return t}return e||(n.parent??void 0)},u$=(n,e)=>{for(const t of n)e(t),t.children!==void 0&&u$(t.children,e)};function qT(n){let e,t=n[0].name+"",i,s,r;return{c(){e=Ue("button"),i=Qx(t),this.h()},l(o){e=He(o,"BUTTON",{class:!0});var l=ke(e);i=Jx(l,t),l.forEach(P),this.h()},h(){X(e,"class","tv-focus-within:text-[var(--treeview-node-hovered-text-color,#fff)] tv-focus-within:bg-[var(--treeview-node-hovered-bg-color,#666)] svelte-1wh2z20"),Fn(e,"active",n[1])},m(o,l){k(o,e,l),ii(e,i),n[6](e),s||(r=[si(e,"click",n[3]),si(e,"pointerdown",n[4])],s=!0)},p(o,l){l&1&&t!==(t=o[0].name+"")&&e$(i,t),l&2&&Fn(e,"active",o[1])},d(o){o&&P(e),n[6](null),s=!1,vh(r)}}}function GT(n){let e,t=n[0].name+"",i,s,r,o;return{c(){e=Ue("a"),i=Qx(t),this.h()},l(l){e=He(l,"A",{href:!0,class:!0});var a=ke(e);i=Jx(a,t),a.forEach(P),this.h()},h(){X(e,"href",s=n[0].href),X(e,"class","tv-focus-within:text-[var(--treeview-node-hovered-text-color,#fff)] tv-focus-within:bg-[var(--treeview-node-hovered-bg-color,#666)] svelte-1wh2z20"),Fn(e,"active",n[1])},m(l,a){k(l,e,a),ii(e,i),n[5](e),r||(o=[si(e,"click",n[3]),si(e,"pointerdown",n[4])],r=!0)},p(l,a){a&1&&t!==(t=l[0].name+"")&&e$(i,t),a&1&&s!==(s=l[0].href)&&X(e,"href",s),a&2&&Fn(e,"active",l[1])},d(l){l&&P(e),n[5](null),r=!1,vh(o)}}}function YT(n){let e;function t(r,o){return"href"in r[0]?GT:qT}let i=t(n),s=i(n);return{c(){s.c(),e=D()},l(r){s.l(r),e=D()},m(r,o){s.m(r,o),k(r,e,o)},p(r,[o]){i===(i=t(r))&&s?s.p(r,o):(s.d(1),s=i(r),s&&(s.c(),s.m(e.parentNode,e)))},i:Xe,o:Xe,d(r){r&&P(e),s.d(r)}}}function XT(n,e,t){let{node:i}=e,{active:s}=e,r;const{selectedNode:o,dragNode:l,pointerDown:a}=fa(),u=()=>o.set(i),h=p=>{l.set(i),a.set({x:p.clientX,y:p.clientY})};function c(p){R[p?"unshift":"push"](()=>{r=p,t(2,r)})}function d(p){R[p?"unshift":"push"](()=>{r=p,t(2,r)})}return n.$$set=p=>{"node"in p&&t(0,i=p.node),"active"in p&&t(1,s=p.active)},n.$$.update=()=>{n.$$.dirty&6&&s&&(r==null||r.focus())},[i,s,r,u,h,c,d]}class WT extends Lt{constructor(e){super(),At(this,e,XT,YT,St,{node:0,active:1})}}function ZT(n){let e;return{c(){e=Ue("div"),this.h()},l(t){e=He(t,"DIV",{class:!0}),ke(e).forEach(P),this.h()},h(){X(e,"class","tv-h-[var(--treeview-toggle-button-size,1.25rem)] tv-w-[var(--treeview-toggle-button-size,1.25rem)] ")},m(t,i){k(t,e,i)},p:Xe,d(t){t&&P(e)}}}function QT(n){let e,t,i,s;function r(a,u){return a[1]?eD:JT}let o=r(n),l=o(n);return{c(){e=Ue("button"),t=ku("svg"),l.c(),this.h()},l(a){e=He(a,"BUTTON",{class:!0});var u=ke(e);t=Su(u,"svg",{viewBox:!0,class:!0});var h=ke(t);l.l(h),h.forEach(P),u.forEach(P),this.h()},h(){X(t,"viewBox","0 0 24 24"),X(t,"class","tv-h-[var(--treeview-toggle-icon-size,1rem)] tv-w-[var(--treeview-toggle-icon-size,1rem)]"),X(e,"class","tv-flex tv-items-center tv-justify-center tv-rounded-[var(--treeview-button-border-radius,2px)] tv-m-0 tv-p-0 tv-border-0 svelte-1l942yr"),Fn(e,"expanded",n[1])},m(a,u){k(a,e,u),ii(e,t),l.m(t,null),i||(s=si(e,"click",function(){t$(n[2])&&n[2].apply(this,arguments)}),i=!0)},p(a,u){n=a,o!==(o=r(n))&&(l.d(1),l=o(n),l&&(l.c(),l.m(t,null))),u&2&&Fn(e,"expanded",n[1])},d(a){a&&P(e),l.d(),i=!1,s()}}}function JT(n){let e;return{c(){e=ku("path"),this.h()},l(t){e=Su(t,"path",{d:!0}),ke(e).forEach(P),this.h()},h(){X(e,"d","M8.58 16.59l4.59-4.59-4.59-4.59 1.41-1.41 6 6-6 6z")},m(t,i){k(t,e,i)},d(t){t&&P(e)}}}function eD(n){let e;return{c(){e=ku("path"),this.h()},l(t){e=Su(t,"path",{d:!0}),ke(e).forEach(P),this.h()},h(){X(e,"d","M7.41 8.58l4.59 4.59 4.59-4.59 1.41 1.41-6 6-6-6z")},m(t,i){k(t,e,i)},d(t){t&&P(e)}}}function tD(n){let e;function t(r,o){return r[0]?QT:ZT}let i=t(n),s=i(n);return{c(){s.c(),e=D()},l(r){s.l(r),e=D()},m(r,o){s.m(r,o),k(r,e,o)},p(r,[o]){i===(i=t(r))&&s?s.p(r,o):(s.d(1),s=i(r),s&&(s.c(),s.m(e.parentNode,e)))},i:Xe,o:Xe,d(r){r&&P(e),s.d(r)}}}function nD(n,e,t){let{enabled:i=!1}=e,{expanded:s=!1}=e,{onToggle:r}=e;return n.$$set=o=>{"enabled"in o&&t(0,i=o.enabled),"expanded"in o&&t(1,s=o.expanded),"onToggle"in o&&t(2,r=o.onToggle)},[i,s,r]}class iD extends Lt{constructor(e){super(),At(this,e,nD,tD,St,{enabled:0,expanded:1,onToggle:2})}}function sD(n){let e,t;return{c(){e=Ue("img"),this.h()},l(i){e=He(i,"IMG",{src:!0,alt:!0,class:!0}),this.h()},h(){UC(e.src,t=n[0].url)||X(e,"src",t),X(e,"alt",""),X(e,"class","svelte-1e51xwa")},m(i,s){k(i,e,s)},p(i,s){s&1&&!UC(e.src,t=i[0].url)&&X(e,"src",t)},d(i){i&&P(e)}}}function rD(n){let e,t,i,s;return{c(){e=ku("svg"),t=ku("path"),this.h()},l(r){e=Su(r,"svg",{viewBox:!0,class:!0});var o=ke(e);t=Su(o,"path",{d:!0,class:!0}),ke(t).forEach(P),o.forEach(P),this.h()},h(){X(t,"d",i=n[0].path),X(t,"class","tv-fill-[var(--treeview-icon-color,#555)]"),X(e,"viewBox",s=n[0].viewBox),X(e,"class","svelte-1e51xwa")},m(r,o){k(r,e,o),ii(e,t)},p(r,o){o&1&&i!==(i=r[0].path)&&X(t,"d",i),o&1&&s!==(s=r[0].viewBox)&&X(e,"viewBox",s)},d(r){r&&P(e)}}}function oD(n){let e,t;return{c(){e=new DT(!1),t=D(),this.h()},l(i){e=OT(i,!1),t=D(),this.h()},h(){e.a=t},m(i,s){e.m(n[0],i,s),k(i,t,s)},p(i,s){s&1&&e.p(i[0])},d(i){i&&(P(t),e.d())}}}function lD(n){let e,t;function i(o,l){if(typeof o[0]=="string")return oD;if("path"in o[0])return rD;if("url"in o[0])return sD}let s=i(n),r=s&&s(n);return{c(){e=Ue("div"),r&&r.c(),this.h()},l(o){e=He(o,"DIV",{class:!0});var l=ke(e);r&&r.l(l),l.forEach(P),this.h()},h(){X(e,"class",t=KC(typeof n[0]=="object"&&"class"in n[0]?n[0].class:"")+" svelte-1e51xwa")},m(o,l){k(o,e,l),r&&r.m(e,null)},p(o,[l]){s===(s=i(o))&&r?r.p(o,l):(r&&r.d(1),r=s&&s(o),r&&(r.c(),r.m(e,null))),l&1&&t!==(t=KC(typeof o[0]=="object"&&"class"in o[0]?o[0].class:"")+" svelte-1e51xwa")&&X(e,"class",t)},i:Xe,o:Xe,d(o){o&&P(e),r&&r.d()}}}function aD(n,e,t){let{icon:i}=e;return n.$$set=s=>{"icon"in s&&t(0,i=s.icon)},[i]}class uD extends Lt{constructor(e){super(),At(this,e,aD,lD,St,{icon:0})}}function zC(n){let e,t;return e=new uD({props:{icon:n[0].icon}}),{c(){fe(e.$$.fragment)},l(i){we(e.$$.fragment,i)},m(i,s){_e(e,i,s),t=!0},p(i,s){const r={};s&1&&(r.icon=i[0].icon),e.$set(r)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function hD(n){let e,t,i,s,r,o,l;i=new iD({props:{enabled:n[0].children.length>0,expanded:n[1],onToggle:n[3]}});let a=n[0].icon!==void 0&&zC(n);return o=new WT({props:{node:n[0],active:n[2]}}),{c(){e=Ue("li"),t=Ue("div"),fe(i.$$.fragment),s=wi(),a&&a.c(),r=wi(),fe(o.$$.fragment),this.h()},l(u){e=He(u,"LI",{role:!0,"aria-selected":!0});var h=ke(e);t=He(h,"DIV",{class:!0});var c=ke(t);we(i.$$.fragment,c),s=_i(c),a&&a.l(c),r=_i(c),we(o.$$.fragment,c),c.forEach(P),h.forEach(P),this.h()},h(){X(t,"class","svelte-4jeame"),X(e,"role","treeitem"),X(e,"aria-selected",n[2])},m(u,h){k(u,e,h),ii(e,t),_e(i,t,null),ii(t,s),a&&a.m(t,null),ii(t,r),_e(o,t,null),n[5](e),l=!0},p(u,[h]){const c={};h&1&&(c.enabled=u[0].children.length>0),h&2&&(c.expanded=u[1]),h&8&&(c.onToggle=u[3]),i.$set(c),u[0].icon!==void 0?a?(a.p(u,h),h&1&&b(a,1)):(a=zC(u),a.c(),b(a,1),a.m(t,r)):a&&(Bi(),y(a,1,1,()=>{a=null}),Ii());const d={};h&1&&(d.node=u[0]),h&4&&(d.active=u[2]),o.$set(d),(!l||h&4)&&X(e,"aria-selected",u[2])},i(u){l||(b(i.$$.fragment,u),b(a),b(o.$$.fragment,u),l=!0)},o(u){y(i.$$.fragment,u),y(a),y(o.$$.fragment,u),l=!1},d(u){u&&P(e),be(i),a&&a.d(),be(o),n[5](null)}}}function cD(n,e,t){let{node:i}=e,{expanded:s=!1}=e,{active:r=!1}=e,{onToggle:o}=e;const{dragMap:l}=fa();let a;fh(()=>(l.set(a,{node:i}),()=>l.delete(a)));function u(h){R[h?"unshift":"push"](()=>{a=h,t(4,a)})}return n.$$set=h=>{"node"in h&&t(0,i=h.node),"expanded"in h&&t(1,s=h.expanded),"active"in h&&t(2,r=h.active),"onToggle"in h&&t(3,o=h.onToggle)},[i,s,r,o,a,u]}class pD extends Lt{constructor(e){super(),At(this,e,cD,hD,St,{node:0,expanded:1,active:2,onToggle:3})}}function qC(n,e,t){const i=n.slice();return i[7]=e[t],i}function GC(n){let e,t=[],i=new Map,s,r=Dr(n[0].children);const o=l=>l[7].id;for(let l=0;l<r.length;l+=1){let a=qC(n,r,l),u=o(a);i.set(u,t[l]=YC(u,a))}return{c(){e=Ue("ul");for(let l=0;l<t.length;l+=1)t[l].c();this.h()},l(l){e=He(l,"UL",{class:!0});var a=ke(e);for(let u=0;u<t.length;u+=1)t[u].l(a);a.forEach(P),this.h()},h(){X(e,"class","svelte-120yci8")},m(l,a){k(l,e,a);for(let u=0;u<t.length;u+=1)t[u]&&t[u].m(e,null);s=!0},p(l,a){a&1&&(r=Dr(l[0].children),Bi(),t=o$(t,a,o,1,l,r,i,e,r$,YC,null,qC),Ii())},i(l){if(!s){for(let a=0;a<r.length;a+=1)b(t[a]);s=!0}},o(l){for(let a=0;a<t.length;a+=1)y(t[a]);s=!1},d(l){l&&P(e);for(let a=0;a<t.length;a+=1)t[a].d()}}}function YC(n,e){let t,i,s;return i=new h$({props:{node:e[7]}}),{key:n,first:null,c(){t=D(),fe(i.$$.fragment),this.h()},l(r){t=D(),we(i.$$.fragment,r),this.h()},h(){this.first=t},m(r,o){k(r,t,o),_e(i,r,o),s=!0},p(r,o){e=r;const l={};o&1&&(l.node=e[7]),i.$set(l)},i(r){s||(b(i.$$.fragment,r),s=!0)},o(r){y(i.$$.fragment,r),s=!1},d(r){r&&P(t),be(i,r)}}}function dD(n){let e,t,i,s;e=new pD({props:{node:n[0],expanded:n[2],active:n[1],onToggle:n[4]}});let r=n[0].children.length>0&&n[2]&&GC(n);return{c(){fe(e.$$.fragment),t=wi(),r&&r.c(),i=D()},l(o){we(e.$$.fragment,o),t=_i(o),r&&r.l(o),i=D()},m(o,l){_e(e,o,l),k(o,t,l),r&&r.m(o,l),k(o,i,l),s=!0},p(o,[l]){const a={};l&1&&(a.node=o[0]),l&4&&(a.expanded=o[2]),l&2&&(a.active=o[1]),e.$set(a),o[0].children.length>0&&o[2]?r?(r.p(o,l),l&5&&b(r,1)):(r=GC(o),r.c(),b(r,1),r.m(i.parentNode,i)):r&&(Bi(),y(r,1,1,()=>{r=null}),Ii())},i(o){s||(b(e.$$.fragment,o),b(r),s=!0)},o(o){y(e.$$.fragment,o),y(r),s=!1},d(o){o&&(P(t),P(i)),be(e,o),r&&r.d(o)}}}function mD(n,e,t){let i,s,r,{node:o}=e;const{selectedNode:l,toggledNode:a}=fa();In(n,l,h=>t(5,r=h));const u=()=>{t(2,i=!i),t(0,o.expanded=i,o),a.set(o)};return n.$$set=h=>{"node"in h&&t(0,o=h.node)},n.$$.update=()=>{n.$$.dirty&1&&t(2,i=o.expanded??!1),n.$$.dirty&33&&t(1,s=r===o)},[o,s,i,l,u,r]}class h$ extends Lt{constructor(e){super(),At(this,e,mD,dD,St,{node:0})}}const vD=()=>{const{selectedNode:n}=fa();return(e,t)=>{const i=RT(n);switch(e){case"arrowleft":{if(i!==void 0)return Lu(t,s=>{i===s&&(s.expanded=!1)}),t;break}case"arrowright":{if(i!==void 0)return Lu(t,s=>i===s&&(s.expanded=!0)),t;break}case"arrowup":{if(i===void 0){n.set(t[0]);return}const s=zT(i);s!==void 0&&n.set(s);break}case"arrowdown":{if(i===void 0){n.set(t[0]);return}const s=HT(i);s!==void 0&&n.set(s);break}}}};function XC(n,e,t){const i=n.slice();return i[24]=e[t],i}function WC(n,e){let t,i,s;return i=new h$({props:{node:e[24]}}),i.$on("toggle",e[17]),{key:n,first:null,c(){t=D(),fe(i.$$.fragment),this.h()},l(r){t=D(),we(i.$$.fragment,r),this.h()},h(){this.first=t},m(r,o){k(r,t,o),_e(i,r,o),s=!0},p(r,o){e=r;const l={};o&2&&(l.node=e[24]),i.$set(l)},i(r){s||(b(i.$$.fragment,r),s=!0)},o(r){y(i.$$.fragment,r),s=!1},d(r){r&&P(t),be(i,r)}}}function fD(n){let e,t=[],i=new Map,s,r,o,l=Dr(n[1]);const a=c=>c[24].id;for(let c=0;c<l.length;c+=1){let d=XC(n,l,c),p=a(d);i.set(p,t[c]=WC(p,d))}let u=[{role:"tree"},{tabindex:"0"},n[11]],h={};for(let c=0;c<u.length;c+=1)h=wt(h,u[c]);return{c(){e=Ue("ul");for(let c=0;c<t.length;c+=1)t[c].c();this.h()},l(c){e=He(c,"UL",{role:!0,tabindex:!0});var d=ke(e);for(let p=0;p<t.length;p+=1)t[p].l(d);d.forEach(P),this.h()},h(){HC(e,h),Fn(e,"svelte-1gfbk2z",!0)},m(c,d){k(c,e,d);for(let p=0;p<t.length;p+=1)t[p]&&t[p].m(e,null);s=!0,r||(o=[si(window,"pointerup",n[10]),si(e,"keydown",n[8]),si(e,"pointermove",function(){t$(n[0]?n[9]:void 0)&&(n[0]?n[9]:void 0).apply(this,arguments)})],r=!0)},p(c,[d]){n=c,d&2&&(l=Dr(n[1]),Bi(),t=o$(t,d,a,1,n,l,i,e,r$,WC,null,XC),Ii()),HC(e,h=Bo(u,[{role:"tree"},{tabindex:"0"},d&2048&&n[11]])),Fn(e,"svelte-1gfbk2z",!0)},i(c){if(!s){for(let d=0;d<l.length;d+=1)b(t[d]);s=!0}},o(c){for(let d=0;d<t.length;d+=1)y(t[d]);s=!1},d(c){c&&P(e);for(let d=0;d<t.length;d+=1)t[d].d();r=!1,vh(o)}}}function wD(n,e,t){const i=["nodes","select"];let s=bi(e,i),r,o,l,a,u,h,{nodes:c}=e;const d=n$(),p=ci();In(n,p,$=>t(1,a=$)),KT();const v=vD(),{selectedNode:m,toggledNode:f,dragNode:w,dragMap:g,dragging:L,pointerDown:ye}=fa();In(n,m,$=>t(15,o=$)),In(n,f,$=>t(16,l=$)),In(n,w,$=>t(0,r=$)),In(n,L,$=>t(19,u=$)),In(n,ye,$=>t(20,h=$));let C;const qe=$=>{$.preventDefault();const J=v($.key.toLowerCase(),a);J&&p.set(J)};let O;const E=$=>{if(Math.hypot($.clientX-h.x,$.clientY-h.y)<8)return;L.set(!0);let Ke=$.target;if(!("spacer"in Ke.dataset))for(;Ke.role!=="treeitem"&&Ke.parentElement;)Ke=Ke.parentElement;O=g.get(Ke)},Ge=()=>{const $=r;if(w.set(void 0),!u||O===void 0||$.parent===null)return;const J=$.parent,Ke=O.node;if($===Ke)return;let kn=!1;Lu($.children,ts=>{ts.id===Ke.id&&(kn=!0)}),!kn&&(J.children.splice(J.children.indexOf($),1),$.parent=Ke,Ke.expanded=!0,Ke.children.unshift($),p.set(a),d("reparent",{node:$,oldParent:J,newParent:Ke}),O=void 0,L.set(!1))},ti=$=>{Lu(a,J=>{J.id===$&&Rf(m,o=J,o)})};function Jt($){i$.call(this,n,$)}return n.$$set=$=>{e=wt(wt({},e),Wl($)),t(11,s=bi(e,i)),"nodes"in $&&t(12,c=$.nodes)},n.$$.update=()=>{n.$$.dirty&4096&&p.set(a$(c)),n.$$.dirty&65536&&l&&d("toggle",l),n.$$.dirty&49152&&(C&&C!==o&&d("deselect",C),t(14,C=o),o&&d("select",o)),n.$$.dirty&1&&typeof document<"u"&&document.body.classList.toggle("!tv-cursor-grabbing",r!==void 0)},[r,a,p,m,f,w,L,ye,qe,E,Ge,s,c,ti,C,o,l,Jt]}class _D extends Lt{constructor(e){super(),At(this,e,wD,fD,St,{nodes:12,select:13})}get select(){return this.$$.ctx[13]}}const bD=(n=21)=>{const e=crypto.getRandomValues(new Uint8Array(n));let t="";for(let i=0,s=e.length;i<s;i+=1){const r=e[i]&63;r<36?t=`${t}${r.toString(36)}`:r<62?t=`${t}${(r-26).toString(36).toUpperCase()}`:r>62?t=`${t}-`:t=`${t}_`}return t},c$=[{name:"Animal GIFs",children:[{name:"Dogs",href:"#dogs",children:[{name:"treadmill.gif",href:"#treadmill"},{name:"rope-jumping.gif"}]},{name:"Bob",children:[{name:"treadmill.gif"},{name:"rope-jumping.gif"}]},{name:"Goats",selected:!0,children:[{name:"parkour.gif"},{name:"rampage.gif"}]},{name:"cat-roomba.gif"},{name:"duck-shuffle.gif"},{name:"monkey-on-a-pig.gif",children:[{name:"Dogs",children:[{name:"treadmill.gif"},{name:"rope-jumping.gif"}]},{name:"Goats",children:[{name:"parkour.gif"},{name:"rampage.gif"}]},{name:"cat-roomba.gif"},{name:"duck-shuffle.gif"},{name:"monkey-on-a-pig.gif",children:[{name:"Dogs",children:[{name:"treadmill.gif"},{name:"rope-jumping.gif"}]},{name:"Goats",children:[{name:"parkour.gif"},{name:"rampage.gif"}]},{name:"cat-roomba.gif"},{name:"duck-shuffle.gif"},{name:"monkey-on-a-pig.gif",children:[{name:"Dogs",children:[{name:"treadmill.gif"},{name:"rope-jumping.gif"},{name:"monkey-on-a-pig.gif",children:[{name:"Dogs",children:[{name:"treadmill.gif"},{name:"rope-jumping.gif"}]},{name:"Goats",children:[{name:"parkour.gif"},{name:"rampage.gif"},{name:"monkey-on-a-pig.gif",children:[{name:"Dogs",children:[{name:"treadmill.gif"},{name:"rope-jumping.gif"}]},{name:"Goats",children:[{name:"parkour.gif"},{name:"rampage.gif"}]},{name:"cat-roomba.gif"},{name:"duck-shuffle.gif"},{name:"monkey-on-a-pig.gif"}]}]},{name:"cat-roomba.gif"},{name:"duck-shuffle.gif"},{name:"monkey-on-a-pig.gif"}]}]},{name:"Goats",children:[{name:"parkour.gif"},{name:"rampage.gif"}]},{name:"cat-roomba.gif"},{name:"duck-shuffle.gif"},{name:"monkey-on-a-pig.gif"},{name:"monkey-on-a-pig.gif",children:[{name:"Dogs",children:[{name:"treadmill.gif"},{name:"rope-jumping.gif"}]},{name:"Goats",children:[{name:"parkour.gif"},{name:"rampage.gif"}]},{name:"cat-roomba.gif"},{name:"duck-shuffle.gif"},{name:"monkey-on-a-pig.gif"}]}]}]}]}]}];u$(c$,n=>{n.icon={path:"M2.61,21L1.61,19.27L11,13.85V3H13V13.85L22.39,19.27L21.39,21L12,15.58L2.61,21Z",viewBox:"0 0 24 24"},n.expanded=!0,n.id=n.name==="Bob"?"bob":bD()});function Me(n){return n==null}function jf(n){return n!==null&&typeof n=="object"}function kv(n){return n!==null&&typeof n=="object"}function gD(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function ho(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((i,s)=>{const r=n[s],o=e[s];return kv(r)&&kv(o)?Object.assign(Object.assign({},i),{[s]:ho(r,o)}):Object.assign(Object.assign({},i),{[s]:s in e?o:r})},{})}function CD(n){return jf(n)?"target"in n:!1}const PD={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};let co=class El{static alreadyDisposed(){return new El({type:"alreadydisposed"})}static notBindable(){return new El({type:"notbindable"})}static notCompatible(e,t){return new El({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new El({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new El({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=PD[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}},ZC=class p${constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const i=this.read();if(!p$.isBindable(i))throw co.notBindable();if(!(e in i))throw co.propertyNotFound(e);i[e]=t}},gn=class{constructor(){this.observers_={}}on(e,t,i){var s;let r=this.observers_[e];return r||(r=this.observers_[e]=[]),r.push({handler:t,key:(s=i==null?void 0:i.key)!==null&&s!==void 0?s:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter(s=>s.key!==t)),this}emit(e,t){const i=this.observers_[e];i&&i.forEach(s=>{s.handler(t)})}},yD=class{constructor(e,t){var i;this.constraint_=t==null?void 0:t.constraint,this.equals_=(i=t==null?void 0:t.equals)!==null&&i!==void 0?i:(s,r)=>s===r,this.emitter=new gn,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,r=this.rawValue_;this.equals_(r,s)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:i,previousRawValue:r,rawValue:s,sender:this}))}},ED=class{constructor(e){this.emitter=new gn,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.value_;s===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:this.value_,sender:this}))}},xD=class{constructor(e){this.emitter=new gn,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}};function ht(n,e){const t=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!t&&!i?new ED(n):new yD(n,e)}function $D(n){return[new xD(n),(e,t)=>{n.setRawValue(e,t)}]}let ge=class d${constructor(e){this.emitter=new gn,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((i,s)=>Object.assign(i,{[s]:ht(e[s])}),{})}static fromObject(e){const t=this.createCore(e);return new d$(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}},Sp=class{constructor(e){this.values=ge.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(e,i),t)}},VD=class{constructor(e){this.values=ge.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");let s=e;return Me(i)||(s=Math.max(s,i)),Me(t)||(s=Math.min(s,t)),s}},kD=class{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,i=Math.round((e-t)/this.step);return t+i*this.step}},SD=class{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}};const LD={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};let AD=class{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=LD[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}};const MD={"+":n=>n,"-":n=>-n,"~":n=>~n};let TD=class{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=MD[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}};function Nf(n){return(e,t)=>{for(let i=0;i<n.length;i++){const s=n[i](e,t);if(s!=="")return s}return""}}function Au(n,e){var t;const i=n.substr(e).match(/^\s+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function DD(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function Mu(n,e){var t;const i=n.substr(e).match(/^[0-9]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function OD(n,e){const t=Mu(n,e);if(t!=="")return t;const i=n.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";const s=Mu(n,e);return s===""?"":i+s}function Bf(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const i=OD(n,e);return i===""?"":t+i}function m$(n,e){const t=n.substr(e,1);if(t==="0")return t;const i=DD(n,e);return e+=i.length,i===""?"":i+Mu(n,e)}function RD(n,e){const t=m$(n,e);if(e+=t.length,t==="")return"";const i=n.substr(e,1);if(e+=i.length,i!==".")return"";const s=Mu(n,e);return e+=s.length,t+i+s+Bf(n,e)}function jD(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const i=Mu(n,e);return e+=i.length,i===""?"":t+i+Bf(n,e)}function ND(n,e){const t=m$(n,e);return e+=t.length,t===""?"":t+Bf(n,e)}const BD=Nf([RD,jD,ND]);function ID(n,e){var t;const i=n.substr(e).match(/^[01]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function FD(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const i=ID(n,e);return i===""?"":t+i}function KD(n,e){var t;const i=n.substr(e).match(/^[0-7]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function UD(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const i=KD(n,e);return i===""?"":t+i}function HD(n,e){var t;const i=n.substr(e).match(/^[0-9a-f]+/i);return(t=i&&i[0])!==null&&t!==void 0?t:""}function zD(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const i=HD(n,e);return i===""?"":t+i}const qD=Nf([FD,UD,zD]),GD=Nf([qD,BD]);function YD(n,e){const t=GD(n,e);return e+=t.length,t===""?null:{evaluable:new SD(t),cursor:e}}function XD(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const i=f$(n,e);if(!i)return null;e=i.cursor,e+=Au(n,e).length;const s=n.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:i.evaluable,cursor:e}}function WD(n,e){var t;return(t=YD(n,e))!==null&&t!==void 0?t:XD(n,e)}function v$(n,e){const t=WD(n,e);if(t)return t;const i=n.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const s=v$(n,e);return s?(e=s.cursor,{cursor:e,evaluable:new TD(i,s.evaluable)}):null}function ZD(n,e,t){t+=Au(e,t).length;const i=n.filter(s=>e.startsWith(s,t))[0];return i?(t+=i.length,t+=Au(e,t).length,{cursor:t,operator:i}):null}function QD(n,e){return(t,i)=>{const s=n(t,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const o=ZD(e,t,i);if(!o)break;i=o.cursor;const l=n(t,i);if(!l)return null;i=l.cursor,r=new AD(o.operator,r,l.evaluable)}return r?{cursor:i,evaluable:r}:null}}const JD=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>QD(n,e),v$);function f$(n,e){return e+=Au(n,e).length,JD(n,e)}function eO(n){const e=f$(n,0);return!e||e.cursor+Au(n,e.cursor).length!==n.length?null:e.evaluable}function Or(n){var e;const t=eO(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function w$(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=Or(n);if(!Me(e))return e}return 0}function an(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function ee(n,e,t,i,s){const r=(n-e)/(t-e);return i+r*(s-i)}function QC(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Qe(n,e,t){return Math.min(Math.max(n,e),t)}function _$(n,e){return(n%e+e)%e}function tO(n,e){return Me(n.step)?Math.max(QC(e),2):QC(n.step)}function b$(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function nO(n,e){var t;const i=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function g$(n,e){return Me(n.step)?null:new kD(n.step,e)}function C$(n){return!Me(n.max)&&!Me(n.min)?new Sp({max:n.max,min:n.min}):!Me(n.max)||!Me(n.min)?new VD({max:n.max,min:n.min}):null}function P$(n,e){var t,i,s;return{formatter:(t=n.format)!==null&&t!==void 0?t:an(tO(n,e)),keyScale:(i=n.keyScale)!==null&&i!==void 0?i:b$(n),pointerScale:(s=n.pointerScale)!==null&&s!==void 0?s:nO(n,e)}}function y$(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function If(n){return{constraint:n.constraint,textProps:ge.fromObject(P$(n.params,n.initialValue))}}let Ff=class{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}},Lp=class{constructor(e){this.target=e}},E$=class extends Lp{constructor(e,t,i){super(e),this.value=t,this.last=i??!0}},iO=class extends Lp{constructor(e,t){super(e),this.expanded=t}},sO=class extends Lp{constructor(e,t){super(e),this.index=t}},rO=class extends Lp{constructor(e,t){super(e),this.native=t}},Kf=class extends Ff{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new gn,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new E$(this,t.binding.target.read(),e.options.last))}};function oO(n,e){const i=Object.keys(e).reduce((s,r)=>{if(s===void 0)return;const o=e[r],l=o(n[r]);return l.succeeded?Object.assign(Object.assign({},s),{[r]:l.value}):void 0},{});return i}function lO(n,e){return n.reduce((t,i)=>{if(t===void 0)return;const s=e(i);if(!(!s.succeeded||s.value===void 0))return[...t,s.value]},[])}function aO(n){return n===null?!1:typeof n=="object"}function ns(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const i=n(t);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function JC(n){return{custom:e=>ns(e)(n),boolean:ns(e=>typeof e=="boolean"?e:void 0)(n),number:ns(e=>typeof e=="number"?e:void 0)(n),string:ns(e=>typeof e=="string"?e:void 0)(n),function:ns(e=>typeof e=="function"?e:void 0)(n),constant:e=>ns(t=>t===e?e:void 0)(n),raw:ns(e=>e)(n),object:e=>ns(t=>{if(aO(t))return oO(t,e)})(n),array:e=>ns(t=>{if(Array.isArray(t))return lO(t,e)})(n)}}const Sv={optional:JC(!0),required:JC(!1)};function Mt(n,e){const t=e(Sv),i=Sv.required.object(t)(n);return i.succeeded?i.value:void 0}function Fi(n,e,t,i){if(e&&!e(n))return!1;const s=Mt(n,t);return s?i(s):!1}function Ki(n,e){var t;return ho((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function yc(n){return"value"in n}function uO(n){if(!jf(n)||!("binding"in n))return!1;const e=n.binding;return CD(e)}const pi="http://www.w3.org/2000/svg";function Wc(n){n.offsetHeight}function hO(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function Uf(n){return n.ontouchstart!==void 0}function cO(){return globalThis}function pO(){return cO().document}function dO(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const mO={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Ap(n,e){const t=n.createElementNS(pi,"svg");return t.innerHTML=mO[e],t}function x$(n,e,t){n.insertBefore(e,n.children[t])}function Hf(n){n.parentElement&&n.parentElement.removeChild(n)}function $$(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function vO(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function V$(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function gs(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function gi(n,e,t){gs(n.value(e),t)}const fO="tp";function Q(n){return(t,i)=>[fO,"-",n,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}const Fa=Q("lbl");function wO(n,e){const t=n.createDocumentFragment();return e.split(`
`).map(s=>n.createTextNode(s)).forEach((s,r)=>{r>0&&t.appendChild(n.createElement("br")),t.appendChild(s)}),t}let _O=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Fa()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Fa("l")),gi(t.props,"label",r=>{Me(r)?this.element.classList.add(Fa(void 0,"nol")):(this.element.classList.remove(Fa(void 0,"nol")),vO(i),i.appendChild(wO(e,r)))}),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("div");s.classList.add(Fa("v")),this.element.appendChild(s),this.valueElement=s}},bO=class{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new _O(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return Fi(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return Ki(null,{label:this.props.get("label")})}};function gO(){return["veryfirst","first","last","verylast"]}const e0=Q(""),t0={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};let k$=class{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{gO().forEach(i=>{t.classList.remove(e0(void 0,t0[i]))}),this.blade.get("positions").forEach(i=>{t.classList.add(e0(void 0,t0[i]))})}),this.viewProps.handleDispose(()=>{Hf(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return Fi(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return Ki(null,Object.assign({},this.viewProps.exportState()))}},CO=class extends Ff{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const i=t.bind(this);return this.controller.buttonController.emitter.on(e,r=>{i(new rO(this,r.nativeEvent))}),this}off(e,t){return this.controller.buttonController.emitter.off(e,t),this}};function PO(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function wa(n,e){return t=>{PO(n,e,t)}}function zf(n,e){gs(n,t=>{e.textContent=t??""})}const Zd=Q("btn");let yO=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Zd()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(Zd("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(Zd("t")),zf(t.props.value("title"),s),this.buttonElement.appendChild(s)}},EO=class{constructor(e,t){this.emitter=new gn,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new yO(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return Fi(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return Ki(null,{title:this.props.get("title")})}onClick_(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}},n0=class extends k${constructor(e,t){const i=new EO(e,{props:t.buttonProps,viewProps:t.viewProps}),s=new bO(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:t.viewProps}),this.buttonController=i,this.labelController=s}importState(e){return Fi(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return Ki(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}},xO=class{constructor(e){const[t,i]=e.split("-"),s=t.split(".");this.major=parseInt(s[0],10),this.minor=parseInt(s[1],10),this.patch=parseInt(s[2],10),this.prerelease=i??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}};const $O=new xO("2.0.3");function Wt(n){return Object.assign({core:$O},n)}Wt({id:"button",type:"blade",accept(n){const e=Mt(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new n0(n.document,{blade:n.blade,buttonProps:ge.fromObject({title:n.params.title}),labelProps:ge.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof n0?new CO(n.controller):null}});function VO(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function kO(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function SO(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function LO(n){return jf(n)?"refresh"in n&&typeof n.refresh=="function":!1}function AO(n,e){if(!ZC.isBindable(n))throw co.notBindable();return new ZC(n,e)}let MO=class{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new gn,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,i){const s=i??{},r=this.controller_.element.ownerDocument,o=this.pool_.createBinding(r,AO(e,t),s),l=this.pool_.createBindingApi(o);return this.add(l,s.index)}addFolder(e){return kO(this,e)}addButton(e){return VO(this,e)}addTab(e){return SO(this,e)}add(e,t){const i=e.controller;return this.controller_.rack.add(i,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,i=this.pool_.createBlade(t,e),s=this.pool_.createApi(i);return this.add(s,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.children.forEach(e=>{LO(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,i=this.pool_.createApi(t),s=uO(t.value)?t.value.binding:null;this.emitter_.emit("change",new E$(i,s?s.target.read():t.value.rawValue,e.options.last))}},qf=class extends Ff{constructor(e,t){super(e),this.rackApi_=new MO(e.rackController,t)}refresh(){this.rackApi_.refresh()}},Gf=class extends k${constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return Fi(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((i,s)=>i.importState(t.children[s])))}exportState(){return Ki(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}};function Lv(n){return"rackController"in n}let TO=class{constructor(e){this.emitter=new gn,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw co.shouldNeverHappen();const i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(r=>{this.cache_.add(r)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.allItems().forEach(s=>{this.cache_.delete(s)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}};function DO(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(yc(i)&&i.value===e)return i}return null}function OO(n){return Lv(n)?n.rackController.rack.bcSet_:null}let RO=class{constructor(e){var t,i;this.emitter=new gn,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new TO(OO),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var i;(i=e.parent)===null||i===void 0||i.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),yc(i))i.value.emitter.on("change",this.onChildValueChange_);else if(Lv(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.on("layout",this.onRackLayout_),r.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const i=e.item;if(yc(i))i.value.emitter.off("change",this.onChildValueChange_);else if(Lv(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.off("layout",this.onRackLayout_),r.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(s=>!s.viewProps.get("hidden")),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach(s=>{const r=[];s===t&&(r.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&r.push("veryfirst")),s===i&&(r.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&r.push("verylast")),s.blade.set("positions",r)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=DO(this.find(yc),e.sender);if(!t)throw co.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}},Yf=class{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new RO({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let i=this.rack.children.length-1;i>=0;i--)this.rack.children[i].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&x$(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&Hf(e.bladeController.view.element)}};function S$(){return new ge({positions:ht([],{equals:gD})})}let Xf=class L$ extends ge{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=ge.createCore(t);return new L$(i)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!Me(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const i=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};gi(this,"expanded",i),gi(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}};function jO(n,e){let t=0;return hO(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),Wc(e),t=e.clientHeight,n.set("temporaryExpanded",null),Wc(e)}),t}function i0(n,e){e.style.height=n.styleHeight}function Wf(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),Me(n.get("expandedHeight"))){const t=jO(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),Wc(e)}),n.emitter.on("change",()=>{i0(n,e)}),i0(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}let NO=class extends qf{constructor(e,t){super(e,t),this.emitter_=new gn,this.controller.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",new iO(this,i.sender.rawValue))}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}};const A$=Q("cnt");let BO=class{constructor(e,t){var i;this.className_=Q((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),A$()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),gi(this.foldable_,"completed",wa(this.element,this.className_(void 0,"cpl")));const s=e.createElement("button");s.classList.add(this.className_("b")),gi(t.props,"title",u=>{Me(u)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const r=e.createElement("div");r.classList.add(this.className_("i")),this.element.appendChild(r);const o=e.createElement("div");o.classList.add(this.className_("t")),zf(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}},s0=class extends Gf{constructor(e,t){var i;const s=Xf.create((i=t.expanded)!==null&&i!==void 0?i:!0),r=new BO(e,{foldable:s,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Yf({blade:t.blade,element:r.containerElement,root:t.root,viewProps:t.viewProps}),view:r})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=s,Wf(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return Fi(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return Ki(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}};Wt({id:"folder",type:"blade",accept(n){const e=Mt(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new s0(n.document,{blade:n.blade,expanded:n.params.expanded,props:ge.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof s0?new NO(n.controller,n.pool):null}});const IO=Q("");function r0(n,e){return wa(n,IO(void 0,e))}let Zf=class M$ extends ge{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=$D(ht(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,i,s;const r=e??{};return new M$(ge.createCore({disabled:(t=r.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(i=r.hidden)!==null&&i!==void 0?i:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){gs(this.globalDisabled_,r0(e,"disabled")),gi(this,"hidden",r0(e,"hidden"))}bindDisabled(e){gs(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){gs(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const i=e.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}};const o0=Q("tbp");let FO=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(o0()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(o0("c")),this.element.appendChild(i),this.containerElement=i}};const Ka=Q("tbi");let KO=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ka()),t.viewProps.bindClassModifiers(this.element),gi(t.props,"selected",r=>{r?this.element.classList.add(Ka(void 0,"sel")):this.element.classList.remove(Ka(void 0,"sel"))});const i=e.createElement("button");i.classList.add(Ka("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(Ka("t")),zf(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}},UO=class{constructor(e,t){this.emitter=new gn,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new KO(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}},Av=class extends Gf{constructor(e,t){const i=new FO(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Yf({blade:t.blade,element:i.containerElement,viewProps:t.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new UO(e,{props:t.itemProps,viewProps:Zf.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,gi(this.props,"selected",s=>{this.itemController.props.set("selected",s),this.viewProps.set("hidden",!s)})}get itemController(){return this.ic_}importState(e){return Fi(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return Ki(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}},HO=class extends qf{constructor(e,t){super(e,t),this.emitter_=new gn,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,i=new Av(t,{blade:S$(),itemProps:ge.fromObject({selected:!1,title:e.title}),props:ge.fromObject({selected:!1}),viewProps:Zf.create()}),s=this.pool_.createApi(i);return this.rackApi_.add(s,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}onSelect_(e){this.emitter_.emit("select",new sO(this,e.rawValue))}},zO=class extends qf{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}};const l0=-1;let qO=class{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=ht(!0),this.selectedIndex=ht(l0),this.items_=[]}add(e,t){const i=t??this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=l0,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,i)=>{t.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,i)=>{t.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(i=>i===e.sender);this.items_.forEach((i,s)=>{i.rawValue=s===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}};const Ua=Q("tab");let GO=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ua(),A$()),t.viewProps.bindClassModifiers(this.element),gs(t.empty,wa(this.element,Ua(void 0,"nop")));const i=e.createElement("div");i.classList.add(Ua("t")),this.element.appendChild(i),this.itemsElement=i;const s=e.createElement("div");s.classList.add(Ua("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(Ua("c")),this.element.appendChild(r),this.contentsElement=r}},a0=class extends Gf{constructor(e,t){const i=new qO,s=new GO(e,{empty:i.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new Yf({blade:t.blade,element:s.contentsElement,viewProps:t.viewProps}),view:s}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=this.rackController.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.tab=i}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;x$(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;Hf(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}};Wt({id:"tab",type:"blade",accept(n){const e=Mt(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new a0(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const i=new Av(n.document,{blade:S$(),itemProps:ge.fromObject({selected:!1,title:t.title}),props:ge.fromObject({selected:!1}),viewProps:Zf.create()});e.add(i)}),e},api(n){return n.controller instanceof a0?new HO(n.controller,n.pool):n.controller instanceof Av?new zO(n.controller,n.pool):null}});let Qf=class extends Kf{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}},wh=class{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,i)=>i.constrain(t),e)}};function Zc(n,e){if(n instanceof e)return n;if(n instanceof wh){const t=n.constraints.reduce((i,s)=>i||(s instanceof e?s:null),null);if(t)return t}return null}let Mp=class{constructor(e){this.values=ge.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(s=>s.value===e).length>0?e:t[0].value}};function Tp(n){var e;const t=Sv;if(Array.isArray(n))return(e=Mt({items:n},i=>({items:i.required.array(i.required.object({text:i.required.string,value:i.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function T$(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function Jf(n){return Me(n)?null:new Mp(T$(n))}const Qd=Q("lst");let YO=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(Qd()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(Qd("s")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const s=e.createElement("div");s.classList.add(Qd("m")),s.appendChild(Ap(e,"dropdown")),this.element.appendChild(s),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,gi(this.props_,"options",r=>{$$(this.selectElement),r.forEach(o=>{const l=e.createElement("option");l.textContent=o.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}},Zl=class{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new YO(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return Fi(e,null,t=>({options:t.required.custom(Tp)}),t=>(this.props.set("options",T$(t.options)),!0))}exportProps(){return Ki(null,{options:this.props.get("options")})}};const u0=Q("pop");let XO=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(u0()),t.viewProps.bindClassModifiers(this.element),gs(t.shows,wa(this.element,u0(void 0,"v")))}},D$=class{constructor(e,t){this.shows=ht(!1),this.viewProps=t.viewProps,this.view=new XO(e,{shows:this.shows,viewProps:this.viewProps})}};const h0=Q("txt");let WO=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(h0()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(h0("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}},ew=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new WO(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Me(s)||(this.value.rawValue=s),this.view.refresh()}};function ZO(n){return String(n)}function O$(n){return n==="false"?!1:!!n}function c0(n){return ZO(n)}function QO(n){return e=>n.reduce((t,i)=>t!==null?t:i(e),null)}const JO=an(0);function Qc(n){return JO(n)+"%"}function R$(n){return String(n)}function Mv(n){return n}function _a({primary:n,secondary:e,forward:t,backward:i}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}n.emitter.on("change",o=>{r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),e.emitter.on("change",o=>{r(()=>{n.setRawValue(i(n.rawValue,e.rawValue),o.options)}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function en(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function Tu(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function ks(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function eR(n){return n==="ArrowUp"||n==="ArrowDown"}function j$(n){return eR(n)||n==="ArrowLeft"||n==="ArrowRight"}function Jd(n,e){var t,i;const s=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:n.pageX-(((t=s&&s.scrollX)!==null&&t!==void 0?t:0)+r.left),y:n.pageY-(((i=s&&s.scrollY)!==null&&i!==void 0?i:0)+r.top)}}let Io=class{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new gn,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Jd(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Jd(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Jd(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-s.left,y:i.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}};const Ln=Q("txt");let tR=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Ln(),Ln(void 0,"num")),t.arrayPosition&&this.element.classList.add(Ln(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(Ln("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Ln()),this.inputElement.classList.add(Ln("i"));const s=e.createElement("div");s.classList.add(Ln("k")),this.element.appendChild(s),this.knobElement=s;const r=e.createElementNS(pi,"svg");r.classList.add(Ln("g")),this.knobElement.appendChild(r);const o=e.createElementNS(pi,"path");o.classList.add(Ln("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=e.createElementNS(pi,"path");l.classList.add(Ln("gh")),r.appendChild(l),this.guideHeadElem_=l;const a=e.createElement("div");a.classList.add(Q("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(Ln(void 0,"drg"));return}this.element.classList.add(Ln(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),i=t+(t>0?-1:t<0?1:0),s=Qe(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+s},0 L${i},4 L${i+s},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}},_h=class{constructor(e,t){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(i=t.sliderProps)!==null&&i!==void 0?i:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=ht(null),this.view=new tR(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new Io(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,i;const s=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),r=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("max");let o=e;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Me(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const t=en(this.props.get("keyScale"),Tu(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){en(this.props.get("keyScale"),Tu(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}};const em=Q("sld");let nR=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(em()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(em("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const s=e.createElement("div");s.classList.add(em("k")),this.trackElement.appendChild(s),this.knobElement=s,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=Qe(ee(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}},iR=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new nR(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Io(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(ee(Qe(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=en(this.props.get("keyScale"),ks(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){en(this.props.get("keyScale"),ks(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const tm=Q("sldtxt");let sR=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(tm());const i=e.createElement("div");i.classList.add(tm("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(tm("t")),this.textView_=t.textView,s.appendChild(this.textView_.element),this.element.appendChild(s)}},p0=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new iR(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new _h(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new sR(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return Fi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const i=this.sliderC_.props;return i.set("max",t.max),i.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return Ki(null,{max:e.get("max"),min:e.get("min")})}};function rR(n){return{sliderProps:new ge({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new ge({formatter:ht(n.formatter),keyScale:n.keyScale,pointerScale:ht(n.pointerScale)})}}const oR={containerUnitSize:"cnt-usz"};function N$(n){return`--${oR[n]}`}function Du(n){return y$(n)}function fr(n){if(kv(n))return Mt(n,Du)}function cs(n,e){if(!n)return;const t=[],i=g$(n,e);i&&t.push(i);const s=C$(n);return s&&t.push(s),new wh(t)}function B$(n){if(n==="inline"||n==="popup")return n}function bh(n,e){n.write(e)}const uc=Q("ckb");let lR=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(uc()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(uc("l")),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("input");s.classList.add(uc("i")),s.type="checkbox",this.labelElement.appendChild(s),this.inputElement=s,t.viewProps.bindDisabled(this.inputElement);const r=e.createElement("div");r.classList.add(uc("w")),this.labelElement.appendChild(r);const o=Ap(e,"check");r.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}},aR=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new lR(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked,e.preventDefault(),e.stopPropagation()}onLabelMouseDown_(e){e.preventDefault()}};function uR(n){const e=[],t=Jf(n.options);return t&&e.push(t),new wh(e)}Wt({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Mt(e,i=>({options:i.optional.custom(Tp),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>O$,constraint:n=>uR(n.params),writer:n=>bh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&Zc(i,Mp);return s?new Zl(e,{props:new ge({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new aR(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof Zl?new Qf(n.controller):null}});const Gr=Q("col");let hR=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Gr()),t.foldable.bindExpandedClass(this.element,Gr(void 0,"expanded")),gi(t.foldable,"completed",wa(this.element,Gr(void 0,"cpl")));const i=e.createElement("div");i.classList.add(Gr("h")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Gr("s")),i.appendChild(s),this.swatchElement=s;const r=e.createElement("div");if(r.classList.add(Gr("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(Gr("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};function cR(n,e,t){const i=Qe(n/255,0,1),s=Qe(e/255,0,1),r=Qe(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u=0,h=0;const c=(l+o)/2;return a!==0&&(h=a/(1-Math.abs(o+l-1)),i===o?u=(s-r)/a:s===o?u=2+(r-i)/a:u=4+(i-s)/a,u=u/6+(u<0?1:0)),[u*360,h*100,c*100]}function pR(n,e,t){const i=(n%360+360)%360,s=Qe(e/100,0,1),r=Qe(t/100,0,1),o=(1-Math.abs(2*r-1))*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o/2;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function dR(n,e,t){const i=Qe(n/255,0,1),s=Qe(e/255,0,1),r=Qe(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u;a===0?u=0:o===i?u=60*(((s-r)/a%6+6)%6):o===s?u=60*((r-i)/a+2):u=60*((i-s)/a+4);const h=o===0?0:a/o,c=o;return[u,h*100,c*100]}function I$(n,e,t){const i=_$(n,360),s=Qe(e/100,0,1),r=Qe(t/100,0,1),o=r*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function mR(n,e,t){const i=t+e*(100-Math.abs(2*t-100))/200;return[n,i!==0?e*(100-Math.abs(2*t-100))/i:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function vR(n,e,t){const i=100-Math.abs(t*(200-e)/100-100);return[n,i!==0?e*t/i:0,t*(200-e)/(2*100)]}function Ci(n){return[n[0],n[1],n[2]]}function Dp(n,e){return[n[0],n[1],n[2],e]}const fR={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:mR,rgb:pR},hsv:{hsl:vR,hsv:(n,e,t)=>[n,e,t],rgb:I$},rgb:{hsl:cR,hsv:dR,rgb:(n,e,t)=>[n,e,t]}};function Ql(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function wR(n,e){return n===e?e:_$(n,e)}function F$(n,e,t){var i;const s=Ql(e,t);return[e==="rgb"?Qe(n[0],0,s[0]):wR(n[0],s[0]),Qe(n[1],0,s[1]),Qe(n[2],0,s[2]),Qe((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function d0(n,e,t,i){const s=Ql(e,t),r=Ql(e,i);return n.map((o,l)=>o/s[l]*r[l])}function K$(n,e,t){const i=d0(n,e.mode,e.type,"int"),s=fR[e.mode][t.mode](...i);return d0(s,t.mode,"int",t.type)}let le=class U${static black(){return new U$([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=F$(e,t,this.type)}getComponents(e){return Dp(K$(Ci(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const Is=Q("colp");let _R=class{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Is()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Is("hsv"));const s=e.createElement("div");s.classList.add(Is("sv")),this.svPaletteView_=t.svPaletteView,s.appendChild(this.svPaletteView_.element),i.appendChild(s);const r=e.createElement("div");r.classList.add(Is("h")),this.hPaletteView_=t.hPaletteView,r.appendChild(this.hPaletteView_.element),i.appendChild(r),this.element.appendChild(i);const o=e.createElement("div");if(o.classList.add(Is("rgb")),this.textsView_=t.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const l=e.createElement("div");l.classList.add(Is("a"));const a=e.createElement("div");a.classList.add(Is("ap")),a.appendChild(this.alphaViews_.palette.element),l.appendChild(a);const u=e.createElement("div");u.classList.add(Is("at")),u.appendChild(this.alphaViews_.text.element),l.appendChild(u),this.element.appendChild(l)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}};function bR(n){return n==="int"?"int":n==="float"?"float":void 0}function tw(n){return Mt(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(bR)}),expanded:e.optional.boolean,picker:e.optional.custom(B$),readonly:e.optional.constant(!1)}))}function po(n){return n?.1:1}function H$(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}let nw=class{constructor(e,t){this.type="float",this.mode=t,this.comps_=F$(e,t,this.type)}getComponents(e){return Dp(K$(Ci(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const gR={int:(n,e)=>new le(n,e),float:(n,e)=>new nw(n,e)};function iw(n,e,t){return gR[t](n,e)}function CR(n){return n.type==="float"}function PR(n){return n.type==="int"}function yR(n){const e=n.getComponents(),t=Ql(n.mode,"int");return new le([Math.round(ee(e[0],0,1,0,t[0])),Math.round(ee(e[1],0,1,0,t[1])),Math.round(ee(e[2],0,1,0,t[2])),e[3]],n.mode)}function ER(n){const e=n.getComponents(),t=Ql(n.mode,"int");return new nw([ee(e[0],0,t[0],0,1),ee(e[1],0,t[1],0,1),ee(e[2],0,t[2],0,1),e[3]],n.mode)}function It(n,e){if(n.type===e)return n;if(PR(n)&&e==="float")return ER(n);if(CR(n)&&e==="int")return yR(n);throw co.shouldNeverHappen()}function xR(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function Kn(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const $R={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function z$(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),i=e[2];return $R[i](t)}function q$(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Kn(e[1],255),Kn(e[2],255),Kn(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function VR(n){const e=q$(n);return e?new le(e,"rgb"):null}function G$(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Kn(e[1],255),Kn(e[2],255),Kn(e[3],255),Kn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function kR(n){const e=G$(n);return e?new le(e,"rgb"):null}function Y$(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[z$(e[1]),Kn(e[2],100),Kn(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function SR(n){const e=Y$(n);return e?new le(e,"hsl"):null}function X$(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[z$(e[1]),Kn(e[2],100),Kn(e[3],100),Kn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function LR(n){const e=X$(n);return e?new le(e,"hsl"):null}function W$(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function AR(n){const e=W$(n);return e?new le(e,"rgb"):null}function Z$(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),ee(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),ee(parseInt(t[4],16),0,255,0,1)]:null}function MR(n){const e=Z$(n);return e?new le(e,"rgb"):null}function Q$(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function TR(n){return e=>{const t=Q$(e);return t?iw(t,"rgb",n):null}}function J$(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function DR(n){return e=>{const t=J$(e);return t?iw(t,"rgb",n):null}}const OR=[{parser:W$,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Z$,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:q$,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:G$,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Y$,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:X$,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Q$,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:J$,result:{alpha:!0,mode:"rgb",notation:"object"}}];function RR(n){return OR.reduce((e,{parser:t,result:i})=>e||(t(n)?i:null),null)}function jR(n,e="int"){const t=RR(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function gh(n){const e=[AR,MR,VR,kR,SR,LR];e.push(TR("int"),DR("int"));const t=QO(e);return i=>{const s=t(i);return s?It(s,n):null}}function NR(n){const e=gh("int");if(typeof n!="string")return le.black();const t=e(n);return t??le.black()}function eV(n){const e=Qe(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function sw(n,e="#"){const t=Ci(n.getComponents("rgb")).map(eV).join("");return`${e}${t}`}function rw(n,e="#"){const t=n.getComponents("rgb"),i=[t[0],t[1],t[2],t[3]*255].map(eV).join("");return`${e}${i}`}function tV(n){const e=an(0),t=It(n,"int");return`rgb(${Ci(t.getComponents("rgb")).map(s=>e(s)).join(", ")})`}function Ec(n){const e=an(2),t=an(0);return`rgba(${It(n,"int").getComponents("rgb").map((r,o)=>(o===3?e:t)(r)).join(", ")})`}function BR(n){const e=[an(0),Qc,Qc],t=It(n,"int");return`hsl(${Ci(t.getComponents("hsl")).map((s,r)=>e[r](s)).join(", ")})`}function IR(n){const e=[an(0),Qc,Qc,an(2)];return`hsla(${It(n,"int").getComponents("hsl").map((s,r)=>e[r](s)).join(", ")})`}function nV(n,e){const t=an(e==="float"?2:0),i=["r","g","b"],s=It(n,e);return`{${Ci(s.getComponents("rgb")).map((o,l)=>`${i[l]}: ${t(o)}`).join(", ")}}`}function FR(n){return e=>nV(e,n)}function iV(n,e){const t=an(2),i=an(e==="float"?2:0),s=["r","g","b","a"];return`{${It(n,e).getComponents("rgb").map((l,a)=>{const u=a===3?t:i;return`${s[a]}: ${u(l)}`}).join(", ")}}`}function KR(n){return e=>iV(e,n)}const UR=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:sw},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:rw},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:tV},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:Ec},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:BR},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:IR},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:FR(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:KR(e)}],[])];function sV(n){return UR.reduce((e,t)=>e||(xR(t.format,n)?t.stringifier:null),null)}const Ha=Q("apl");let HR=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Ha()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Ha("b")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Ha("c")),i.appendChild(s),this.colorElem_=s;const r=e.createElement("div");r.classList.add(Ha("m")),this.element.appendChild(r),this.markerElem_=r;const o=e.createElement("div");o.classList.add(Ha("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new le([t[0],t[1],t[2],0],"rgb"),s=new le([t[0],t[1],t[2],255],"rgb"),r=["to right",Ec(i),Ec(s)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=Ec(e);const o=ee(t[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}},zR=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new HR(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Io(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,s=this.value.rawValue,[r,o,l]=s.getComponents("hsv");this.value.setRawValue(new le([r,o,l,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=en(po(!0),ks(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new le([s,r,o,l+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){en(po(!0),ks(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const el=Q("coltxt");function qR(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((i,s)=>{const r=n.createElement("option");return r.textContent=s.text,r.value=s.value,i.appendChild(r),i},n.createDocumentFragment())),e}let GR=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(el()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(el("m")),this.modeElem_=qR(e),this.modeElem_.classList.add(el("ms")),i.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const s=e.createElement("div");s.classList.add(el("mm")),s.appendChild(Ap(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(el("w")),this.element.appendChild(r),this.inputsElem_=r,this.inputViews_=t.inputViews,this.applyInputViews_(),gs(t.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){$$(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const i=e.createElement("div");i.classList.add(el("c")),i.appendChild(t.element),this.inputsElem_.appendChild(i)})}};function YR(n){return an(n==="float"?2:0)}function XR(n,e,t){const i=Ql(n,e)[t];return new Sp({min:0,max:i})}function WR(n,e,t){return new _h(n,{arrayPosition:t===0?"fst":t===2?"lst":"mid",parser:e.parser,props:ge.fromObject({formatter:YR(e.colorType),keyScale:po(!1),pointerScale:e.colorType==="float"?.01:1}),value:ht(0,{constraint:XR(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function ZR(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:Or,viewProps:e.viewProps};return[0,1,2].map(i=>{const s=WR(n,t,i);return _a({primary:e.value,secondary:s.value,forward(r){return It(r,e.colorType).getComponents(e.colorMode)[i]},backward(r,o){const l=e.colorMode,u=It(r,e.colorType).getComponents(l);u[i]=o;const h=iw(Dp(Ci(u),u[3]),l,e.colorType);return It(h,"int")}}),s})}function QR(n,e){const t=new ew(n,{parser:gh("int"),props:ge.fromObject({formatter:sw}),value:ht(le.black()),viewProps:e.viewProps});return _a({primary:e.value,secondary:t.value,forward:i=>new le(Ci(i.getComponents()),i.mode),backward:(i,s)=>new le(Dp(Ci(s.getComponents(i.mode)),i.getComponents()[3]),i.mode)}),[t]}function JR(n){return n!=="hex"}let ej=class{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=ht(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new GR(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return JR(t)?ZR(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):QR(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(i=>i.view)}};const nm=Q("hpl");let tj=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(nm()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(nm("c")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(nm("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=tV(new le([t,100,100],"hsv"));const i=ee(t,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}},nj=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new tj(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Io(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=ee(Qe(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),s=this.value.rawValue,[,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new le([i,r,o,l],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=en(po(!1),ks(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new le([s+t,r,o,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){en(po(!1),ks(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const im=Q("svp"),m0=64;let ij=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(im()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=m0,i.width=m0,i.classList.add(im("c")),this.element.appendChild(i),this.canvasElement=i;const s=e.createElement("div");s.classList.add(im("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=dO(this.canvasElement);if(!e)return;const i=this.value.rawValue.getComponents("hsv"),s=this.canvasElement.width,r=this.canvasElement.height,o=e.getImageData(0,0,s,r),l=o.data;for(let h=0;h<r;h++)for(let c=0;c<s;c++){const d=ee(c,0,s,0,100),p=ee(h,0,r,100,0),v=I$(i[0],d,p),m=(h*s+c)*4;l[m]=v[0],l[m+1]=v[1],l[m+2]=v[2],l[m+3]=255}e.putImageData(o,0,0);const a=ee(i[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const u=ee(i[2],0,100,100,0);this.markerElem_.style.top=`${u}%`}onValueChange_(){this.update_()}},sj=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new ij(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Io(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=ee(e.point.x,0,e.bounds.width,0,100),s=ee(e.point.y,0,e.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new le([r,i,s,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){j$(e.key)&&e.preventDefault();const[t,i,s,r]=this.value.rawValue.getComponents("hsv"),o=po(!1),l=en(o,ks(e)),a=en(o,Tu(e));l===0&&a===0||this.value.setRawValue(new le([t,i+l,s+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=po(!1),i=en(t,ks(e)),s=en(t,Tu(e));i===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},rj=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new nj(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new sj(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new zR(e,{value:this.value,viewProps:this.viewProps}),text:new _h(e,{parser:Or,props:ge.fromObject({pointerScale:.01,keyScale:.1,formatter:an(2)}),value:ht(0,{constraint:new Sp({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&_a({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.getComponents()[3],backward:(i,s)=>{const r=i.getComponents();return r[3]=s,new le(r,i.mode)}}),this.textsC_=new ej(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new _R(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}};const sm=Q("colsw");let oj=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(sm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(sm("sw")),this.element.appendChild(i),this.swatchElem_=i;const s=e.createElement("button");s.classList.add(sm("b")),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=rw(e)}onValueChange_(){this.update_()}},lj=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new oj(e,{value:this.value,viewProps:this.viewProps})}},ow=class{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Xf.create(t.expanded),this.swatchC_=new lj(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new ew(e,{parser:t.parser,props:ge.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new hR(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new D$(e,{viewProps:this.viewProps}):null;const s=new rj(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),_a({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Wf(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=V$(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!Uf(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}};function aj(n){return Ci(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function uj(n){return n.getComponents("rgb").reduce((e,t,i)=>{const s=Math.floor(i===3?t*255:t)&255;return e<<8|s},0)>>>0}function hj(n){return new le([n>>16&255,n>>8&255,n&255],"rgb")}function cj(n){return new le([n>>24&255,n>>16&255,n>>8&255,ee(n&255,0,255,0,1)],"rgb")}function pj(n){return typeof n!="number"?le.black():hj(n)}function dj(n){return typeof n!="number"?le.black():cj(n)}function xc(n,e){return typeof n!="object"||Me(n)?!1:e in n&&typeof n[e]=="number"}function lw(n){return xc(n,"r")&&xc(n,"g")&&xc(n,"b")}function aw(n){return lw(n)&&xc(n,"a")}function rV(n){return lw(n)}function uw(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),i=e.getComponents();for(let s=0;s<t.length;s++)if(t[s]!==i[s])return!1;return!0}function v0(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function mj(n){const e=sV(n);return e?(t,i)=>{bh(t,e(i))}:null}function vj(n){const e=n?uj:aj;return(t,i)=>{bh(t,e(i))}}function fj(n,e,t){const s=It(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b),n.writeProperty("a",s.a)}function wj(n,e,t){const s=It(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b)}function _j(n,e){return(t,i)=>{n?fj(t,i,e):wj(t,i,e)}}function bj(n){var e;return!!(!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function gj(n){return n?e=>rw(e,"0x"):e=>sw(e,"0x")}function Cj(n){return"color"in n||n.view==="color"}Wt({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!Cj(e))return null;const t=tw(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:bj(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?dj:pj,equals:uw,writer:n=>vj(n.params.supportsAlpha)},controller:n=>{var e,t;return new ow(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:gj(n.params.supportsAlpha),parser:gh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function Pj(n,e){if(!rV(n))return It(le.black(),e);if(e==="int"){const t=v0(n);return new le(t,"rgb")}if(e==="float"){const t=v0(n);return new nw(t,"rgb")}return It(le.black(),"int")}function yj(n){return aw(n)}function Ej(n){return e=>{const t=Pj(e,n);return It(t,"int")}}function xj(n,e){return t=>n?iV(t,e):nV(t,e)}Wt({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!rV(n))return null;const i=tw(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{colorType:(t=H$(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>Ej(n.params.colorType),equals:uw,writer:n=>_j(yj(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const i=aw(n.initialValue);return new ow(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:xj(i,n.params.colorType),parser:gh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:i,value:n.value,viewProps:n.viewProps})}});Wt({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=jR(n,H$(e));if(!t)return null;const i=sV(t);if(!i)return null;const s=tw(e);return s?{initialValue:n,params:Object.assign(Object.assign({},s),{format:t,stringifier:i})}:null},binding:{reader:()=>NR,equals:uw,writer:n=>{const e=mj(n.params.format);if(!e)throw co.notBindable();return e}},controller:n=>{var e,t;return new ow(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:gh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});let hw=class{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((i,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(i))!==null&&o!==void 0?o:i});return this.asm_.fromComponents(t)}};const f0=Q("pndtxt");let $j=class{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(f0()),this.textViews.forEach(i=>{const s=e.createElement("div");s.classList.add(f0("a")),s.appendChild(i.element),this.element.appendChild(s)})}};function Vj(n,e,t){return new _h(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:ht(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}let cw=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((i,s)=>Vj(e,t,s)),this.acs_.forEach((i,s)=>{_a({primary:this.value,secondary:i.value,forward:r=>t.assembly.toComponents(r)[s],backward:(r,o)=>{const l=t.assembly.toComponents(r);return l[s]=o,t.assembly.fromComponents(l)}})}),this.view=new $j(e,{textViews:this.acs_.map(i=>i.view)})}get textControllers(){return this.acs_}},kj=class extends Kf{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}};function Sj(n,e){const t=[],i=g$(n,e);i&&t.push(i);const s=C$(n);s&&t.push(s);const r=Jf(n.options);return r&&t.push(r),new wh(t)}Wt({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=Mt(e,i=>Object.assign(Object.assign({},y$(i)),{options:i.optional.custom(Tp),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>w$,constraint:n=>Sj(n.params,n.initialValue),writer:n=>bh},controller:n=>{const e=n.value,t=n.constraint,i=t&&Zc(t,Mp);if(i)return new Zl(n.document,{props:new ge({options:i.values.value("options")}),value:e,viewProps:n.viewProps});const s=P$(n.params,e.rawValue),r=t&&Zc(t,Sp);return r?new p0(n.document,Object.assign(Object.assign({},rR(Object.assign(Object.assign({},s),{keyScale:ht(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:Or,value:e,viewProps:n.viewProps})):new _h(n.document,{parser:Or,props:ge.fromObject(s),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof p0?new kj(n.controller):n.controller.valueController instanceof Zl?new Qf(n.controller):null}});let Er=class{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(Me(e))return!1;const t=e.x,i=e.y;return!(typeof t!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}};const oV={toComponents:n=>n.getComponents(),fromComponents:n=>new Er(...n)},tl=Q("p2d");let Lj=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(tl()),t.viewProps.bindClassModifiers(this.element),gs(t.expanded,wa(this.element,tl(void 0,"expanded")));const i=e.createElement("div");i.classList.add(tl("h")),this.element.appendChild(i);const s=e.createElement("button");s.classList.add(tl("b")),s.appendChild(Ap(e,"p2dpad")),t.viewProps.bindDisabled(s),i.appendChild(s),this.buttonElement=s;const r=e.createElement("div");if(r.classList.add(tl("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(tl("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};const Fs=Q("p2dp");let Aj=class{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(Fs()),t.layout==="popup"&&this.element.classList.add(Fs(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Fs("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=e.createElementNS(pi,"svg");s.classList.add(Fs("g")),this.padElement.appendChild(s),this.svgElem_=s;const r=e.createElementNS(pi,"line");r.classList.add(Fs("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=e.createElementNS(pi,"line");o.classList.add(Fs("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const l=e.createElementNS(pi,"line");l.classList.add(Fs("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const a=e.createElement("div");a.classList.add(Fs("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.props_.get("max"),s=ee(e,-i,+i,0,100),r=ee(t,-i,+i,0,100),o=this.props_.get("invertsY")?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${s}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${s}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}};function w0(n,e,t){return[en(e[0],ks(n)),en(e[1],Tu(n))*(t?1:-1)]}let Mj=class{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Aj(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Io(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.props.get("max"),s=ee(e.point.x,0,e.bounds.width,-i,+i),r=ee(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new Er(s,r),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){j$(e.key)&&e.preventDefault();const[t,i]=w0(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(new Er(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=w0(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},Tj=class{constructor(e,t){var i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Xf.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new D$(e,{viewProps:this.viewProps}):null;const r=new Mj(e,{layout:t.pickerLayout,props:new ge({invertsY:ht(t.invertsY),max:ht(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.textC_=new cw(e,{assembly:oV,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new Lj(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),_a({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Wf(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=V$(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!Uf(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}};function Dj(n){return Er.isObject(n)?new Er(n.x,n.y):new Er}function Oj(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function Rj(n,e){return new hw({assembly:oV,components:[cs(Object.assign(Object.assign({},n),n.x),e.x),cs(Object.assign(Object.assign({},n),n.y),e.y)]})}function _0(n,e){var t,i;if(!Me(n.min)||!Me(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((i=n.max)!==null&&i!==void 0?i:0));const s=b$(n);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function jj(n,e){var t,i;const s=_0(ho(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),r=_0(ho(n,(i=n.y)!==null&&i!==void 0?i:{}),e.y);return Math.max(s,r)}function Nj(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}Wt({id:"input-point2d",type:"input",accept:(n,e)=>{if(!Er.isObject(n))return null;const t=Mt(e,i=>Object.assign(Object.assign({},Du(i)),{expanded:i.optional.boolean,picker:i.optional.custom(B$),readonly:i.optional.constant(!1),x:i.optional.custom(fr),y:i.optional.object(Object.assign(Object.assign({},Du(i)),{inverted:i.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>Dj,constraint:n=>Rj(n.params,n.initialValue),equals:Er.equals,writer:()=>Oj},controller:n=>{var e,t;const i=n.document,s=n.value,r=n.constraint,o=[n.params.x,n.params.y];return new Tj(i,{axes:s.rawValue.getComponents().map((l,a)=>{var u;return If({constraint:r.components[a],initialValue:l,params:ho(n.params,(u=o[a])!==null&&u!==void 0?u:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:Nj(n.params),max:jj(n.params,s.rawValue),parser:Or,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:n.viewProps})}});let Ml=class{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(Me(e))return!1;const t=e.x,i=e.y,s=e.z;return!(typeof t!="number"||typeof i!="number"||typeof s!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}};const lV={toComponents:n=>n.getComponents(),fromComponents:n=>new Ml(...n)};function Bj(n){return Ml.isObject(n)?new Ml(n.x,n.y,n.z):new Ml}function Ij(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function Fj(n,e){return new hw({assembly:lV,components:[cs(Object.assign(Object.assign({},n),n.x),e.x),cs(Object.assign(Object.assign({},n),n.y),e.y),cs(Object.assign(Object.assign({},n),n.z),e.z)]})}Wt({id:"input-point3d",type:"input",accept:(n,e)=>{if(!Ml.isObject(n))return null;const t=Mt(e,i=>Object.assign(Object.assign({},Du(i)),{readonly:i.optional.constant(!1),x:i.optional.custom(fr),y:i.optional.custom(fr),z:i.optional.custom(fr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Bj,constraint:n=>Fj(n.params,n.initialValue),equals:Ml.equals,writer:n=>Ij},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z];return new cw(n.document,{assembly:lV,axes:e.rawValue.getComponents().map((s,r)=>{var o;return If({constraint:t.components[r],initialValue:s,params:ho(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Or,value:e,viewProps:n.viewProps})}});let Tl=class{constructor(e=0,t=0,i=0,s=0){this.x=e,this.y=t,this.z=i,this.w=s}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(Me(e))return!1;const t=e.x,i=e.y,s=e.z,r=e.w;return!(typeof t!="number"||typeof i!="number"||typeof s!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}};const aV={toComponents:n=>n.getComponents(),fromComponents:n=>new Tl(...n)};function Kj(n){return Tl.isObject(n)?new Tl(n.x,n.y,n.z,n.w):new Tl}function Uj(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function Hj(n,e){return new hw({assembly:aV,components:[cs(Object.assign(Object.assign({},n),n.x),e.x),cs(Object.assign(Object.assign({},n),n.y),e.y),cs(Object.assign(Object.assign({},n),n.z),e.z),cs(Object.assign(Object.assign({},n),n.w),e.w)]})}Wt({id:"input-point4d",type:"input",accept:(n,e)=>{if(!Tl.isObject(n))return null;const t=Mt(e,i=>Object.assign(Object.assign({},Du(i)),{readonly:i.optional.constant(!1),w:i.optional.custom(fr),x:i.optional.custom(fr),y:i.optional.custom(fr),z:i.optional.custom(fr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Kj,constraint:n=>Hj(n.params,n.initialValue),equals:Tl.equals,writer:n=>Uj},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z,n.params.w];return new cw(n.document,{assembly:aV,axes:e.rawValue.getComponents().map((s,r)=>{var o;return If({constraint:t.components[r],initialValue:s,params:ho(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Or,value:e,viewProps:n.viewProps})}});function zj(n){const e=[],t=Jf(n.options);return t&&e.push(t),new wh(e)}Wt({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=Mt(e,i=>({readonly:i.optional.constant(!1),options:i.optional.custom(Tp)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>R$,constraint:n=>zj(n.params),writer:n=>bh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&Zc(i,Mp);return s?new Zl(e,{props:new ge({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new ew(e,{parser:r=>r,props:ge.fromObject({formatter:Mv}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof Zl?new Qf(n.controller):null}});const Op={monitor:{defaultInterval:200,defaultRows:3}},b0=Q("mll");let qj=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(b0()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(b0("i")),i.style.height=`calc(var(${N$("containerUnitSize")}) * ${t.rows})`,i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach(s=>{s!==void 0&&i.push(this.formatter_(s))}),e.textContent=i.join(`
`),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}},pw=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new qj(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}};const g0=Q("sgl");let Gj=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(g0()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(g0("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}},dw=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Gj(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}};Wt({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Mt(e,i=>({readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>O$},controller:n=>{var e;return n.value.rawValue.length===1?new dw(n.document,{formatter:c0,value:n.value,viewProps:n.viewProps}):new pw(n.document,{formatter:c0,rows:(e=n.params.rows)!==null&&e!==void 0?e:Op.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});let Yj=class extends Kf{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}};const Ks=Q("grl");let Xj=class{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Ks()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(pi,"svg");i.classList.add(Ks("g")),i.style.height=`calc(var(${N$("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(pi,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=e.createElement("div");r.classList.add(Ks("t"),Q("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:e,clientHeight:t}=this.element,i=this.value.rawValue.length-1,s=this.props_.get("min"),r=this.props_.get("max"),o=[];this.value.rawValue.forEach((c,d)=>{if(c===void 0)return;const p=ee(d,0,i,0,e),v=ee(c,s,r,t,0);o.push([p,v].join(","))}),this.lineElem_.setAttributeNS(null,"points",o.join(" "));const l=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(a===void 0){l.classList.remove(Ks("t","a"));return}const u=ee(this.cursor_.rawValue,0,i,0,e),h=ee(a,s,r,t,0);l.style.left=`${u}px`,l.style.top=`${h}px`,l.textContent=`${this.formatter_(a)}`,l.classList.contains(Ks("t","a"))||(l.classList.add(Ks("t","a"),Ks("t","in")),Wc(l),l.classList.remove(Ks("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}},uV=class{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=ht(-1),this.view=new Xj(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!Uf(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new Io(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return Fi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return Ki(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const{clientWidth:t}=this.view.element;this.cursor_.rawValue=Math.floor(ee(e.offsetX,0,t,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(ee(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}};function Tv(n){return Me(n.format)?an(2):n.format}function Wj(n){var e;return n.value.rawValue.length===1?new dw(n.document,{formatter:Tv(n.params),value:n.value,viewProps:n.viewProps}):new pw(n.document,{formatter:Tv(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Op.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function Zj(n){var e,t,i;return new uV(n.document,{formatter:Tv(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Op.monitor.defaultRows,props:ge.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(i=n.params.min)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function C0(n){return n.view==="graph"}Wt({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=Mt(e,i=>({format:i.optional.function,max:i.optional.number,min:i.optional.number,readonly:i.required.constant(!0),rows:i.optional.number,view:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>C0(n)?64:1,reader:n=>w$},controller:n=>C0(n.params)?Zj(n):Wj(n),api:n=>n.controller.valueController instanceof uV?new Yj(n.controller):null});Wt({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=Mt(e,i=>({multiline:i.optional.boolean,readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>R$},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new pw(n.document,{formatter:Mv,rows:(e=n.params.rows)!==null&&e!==void 0?e:Op.monitor.defaultRows,value:t,viewProps:n.viewProps}):new dw(n.document,{formatter:Mv,value:t,viewProps:n.viewProps})}});const Jc={baseBackgroundColor:"hsl(230, 7%, 17%)",baseBorderRadius:"6px",baseFontFamily:"Roboto Mono, Source Code Pro, Menlo, Courier, monospace",baseShadowColor:"rgba(0, 0, 0, 0.2)",bladeBorderRadius:"2px",bladeHorizontalPadding:"4px",bladeValueWidth:"160px",buttonBackgroundColor:"hsl(230, 7%, 70%)",buttonBackgroundColorActive:"#d6d7db",buttonBackgroundColorFocus:"#c8cad0",buttonBackgroundColorHover:"#bbbcc4",buttonForegroundColor:"hsl(230, 7%, 17%)",containerBackgroundColor:"rgba(187, 188, 196, 0.1)",containerBackgroundColorActive:"rgba(187, 188, 196, 0.25)",containerBackgroundColorFocus:"rgba(187, 188, 196, 0.2)",containerBackgroundColorHover:"rgba(187, 188, 196, 0.15)",containerForegroundColor:"hsl(230, 7%, 75%)",containerHorizontalPadding:"4px",containerUnitSize:"20px",containerUnitSpacing:"4px",containerVerticalPadding:"4px",grooveForegroundColor:"rgba(187, 188, 196, 0.1)",inputBackgroundColor:"rgba(187, 188, 196, 0.1)",inputBackgroundColorActive:"rgba(187, 188, 196, 0.25)",inputBackgroundColorFocus:"rgba(187, 188, 196, 0.2)",inputBackgroundColorHover:"rgba(187, 188, 196, 0.15)",inputForegroundColor:"hsl(230, 7%, 75%)",labelForegroundColor:"rgba(187, 188, 196, 0.7)",monitorBackgroundColor:"rgba(0, 0, 0, 0.2)",monitorForegroundColor:"rgba(187, 188, 196, 0.7)",pluginImageDraggingColor:"hsla(230, 100%, 66%, 1)"};Object.keys(Jc).reduce((n,e)=>(n[e]=e,n),{});const Qj=new Map([["baseBackgroundColor","--tp-base-background-color"],["baseBorderRadius","--tp-base-border-radius"],["baseFontFamily","--tp-base-font-family"],["baseShadowColor","--tp-base-shadow-color"],["bladeBorderRadius","--tp-blade-border-radius"],["bladeHorizontalPadding","--tp-blade-horizontal-padding"],["bladeValueWidth","--tp-blade-value-width"],["buttonBackgroundColor","--tp-button-background-color"],["buttonBackgroundColorActive","--tp-button-background-color-active"],["buttonBackgroundColorFocus","--tp-button-background-color-focus"],["buttonBackgroundColorHover","--tp-button-background-color-hover"],["buttonForegroundColor","--tp-button-foreground-color"],["containerBackgroundColor","--tp-container-background-color"],["containerBackgroundColorActive","--tp-container-background-color-active"],["containerBackgroundColorFocus","--tp-container-background-color-focus"],["containerBackgroundColorHover","--tp-container-background-color-hover"],["containerForegroundColor","--tp-container-foreground-color"],["containerHorizontalPadding","--tp-container-horizontal-padding"],["containerUnitSize","--tp-container-unit-size"],["containerUnitSpacing","--tp-container-unit-spacing"],["containerVerticalPadding","--tp-container-vertical-padding"],["grooveForegroundColor","--tp-groove-foreground-color"],["inputBackgroundColor","--tp-input-background-color"],["inputBackgroundColorActive","--tp-input-background-color-active"],["inputBackgroundColorFocus","--tp-input-background-color-focus"],["inputBackgroundColorHover","--tp-input-background-color-hover"],["inputForegroundColor","--tp-input-foreground-color"],["labelForegroundColor","--tp-label-foreground-color"],["monitorBackgroundColor","--tp-monitor-background-color"],["monitorForegroundColor","--tp-monitor-foreground-color"],["pluginImageDraggingColor","--tp-plugin-image-dragging-color"]]);function Dv(n){if(n!==void 0){if(typeof n=="string")return n;if(aw(n))return`rgba(${n.r}, ${n.g}, ${n.b}, ${n.a})`;if(lw(n))return`rgb(${n.r}, ${n.g}, ${n.b})`}}function P0(n){if(n.startsWith("--tp-"))return n;const e=Qj.get(n);if(e)return e;throw new Error(`Unknown Tweakpane CSS theme map variable key: "${n}"`)}function y0(n,e){return(n==null?void 0:n[e])===void 0?Dv(Jc[e]):Dv(n[e])}function Jj(n,e){const t=pO().documentElement;if(e===void 0)for(const i of Object.keys(Jc)){const s=P0(i);n.style.getPropertyValue(s).length>0&&n.style.removeProperty(s)}else for(const[i,s]of Object.entries(e)){const r=P0(i),o=Dv(s),l=Jc[i]||void 0,a=t.style.getPropertyValue(r)||void 0;e!==void 0&&o!==void 0&&(((a&&o!==a)??!1)||!a&&((l&&o!==l)??!1))?n.style.setProperty(r,o):n.style.getPropertyValue(r).length>0&&n.style.removeProperty(r)}}function E0(n){let e,t=`${n[0]}px`;return{c(){e=Ue("div"),this.h()},l(i){e=He(i,"DIV",{}),ke(e).forEach(P),this.h()},h(){Ye(e,"background",null),Ye(e,"height",t)},m(i,s){k(i,e,s)},p(i,s){s&1&&t!==(t=`${i[0]}px`)&&Ye(e,"height",t)},d(i){i&&P(e)}}}function eN(n){let e,t=n[0]>0&&E0(n);return{c(){t&&t.c(),e=D()},l(i){t&&t.l(i),e=D()},m(i,s){t&&t.m(i,s),k(i,e,s)},p(i,[s]){i[0]>0?t?t.p(i,s):(t=E0(i),t.c(),t.m(e.parentNode,e)):t&&(t.d(1),t=null)},i:Xe,o:Xe,d(i){i&&P(e),t&&t.d(i)}}}function x0(n){return Number.parseFloat(n.replace("px",""))}function tN(n,e,t){let i,{theme:s=void 0}=e,{keysAdd:r=[]}=e,{keysSubtract:o=[]}=e,{extra:l=void 0}=e;function a(u,h,c=0){return u.reduce((d,p)=>d+=x0(y0(s,p)),0)-h.reduce((d,p)=>d+=x0(y0(s,p)),0)+c}return n.$$set=u=>{"theme"in u&&t(1,s=u.theme),"keysAdd"in u&&t(2,r=u.keysAdd),"keysSubtract"in u&&t(3,o=u.keysSubtract),"extra"in u&&t(4,l=u.extra)},n.$$.update=()=>{n.$$.dirty&28&&t(0,i=a(r,o,l))},[i,s,r,o,l]}class ba extends Lt{constructor(e){super(),At(this,e,tN,eN,St,{theme:1,keysAdd:2,keysSubtract:3,extra:4})}}function hV(n){return n.constructor.name==="Pane"}function rm(n,e,t){return Math.min(Math.max(n,e),t)}function cV(n){let e=0,t=n;for(;(t=t.previousElementSibling)!==null;)e++;return e}function Rr(n,...e){for(const t of e)t in n&&delete n[t];return n}function $0(n){n.isTrusted&&n.stopPropagation()}function pV(n,e,t,i){if(e){const s=e.querySelector(`.${t}`);if(s){const r=i?e.querySelector(`.${i}`):void 0;n?(s.removeEventListener("click",$0,{capture:!0}),s.style.cursor="pointer",r&&(r.style.display="block")):(s.addEventListener("click",$0,{capture:!0}),s.style.cursor="default",r&&(r.style.display="none"))}}else console.warn(`Title bar element not found with class "${t}"`)}function nN(n){var e,t,i,s;return(s=(i=(t=(e=n.controller.valueController)==null?void 0:e.foldable_)==null?void 0:t.valMap_)==null?void 0:i.expanded)==null?void 0:s.value_}function iN(n){var t,i,s,r,o,l,a;return((r=(s=(i=(t=n.controller)==null?void 0:t.valueController)==null?void 0:i.view)==null?void 0:s.swatchElement)==null?void 0:r.querySelector("button"))??((a=(l=(o=n.controller)==null?void 0:o.valueController)==null?void 0:l.view)==null?void 0:a.buttonElement)}/*! Tweakpane 4.0.3 (c) 2016 cocopon, licensed under the MIT license. */function $e(n){return n==null}function mw(n){return n!==null&&typeof n=="object"}function Ov(n){return n!==null&&typeof n=="object"}function sN(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function mo(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((i,s)=>{const r=n[s],o=e[s];return Ov(r)&&Ov(o)?Object.assign(Object.assign({},i),{[s]:mo(r,o)}):Object.assign(Object.assign({},i),{[s]:s in e?o:r})},{})}function vw(n){return mw(n)?"target"in n:!1}const rN={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};let $t=class xl{static alreadyDisposed(){return new xl({type:"alreadydisposed"})}static notBindable(){return new xl({type:"notbindable"})}static notCompatible(e,t){return new xl({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new xl({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new xl({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=rN[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}},V0=class dV{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const i=this.read();if(!dV.isBindable(i))throw $t.notBindable();if(!(e in i))throw $t.propertyNotFound(e);i[e]=t}},Ze=class{constructor(){this.observers_={}}on(e,t,i){var s;let r=this.observers_[e];return r||(r=this.observers_[e]=[]),r.push({handler:t,key:(s=i==null?void 0:i.key)!==null&&s!==void 0?s:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter(s=>s.key!==t)),this}emit(e,t){const i=this.observers_[e];i&&i.forEach(s=>{s.handler(t)})}},oN=class{constructor(e,t){var i;this.constraint_=t==null?void 0:t.constraint,this.equals_=(i=t==null?void 0:t.equals)!==null&&i!==void 0?i:(s,r)=>s===r,this.emitter=new Ze,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,r=this.rawValue_;this.equals_(r,s)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:i,previousRawValue:r,rawValue:s,sender:this}))}},lN=class{constructor(e){this.emitter=new Ze,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.value_;s===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:this.value_,sender:this}))}},aN=class{constructor(e){this.emitter=new Ze,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}};function Ae(n,e){const t=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!t&&!i?new lN(n):new oN(n,e)}function uN(n){return[new aN(n),(e,t)=>{n.setRawValue(e,t)}]}let T=class mV{constructor(e){this.emitter=new Ze,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((i,s)=>Object.assign(i,{[s]:Ae(e[s])}),{})}static fromObject(e){const t=this.createCore(e);return new mV(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}},Ch=class{constructor(e){this.values=T.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(e,i),t)}},hN=class{constructor(e){this.values=T.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");let s=e;return $e(i)||(s=Math.max(s,i)),$e(t)||(s=Math.min(s,t)),s}},cN=class{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,i=Math.round((e-t)/this.step);return t+i*this.step}},pN=class{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}};const dN={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};let mN=class{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=dN[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}};const vN={"+":n=>n,"-":n=>-n,"~":n=>~n};let fN=class{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=vN[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}};function fw(n){return(e,t)=>{for(let i=0;i<n.length;i++){const s=n[i](e,t);if(s!=="")return s}return""}}function Ou(n,e){var t;const i=n.substr(e).match(/^\s+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function wN(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function Ru(n,e){var t;const i=n.substr(e).match(/^[0-9]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function _N(n,e){const t=Ru(n,e);if(t!=="")return t;const i=n.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";const s=Ru(n,e);return s===""?"":i+s}function ww(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const i=_N(n,e);return i===""?"":t+i}function vV(n,e){const t=n.substr(e,1);if(t==="0")return t;const i=wN(n,e);return e+=i.length,i===""?"":i+Ru(n,e)}function bN(n,e){const t=vV(n,e);if(e+=t.length,t==="")return"";const i=n.substr(e,1);if(e+=i.length,i!==".")return"";const s=Ru(n,e);return e+=s.length,t+i+s+ww(n,e)}function gN(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const i=Ru(n,e);return e+=i.length,i===""?"":t+i+ww(n,e)}function CN(n,e){const t=vV(n,e);return e+=t.length,t===""?"":t+ww(n,e)}const PN=fw([bN,gN,CN]);function yN(n,e){var t;const i=n.substr(e).match(/^[01]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function EN(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const i=yN(n,e);return i===""?"":t+i}function xN(n,e){var t;const i=n.substr(e).match(/^[0-7]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function $N(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const i=xN(n,e);return i===""?"":t+i}function VN(n,e){var t;const i=n.substr(e).match(/^[0-9a-f]+/i);return(t=i&&i[0])!==null&&t!==void 0?t:""}function kN(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const i=VN(n,e);return i===""?"":t+i}const SN=fw([EN,$N,kN]),LN=fw([SN,PN]);function AN(n,e){const t=LN(n,e);return e+=t.length,t===""?null:{evaluable:new pN(t),cursor:e}}function MN(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const i=wV(n,e);if(!i)return null;e=i.cursor,e+=Ou(n,e).length;const s=n.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:i.evaluable,cursor:e}}function TN(n,e){var t;return(t=AN(n,e))!==null&&t!==void 0?t:MN(n,e)}function fV(n,e){const t=TN(n,e);if(t)return t;const i=n.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const s=fV(n,e);return s?(e=s.cursor,{cursor:e,evaluable:new fN(i,s.evaluable)}):null}function DN(n,e,t){t+=Ou(e,t).length;const i=n.filter(s=>e.startsWith(s,t))[0];return i?(t+=i.length,t+=Ou(e,t).length,{cursor:t,operator:i}):null}function ON(n,e){return(t,i)=>{const s=n(t,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const o=DN(e,t,i);if(!o)break;i=o.cursor;const l=n(t,i);if(!l)return null;i=l.cursor,r=new mN(o.operator,r,l.evaluable)}return r?{cursor:i,evaluable:r}:null}}const RN=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>ON(n,e),fV);function wV(n,e){return e+=Ou(n,e).length,RN(n,e)}function jN(n){const e=wV(n,0);return!e||e.cursor+Ou(n,e.cursor).length!==n.length?null:e.evaluable}function Ss(n){var e;const t=jN(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function _V(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=Ss(n);if(!$e(e))return e}return 0}function NN(n){return String(n)}function un(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function te(n,e,t,i,s){const r=(n-e)/(t-e);return i+r*(s-i)}function k0(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Je(n,e,t){return Math.min(Math.max(n,e),t)}function bV(n,e){return(n%e+e)%e}function BN(n,e){return $e(n.step)?Math.max(k0(e),2):k0(n.step)}function gV(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function CV(n,e){var t;const i=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function PV(n,e){return $e(n.step)?null:new cN(n.step,e)}function yV(n){return!$e(n.max)&&!$e(n.min)?new Ch({max:n.max,min:n.min}):!$e(n.max)||!$e(n.min)?new hN({max:n.max,min:n.min}):null}function EV(n,e){var t,i,s;return{formatter:(t=n.format)!==null&&t!==void 0?t:un(BN(n,e)),keyScale:(i=n.keyScale)!==null&&i!==void 0?i:gV(n),pointerScale:(s=n.pointerScale)!==null&&s!==void 0?s:CV(n,e)}}function xV(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function _w(n){return{constraint:n.constraint,textProps:T.fromObject(EV(n.params,n.initialValue))}}let Fo=class{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}},Rp=class{constructor(e){this.target=e}},Ph=class extends Rp{constructor(e,t,i){super(e),this.value=t,this.last=i??!0}},IN=class extends Rp{constructor(e,t){super(e),this.expanded=t}},FN=class extends Rp{constructor(e,t){super(e),this.index=t}},KN=class extends Rp{constructor(e,t){super(e),this.native=t}},ju=class extends Fo{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Ze,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new Ph(this,t.binding.target.read(),e.options.last))}};class UN{constructor(e,t){this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=t,this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.emitter=new Ze}get rawValue(){return this.value_.rawValue}set rawValue(e){this.value_.rawValue=e}setRawValue(e,t){this.value_.setRawValue(e,t)}fetch(){this.value_.rawValue=this.binding.read()}push(){this.binding.write(this.value_.rawValue)}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.push(),this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function HN(n){if(!("binding"in n))return!1;const e=n.binding;return vw(e)&&"read"in e&&"write"in e}function zN(n,e){const i=Object.keys(e).reduce((s,r)=>{if(s===void 0)return;const o=e[r],l=o(n[r]);return l.succeeded?Object.assign(Object.assign({},s),{[r]:l.value}):void 0},{});return i}function qN(n,e){return n.reduce((t,i)=>{if(t===void 0)return;const s=e(i);if(!(!s.succeeded||s.value===void 0))return[...t,s.value]},[])}function GN(n){return n===null?!1:typeof n=="object"}function is(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const i=n(t);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function S0(n){return{custom:e=>is(e)(n),boolean:is(e=>typeof e=="boolean"?e:void 0)(n),number:is(e=>typeof e=="number"?e:void 0)(n),string:is(e=>typeof e=="string"?e:void 0)(n),function:is(e=>typeof e=="function"?e:void 0)(n),constant:e=>is(t=>t===e?e:void 0)(n),raw:is(e=>e)(n),object:e=>is(t=>{if(GN(t))return zN(t,e)})(n),array:e=>is(t=>{if(Array.isArray(t))return qN(t,e)})(n)}}const Rv={optional:S0(!0),required:S0(!1)};function Be(n,e){const t=e(Rv),i=Rv.required.object(t)(n);return i.succeeded?i.value:void 0}function Cn(n,e,t,i){if(e&&!e(n))return!1;const s=Be(n,t);return s?i(s):!1}function Pn(n,e){var t;return mo((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function uo(n){return"value"in n}function $V(n){if(!mw(n)||!("binding"in n))return!1;const e=n.binding;return vw(e)}const di="http://www.w3.org/2000/svg";function ep(n){n.offsetHeight}function YN(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function bw(n){return n.ontouchstart!==void 0}function XN(){return globalThis}function WN(){return XN().document}function ZN(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const QN={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function jp(n,e){const t=n.createElementNS(di,"svg");return t.innerHTML=QN[e],t}function VV(n,e,t){n.insertBefore(e,n.children[t])}function gw(n){n.parentElement&&n.parentElement.removeChild(n)}function kV(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function JN(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function SV(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function Cs(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function Pi(n,e,t){Cs(n.value(e),t)}const eB="tp";function B(n){return(t,i)=>[eB,"-",n,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}const za=B("lbl");function tB(n,e){const t=n.createDocumentFragment();return e.split(`
`).map(s=>n.createTextNode(s)).forEach((s,r)=>{r>0&&t.appendChild(n.createElement("br")),t.appendChild(s)}),t}let LV=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(za()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(za("l")),Pi(t.props,"label",r=>{$e(r)?this.element.classList.add(za(void 0,"nol")):(this.element.classList.remove(za(void 0,"nol")),JN(i),i.appendChild(tB(e,r)))}),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("div");s.classList.add(za("v")),this.element.appendChild(s),this.valueElement=s}},AV=class{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new LV(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return Cn(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return Pn(null,{label:this.props.get("label")})}};function nB(){return["veryfirst","first","last","verylast"]}const L0=B(""),A0={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};let Np=class{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{nB().forEach(i=>{t.classList.remove(L0(void 0,A0[i]))}),this.blade.get("positions").forEach(i=>{t.classList.add(L0(void 0,A0[i]))})}),this.viewProps.handleDispose(()=>{gw(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return Cn(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return Pn(null,Object.assign({},this.viewProps.exportState()))}},vo=class extends Np{constructor(e,t){if(t.value!==t.valueController.value)throw $t.shouldNeverHappen();const i=t.valueController.viewProps,s=new AV(e,{blade:t.blade,props:t.props,valueController:t.valueController});super(Object.assign(Object.assign({},t),{view:new LV(e,{props:t.props,viewProps:i}),viewProps:i})),this.labelController=s,this.value=t.value,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}importState(e){return Cn(e,t=>{var i,s,r;return super.importState(t)&&this.labelController.importProps(t)&&((r=(s=(i=this.valueController).importProps)===null||s===void 0?void 0:s.call(i,e))!==null&&r!==void 0?r:!0)},t=>({value:t.optional.raw}),t=>(t.value&&(this.value.rawValue=t.value),!0))}exportState(){var e,t,i;return Pn(()=>super.exportState(),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),(i=(t=(e=this.valueController).exportProps)===null||t===void 0?void 0:t.call(e))!==null&&i!==void 0?i:{}))}};function M0(n){const e=Object.assign({},n);return delete e.value,e}class MV extends vo{constructor(e,t){super(e,t),this.tag=t.tag}importState(e){return Cn(e,t=>super.importState(M0(e)),t=>({tag:t.optional.string}),t=>(this.tag=t.tag,!0))}exportState(){return Pn(()=>M0(super.exportState()),{binding:{key:this.value.binding.target.key,value:this.value.binding.target.read()},tag:this.tag})}}function iB(n){return uo(n)&&$V(n.value)}class sB extends MV{importState(e){return Cn(e,t=>super.importState(t),t=>({binding:t.required.object({value:t.required.raw})}),t=>(this.value.binding.inject(t.binding.value),this.value.fetch(),!0))}}function rB(n){return uo(n)&&HN(n.value)}function TV(n,e){for(;n.length<e;)n.push(void 0)}function oB(n){const e=[];return TV(e,n),e}function lB(n){const e=n.indexOf(void 0);return e<0?n:n.slice(0,e)}function aB(n,e){const t=[...lB(n),e];return t.length>n.length?t.splice(0,t.length-n.length):TV(t,n.length),t}class uB{constructor(e){this.emitter=new Ze,this.onTick_=this.onTick_.bind(this),this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.binding=e.binding,this.value_=Ae(oB(e.bufferSize)),this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_),this.ticker=e.ticker,this.ticker.emitter.on("tick",this.onTick_),this.fetch()}get rawValue(){return this.value_.rawValue}set rawValue(e){this.value_.rawValue=e}setRawValue(e,t){this.value_.setRawValue(e,t)}fetch(){this.value_.rawValue=aB(this.value_.rawValue,this.binding.read())}onTick_(){this.fetch()}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function hB(n){if(!("binding"in n))return!1;const e=n.binding;return vw(e)&&"read"in e&&!("write"in e)}class cB extends MV{exportState(){return Pn(()=>super.exportState(),{binding:{readonly:!0}})}}function pB(n){return uo(n)&&hB(n.value)}let dB=class extends Fo{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const i=t.bind(this);return this.controller.buttonController.emitter.on(e,r=>{i(new KN(this,r.nativeEvent))}),this}off(e,t){return this.controller.buttonController.emitter.off(e,t),this}};function mB(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function ga(n,e){return t=>{mB(n,e,t)}}function Cw(n,e){Cs(n,t=>{e.textContent=t??""})}const om=B("btn");let vB=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(om()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(om("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(om("t")),Cw(t.props.value("title"),s),this.buttonElement.appendChild(s)}},fB=class{constructor(e,t){this.emitter=new Ze,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new vB(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return Cn(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return Pn(null,{title:this.props.get("title")})}onClick_(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}},T0=class extends Np{constructor(e,t){const i=new fB(e,{props:t.buttonProps,viewProps:t.viewProps}),s=new AV(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:t.viewProps}),this.buttonController=i,this.labelController=s}importState(e){return Cn(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return Pn(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}},DV=class{constructor(e){const[t,i]=e.split("-"),s=t.split(".");this.major=parseInt(s[0],10),this.minor=parseInt(s[1],10),this.patch=parseInt(s[2],10),this.prerelease=i??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}};const Ca=new DV("2.0.3");function Zt(n){return Object.assign({core:Ca},n)}const wB=Zt({id:"button",type:"blade",accept(n){const e=Be(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new T0(n.document,{blade:n.blade,buttonProps:T.fromObject({title:n.params.title}),labelProps:T.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof T0?new dB(n.controller):null}});function _B(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function bB(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function gB(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function CB(n){return mw(n)?"refresh"in n&&typeof n.refresh=="function":!1}function PB(n,e){if(!V0.isBindable(n))throw $t.notBindable();return new V0(n,e)}let yB=class{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new Ze,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,i){const s=i??{},r=this.controller_.element.ownerDocument,o=this.pool_.createBinding(r,PB(e,t),s),l=this.pool_.createBindingApi(o);return this.add(l,s.index)}addFolder(e){return bB(this,e)}addButton(e){return _B(this,e)}addTab(e){return gB(this,e)}add(e,t){const i=e.controller;return this.controller_.rack.add(i,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,i=this.pool_.createBlade(t,e),s=this.pool_.createApi(i);return this.add(s,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.children.forEach(e=>{CB(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,i=this.pool_.createApi(t),s=$V(t.value)?t.value.binding:null;this.emitter_.emit("change",new Ph(i,s?s.target.read():t.value.rawValue,e.options.last))}},Pw=class extends Fo{constructor(e,t){super(e),this.rackApi_=new yB(e.rackController,t)}refresh(){this.rackApi_.refresh()}},yw=class extends Np{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return Cn(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((i,s)=>i.importState(t.children[s])))}exportState(){return Pn(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}};function jv(n){return"rackController"in n}let EB=class{constructor(e){this.emitter=new Ze,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw $t.shouldNeverHappen();const i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(r=>{this.cache_.add(r)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.allItems().forEach(s=>{this.cache_.delete(s)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}};function xB(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(uo(i)&&i.value===e)return i}return null}function $B(n){return jv(n)?n.rackController.rack.bcSet_:null}let VB=class{constructor(e){var t,i;this.emitter=new Ze,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new EB($B),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var i;(i=e.parent)===null||i===void 0||i.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),uo(i))i.value.emitter.on("change",this.onChildValueChange_);else if(jv(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.on("layout",this.onRackLayout_),r.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const i=e.item;if(uo(i))i.value.emitter.off("change",this.onChildValueChange_);else if(jv(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.off("layout",this.onRackLayout_),r.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(s=>!s.viewProps.get("hidden")),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach(s=>{const r=[];s===t&&(r.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&r.push("veryfirst")),s===i&&(r.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&r.push("verylast")),s.blade.set("positions",r)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=xB(this.find(uo),e.sender);if(!t)throw $t.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}},Ew=class{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new VB({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let i=this.rack.children.length-1;i>=0;i--)this.rack.children[i].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&VV(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&gw(e.bladeController.view.element)}};function Pa(){return new T({positions:Ae([],{equals:sN})})}let xw=class OV extends T{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=T.createCore(t);return new OV(i)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!$e(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const i=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};Pi(this,"expanded",i),Pi(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}};function kB(n,e){let t=0;return YN(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),ep(e),t=e.clientHeight,n.set("temporaryExpanded",null),ep(e)}),t}function D0(n,e){e.style.height=n.styleHeight}function $w(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),$e(n.get("expandedHeight"))){const t=kB(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),ep(e)}),n.emitter.on("change",()=>{D0(n,e)}),D0(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}let RV=class extends Pw{constructor(e,t){super(e,t),this.emitter_=new Ze,this.controller.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",new IN(this,i.sender.rawValue))}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}};const jV=B("cnt");let SB=class{constructor(e,t){var i;this.className_=B((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),jV()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),Pi(this.foldable_,"completed",ga(this.element,this.className_(void 0,"cpl")));const s=e.createElement("button");s.classList.add(this.className_("b")),Pi(t.props,"title",u=>{$e(u)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const r=e.createElement("div");r.classList.add(this.className_("i")),this.element.appendChild(r);const o=e.createElement("div");o.classList.add(this.className_("t")),Cw(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}},Nv=class extends yw{constructor(e,t){var i;const s=xw.create((i=t.expanded)!==null&&i!==void 0?i:!0),r=new SB(e,{foldable:s,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Ew({blade:t.blade,element:r.containerElement,root:t.root,viewProps:t.viewProps}),view:r})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=s,$w(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return Cn(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return Pn(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}};const LB=Zt({id:"folder",type:"blade",accept(n){const e=Be(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new Nv(n.document,{blade:n.blade,expanded:n.params.expanded,props:T.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof Nv?new RV(n.controller,n.pool):null}}),AB=B("");function O0(n,e){return ga(n,AB(void 0,e))}let Ko=class NV extends T{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=uN(Ae(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,i,s;const r=e??{};return new NV(T.createCore({disabled:(t=r.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(i=r.hidden)!==null&&i!==void 0?i:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){Cs(this.globalDisabled_,O0(e,"disabled")),Pi(this,"hidden",O0(e,"hidden"))}bindDisabled(e){Cs(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){Cs(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const i=e.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}};const R0=B("tbp");let MB=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(R0()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(R0("c")),this.element.appendChild(i),this.containerElement=i}};const qa=B("tbi");let TB=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(qa()),t.viewProps.bindClassModifiers(this.element),Pi(t.props,"selected",r=>{r?this.element.classList.add(qa(void 0,"sel")):this.element.classList.remove(qa(void 0,"sel"))});const i=e.createElement("button");i.classList.add(qa("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(qa("t")),Cw(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}},DB=class{constructor(e,t){this.emitter=new Ze,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new TB(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}},Bv=class extends yw{constructor(e,t){const i=new MB(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Ew({blade:t.blade,element:i.containerElement,viewProps:t.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new DB(e,{props:t.itemProps,viewProps:Ko.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,Pi(this.props,"selected",s=>{this.itemController.props.set("selected",s),this.viewProps.set("hidden",!s)})}get itemController(){return this.ic_}importState(e){return Cn(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return Pn(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}},OB=class extends Pw{constructor(e,t){super(e,t),this.emitter_=new Ze,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,i=new Bv(t,{blade:Pa(),itemProps:T.fromObject({selected:!1,title:e.title}),props:T.fromObject({selected:!1}),viewProps:Ko.create()}),s=this.pool_.createApi(i);return this.rackApi_.add(s,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}onSelect_(e){this.emitter_.emit("select",new FN(this,e.rawValue))}},RB=class extends Pw{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}};const j0=-1;let jB=class{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=Ae(!0),this.selectedIndex=Ae(j0),this.items_=[]}add(e,t){const i=t??this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=j0,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,i)=>{t.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,i)=>{t.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(i=>i===e.sender);this.items_.forEach((i,s)=>{i.rawValue=s===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}};const Ga=B("tab");let NB=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ga(),jV()),t.viewProps.bindClassModifiers(this.element),Cs(t.empty,ga(this.element,Ga(void 0,"nop")));const i=e.createElement("div");i.classList.add(Ga("t")),this.element.appendChild(i),this.itemsElement=i;const s=e.createElement("div");s.classList.add(Ga("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(Ga("c")),this.element.appendChild(r),this.contentsElement=r}},N0=class extends yw{constructor(e,t){const i=new jB,s=new NB(e,{empty:i.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new Ew({blade:t.blade,element:s.contentsElement,viewProps:t.viewProps}),view:s}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=this.rackController.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.tab=i}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;VV(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;gw(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}};const BV=Zt({id:"tab",type:"blade",accept(n){const e=Be(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new N0(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const i=new Bv(n.document,{blade:Pa(),itemProps:T.fromObject({selected:!1,title:t.title}),props:T.fromObject({selected:!1}),viewProps:Ko.create()});e.add(i)}),e},api(n){return n.controller instanceof N0?new OB(n.controller,n.pool):n.controller instanceof Bv?new RB(n.controller,n.pool):null}});function BB(n,e){const t=n.accept(e.params);if(!t)return null;const i=Be(e.params,s=>({disabled:s.optional.boolean,hidden:s.optional.boolean}));return n.controller({blade:Pa(),document:e.document,params:Object.assign(Object.assign({},t.params),{disabled:i==null?void 0:i.disabled,hidden:i==null?void 0:i.hidden}),viewProps:Ko.create({disabled:i==null?void 0:i.disabled,hidden:i==null?void 0:i.hidden})})}let Vw=class extends ju{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}},IB=class{constructor(){this.disabled=!1,this.emitter=new Ze}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}},FB=class{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new Ze,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}},yh=class{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,i)=>i.constrain(t),e)}};function tp(n,e){if(n instanceof e)return n;if(n instanceof yh){const t=n.constraints.reduce((i,s)=>i||(s instanceof e?s:null),null);if(t)return t}return null}let Eh=class{constructor(e){this.values=T.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(s=>s.value===e).length>0?e:t[0].value}};function xh(n){var e;const t=Rv;if(Array.isArray(n))return(e=Be({items:n},i=>({items:i.required.array(i.required.object({text:i.required.string,value:i.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function kw(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function Sw(n){return $e(n)?null:new Eh(kw(n))}const lm=B("lst");let KB=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(lm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(lm("s")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const s=e.createElement("div");s.classList.add(lm("m")),s.appendChild(jp(e,"dropdown")),this.element.appendChild(s),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,Pi(this.props_,"options",r=>{kV(this.selectElement),r.forEach(o=>{const l=e.createElement("option");l.textContent=o.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}},jr=class{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new KB(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return Cn(e,null,t=>({options:t.required.custom(xh)}),t=>(this.props.set("options",kw(t.options)),!0))}exportProps(){return Pn(null,{options:this.props.get("options")})}};const B0=B("pop");let UB=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(B0()),t.viewProps.bindClassModifiers(this.element),Cs(t.shows,ga(this.element,B0(void 0,"v")))}},IV=class{constructor(e,t){this.shows=Ae(!1),this.viewProps=t.viewProps,this.view=new UB(e,{shows:this.shows,viewProps:this.viewProps})}};const I0=B("txt");let HB=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(I0()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(I0("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}},Nu=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new HB(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);$e(s)||(this.value.rawValue=s),this.view.refresh()}};function zB(n){return String(n)}function FV(n){return n==="false"?!1:!!n}function F0(n){return zB(n)}function qB(n){return e=>n.reduce((t,i)=>t!==null?t:i(e),null)}const GB=un(0);function np(n){return GB(n)+"%"}function KV(n){return String(n)}function Iv(n){return n}function ya({primary:n,secondary:e,forward:t,backward:i}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}n.emitter.on("change",o=>{r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),e.emitter.on("change",o=>{r(()=>{n.setRawValue(i(n.rawValue,e.rawValue),o.options)}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function tn(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function Bu(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function Ls(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function YB(n){return n==="ArrowUp"||n==="ArrowDown"}function UV(n){return YB(n)||n==="ArrowLeft"||n==="ArrowRight"}function am(n,e){var t,i;const s=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:n.pageX-(((t=s&&s.scrollX)!==null&&t!==void 0?t:0)+r.left),y:n.pageY-(((i=s&&s.scrollY)!==null&&i!==void 0?i:0)+r.top)}}let Uo=class{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new Ze,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(am(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(am(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(am(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-s.left,y:i.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}};const An=B("txt");let XB=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(An(),An(void 0,"num")),t.arrayPosition&&this.element.classList.add(An(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(An("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(An()),this.inputElement.classList.add(An("i"));const s=e.createElement("div");s.classList.add(An("k")),this.element.appendChild(s),this.knobElement=s;const r=e.createElementNS(di,"svg");r.classList.add(An("g")),this.knobElement.appendChild(r);const o=e.createElementNS(di,"path");o.classList.add(An("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=e.createElementNS(di,"path");l.classList.add(An("gh")),r.appendChild(l),this.guideHeadElem_=l;const a=e.createElement("div");a.classList.add(B("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(An(void 0,"drg"));return}this.element.classList.add(An(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),i=t+(t>0?-1:t<0?1:0),s=Je(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+s},0 L${i},4 L${i+s},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}},$h=class{constructor(e,t){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(i=t.sliderProps)!==null&&i!==void 0?i:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=Ae(null),this.view=new XB(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new Uo(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,i;const s=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),r=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("max");let o=e;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);$e(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const t=tn(this.props.get("keyScale"),Bu(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){tn(this.props.get("keyScale"),Bu(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}};const um=B("sld");let WB=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(um()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(um("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const s=e.createElement("div");s.classList.add(um("k")),this.trackElement.appendChild(s),this.knobElement=s,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=Je(te(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}},ZB=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new WB(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Uo(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(te(Je(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=tn(this.props.get("keyScale"),Ls(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){tn(this.props.get("keyScale"),Ls(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const hm=B("sldtxt");let QB=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(hm());const i=e.createElement("div");i.classList.add(hm("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(hm("t")),this.textView_=t.textView,s.appendChild(this.textView_.element),this.element.appendChild(s)}},ip=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new ZB(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new $h(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new QB(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return Cn(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const i=this.sliderC_.props;return i.set("max",t.max),i.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return Pn(null,{max:e.get("max"),min:e.get("min")})}};function HV(n){return{sliderProps:new T({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new T({formatter:Ae(n.formatter),keyScale:n.keyScale,pointerScale:Ae(n.pointerScale)})}}const JB={containerUnitSize:"cnt-usz"};function zV(n){return`--${JB[n]}`}function Iu(n){return xV(n)}function wr(n){if(Ov(n))return Be(n,Iu)}function ps(n,e){if(!n)return;const t=[],i=PV(n,e);i&&t.push(i);const s=yV(n);return s&&t.push(s),new yh(t)}function eI(n){return n?n.major===Ca.major:!1}function qV(n){if(n==="inline"||n==="popup")return n}function Vh(n,e){n.write(e)}const hc=B("ckb");let tI=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(hc()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(hc("l")),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("input");s.classList.add(hc("i")),s.type="checkbox",this.labelElement.appendChild(s),this.inputElement=s,t.viewProps.bindDisabled(this.inputElement);const r=e.createElement("div");r.classList.add(hc("w")),this.labelElement.appendChild(r);const o=jp(e,"check");r.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}},nI=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new tI(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked,e.preventDefault(),e.stopPropagation()}onLabelMouseDown_(e){e.preventDefault()}};function iI(n){const e=[],t=Sw(n.options);return t&&e.push(t),new yh(e)}const sI=Zt({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Be(e,i=>({options:i.optional.custom(xh),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>FV,constraint:n=>iI(n.params),writer:n=>Vh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&tp(i,Eh);return s?new jr(e,{props:new T({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new nI(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof jr?new Vw(n.controller):null}}),Yr=B("col");let rI=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Yr()),t.foldable.bindExpandedClass(this.element,Yr(void 0,"expanded")),Pi(t.foldable,"completed",ga(this.element,Yr(void 0,"cpl")));const i=e.createElement("div");i.classList.add(Yr("h")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Yr("s")),i.appendChild(s),this.swatchElement=s;const r=e.createElement("div");if(r.classList.add(Yr("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(Yr("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};function oI(n,e,t){const i=Je(n/255,0,1),s=Je(e/255,0,1),r=Je(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u=0,h=0;const c=(l+o)/2;return a!==0&&(h=a/(1-Math.abs(o+l-1)),i===o?u=(s-r)/a:s===o?u=2+(r-i)/a:u=4+(i-s)/a,u=u/6+(u<0?1:0)),[u*360,h*100,c*100]}function lI(n,e,t){const i=(n%360+360)%360,s=Je(e/100,0,1),r=Je(t/100,0,1),o=(1-Math.abs(2*r-1))*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o/2;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function aI(n,e,t){const i=Je(n/255,0,1),s=Je(e/255,0,1),r=Je(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u;a===0?u=0:o===i?u=60*(((s-r)/a%6+6)%6):o===s?u=60*((r-i)/a+2):u=60*((i-s)/a+4);const h=o===0?0:a/o,c=o;return[u,h*100,c*100]}function GV(n,e,t){const i=bV(n,360),s=Je(e/100,0,1),r=Je(t/100,0,1),o=r*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function uI(n,e,t){const i=t+e*(100-Math.abs(2*t-100))/200;return[n,i!==0?e*(100-Math.abs(2*t-100))/i:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function hI(n,e,t){const i=100-Math.abs(t*(200-e)/100-100);return[n,i!==0?e*t/i:0,t*(200-e)/(2*100)]}function yi(n){return[n[0],n[1],n[2]]}function Bp(n,e){return[n[0],n[1],n[2],e]}const cI={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:uI,rgb:lI},hsv:{hsl:hI,hsv:(n,e,t)=>[n,e,t],rgb:GV},rgb:{hsl:oI,hsv:aI,rgb:(n,e,t)=>[n,e,t]}};function Jl(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function pI(n,e){return n===e?e:bV(n,e)}function YV(n,e,t){var i;const s=Jl(e,t);return[e==="rgb"?Je(n[0],0,s[0]):pI(n[0],s[0]),Je(n[1],0,s[1]),Je(n[2],0,s[2]),Je((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function K0(n,e,t,i){const s=Jl(e,t),r=Jl(e,i);return n.map((o,l)=>o/s[l]*r[l])}function XV(n,e,t){const i=K0(n,e.mode,e.type,"int"),s=cI[e.mode][t.mode](...i);return K0(s,t.mode,"int",t.type)}let ae=class WV{static black(){return new WV([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=YV(e,t,this.type)}getComponents(e){return Bp(XV(yi(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const Us=B("colp");let dI=class{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Us()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Us("hsv"));const s=e.createElement("div");s.classList.add(Us("sv")),this.svPaletteView_=t.svPaletteView,s.appendChild(this.svPaletteView_.element),i.appendChild(s);const r=e.createElement("div");r.classList.add(Us("h")),this.hPaletteView_=t.hPaletteView,r.appendChild(this.hPaletteView_.element),i.appendChild(r),this.element.appendChild(i);const o=e.createElement("div");if(o.classList.add(Us("rgb")),this.textsView_=t.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const l=e.createElement("div");l.classList.add(Us("a"));const a=e.createElement("div");a.classList.add(Us("ap")),a.appendChild(this.alphaViews_.palette.element),l.appendChild(a);const u=e.createElement("div");u.classList.add(Us("at")),u.appendChild(this.alphaViews_.text.element),l.appendChild(u),this.element.appendChild(l)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}};function mI(n){return n==="int"?"int":n==="float"?"float":void 0}function Lw(n){return Be(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(mI)}),expanded:e.optional.boolean,picker:e.optional.custom(qV),readonly:e.optional.constant(!1)}))}function fo(n){return n?.1:1}function ZV(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}let Aw=class{constructor(e,t){this.type="float",this.mode=t,this.comps_=YV(e,t,this.type)}getComponents(e){return Bp(XV(yi(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const vI={int:(n,e)=>new ae(n,e),float:(n,e)=>new Aw(n,e)};function Mw(n,e,t){return vI[t](n,e)}function fI(n){return n.type==="float"}function wI(n){return n.type==="int"}function _I(n){const e=n.getComponents(),t=Jl(n.mode,"int");return new ae([Math.round(te(e[0],0,1,0,t[0])),Math.round(te(e[1],0,1,0,t[1])),Math.round(te(e[2],0,1,0,t[2])),e[3]],n.mode)}function bI(n){const e=n.getComponents(),t=Jl(n.mode,"int");return new Aw([te(e[0],0,t[0],0,1),te(e[1],0,t[1],0,1),te(e[2],0,t[2],0,1),e[3]],n.mode)}function Ft(n,e){if(n.type===e)return n;if(wI(n)&&e==="float")return bI(n);if(fI(n)&&e==="int")return _I(n);throw $t.shouldNeverHappen()}function gI(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function Un(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const CI={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function QV(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),i=e[2];return CI[i](t)}function JV(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Un(e[1],255),Un(e[2],255),Un(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function PI(n){const e=JV(n);return e?new ae(e,"rgb"):null}function ek(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Un(e[1],255),Un(e[2],255),Un(e[3],255),Un(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function yI(n){const e=ek(n);return e?new ae(e,"rgb"):null}function tk(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[QV(e[1]),Un(e[2],100),Un(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function EI(n){const e=tk(n);return e?new ae(e,"hsl"):null}function nk(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[QV(e[1]),Un(e[2],100),Un(e[3],100),Un(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function xI(n){const e=nk(n);return e?new ae(e,"hsl"):null}function ik(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function $I(n){const e=ik(n);return e?new ae(e,"rgb"):null}function sk(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),te(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),te(parseInt(t[4],16),0,255,0,1)]:null}function VI(n){const e=sk(n);return e?new ae(e,"rgb"):null}function rk(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function kI(n){return e=>{const t=rk(e);return t?Mw(t,"rgb",n):null}}function ok(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function SI(n){return e=>{const t=ok(e);return t?Mw(t,"rgb",n):null}}const LI=[{parser:ik,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:sk,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:JV,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:ek,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:tk,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:nk,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:rk,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:ok,result:{alpha:!0,mode:"rgb",notation:"object"}}];function AI(n){return LI.reduce((e,{parser:t,result:i})=>e||(t(n)?i:null),null)}function MI(n,e="int"){const t=AI(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function kh(n){const e=[$I,VI,PI,yI,EI,xI];e.push(kI("int"),SI("int"));const t=qB(e);return i=>{const s=t(i);return s?Ft(s,n):null}}function TI(n){const e=kh("int");if(typeof n!="string")return ae.black();const t=e(n);return t??ae.black()}function lk(n){const e=Je(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function Tw(n,e="#"){const t=yi(n.getComponents("rgb")).map(lk).join("");return`${e}${t}`}function Dw(n,e="#"){const t=n.getComponents("rgb"),i=[t[0],t[1],t[2],t[3]*255].map(lk).join("");return`${e}${i}`}function ak(n){const e=un(0),t=Ft(n,"int");return`rgb(${yi(t.getComponents("rgb")).map(s=>e(s)).join(", ")})`}function $c(n){const e=un(2),t=un(0);return`rgba(${Ft(n,"int").getComponents("rgb").map((r,o)=>(o===3?e:t)(r)).join(", ")})`}function DI(n){const e=[un(0),np,np],t=Ft(n,"int");return`hsl(${yi(t.getComponents("hsl")).map((s,r)=>e[r](s)).join(", ")})`}function OI(n){const e=[un(0),np,np,un(2)];return`hsla(${Ft(n,"int").getComponents("hsl").map((s,r)=>e[r](s)).join(", ")})`}function uk(n,e){const t=un(e==="float"?2:0),i=["r","g","b"],s=Ft(n,e);return`{${yi(s.getComponents("rgb")).map((o,l)=>`${i[l]}: ${t(o)}`).join(", ")}}`}function RI(n){return e=>uk(e,n)}function hk(n,e){const t=un(2),i=un(e==="float"?2:0),s=["r","g","b","a"];return`{${Ft(n,e).getComponents("rgb").map((l,a)=>{const u=a===3?t:i;return`${s[a]}: ${u(l)}`}).join(", ")}}`}function jI(n){return e=>hk(e,n)}const NI=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Tw},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Dw},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:ak},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:$c},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:DI},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:OI},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:RI(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:jI(e)}],[])];function ck(n){return NI.reduce((e,t)=>e||(gI(t.format,n)?t.stringifier:null),null)}const Ya=B("apl");let BI=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Ya()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Ya("b")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Ya("c")),i.appendChild(s),this.colorElem_=s;const r=e.createElement("div");r.classList.add(Ya("m")),this.element.appendChild(r),this.markerElem_=r;const o=e.createElement("div");o.classList.add(Ya("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new ae([t[0],t[1],t[2],0],"rgb"),s=new ae([t[0],t[1],t[2],255],"rgb"),r=["to right",$c(i),$c(s)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=$c(e);const o=te(t[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}},II=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new BI(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Uo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,s=this.value.rawValue,[r,o,l]=s.getComponents("hsv");this.value.setRawValue(new ae([r,o,l,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=tn(fo(!0),Ls(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new ae([s,r,o,l+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){tn(fo(!0),Ls(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const nl=B("coltxt");function FI(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((i,s)=>{const r=n.createElement("option");return r.textContent=s.text,r.value=s.value,i.appendChild(r),i},n.createDocumentFragment())),e}let KI=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(nl()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(nl("m")),this.modeElem_=FI(e),this.modeElem_.classList.add(nl("ms")),i.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const s=e.createElement("div");s.classList.add(nl("mm")),s.appendChild(jp(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(nl("w")),this.element.appendChild(r),this.inputsElem_=r,this.inputViews_=t.inputViews,this.applyInputViews_(),Cs(t.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){kV(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const i=e.createElement("div");i.classList.add(nl("c")),i.appendChild(t.element),this.inputsElem_.appendChild(i)})}};function UI(n){return un(n==="float"?2:0)}function HI(n,e,t){const i=Jl(n,e)[t];return new Ch({min:0,max:i})}function zI(n,e,t){return new $h(n,{arrayPosition:t===0?"fst":t===2?"lst":"mid",parser:e.parser,props:T.fromObject({formatter:UI(e.colorType),keyScale:fo(!1),pointerScale:e.colorType==="float"?.01:1}),value:Ae(0,{constraint:HI(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function qI(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:Ss,viewProps:e.viewProps};return[0,1,2].map(i=>{const s=zI(n,t,i);return ya({primary:e.value,secondary:s.value,forward(r){return Ft(r,e.colorType).getComponents(e.colorMode)[i]},backward(r,o){const l=e.colorMode,u=Ft(r,e.colorType).getComponents(l);u[i]=o;const h=Mw(Bp(yi(u),u[3]),l,e.colorType);return Ft(h,"int")}}),s})}function GI(n,e){const t=new Nu(n,{parser:kh("int"),props:T.fromObject({formatter:Tw}),value:Ae(ae.black()),viewProps:e.viewProps});return ya({primary:e.value,secondary:t.value,forward:i=>new ae(yi(i.getComponents()),i.mode),backward:(i,s)=>new ae(Bp(yi(s.getComponents(i.mode)),i.getComponents()[3]),i.mode)}),[t]}function YI(n){return n!=="hex"}let XI=class{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=Ae(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new KI(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return YI(t)?qI(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):GI(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(i=>i.view)}};const cm=B("hpl");let WI=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(cm()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(cm("c")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(cm("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=ak(new ae([t,100,100],"hsv"));const i=te(t,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}},ZI=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new WI(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Uo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=te(Je(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),s=this.value.rawValue,[,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new ae([i,r,o,l],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=tn(fo(!1),Ls(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new ae([s+t,r,o,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){tn(fo(!1),Ls(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const pm=B("svp"),U0=64;let QI=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(pm()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=U0,i.width=U0,i.classList.add(pm("c")),this.element.appendChild(i),this.canvasElement=i;const s=e.createElement("div");s.classList.add(pm("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=ZN(this.canvasElement);if(!e)return;const i=this.value.rawValue.getComponents("hsv"),s=this.canvasElement.width,r=this.canvasElement.height,o=e.getImageData(0,0,s,r),l=o.data;for(let h=0;h<r;h++)for(let c=0;c<s;c++){const d=te(c,0,s,0,100),p=te(h,0,r,100,0),v=GV(i[0],d,p),m=(h*s+c)*4;l[m]=v[0],l[m+1]=v[1],l[m+2]=v[2],l[m+3]=255}e.putImageData(o,0,0);const a=te(i[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const u=te(i[2],0,100,100,0);this.markerElem_.style.top=`${u}%`}onValueChange_(){this.update_()}},JI=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new QI(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Uo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=te(e.point.x,0,e.bounds.width,0,100),s=te(e.point.y,0,e.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new ae([r,i,s,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){UV(e.key)&&e.preventDefault();const[t,i,s,r]=this.value.rawValue.getComponents("hsv"),o=fo(!1),l=tn(o,Ls(e)),a=tn(o,Bu(e));l===0&&a===0||this.value.setRawValue(new ae([t,i+l,s+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=fo(!1),i=tn(t,Ls(e)),s=tn(t,Bu(e));i===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},eF=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new ZI(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new JI(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new II(e,{value:this.value,viewProps:this.viewProps}),text:new $h(e,{parser:Ss,props:T.fromObject({pointerScale:.01,keyScale:.1,formatter:un(2)}),value:Ae(0,{constraint:new Ch({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&ya({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.getComponents()[3],backward:(i,s)=>{const r=i.getComponents();return r[3]=s,new ae(r,i.mode)}}),this.textsC_=new XI(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new dI(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}};const dm=B("colsw");let tF=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(dm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(dm("sw")),this.element.appendChild(i),this.swatchElem_=i;const s=e.createElement("button");s.classList.add(dm("b")),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=Dw(e)}onValueChange_(){this.update_()}},nF=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new tF(e,{value:this.value,viewProps:this.viewProps})}},Ow=class{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=xw.create(t.expanded),this.swatchC_=new nF(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new Nu(e,{parser:t.parser,props:T.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new rI(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new IV(e,{viewProps:this.viewProps}):null;const s=new eF(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),ya({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),$w(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=SV(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!bw(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}};function iF(n){return yi(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function sF(n){return n.getComponents("rgb").reduce((e,t,i)=>{const s=Math.floor(i===3?t*255:t)&255;return e<<8|s},0)>>>0}function rF(n){return new ae([n>>16&255,n>>8&255,n&255],"rgb")}function oF(n){return new ae([n>>24&255,n>>16&255,n>>8&255,te(n&255,0,255,0,1)],"rgb")}function lF(n){return typeof n!="number"?ae.black():rF(n)}function aF(n){return typeof n!="number"?ae.black():oF(n)}function Vc(n,e){return typeof n!="object"||$e(n)?!1:e in n&&typeof n[e]=="number"}function pk(n){return Vc(n,"r")&&Vc(n,"g")&&Vc(n,"b")}function dk(n){return pk(n)&&Vc(n,"a")}function mk(n){return pk(n)}function Rw(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),i=e.getComponents();for(let s=0;s<t.length;s++)if(t[s]!==i[s])return!1;return!0}function H0(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function uF(n){const e=ck(n);return e?(t,i)=>{Vh(t,e(i))}:null}function hF(n){const e=n?sF:iF;return(t,i)=>{Vh(t,e(i))}}function cF(n,e,t){const s=Ft(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b),n.writeProperty("a",s.a)}function pF(n,e,t){const s=Ft(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b)}function dF(n,e){return(t,i)=>{n?cF(t,i,e):pF(t,i,e)}}function mF(n){var e;return!!(!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function vF(n){return n?e=>Dw(e,"0x"):e=>Tw(e,"0x")}function fF(n){return"color"in n||n.view==="color"}const wF=Zt({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!fF(e))return null;const t=Lw(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:mF(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?aF:lF,equals:Rw,writer:n=>hF(n.params.supportsAlpha)},controller:n=>{var e,t;return new Ow(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:vF(n.params.supportsAlpha),parser:kh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function _F(n,e){if(!mk(n))return Ft(ae.black(),e);if(e==="int"){const t=H0(n);return new ae(t,"rgb")}if(e==="float"){const t=H0(n);return new Aw(t,"rgb")}return Ft(ae.black(),"int")}function bF(n){return dk(n)}function gF(n){return e=>{const t=_F(e,n);return Ft(t,"int")}}function CF(n,e){return t=>n?hk(t,e):uk(t,e)}const PF=Zt({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!mk(n))return null;const i=Lw(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{colorType:(t=ZV(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>gF(n.params.colorType),equals:Rw,writer:n=>dF(bF(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const i=dk(n.initialValue);return new Ow(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:CF(i,n.params.colorType),parser:kh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:i,value:n.value,viewProps:n.viewProps})}}),yF=Zt({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=MI(n,ZV(e));if(!t)return null;const i=ck(t);if(!i)return null;const s=Lw(e);return s?{initialValue:n,params:Object.assign(Object.assign({},s),{format:t,stringifier:i})}:null},binding:{reader:()=>TI,equals:Rw,writer:n=>{const e=uF(n.params.format);if(!e)throw $t.notBindable();return e}},controller:n=>{var e,t;return new Ow(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:kh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});let jw=class{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((i,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(i))!==null&&o!==void 0?o:i});return this.asm_.fromComponents(t)}};const z0=B("pndtxt");let EF=class{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(z0()),this.textViews.forEach(i=>{const s=e.createElement("div");s.classList.add(z0("a")),s.appendChild(i.element),this.element.appendChild(s)})}};function xF(n,e,t){return new $h(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:Ae(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}let Nw=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((i,s)=>xF(e,t,s)),this.acs_.forEach((i,s)=>{ya({primary:this.value,secondary:i.value,forward:r=>t.assembly.toComponents(r)[s],backward:(r,o)=>{const l=t.assembly.toComponents(r);return l[s]=o,t.assembly.fromComponents(l)}})}),this.view=new EF(e,{textViews:this.acs_.map(i=>i.view)})}get textControllers(){return this.acs_}},$F=class extends ju{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}};function VF(n,e){const t=[],i=PV(n,e);i&&t.push(i);const s=yV(n);s&&t.push(s);const r=Sw(n.options);return r&&t.push(r),new yh(t)}const kF=Zt({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=Be(e,i=>Object.assign(Object.assign({},xV(i)),{options:i.optional.custom(xh),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>_V,constraint:n=>VF(n.params,n.initialValue),writer:n=>Vh},controller:n=>{const e=n.value,t=n.constraint,i=t&&tp(t,Eh);if(i)return new jr(n.document,{props:new T({options:i.values.value("options")}),value:e,viewProps:n.viewProps});const s=EV(n.params,e.rawValue),r=t&&tp(t,Ch);return r?new ip(n.document,Object.assign(Object.assign({},HV(Object.assign(Object.assign({},s),{keyScale:Ae(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:Ss,value:e,viewProps:n.viewProps})):new $h(n.document,{parser:Ss,props:T.fromObject(s),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof ip?new $F(n.controller):n.controller.valueController instanceof jr?new Vw(n.controller):null}});let xr=class{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if($e(e))return!1;const t=e.x,i=e.y;return!(typeof t!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}};const vk={toComponents:n=>n.getComponents(),fromComponents:n=>new xr(...n)},il=B("p2d");let SF=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(il()),t.viewProps.bindClassModifiers(this.element),Cs(t.expanded,ga(this.element,il(void 0,"expanded")));const i=e.createElement("div");i.classList.add(il("h")),this.element.appendChild(i);const s=e.createElement("button");s.classList.add(il("b")),s.appendChild(jp(e,"p2dpad")),t.viewProps.bindDisabled(s),i.appendChild(s),this.buttonElement=s;const r=e.createElement("div");if(r.classList.add(il("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(il("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};const Hs=B("p2dp");let LF=class{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(Hs()),t.layout==="popup"&&this.element.classList.add(Hs(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Hs("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=e.createElementNS(di,"svg");s.classList.add(Hs("g")),this.padElement.appendChild(s),this.svgElem_=s;const r=e.createElementNS(di,"line");r.classList.add(Hs("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=e.createElementNS(di,"line");o.classList.add(Hs("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const l=e.createElementNS(di,"line");l.classList.add(Hs("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const a=e.createElement("div");a.classList.add(Hs("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.props_.get("max"),s=te(e,-i,+i,0,100),r=te(t,-i,+i,0,100),o=this.props_.get("invertsY")?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${s}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${s}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}};function q0(n,e,t){return[tn(e[0],Ls(n)),tn(e[1],Bu(n))*(t?1:-1)]}let AF=class{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new LF(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Uo(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.props.get("max"),s=te(e.point.x,0,e.bounds.width,-i,+i),r=te(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new xr(s,r),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){UV(e.key)&&e.preventDefault();const[t,i]=q0(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(new xr(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=q0(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},MF=class{constructor(e,t){var i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=xw.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new IV(e,{viewProps:this.viewProps}):null;const r=new AF(e,{layout:t.pickerLayout,props:new T({invertsY:Ae(t.invertsY),max:Ae(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.textC_=new Nw(e,{assembly:vk,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new SF(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),ya({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),$w(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=SV(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!bw(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}};function TF(n){return xr.isObject(n)?new xr(n.x,n.y):new xr}function DF(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function OF(n,e){return new jw({assembly:vk,components:[ps(Object.assign(Object.assign({},n),n.x),e.x),ps(Object.assign(Object.assign({},n),n.y),e.y)]})}function G0(n,e){var t,i;if(!$e(n.min)||!$e(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((i=n.max)!==null&&i!==void 0?i:0));const s=gV(n);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function RF(n,e){var t,i;const s=G0(mo(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),r=G0(mo(n,(i=n.y)!==null&&i!==void 0?i:{}),e.y);return Math.max(s,r)}function jF(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}const NF=Zt({id:"input-point2d",type:"input",accept:(n,e)=>{if(!xr.isObject(n))return null;const t=Be(e,i=>Object.assign(Object.assign({},Iu(i)),{expanded:i.optional.boolean,picker:i.optional.custom(qV),readonly:i.optional.constant(!1),x:i.optional.custom(wr),y:i.optional.object(Object.assign(Object.assign({},Iu(i)),{inverted:i.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>TF,constraint:n=>OF(n.params,n.initialValue),equals:xr.equals,writer:()=>DF},controller:n=>{var e,t;const i=n.document,s=n.value,r=n.constraint,o=[n.params.x,n.params.y];return new MF(i,{axes:s.rawValue.getComponents().map((l,a)=>{var u;return _w({constraint:r.components[a],initialValue:l,params:mo(n.params,(u=o[a])!==null&&u!==void 0?u:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:jF(n.params),max:RF(n.params,s.rawValue),parser:Ss,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:n.viewProps})}});let Dl=class{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if($e(e))return!1;const t=e.x,i=e.y,s=e.z;return!(typeof t!="number"||typeof i!="number"||typeof s!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}};const fk={toComponents:n=>n.getComponents(),fromComponents:n=>new Dl(...n)};function BF(n){return Dl.isObject(n)?new Dl(n.x,n.y,n.z):new Dl}function IF(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function FF(n,e){return new jw({assembly:fk,components:[ps(Object.assign(Object.assign({},n),n.x),e.x),ps(Object.assign(Object.assign({},n),n.y),e.y),ps(Object.assign(Object.assign({},n),n.z),e.z)]})}const KF=Zt({id:"input-point3d",type:"input",accept:(n,e)=>{if(!Dl.isObject(n))return null;const t=Be(e,i=>Object.assign(Object.assign({},Iu(i)),{readonly:i.optional.constant(!1),x:i.optional.custom(wr),y:i.optional.custom(wr),z:i.optional.custom(wr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>BF,constraint:n=>FF(n.params,n.initialValue),equals:Dl.equals,writer:n=>IF},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z];return new Nw(n.document,{assembly:fk,axes:e.rawValue.getComponents().map((s,r)=>{var o;return _w({constraint:t.components[r],initialValue:s,params:mo(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Ss,value:e,viewProps:n.viewProps})}});let Ol=class{constructor(e=0,t=0,i=0,s=0){this.x=e,this.y=t,this.z=i,this.w=s}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if($e(e))return!1;const t=e.x,i=e.y,s=e.z,r=e.w;return!(typeof t!="number"||typeof i!="number"||typeof s!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}};const wk={toComponents:n=>n.getComponents(),fromComponents:n=>new Ol(...n)};function UF(n){return Ol.isObject(n)?new Ol(n.x,n.y,n.z,n.w):new Ol}function HF(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function zF(n,e){return new jw({assembly:wk,components:[ps(Object.assign(Object.assign({},n),n.x),e.x),ps(Object.assign(Object.assign({},n),n.y),e.y),ps(Object.assign(Object.assign({},n),n.z),e.z),ps(Object.assign(Object.assign({},n),n.w),e.w)]})}const qF=Zt({id:"input-point4d",type:"input",accept:(n,e)=>{if(!Ol.isObject(n))return null;const t=Be(e,i=>Object.assign(Object.assign({},Iu(i)),{readonly:i.optional.constant(!1),w:i.optional.custom(wr),x:i.optional.custom(wr),y:i.optional.custom(wr),z:i.optional.custom(wr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>UF,constraint:n=>zF(n.params,n.initialValue),equals:Ol.equals,writer:n=>HF},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z,n.params.w];return new Nw(n.document,{assembly:wk,axes:e.rawValue.getComponents().map((s,r)=>{var o;return _w({constraint:t.components[r],initialValue:s,params:mo(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Ss,value:e,viewProps:n.viewProps})}});function GF(n){const e=[],t=Sw(n.options);return t&&e.push(t),new yh(e)}const YF=Zt({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=Be(e,i=>({readonly:i.optional.constant(!1),options:i.optional.custom(xh)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>KV,constraint:n=>GF(n.params),writer:n=>Vh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&tp(i,Eh);return s?new jr(e,{props:new T({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new Nu(e,{parser:r=>r,props:T.fromObject({formatter:Iv}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof jr?new Vw(n.controller):null}}),Sh={monitor:{defaultInterval:200,defaultRows:3}},Y0=B("mll");let XF=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(Y0()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(Y0("i")),i.style.height=`calc(var(${zV("containerUnitSize")}) * ${t.rows})`,i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach(s=>{s!==void 0&&i.push(this.formatter_(s))}),e.textContent=i.join(`
`),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}},Bw=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new XF(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}};const X0=B("sgl");let WF=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(X0()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(X0("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}},Iw=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new WF(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}};const ZF=Zt({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Be(e,i=>({readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>FV},controller:n=>{var e;return n.value.rawValue.length===1?new Iw(n.document,{formatter:F0,value:n.value,viewProps:n.viewProps}):new Bw(n.document,{formatter:F0,rows:(e=n.params.rows)!==null&&e!==void 0?e:Sh.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});let QF=class extends ju{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}};const zs=B("grl");let JF=class{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(zs()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(di,"svg");i.classList.add(zs("g")),i.style.height=`calc(var(${zV("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(di,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=e.createElement("div");r.classList.add(zs("t"),B("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:e,clientHeight:t}=this.element,i=this.value.rawValue.length-1,s=this.props_.get("min"),r=this.props_.get("max"),o=[];this.value.rawValue.forEach((c,d)=>{if(c===void 0)return;const p=te(d,0,i,0,e),v=te(c,s,r,t,0);o.push([p,v].join(","))}),this.lineElem_.setAttributeNS(null,"points",o.join(" "));const l=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(a===void 0){l.classList.remove(zs("t","a"));return}const u=te(this.cursor_.rawValue,0,i,0,e),h=te(a,s,r,t,0);l.style.left=`${u}px`,l.style.top=`${h}px`,l.textContent=`${this.formatter_(a)}`,l.classList.contains(zs("t","a"))||(l.classList.add(zs("t","a"),zs("t","in")),ep(l),l.classList.remove(zs("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}},_k=class{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=Ae(-1),this.view=new JF(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!bw(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new Uo(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return Cn(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return Pn(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const{clientWidth:t}=this.view.element;this.cursor_.rawValue=Math.floor(te(e.offsetX,0,t,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(te(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}};function Fv(n){return $e(n.format)?un(2):n.format}function e5(n){var e;return n.value.rawValue.length===1?new Iw(n.document,{formatter:Fv(n.params),value:n.value,viewProps:n.viewProps}):new Bw(n.document,{formatter:Fv(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Sh.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function t5(n){var e,t,i;return new _k(n.document,{formatter:Fv(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Sh.monitor.defaultRows,props:T.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(i=n.params.min)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function W0(n){return n.view==="graph"}const n5=Zt({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=Be(e,i=>({format:i.optional.function,max:i.optional.number,min:i.optional.number,readonly:i.required.constant(!0),rows:i.optional.number,view:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>W0(n)?64:1,reader:n=>_V},controller:n=>W0(n.params)?t5(n):e5(n),api:n=>n.controller.valueController instanceof _k?new QF(n.controller):null}),i5=Zt({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=Be(e,i=>({multiline:i.optional.boolean,readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>KV},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new Bw(n.document,{formatter:Iv,rows:(e=n.params.rows)!==null&&e!==void 0?e:Sh.monitor.defaultRows,value:t,viewProps:n.viewProps}):new Iw(n.document,{formatter:Iv,value:t,viewProps:n.viewProps})}});class s5{constructor(){this.map_=new Map}get(e){var t;return(t=this.map_.get(e))!==null&&t!==void 0?t:null}has(e){return this.map_.has(e)}add(e,t){return this.map_.set(e,t),e.viewProps.handleDispose(()=>{this.map_.delete(e)}),t}}class r5{constructor(e){this.target=e.target,this.reader_=e.reader,this.writer_=e.writer}read(){return this.reader_(this.target.read())}write(e){this.writer_(this.target,e)}inject(e){this.write(this.reader_(e))}}function o5(n,e){var t;const i=n.accept(e.target.read(),e.params);if($e(i))return null;const s={target:e.target,initialValue:i.initialValue,params:i.params},r=Be(e.params,c=>({disabled:c.optional.boolean,hidden:c.optional.boolean,label:c.optional.string,tag:c.optional.string})),o=n.binding.reader(s),l=n.binding.constraint?n.binding.constraint(s):void 0,a=new r5({reader:o,target:e.target,writer:n.binding.writer(s)}),u=new UN(Ae(o(i.initialValue),{constraint:l,equals:n.binding.equals}),a),h=n.controller({constraint:l,document:e.document,initialValue:i.initialValue,params:i.params,value:u,viewProps:Ko.create({disabled:r==null?void 0:r.disabled,hidden:r==null?void 0:r.hidden})});return new sB(e.document,{blade:Pa(),props:T.fromObject({label:"label"in e.params?(t=r==null?void 0:r.label)!==null&&t!==void 0?t:null:e.target.key}),tag:r==null?void 0:r.tag,value:u,valueController:h})}class l5{constructor(e){this.target=e.target,this.reader_=e.reader}read(){return this.reader_(this.target.read())}}function a5(n,e){return e===0?new IB:new FB(n,e??Sh.monitor.defaultInterval)}function u5(n,e){var t,i,s;const r=n.accept(e.target.read(),e.params);if($e(r))return null;const o={target:e.target,initialValue:r.initialValue,params:r.params},l=Be(e.params,d=>({bufferSize:d.optional.number,disabled:d.optional.boolean,hidden:d.optional.boolean,interval:d.optional.number,label:d.optional.string})),a=n.binding.reader(o),u=(i=(t=l==null?void 0:l.bufferSize)!==null&&t!==void 0?t:n.binding.defaultBufferSize&&n.binding.defaultBufferSize(r.params))!==null&&i!==void 0?i:1,h=new uB({binding:new l5({reader:a,target:e.target}),bufferSize:u,ticker:a5(e.document,l==null?void 0:l.interval)}),c=n.controller({document:e.document,params:r.params,value:h,viewProps:Ko.create({disabled:l==null?void 0:l.disabled,hidden:l==null?void 0:l.hidden})});return c.viewProps.bindDisabled(h.ticker),c.viewProps.handleDispose(()=>{h.ticker.dispose()}),new cB(e.document,{blade:Pa(),props:T.fromObject({label:"label"in e.params?(s=l==null?void 0:l.label)!==null&&s!==void 0?s:null:e.target.key}),value:h,valueController:c})}class h5{constructor(e){this.pluginsMap_={blades:[],inputs:[],monitors:[]},this.apiCache_=e}getAll(){return[...this.pluginsMap_.blades,...this.pluginsMap_.inputs,...this.pluginsMap_.monitors]}register(e,t){if(!eI(t.core))throw $t.notCompatible(e,t.id);t.type==="blade"?this.pluginsMap_.blades.unshift(t):t.type==="input"?this.pluginsMap_.inputs.unshift(t):t.type==="monitor"&&this.pluginsMap_.monitors.unshift(t)}createInput_(e,t,i){return this.pluginsMap_.inputs.reduce((s,r)=>s??o5(r,{document:e,target:t,params:i}),null)}createMonitor_(e,t,i){return this.pluginsMap_.monitors.reduce((s,r)=>s??u5(r,{document:e,params:i,target:t}),null)}createBinding(e,t,i){const s=t.read();if($e(s))throw new $t({context:{key:t.key},type:"nomatchingcontroller"});const r=this.createInput_(e,t,i);if(r)return r;const o=this.createMonitor_(e,t,i);if(o)return o;throw new $t({context:{key:t.key},type:"nomatchingcontroller"})}createBlade(e,t){const i=this.pluginsMap_.blades.reduce((s,r)=>s??BB(r,{document:e,params:t}),null);if(!i)throw new $t({type:"nomatchingview",context:{params:t}});return i}createInputBindingApi_(e){const t=this.pluginsMap_.inputs.reduce((i,s)=>{var r,o;return i||((o=(r=s.api)===null||r===void 0?void 0:r.call(s,{controller:e}))!==null&&o!==void 0?o:null)},null);return this.apiCache_.add(e,t??new ju(e))}createMonitorBindingApi_(e){const t=this.pluginsMap_.monitors.reduce((i,s)=>{var r,o;return i||((o=(r=s.api)===null||r===void 0?void 0:r.call(s,{controller:e}))!==null&&o!==void 0?o:null)},null);return this.apiCache_.add(e,t??new ju(e))}createBindingApi(e){if(this.apiCache_.has(e))return this.apiCache_.get(e);if(rB(e))return this.createInputBindingApi_(e);if(pB(e))return this.createMonitorBindingApi_(e);throw $t.shouldNeverHappen()}createApi(e){if(this.apiCache_.has(e))return this.apiCache_.get(e);if(iB(e))return this.createBindingApi(e);const t=this.pluginsMap_.blades.reduce((i,s)=>i??s.api({controller:e,pool:this}),null);if(!t)throw $t.shouldNeverHappen();return this.apiCache_.add(e,t)}}const c5=new s5;function p5(){const n=new h5(c5);return[NF,KF,qF,YF,kF,yF,PF,wF,sI,ZF,i5,n5,wB,LB,BV].forEach(e=>{n.register("core",e)}),n}class d5 extends Fo{constructor(e){super(e),this.emitter_=new Ze,this.controller.value.emitter.on("change",t=>{this.emitter_.emit("change",new Ph(this,t.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}class m5 extends Fo{}class v5 extends Fo{constructor(e){super(e),this.emitter_=new Ze,this.controller.value.emitter.on("change",t=>{this.emitter_.emit("change",new Ph(this,t.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}class f5 extends Fo{constructor(e){super(e),this.emitter_=new Ze,this.controller.value.emitter.on("change",t=>{this.emitter_.emit("change",new Ph(this,t.rawValue))})}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get formatter(){return this.controller.valueController.props.get("formatter")}set formatter(e){this.controller.valueController.props.set("formatter",e)}get value(){return this.controller.value.rawValue}set value(e){this.controller.value.rawValue=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}}const w5=function(){return{id:"list",type:"blade",core:Ca,accept(n){const e=Be(n,t=>({options:t.required.custom(xh),value:t.required.raw,view:t.required.constant("list"),label:t.optional.string}));return e?{params:e}:null},controller(n){const e=new Eh(kw(n.params.options)),t=Ae(n.params.value,{constraint:e}),i=new jr(n.document,{props:new T({options:e.values.value("options")}),value:t,viewProps:n.viewProps});return new vo(n.document,{blade:n.blade,props:T.fromObject({label:n.params.label}),value:t,valueController:i})},api(n){return!(n.controller instanceof vo)||!(n.controller.valueController instanceof jr)?null:new d5(n.controller)}}}();class _5 extends RV{constructor(e,t){super(e,t)}get element(){return this.controller.view.element}}class b5 extends Nv{constructor(e,t){super(e,{expanded:t.expanded,blade:t.blade,props:t.props,root:!0,viewProps:t.viewProps})}}const Z0=B("spr");class g5{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Z0()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("hr");i.classList.add(Z0("r")),this.element.appendChild(i)}}class Q0 extends Np{constructor(e,t){super(Object.assign(Object.assign({},t),{view:new g5(e,{viewProps:t.viewProps})}))}}const C5={id:"separator",type:"blade",core:Ca,accept(n){const e=Be(n,t=>({view:t.required.constant("separator")}));return e?{params:e}:null},controller(n){return new Q0(n.document,{blade:n.blade,viewProps:n.viewProps})},api(n){return n.controller instanceof Q0?new m5(n.controller):null}},P5={id:"slider",type:"blade",core:Ca,accept(n){const e=Be(n,t=>({max:t.required.number,min:t.required.number,view:t.required.constant("slider"),format:t.optional.function,label:t.optional.string,value:t.optional.number}));return e?{params:e}:null},controller(n){var e,t;const i=(e=n.params.value)!==null&&e!==void 0?e:0,s=new Ch({max:n.params.max,min:n.params.min}),r=Ae(i,{constraint:s}),o=new ip(n.document,Object.assign(Object.assign({},HV({formatter:(t=n.params.format)!==null&&t!==void 0?t:NN,keyScale:Ae(1),max:s.values.value("max"),min:s.values.value("min"),pointerScale:CV(n.params,i)})),{parser:Ss,value:r,viewProps:n.viewProps}));return new vo(n.document,{blade:n.blade,props:T.fromObject({label:n.params.label}),value:r,valueController:o})},api(n){return!(n.controller instanceof vo)||!(n.controller.valueController instanceof ip)?null:new v5(n.controller)}},y5=function(){return{id:"text",type:"blade",core:Ca,accept(n){const e=Be(n,t=>({parse:t.required.function,value:t.required.raw,view:t.required.constant("text"),format:t.optional.function,label:t.optional.string}));return e?{params:e}:null},controller(n){var e;const t=Ae(n.params.value),i=new Nu(n.document,{parser:n.params.parse,props:T.fromObject({formatter:(e=n.params.format)!==null&&e!==void 0?e:s=>String(s)}),value:t,viewProps:n.viewProps});return new vo(n.document,{blade:n.blade,props:T.fromObject({label:n.params.label}),value:t,valueController:i})},api(n){return!(n.controller instanceof vo)||!(n.controller.valueController instanceof Nu)?null:new f5(n.controller)}}}();function E5(n){const e=n.createElement("div");return e.classList.add(B("dfw")()),n.body&&n.body.appendChild(e),e}function x5(n,e,t){if(n.querySelector(`style[data-tp-style=${e}]`))return;const i=n.createElement("style");i.dataset.tpStyle=e,i.textContent=t,n.head.appendChild(i)}let $5=class extends _5{constructor(e){var t,i;const s=e??{},r=(t=s.document)!==null&&t!==void 0?t:WN(),o=p5(),l=new b5(r,{expanded:s.expanded,blade:Pa(),props:T.fromObject({title:s.title}),viewProps:Ko.create()});super(l,o),this.pool_=o,this.containerElem_=(i=s.container)!==null&&i!==void 0?i:E5(r),this.containerElem_.appendChild(this.element),this.doc_=r,this.usesDefaultWrapper_=!s.container,this.setUpDefaultPlugins_()}get document(){if(!this.doc_)throw $t.alreadyDisposed();return this.doc_}dispose(){const e=this.containerElem_;if(!e)throw $t.alreadyDisposed();if(this.usesDefaultWrapper_){const t=e.parentElement;t&&t.removeChild(e)}this.containerElem_=null,this.doc_=null,super.dispose()}registerPlugin(e){e.css&&x5(this.document,`plugin-${e.id}`,e.css),("plugin"in e?[e.plugin]:"plugins"in e?e.plugins:[]).forEach(i=>{this.pool_.register(e.id,i)})}setUpDefaultPlugins_(){this.registerPlugin({id:"default",css:'.tp-tbiv_b,.tp-coltxtv_ms,.tp-colswv_b,.tp-ckbv_i,.tp-sglv_i,.tp-mllv_i,.tp-grlv_g,.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw,.tp-rotv_b,.tp-fldv_b,.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{-webkit-appearance:none;-moz-appearance:none;appearance:none;background-color:rgba(0,0,0,0);border-width:0;font-family:inherit;font-size:inherit;font-weight:inherit;margin:0;outline:none;padding:0}.tp-p2dv_b,.tp-btnv_b,.tp-lstv_s{background-color:var(--btn-bg);border-radius:var(--bld-br);color:var(--btn-fg);cursor:pointer;display:block;font-weight:bold;height:var(--cnt-usz);line-height:var(--cnt-usz);overflow:hidden;text-overflow:ellipsis;white-space:nowrap}.tp-p2dv_b:hover,.tp-btnv_b:hover,.tp-lstv_s:hover{background-color:var(--btn-bg-h)}.tp-p2dv_b:focus,.tp-btnv_b:focus,.tp-lstv_s:focus{background-color:var(--btn-bg-f)}.tp-p2dv_b:active,.tp-btnv_b:active,.tp-lstv_s:active{background-color:var(--btn-bg-a)}.tp-p2dv_b:disabled,.tp-btnv_b:disabled,.tp-lstv_s:disabled{opacity:.5}.tp-rotv_c>.tp-cntv.tp-v-lst,.tp-tbpv_c>.tp-cntv.tp-v-lst,.tp-fldv_c>.tp-cntv.tp-v-lst{margin-bottom:calc(-1*var(--cnt-vp))}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_c,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_c{border-bottom-left-radius:0}.tp-rotv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-tbpv_c>.tp-fldv.tp-v-lst .tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-v-lst .tp-fldv_b{border-bottom-left-radius:0}.tp-rotv_c>*:not(.tp-v-fst),.tp-tbpv_c>*:not(.tp-v-fst),.tp-fldv_c>*:not(.tp-v-fst){margin-top:var(--cnt-usp)}.tp-rotv_c>.tp-sprv:not(.tp-v-fst),.tp-tbpv_c>.tp-sprv:not(.tp-v-fst),.tp-fldv_c>.tp-sprv:not(.tp-v-fst),.tp-rotv_c>.tp-cntv:not(.tp-v-fst),.tp-tbpv_c>.tp-cntv:not(.tp-v-fst),.tp-fldv_c>.tp-cntv:not(.tp-v-fst){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-sprv+*:not(.tp-v-hidden),.tp-rotv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-tbpv_c>.tp-cntv+*:not(.tp-v-hidden),.tp-fldv_c>.tp-cntv+*:not(.tp-v-hidden){margin-top:var(--cnt-vp)}.tp-rotv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-tbpv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-fldv_c>.tp-sprv:not(.tp-v-hidden)+.tp-sprv,.tp-rotv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-tbpv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv,.tp-fldv_c>.tp-cntv:not(.tp-v-hidden)+.tp-cntv{margin-top:0}.tp-tbpv_c>.tp-cntv,.tp-fldv_c>.tp-cntv{margin-left:4px}.tp-tbpv_c>.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-fldv>.tp-fldv_b{border-top-left-radius:var(--bld-br);border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b,.tp-fldv_c>.tp-fldv.tp-fldv-expanded>.tp-fldv_b{border-bottom-left-radius:0}.tp-tbpv_c .tp-fldv>.tp-fldv_c,.tp-fldv_c .tp-fldv>.tp-fldv_c{border-bottom-left-radius:var(--bld-br)}.tp-tbpv_c>.tp-cntv+.tp-fldv>.tp-fldv_b,.tp-fldv_c>.tp-cntv+.tp-fldv>.tp-fldv_b{border-top-left-radius:0}.tp-tbpv_c>.tp-cntv+.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-cntv+.tp-tabv>.tp-tabv_t{border-top-left-radius:0}.tp-tbpv_c>.tp-tabv>.tp-tabv_t,.tp-fldv_c>.tp-tabv>.tp-tabv_t{border-top-left-radius:var(--bld-br)}.tp-tbpv_c .tp-tabv>.tp-tabv_c,.tp-fldv_c .tp-tabv>.tp-tabv_c{border-bottom-left-radius:var(--bld-br)}.tp-rotv_b,.tp-fldv_b{background-color:var(--cnt-bg);color:var(--cnt-fg);cursor:pointer;display:block;height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);overflow:hidden;padding-left:var(--cnt-hp);padding-right:calc(4px + var(--cnt-usz) + var(--cnt-hp));position:relative;text-align:left;text-overflow:ellipsis;white-space:nowrap;width:100%;transition:border-radius .2s ease-in-out .2s}.tp-rotv_b:hover,.tp-fldv_b:hover{background-color:var(--cnt-bg-h)}.tp-rotv_b:focus,.tp-fldv_b:focus{background-color:var(--cnt-bg-f)}.tp-rotv_b:active,.tp-fldv_b:active{background-color:var(--cnt-bg-a)}.tp-rotv_b:disabled,.tp-fldv_b:disabled{opacity:.5}.tp-rotv_m,.tp-fldv_m{background:linear-gradient(to left, var(--cnt-fg), var(--cnt-fg) 2px, transparent 2px, transparent 4px, var(--cnt-fg) 4px);border-radius:2px;bottom:0;content:"";display:block;height:6px;right:calc(var(--cnt-hp) + (var(--cnt-usz) + 4px - 6px)/2 - 2px);margin:auto;opacity:.5;position:absolute;top:0;transform:rotate(90deg);transition:transform .2s ease-in-out;width:6px}.tp-rotv.tp-rotv-expanded .tp-rotv_m,.tp-fldv.tp-fldv-expanded>.tp-fldv_b>.tp-fldv_m{transform:none}.tp-rotv_c,.tp-fldv_c{box-sizing:border-box;height:0;opacity:0;overflow:hidden;padding-bottom:0;padding-top:0;position:relative;transition:height .2s ease-in-out,opacity .2s linear,padding .2s ease-in-out}.tp-rotv.tp-rotv-cpl:not(.tp-rotv-expanded) .tp-rotv_c,.tp-fldv.tp-fldv-cpl:not(.tp-fldv-expanded)>.tp-fldv_c{display:none}.tp-rotv.tp-rotv-expanded .tp-rotv_c,.tp-fldv.tp-fldv-expanded>.tp-fldv_c{opacity:1;padding-bottom:var(--cnt-vp);padding-top:var(--cnt-vp);transform:none;overflow:visible;transition:height .2s ease-in-out,opacity .2s linear .2s,padding .2s ease-in-out}.tp-txtv_i,.tp-p2dpv_p,.tp-colswv_sw{background-color:var(--in-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--in-fg);font-family:inherit;height:var(--cnt-usz);line-height:var(--cnt-usz);min-width:0;width:100%}.tp-txtv_i:hover,.tp-p2dpv_p:hover,.tp-colswv_sw:hover{background-color:var(--in-bg-h)}.tp-txtv_i:focus,.tp-p2dpv_p:focus,.tp-colswv_sw:focus{background-color:var(--in-bg-f)}.tp-txtv_i:active,.tp-p2dpv_p:active,.tp-colswv_sw:active{background-color:var(--in-bg-a)}.tp-txtv_i:disabled,.tp-p2dpv_p:disabled,.tp-colswv_sw:disabled{opacity:.5}.tp-lstv,.tp-coltxtv_m{position:relative}.tp-lstv_s{padding:0 20px 0 4px;width:100%}.tp-lstv_m,.tp-coltxtv_mm{bottom:0;margin:auto;pointer-events:none;position:absolute;right:2px;top:0}.tp-lstv_m svg,.tp-coltxtv_mm svg{bottom:0;height:16px;margin:auto;position:absolute;right:0;top:0;width:16px}.tp-lstv_m svg path,.tp-coltxtv_mm svg path{fill:currentColor}.tp-sglv_i,.tp-mllv_i,.tp-grlv_g{background-color:var(--mo-bg);border-radius:var(--bld-br);box-sizing:border-box;color:var(--mo-fg);height:var(--cnt-usz);scrollbar-color:currentColor rgba(0,0,0,0);scrollbar-width:thin;width:100%}.tp-sglv_i::-webkit-scrollbar,.tp-mllv_i::-webkit-scrollbar,.tp-grlv_g::-webkit-scrollbar{height:8px;width:8px}.tp-sglv_i::-webkit-scrollbar-corner,.tp-mllv_i::-webkit-scrollbar-corner,.tp-grlv_g::-webkit-scrollbar-corner{background-color:rgba(0,0,0,0)}.tp-sglv_i::-webkit-scrollbar-thumb,.tp-mllv_i::-webkit-scrollbar-thumb,.tp-grlv_g::-webkit-scrollbar-thumb{background-clip:padding-box;background-color:currentColor;border:rgba(0,0,0,0) solid 2px;border-radius:4px}.tp-pndtxtv,.tp-coltxtv_w{display:flex}.tp-pndtxtv_a,.tp-coltxtv_c{width:100%}.tp-pndtxtv_a+.tp-pndtxtv_a,.tp-coltxtv_c+.tp-pndtxtv_a,.tp-pndtxtv_a+.tp-coltxtv_c,.tp-coltxtv_c+.tp-coltxtv_c{margin-left:2px}.tp-rotv{--bs-bg: var(--tp-base-background-color, hsl(230, 7%, 17%));--bs-br: var(--tp-base-border-radius, 6px);--bs-ff: var(--tp-base-font-family, Roboto Mono, Source Code Pro, Menlo, Courier, monospace);--bs-sh: var(--tp-base-shadow-color, rgba(0, 0, 0, 0.2));--bld-br: var(--tp-blade-border-radius, 2px);--bld-hp: var(--tp-blade-horizontal-padding, 4px);--bld-vw: var(--tp-blade-value-width, 160px);--btn-bg: var(--tp-button-background-color, hsl(230, 7%, 70%));--btn-bg-a: var(--tp-button-background-color-active, #d6d7db);--btn-bg-f: var(--tp-button-background-color-focus, #c8cad0);--btn-bg-h: var(--tp-button-background-color-hover, #bbbcc4);--btn-fg: var(--tp-button-foreground-color, hsl(230, 7%, 17%));--cnt-bg: var(--tp-container-background-color, rgba(187, 188, 196, 0.1));--cnt-bg-a: var(--tp-container-background-color-active, rgba(187, 188, 196, 0.25));--cnt-bg-f: var(--tp-container-background-color-focus, rgba(187, 188, 196, 0.2));--cnt-bg-h: var(--tp-container-background-color-hover, rgba(187, 188, 196, 0.15));--cnt-fg: var(--tp-container-foreground-color, hsl(230, 7%, 75%));--cnt-hp: var(--tp-container-horizontal-padding, 4px);--cnt-vp: var(--tp-container-vertical-padding, 4px);--cnt-usp: var(--tp-container-unit-spacing, 4px);--cnt-usz: var(--tp-container-unit-size, 20px);--in-bg: var(--tp-input-background-color, rgba(187, 188, 196, 0.1));--in-bg-a: var(--tp-input-background-color-active, rgba(187, 188, 196, 0.25));--in-bg-f: var(--tp-input-background-color-focus, rgba(187, 188, 196, 0.2));--in-bg-h: var(--tp-input-background-color-hover, rgba(187, 188, 196, 0.15));--in-fg: var(--tp-input-foreground-color, hsl(230, 7%, 75%));--lbl-fg: var(--tp-label-foreground-color, rgba(187, 188, 196, 0.7));--mo-bg: var(--tp-monitor-background-color, rgba(0, 0, 0, 0.2));--mo-fg: var(--tp-monitor-foreground-color, rgba(187, 188, 196, 0.7));--grv-fg: var(--tp-groove-foreground-color, rgba(187, 188, 196, 0.1))}.tp-btnv_b{width:100%}.tp-btnv_t{text-align:center}.tp-ckbv_l{display:block;position:relative}.tp-ckbv_i{left:0;opacity:0;position:absolute;top:0}.tp-ckbv_w{background-color:var(--in-bg);border-radius:var(--bld-br);cursor:pointer;display:block;height:var(--cnt-usz);position:relative;width:var(--cnt-usz)}.tp-ckbv_w svg{bottom:0;display:block;height:16px;left:0;margin:auto;opacity:0;position:absolute;right:0;top:0;width:16px}.tp-ckbv_w svg path{fill:none;stroke:var(--in-fg);stroke-width:2}.tp-ckbv_i:hover+.tp-ckbv_w{background-color:var(--in-bg-h)}.tp-ckbv_i:focus+.tp-ckbv_w{background-color:var(--in-bg-f)}.tp-ckbv_i:active+.tp-ckbv_w{background-color:var(--in-bg-a)}.tp-ckbv_i:checked+.tp-ckbv_w svg{opacity:1}.tp-ckbv.tp-v-disabled .tp-ckbv_w{opacity:.5}.tp-colv{position:relative}.tp-colv_h{display:flex}.tp-colv_s{flex-grow:0;flex-shrink:0;width:var(--cnt-usz)}.tp-colv_t{flex:1;margin-left:4px}.tp-colv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-colv.tp-colv-expanded.tp-colv-cpl .tp-colv_p{overflow:visible}.tp-colv.tp-colv-expanded .tp-colv_p{margin-top:var(--cnt-usp);opacity:1}.tp-colv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-colpv_h,.tp-colpv_ap{margin-left:6px;margin-right:6px}.tp-colpv_h{margin-top:var(--cnt-usp)}.tp-colpv_rgb{display:flex;margin-top:var(--cnt-usp);width:100%}.tp-colpv_a{display:flex;margin-top:var(--cnt-vp);padding-top:calc(var(--cnt-vp) + 2px);position:relative}.tp-colpv_a::before{background-color:var(--grv-fg);content:"";height:2px;left:calc(-1*var(--cnt-hp));position:absolute;right:calc(-1*var(--cnt-hp));top:0}.tp-colpv.tp-v-disabled .tp-colpv_a::before{opacity:.5}.tp-colpv_ap{align-items:center;display:flex;flex:3}.tp-colpv_at{flex:1;margin-left:4px}.tp-svpv{border-radius:var(--bld-br);outline:none;overflow:hidden;position:relative}.tp-svpv.tp-v-disabled{opacity:.5}.tp-svpv_c{cursor:crosshair;display:block;height:calc(var(--cnt-usz)*4);width:100%}.tp-svpv_m{border-radius:100%;border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;filter:drop-shadow(0 0 1px rgba(0, 0, 0, 0.3));height:12px;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;width:12px}.tp-svpv:focus .tp-svpv_m{border-color:#fff}.tp-hplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative}.tp-hplv.tp-v-disabled{opacity:.5}.tp-hplv_c{background-image:url(data:image/png;base64,iVBORw0KGgoAAAANSUhEUgAAAEAAAAABCAYAAABubagXAAAAQ0lEQVQoU2P8z8Dwn0GCgQEDi2OK/RBgYHjBgIpfovFh8j8YBIgzFGQxuqEgPhaDOT5gOhPkdCxOZeBg+IDFZZiGAgCaSSMYtcRHLgAAAABJRU5ErkJggg==);background-position:left top;background-repeat:no-repeat;background-size:100% 100%;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;position:absolute;top:50%;width:100%}.tp-hplv_m{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-shadow:0 0 2px rgba(0,0,0,.1);box-sizing:border-box;height:12px;left:50%;margin-left:-6px;margin-top:-6px;pointer-events:none;position:absolute;top:50%;width:12px}.tp-hplv:focus .tp-hplv_m{border-color:#fff}.tp-aplv{cursor:pointer;height:var(--cnt-usz);outline:none;position:relative;width:100%}.tp-aplv.tp-v-disabled{opacity:.5}.tp-aplv_b{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:4px 4px;background-position:0 0,2px 2px;border-radius:2px;display:block;height:4px;left:0;margin-top:-2px;overflow:hidden;position:absolute;top:50%;width:100%}.tp-aplv_c{bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv_m{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:12px 12px;background-position:0 0,6px 6px;border-radius:var(--bld-br);box-shadow:0 0 2px rgba(0,0,0,.1);height:12px;left:50%;margin-left:-6px;margin-top:-6px;overflow:hidden;pointer-events:none;position:absolute;top:50%;width:12px}.tp-aplv_p{border-radius:var(--bld-br);border:rgba(255,255,255,.75) solid 2px;box-sizing:border-box;bottom:0;left:0;position:absolute;right:0;top:0}.tp-aplv:focus .tp-aplv_p{border-color:#fff}.tp-colswv{background-color:#fff;background-image:linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%),linear-gradient(to top right, #ddd 25%, transparent 25%, transparent 75%, #ddd 75%);background-size:10px 10px;background-position:0 0,5px 5px;border-radius:var(--bld-br);overflow:hidden}.tp-colswv.tp-v-disabled{opacity:.5}.tp-colswv_sw{border-radius:0}.tp-colswv_b{cursor:pointer;display:block;height:var(--cnt-usz);left:0;position:absolute;top:0;width:var(--cnt-usz)}.tp-colswv_b:focus::after{border:rgba(255,255,255,.75) solid 2px;border-radius:var(--bld-br);bottom:0;content:"";display:block;left:0;position:absolute;right:0;top:0}.tp-coltxtv{display:flex;width:100%}.tp-coltxtv_m{margin-right:4px}.tp-coltxtv_ms{border-radius:var(--bld-br);color:var(--lbl-fg);cursor:pointer;height:var(--cnt-usz);line-height:var(--cnt-usz);padding:0 18px 0 4px}.tp-coltxtv_ms:hover{background-color:var(--in-bg-h)}.tp-coltxtv_ms:focus{background-color:var(--in-bg-f)}.tp-coltxtv_ms:active{background-color:var(--in-bg-a)}.tp-coltxtv_mm{color:var(--lbl-fg)}.tp-coltxtv.tp-v-disabled .tp-coltxtv_mm{opacity:.5}.tp-coltxtv_w{flex:1}.tp-dfwv{position:absolute;top:8px;right:8px;width:256px}.tp-fldv{position:relative}.tp-fldv_t{padding-left:4px}.tp-fldv_b:disabled .tp-fldv_m{display:none}.tp-fldv_c{padding-left:4px}.tp-fldv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-fldv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-fldv_b:hover+.tp-fldv_i{color:var(--cnt-bg-h)}.tp-fldv_b:focus+.tp-fldv_i{color:var(--cnt-bg-f)}.tp-fldv_b:active+.tp-fldv_i{color:var(--cnt-bg-a)}.tp-fldv.tp-v-disabled>.tp-fldv_i{opacity:.5}.tp-grlv{position:relative}.tp-grlv_g{display:block;height:calc(var(--cnt-usz)*3)}.tp-grlv_g polyline{fill:none;stroke:var(--mo-fg);stroke-linejoin:round}.tp-grlv_t{margin-top:-4px;transition:left .05s,top .05s;visibility:hidden}.tp-grlv_t.tp-grlv_t-a{visibility:visible}.tp-grlv_t.tp-grlv_t-in{transition:none}.tp-grlv.tp-v-disabled .tp-grlv_g{opacity:.5}.tp-grlv .tp-ttv{background-color:var(--mo-fg)}.tp-grlv .tp-ttv::before{border-top-color:var(--mo-fg)}.tp-lblv{align-items:center;display:flex;line-height:1.3;padding-left:var(--cnt-hp);padding-right:var(--cnt-hp)}.tp-lblv.tp-lblv-nol{display:block}.tp-lblv_l{color:var(--lbl-fg);flex:1;-webkit-hyphens:auto;hyphens:auto;overflow:hidden;padding-left:4px;padding-right:16px}.tp-lblv.tp-v-disabled .tp-lblv_l{opacity:.5}.tp-lblv.tp-lblv-nol .tp-lblv_l{display:none}.tp-lblv_v{align-self:flex-start;flex-grow:0;flex-shrink:0;width:var(--bld-vw)}.tp-lblv.tp-lblv-nol .tp-lblv_v{width:100%}.tp-lstv_s{padding:0 20px 0 var(--bld-hp);width:100%}.tp-lstv_m{color:var(--btn-fg)}.tp-sglv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-sglv.tp-v-disabled .tp-sglv_i{opacity:.5}.tp-mllv_i{display:block;height:calc(var(--cnt-usz)*3);line-height:var(--cnt-usz);padding-left:var(--bld-hp);padding-right:var(--bld-hp);resize:none;white-space:pre}.tp-mllv.tp-v-disabled .tp-mllv_i{opacity:.5}.tp-p2dv{position:relative}.tp-p2dv_h{display:flex}.tp-p2dv_b{height:var(--cnt-usz);margin-right:4px;position:relative;width:var(--cnt-usz)}.tp-p2dv_b svg{display:block;height:16px;left:50%;margin-left:-8px;margin-top:-8px;position:absolute;top:50%;width:16px}.tp-p2dv_b svg path{stroke:currentColor;stroke-width:2}.tp-p2dv_b svg circle{fill:currentColor}.tp-p2dv_t{flex:1}.tp-p2dv_p{height:0;margin-top:0;opacity:0;overflow:hidden;transition:height .2s ease-in-out,opacity .2s linear,margin .2s ease-in-out}.tp-p2dv.tp-p2dv-expanded .tp-p2dv_p{margin-top:var(--cnt-usp);opacity:1}.tp-p2dv .tp-popv{left:calc(-1*var(--cnt-hp));right:calc(-1*var(--cnt-hp));top:var(--cnt-usz)}.tp-p2dpv{padding-left:calc(var(--cnt-usz) + 4px)}.tp-p2dpv_p{cursor:crosshair;height:0;overflow:hidden;padding-bottom:100%;position:relative}.tp-p2dpv.tp-v-disabled .tp-p2dpv_p{opacity:.5}.tp-p2dpv_g{display:block;height:100%;left:0;pointer-events:none;position:absolute;top:0;width:100%}.tp-p2dpv_ax{opacity:.1;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_l{opacity:.5;stroke:var(--in-fg);stroke-dasharray:1}.tp-p2dpv_m{border:var(--in-fg) solid 1px;border-radius:50%;box-sizing:border-box;height:4px;margin-left:-2px;margin-top:-2px;position:absolute;width:4px}.tp-p2dpv_p:focus .tp-p2dpv_m{background-color:var(--in-fg);border-width:0}.tp-popv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);display:none;max-width:var(--bld-vw);padding:var(--cnt-vp) var(--cnt-hp);position:absolute;visibility:hidden;z-index:1000}.tp-popv.tp-popv-v{display:block;visibility:visible}.tp-sldv.tp-v-disabled{opacity:.5}.tp-sldv_t{box-sizing:border-box;cursor:pointer;height:var(--cnt-usz);margin:0 6px;outline:none;position:relative}.tp-sldv_t::before{background-color:var(--in-bg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin:auto;position:absolute;right:0;top:0}.tp-sldv_k{height:100%;left:0;position:absolute;top:0}.tp-sldv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";display:block;height:2px;left:0;margin-bottom:auto;margin-top:auto;position:absolute;right:0;top:0}.tp-sldv_k::after{background-color:var(--btn-bg);border-radius:var(--bld-br);bottom:0;content:"";display:block;height:12px;margin-bottom:auto;margin-top:auto;position:absolute;right:-6px;top:0;width:12px}.tp-sldv_t:hover .tp-sldv_k::after{background-color:var(--btn-bg-h)}.tp-sldv_t:focus .tp-sldv_k::after{background-color:var(--btn-bg-f)}.tp-sldv_t:active .tp-sldv_k::after{background-color:var(--btn-bg-a)}.tp-sldtxtv{display:flex}.tp-sldtxtv_s{flex:2}.tp-sldtxtv_t{flex:1;margin-left:4px}.tp-tabv{position:relative}.tp-tabv_t{align-items:flex-end;color:var(--cnt-bg);display:flex;overflow:hidden;position:relative}.tp-tabv_t:hover{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus){color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active){color:var(--cnt-bg-a)}.tp-tabv_t::before{background-color:currentColor;bottom:0;content:"";height:2px;left:0;pointer-events:none;position:absolute;right:0}.tp-tabv.tp-v-disabled .tp-tabv_t::before{opacity:.5}.tp-tabv.tp-tabv-nop .tp-tabv_t{height:calc(var(--cnt-usz) + 4px);position:relative}.tp-tabv.tp-tabv-nop .tp-tabv_t::before{background-color:var(--cnt-bg);bottom:0;content:"";height:2px;left:0;position:absolute;right:0}.tp-tabv_i{bottom:0;color:var(--cnt-bg);left:0;overflow:hidden;position:absolute;top:calc(var(--cnt-usz) + 4px);width:max(var(--bs-br),4px)}.tp-tabv_i::before{background-color:currentColor;bottom:0;content:"";left:0;position:absolute;top:0;width:4px}.tp-tabv_t:hover+.tp-tabv_i{color:var(--cnt-bg-h)}.tp-tabv_t:has(*:focus)+.tp-tabv_i{color:var(--cnt-bg-f)}.tp-tabv_t:has(*:active)+.tp-tabv_i{color:var(--cnt-bg-a)}.tp-tabv.tp-v-disabled>.tp-tabv_i{opacity:.5}.tp-tbiv{flex:1;min-width:0;position:relative}.tp-tbiv+.tp-tbiv{margin-left:2px}.tp-tbiv+.tp-tbiv.tp-v-disabled::before{opacity:.5}.tp-tbiv_b{display:block;padding-left:calc(var(--cnt-hp) + 4px);padding-right:calc(var(--cnt-hp) + 4px);position:relative;width:100%}.tp-tbiv_b:disabled{opacity:.5}.tp-tbiv_b::before{background-color:var(--cnt-bg);bottom:2px;content:"";left:0;pointer-events:none;position:absolute;right:0;top:0}.tp-tbiv_b:hover::before{background-color:var(--cnt-bg-h)}.tp-tbiv_b:focus::before{background-color:var(--cnt-bg-f)}.tp-tbiv_b:active::before{background-color:var(--cnt-bg-a)}.tp-tbiv_t{color:var(--cnt-fg);height:calc(var(--cnt-usz) + 4px);line-height:calc(var(--cnt-usz) + 4px);opacity:.5;overflow:hidden;position:relative;text-overflow:ellipsis}.tp-tbiv.tp-tbiv-sel .tp-tbiv_t{opacity:1}.tp-tbpv_c{padding-bottom:var(--cnt-vp);padding-left:4px;padding-top:var(--cnt-vp)}.tp-txtv{position:relative}.tp-txtv_i{padding-left:var(--bld-hp);padding-right:var(--bld-hp)}.tp-txtv.tp-txtv-fst .tp-txtv_i{border-bottom-right-radius:0;border-top-right-radius:0}.tp-txtv.tp-txtv-mid .tp-txtv_i{border-radius:0}.tp-txtv.tp-txtv-lst .tp-txtv_i{border-bottom-left-radius:0;border-top-left-radius:0}.tp-txtv.tp-txtv-num .tp-txtv_i{text-align:right}.tp-txtv.tp-txtv-drg .tp-txtv_i{opacity:.3}.tp-txtv_k{cursor:pointer;height:100%;left:calc(var(--bld-hp) - 5px);position:absolute;top:0;width:12px}.tp-txtv_k::before{background-color:var(--in-fg);border-radius:1px;bottom:0;content:"";height:calc(var(--cnt-usz) - 4px);left:50%;margin-bottom:auto;margin-left:-1px;margin-top:auto;opacity:.1;position:absolute;top:0;transition:border-radius .1s,height .1s,transform .1s,width .1s;width:2px}.tp-txtv_k:hover::before,.tp-txtv.tp-txtv-drg .tp-txtv_k::before{opacity:1}.tp-txtv.tp-txtv-drg .tp-txtv_k::before{border-radius:50%;height:4px;transform:translateX(-1px);width:4px}.tp-txtv_g{bottom:0;display:block;height:8px;left:50%;margin:auto;overflow:visible;pointer-events:none;position:absolute;top:0;visibility:hidden;width:100%}.tp-txtv.tp-txtv-drg .tp-txtv_g{visibility:visible}.tp-txtv_gb{fill:none;stroke:var(--in-fg);stroke-dasharray:1}.tp-txtv_gh{fill:none;stroke:var(--in-fg)}.tp-txtv .tp-ttv{margin-left:6px;visibility:hidden}.tp-txtv.tp-txtv-drg .tp-ttv{visibility:visible}.tp-ttv{background-color:var(--in-fg);border-radius:var(--bld-br);color:var(--bs-bg);padding:2px 4px;pointer-events:none;position:absolute;transform:translate(-50%, -100%)}.tp-ttv::before{border-color:var(--in-fg) rgba(0,0,0,0) rgba(0,0,0,0) rgba(0,0,0,0);border-style:solid;border-width:2px;box-sizing:border-box;content:"";font-size:.9em;height:4px;left:50%;margin-left:-2px;position:absolute;top:100%;width:4px}.tp-rotv{background-color:var(--bs-bg);border-radius:var(--bs-br);box-shadow:0 2px 4px var(--bs-sh);font-family:var(--bs-ff);font-size:11px;font-weight:500;line-height:1;text-align:left}.tp-rotv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br);border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br);padding-left:calc(4px + var(--cnt-usz) + var(--cnt-hp));text-align:center}.tp-rotv.tp-rotv-expanded .tp-rotv_b{border-bottom-left-radius:0;border-bottom-right-radius:0;transition-delay:0s;transition-duration:0s}.tp-rotv.tp-rotv-not>.tp-rotv_b{display:none}.tp-rotv_b:disabled .tp-rotv_m{display:none}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst>.tp-fldv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-fldv.tp-v-lst.tp-fldv-expanded>.tp-fldv_b{transition-delay:0s;transition-duration:0s}.tp-rotv_c .tp-fldv.tp-v-vlst:not(.tp-fldv-expanded)>.tp-fldv_b{border-bottom-right-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-fldv.tp-v-fst>.tp-fldv_b{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_c{border-bottom-left-radius:var(--bs-br);border-bottom-right-radius:var(--bs-br)}.tp-rotv_c>.tp-tabv.tp-v-lst>.tp-tabv_i{border-bottom-left-radius:var(--bs-br)}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst{margin-top:calc(-1*var(--cnt-vp))}.tp-rotv.tp-rotv-not .tp-rotv_c>.tp-tabv.tp-v-fst>.tp-tabv_t{border-top-left-radius:var(--bs-br);border-top-right-radius:var(--bs-br)}.tp-rotv.tp-v-disabled,.tp-rotv .tp-v-disabled{pointer-events:none}.tp-rotv.tp-v-hidden,.tp-rotv .tp-v-hidden{display:none}.tp-sprv_r{background-color:var(--grv-fg);border-width:0;display:block;height:2px;margin:0;width:100%}.tp-sprv.tp-v-disabled .tp-sprv_r{opacity:.5}',plugins:[w5,C5,P5,BV,y5]})}};new DV("4.0.3");function V5(n){let e,t;return e=new ba({props:{keysAdd:["containerVerticalPadding","containerUnitSize"],theme:n[2]}}),{c(){fe(e.$$.fragment)},l(i){we(e.$$.fragment,i)},m(i,s){_e(e,i,s),t=!0},p(i,s){const r={};s&4&&(r.theme=i[2]),e.$set(r)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function k5(n){return{c:Xe,l:Xe,m:Xe,p:Xe,i:Xe,o:Xe,d:Xe}}function S5(n){let e,t,i,s;const r=[M5,A5],o=[];function l(h,c){return h[1]===void 0?0:1}e=l(n),t=o[e]=r[e](n);const a=n[11].default,u=mn(a,n,n[10],null);return{c(){t.c(),i=wi(),u&&u.c()},l(h){t.l(h),i=_i(h),u&&u.l(h)},m(h,c){o[e].m(h,c),k(h,i,c),u&&u.m(h,c),s=!0},p(h,c){let d=e;e=l(h),e===d?o[e].p(h,c):(Bi(),y(o[d],1,1,()=>{o[d]=null}),Ii(),t=o[e],t?t.p(h,c):(t=o[e]=r[e](h),t.c()),b(t,1),t.m(i.parentNode,i)),u&&u.p&&(!s||c&1024)&&vn(u,a,h,h[10],s?wn(a,h[10],c,null):fn(h[10]),null)},i(h){s||(b(t),b(u,h),s=!0)},o(h){y(t),y(u,h),s=!1},d(h){h&&P(i),o[e].d(h),u&&u.d(h)}}}function L5(n){let e;const t=n[11].default,i=mn(t,n,n[10],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&1024)&&vn(i,t,s,s[10],e?wn(t,s[10],r,null):fn(s[10]),null)},i(s){e||(b(i,s),e=!0)},o(s){y(i,s),e=!1},d(s){i&&i.d(s)}}}function A5(n){let e,t;return e=new ba({props:{keysAdd:["containerVerticalPadding","containerVerticalPadding","containerVerticalPadding","containerUnitSize"],theme:n[2]}}),{c(){fe(e.$$.fragment)},l(i){we(e.$$.fragment,i)},m(i,s){_e(e,i,s),t=!0},p(i,s){const r={};s&4&&(r.theme=i[2]),e.$set(r)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function M5(n){let e,t;return e=new ba({props:{keysAdd:["containerVerticalPadding"],theme:n[2]}}),{c(){fe(e.$$.fragment)},l(i){we(e.$$.fragment,i)},m(i,s){_e(e,i,s),t=!0},p(i,s){const r={};s&4&&(r.theme=i[2]),e.$set(r)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function T5(n){let e,t,i,s;const r=[L5,S5,k5,V5],o=[];function l(a,u){return 0}return e=l(),t=o[e]=r[e](n),{c(){t.c(),i=D()},l(a){t.l(a),i=D()},m(a,u){o[e].m(a,u),k(a,i,u),s=!0},p(a,[u]){let h=e;e=l(),e===h?o[e].p(a,u):(Bi(),y(o[h],1,1,()=>{o[h]=null}),Ii(),t=o[e],t?t.p(a,u):(t=o[e]=r[e](a),t.c()),b(t,1),t.m(i.parentNode,i))},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&P(i),o[e].d(a)}}}function D5(n,e,t){let i,s,{$$slots:r={},$$scope:o}=e,{title:l=void 0}=e,{userExpandable:a=!0}=e,{expanded:u=!0}=e,{theme:h=void 0}=e,{scale:c=1}=e,{userCreatedPane:d=!0}=e,{tpPane:p=void 0}=e;const v=ci();In(n,v,C=>t(12,i=C));const m=ao("parentStore");In(n,m,C=>t(13,s=C));let f=[];$u("registerPlugin",C=>{p===void 0?console.warn(`tpPane is undefined, failed to register plugin "${C.id}"`):f.includes(C.id)||(p==null||p.registerPlugin(C),f.push(C.id))}),$u("userCreatedPane",d),s!==void 0&&console.warn("<Panes> must not be nested");let g=u;Rf(v,i=new $5({expanded:u,title:l}),i),i.on("fold",()=>{t(9,g=i.expanded)}),p=i,$u("parentStore",v),kp(()=>{i.dispose()});function L(C){if(p)if(C===1)p.element.style.removeProperty("transform-origin"),p.element.style.removeProperty("transform"),p.element.style.removeProperty("width");else{const qe=Math.max(0,C);t(5,p.element.style.transformOrigin="0 0",p),t(5,p.element.style.transform=`scale(${qe})`,p),t(5,p.element.style.width=`${100/qe}%`,p)}}function ye(){p&&p.expanded!==g&&t(5,p.expanded=g,p),t(0,u=g)}return n.$$set=C=>{"title"in C&&t(1,l=C.title),"userExpandable"in C&&t(6,a=C.userExpandable),"expanded"in C&&t(0,u=C.expanded),"theme"in C&&t(2,h=C.theme),"scale"in C&&t(7,c=C.scale),"userCreatedPane"in C&&t(8,d=C.userCreatedPane),"tpPane"in C&&t(5,p=C.tpPane),"$$scope"in C&&t(10,o=C.$$scope)},n.$$.update=()=>{n.$$.dirty&34&&p&&l&&t(5,p.title=l,p),n.$$.dirty&32&&p!=null&&p.element&&(p==null||p.element.classList.add("svelte-tweakpane-ui")),n.$$.dirty&160&&p&&L(c),n.$$.dirty&96&&p&&pV(a,p.element,"tp-rotv_b","tp-rotv_m"),n.$$.dirty&36&&p&&Jj(p.element,h),n.$$.dirty&33&&p&&t(9,g=u),n.$$.dirty&545&&p&&u!==void 0&&ye()},[u,l,h,v,m,p,a,c,d,g,o,r]}class Fw extends Lt{constructor(e){super(),At(this,e,D5,T5,St,{title:1,userExpandable:6,expanded:0,theme:2,scale:7,userCreatedPane:8,tpPane:5})}}function O5(n){let e;const t=n[6].default,i=mn(t,n,n[10],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&1024)&&vn(i,t,s,s[10],e?wn(t,s[10],r,null):fn(s[10]),null)},i(s){e||(b(i,s),e=!0)},o(s){y(i,s),e=!1},d(s){i&&i.d(s)}}}function R5(n){let e,t,i,s,r;const o=[{theme:n[3]},Rr(n[5],"position")];function l(h){n[7](h)}function a(h){n[8](h)}let u={$$slots:{default:[O5]},$$scope:{ctx:n}};for(let h=0;h<o.length;h+=1)u=wt(u,o[h]);return n[0]!==void 0&&(u.expanded=n[0]),n[1]!==void 0&&(u.tpPane=n[1]),t=new Fw({props:u}),R.push(()=>xe(t,"expanded",l)),R.push(()=>xe(t,"tpPane",a)),{c(){e=Ue("div"),fe(t.$$.fragment),this.h()},l(h){e=He(h,"DIV",{});var c=ke(e);we(t.$$.fragment,c),c.forEach(P),this.h()},h(){Ye(e,"width",n[2]===void 0?null:`${n[2]}px`)},m(h,c){k(h,e,c),_e(t,e,null),n[9](e),r=!0},p(h,[c]){const d=c&40?Bo(o,[c&8&&{theme:h[3]},c&32&&va(Rr(h[5],"position"))]):{};c&1024&&(d.$$scope={dirty:c,ctx:h}),!i&&c&1&&(i=!0,d.expanded=h[0],Ee(()=>i=!1)),!s&&c&2&&(s=!0,d.tpPane=h[1],Ee(()=>s=!1)),t.$set(d),c&4&&Ye(e,"width",h[2]===void 0?null:`${h[2]}px`)},i(h){r||(b(t.$$.fragment,h),r=!0)},o(h){y(t.$$.fragment,h),r=!1},d(h){h&&P(e),be(t),n[9](null)}}}function j5(n,e,t){const i=["expanded","width","tpPane","theme"];let s=bi(e,i),{$$slots:r={},$$scope:o}=e,{expanded:l=void 0}=e,{width:a=void 0}=e,{tpPane:u=void 0}=e,{theme:h={baseBorderRadius:"0px",baseShadowColor:"hsla(0, 0%, 0%, 0)"}}=e,c;fh(()=>{if(u){const m=u.element.parentElement;c.append(u.element),m==null||m.remove()}else console.warn("tpPane is undefined")});function d(m){l=m,t(0,l)}function p(m){u=m,t(1,u)}function v(m){R[m?"unshift":"push"](()=>{c=m,t(4,c)})}return n.$$set=m=>{e=wt(wt({},e),Wl(m)),t(5,s=bi(e,i)),"expanded"in m&&t(0,l=m.expanded),"width"in m&&t(2,a=m.width),"tpPane"in m&&t(1,u=m.tpPane),"theme"in m&&t(3,h=m.theme),"$$scope"in m&&t(10,o=m.$$scope)},[l,u,a,h,c,s,r,d,p,v,o]}class Kw extends Lt{constructor(e){super(),At(this,e,j5,R5,St,{expanded:0,width:2,tpPane:1,theme:3})}}function Le(n){return n==null}function Uw(n){return n!==null&&typeof n=="object"}function Kv(n){return n!==null&&typeof n=="object"}function N5(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function wo(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((i,s)=>{const r=n[s],o=e[s];return Kv(r)&&Kv(o)?Object.assign(Object.assign({},i),{[s]:wo(r,o)}):Object.assign(Object.assign({},i),{[s]:s in e?o:r})},{})}function B5(n){return Uw(n)?"target"in n:!1}const I5={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};let As=class $l{static alreadyDisposed(){return new $l({type:"alreadydisposed"})}static notBindable(){return new $l({type:"notbindable"})}static notCompatible(e,t){return new $l({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new $l({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new $l({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=I5[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}},J0=class bk{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const i=this.read();if(!bk.isBindable(i))throw As.notBindable();if(!(e in i))throw As.propertyNotFound(e);i[e]=t}},Tt=class{constructor(){this.observers_={}}on(e,t){let i=this.observers_[e];return i||(i=this.observers_[e]=[]),i.push({handler:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter(s=>s.handler!==t)),this}emit(e,t){const i=this.observers_[e];i&&i.forEach(s=>{s.handler(t)})}},F5=class{constructor(e,t){var i;this.constraint_=t==null?void 0:t.constraint,this.equals_=(i=t==null?void 0:t.equals)!==null&&i!==void 0?i:(s,r)=>s===r,this.emitter=new Tt,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,r=this.rawValue_;this.equals_(r,s)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:i,previousRawValue:r,rawValue:s,sender:this}))}},K5=class{constructor(e){this.emitter=new Tt,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.value_;s===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:this.value_,sender:this}))}},U5=class{constructor(e){this.emitter=new Tt,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}};function Ie(n,e){const t=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!t&&!i?new K5(n):new F5(n,e)}function H5(n){return[new U5(n),(e,t)=>{n.setRawValue(e,t)}]}let A=class gk{constructor(e){this.emitter=new Tt,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((i,s)=>Object.assign(i,{[s]:Ie(e[s])}),{})}static fromObject(e){const t=this.createCore(e);return new gk(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}},Lh=class{constructor(e){this.values=A.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(e,i),t)}},Hw=class{constructor(e){this.values=A.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");let s=e;return Le(i)||(s=Math.max(s,i)),Le(t)||(s=Math.min(s,t)),s}},z5=class{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,i=Math.round((e-t)/this.step);return t+i*this.step}},q5=class{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}};const G5={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};let Y5=class{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=G5[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}};const X5={"+":n=>n,"-":n=>-n,"~":n=>~n};let W5=class{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=X5[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}};function zw(n){return(e,t)=>{for(let i=0;i<n.length;i++){const s=n[i](e,t);if(s!=="")return s}return""}}function Fu(n,e){var t;const i=n.substr(e).match(/^\s+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Z5(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function Ku(n,e){var t;const i=n.substr(e).match(/^[0-9]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Q5(n,e){const t=Ku(n,e);if(t!=="")return t;const i=n.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";const s=Ku(n,e);return s===""?"":i+s}function qw(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const i=Q5(n,e);return i===""?"":t+i}function Ck(n,e){const t=n.substr(e,1);if(t==="0")return t;const i=Z5(n,e);return e+=i.length,i===""?"":i+Ku(n,e)}function J5(n,e){const t=Ck(n,e);if(e+=t.length,t==="")return"";const i=n.substr(e,1);if(e+=i.length,i!==".")return"";const s=Ku(n,e);return e+=s.length,t+i+s+qw(n,e)}function e3(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const i=Ku(n,e);return e+=i.length,i===""?"":t+i+qw(n,e)}function t3(n,e){const t=Ck(n,e);return e+=t.length,t===""?"":t+qw(n,e)}const n3=zw([J5,e3,t3]);function i3(n,e){var t;const i=n.substr(e).match(/^[01]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function s3(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const i=i3(n,e);return i===""?"":t+i}function r3(n,e){var t;const i=n.substr(e).match(/^[0-7]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function o3(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const i=r3(n,e);return i===""?"":t+i}function l3(n,e){var t;const i=n.substr(e).match(/^[0-9a-f]+/i);return(t=i&&i[0])!==null&&t!==void 0?t:""}function a3(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const i=l3(n,e);return i===""?"":t+i}const u3=zw([s3,o3,a3]),h3=zw([u3,n3]);function c3(n,e){const t=h3(n,e);return e+=t.length,t===""?null:{evaluable:new q5(t),cursor:e}}function p3(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const i=yk(n,e);if(!i)return null;e=i.cursor,e+=Fu(n,e).length;const s=n.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:i.evaluable,cursor:e}}function d3(n,e){var t;return(t=c3(n,e))!==null&&t!==void 0?t:p3(n,e)}function Pk(n,e){const t=d3(n,e);if(t)return t;const i=n.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const s=Pk(n,e);return s?(e=s.cursor,{cursor:e,evaluable:new W5(i,s.evaluable)}):null}function m3(n,e,t){t+=Fu(e,t).length;const i=n.filter(s=>e.startsWith(s,t))[0];return i?(t+=i.length,t+=Fu(e,t).length,{cursor:t,operator:i}):null}function v3(n,e){return(t,i)=>{const s=n(t,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const o=m3(e,t,i);if(!o)break;i=o.cursor;const l=n(t,i);if(!l)return null;i=l.cursor,r=new Y5(o.operator,r,l.evaluable)}return r?{cursor:i,evaluable:r}:null}}const f3=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>v3(n,e),Pk);function yk(n,e){return e+=Fu(n,e).length,f3(n,e)}function w3(n){const e=yk(n,0);return!e||e.cursor+Fu(n,e.cursor).length!==n.length?null:e.evaluable}function ri(n){var e;const t=w3(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function Gw(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=ri(n);if(!Le(e))return e}return 0}function _t(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function S(n,e,t,i,s){const r=(n-e)/(t-e);return i+r*(s-i)}function eP(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function Te(n,e,t){return Math.min(Math.max(n,e),t)}function Ek(n,e){return(n%e+e)%e}function _3(n,e){return Le(n.step)?Math.max(eP(e),2):eP(n.step)}function xk(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function b3(n,e){var t;const i=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function Yw(n,e){return Le(n.step)?null:new z5(n.step,e)}function Xw(n){return!Le(n.max)&&!Le(n.min)?new Lh({max:n.max,min:n.min}):!Le(n.max)||!Le(n.min)?new Hw({max:n.max,min:n.min}):null}function Ww(n,e){var t,i,s;return{formatter:(t=n.format)!==null&&t!==void 0?t:_t(_3(n,e)),keyScale:(i=n.keyScale)!==null&&i!==void 0?i:xk(n),pointerScale:(s=n.pointerScale)!==null&&s!==void 0?s:b3(n,e)}}function Zw(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function Qw(n){return{constraint:n.constraint,textProps:A.fromObject(Ww(n.params,n.initialValue))}}let Ho=class{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}},zo=class{constructor(e){this.target=e}},Ip=class extends zo{constructor(e,t,i){super(e),this.value=t,this.last=i??!0}},g3=class extends zo{constructor(e,t){super(e),this.expanded=t}},C3=class extends zo{constructor(e,t){super(e),this.index=t}},Jw=class extends Ho{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Tt,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new Ip(this,t.binding.target.read(),e.options.last))}};function P3(n,e){const i=Object.keys(e).reduce((s,r)=>{if(s===void 0)return;const o=e[r],l=o(n[r]);return l.succeeded?Object.assign(Object.assign({},s),{[r]:l.value}):void 0},{});return i}function y3(n,e){return n.reduce((t,i)=>{if(t===void 0)return;const s=e(i);if(!(!s.succeeded||s.value===void 0))return[...t,s.value]},[])}function E3(n){return n===null?!1:typeof n=="object"}function ss(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const i=n(t);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function tP(n){return{custom:e=>ss(e)(n),boolean:ss(e=>typeof e=="boolean"?e:void 0)(n),number:ss(e=>typeof e=="number"?e:void 0)(n),string:ss(e=>typeof e=="string"?e:void 0)(n),function:ss(e=>typeof e=="function"?e:void 0)(n),constant:e=>ss(t=>t===e?e:void 0)(n),raw:ss(e=>e)(n),object:e=>ss(t=>{if(E3(t))return P3(t,e)})(n),array:e=>ss(t=>{if(Array.isArray(t))return y3(t,e)})(n)}}const Uv={optional:tP(!0),required:tP(!1)};function Fe(n,e){const t=e(Uv),i=Uv.required.object(t)(n);return i.succeeded?i.value:void 0}function ai(n,e,t,i){if(e&&!e(n))return!1;const s=Fe(n,t);return s?i(s):!1}function ui(n,e){var t;return wo((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function kc(n){return"value"in n}function x3(n){if(!Uw(n)||!("binding"in n))return!1;const e=n.binding;return B5(e)}const lt="http://www.w3.org/2000/svg";function sp(n){n.offsetHeight}function $3(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function Fp(n){return n.ontouchstart!==void 0}function V3(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const k3={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Kp(n,e){const t=n.createElementNS(lt,"svg");return t.innerHTML=k3[e],t}function $k(n,e,t){n.insertBefore(e,n.children[t])}function e_(n){n.parentElement&&n.parentElement.removeChild(n)}function Vk(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function S3(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function t_(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function Qn(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function ei(n,e,t){Qn(n.value(e),t)}const L3="tp";function M(n){return(t,i)=>[L3,"-",n,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}const Xa=M("lbl");function A3(n,e){const t=n.createDocumentFragment();return e.split(`
`).map(s=>n.createTextNode(s)).forEach((s,r)=>{r>0&&t.appendChild(n.createElement("br")),t.appendChild(s)}),t}let kk=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Xa()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Xa("l")),ei(t.props,"label",r=>{Le(r)?this.element.classList.add(Xa(void 0,"nol")):(this.element.classList.remove(Xa(void 0,"nol")),S3(i),i.appendChild(A3(e,r)))}),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("div");s.classList.add(Xa("v")),this.element.appendChild(s),this.valueElement=s}},Up=class{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new kk(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return ai(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return ui(null,{label:this.props.get("label")})}};function M3(){return["veryfirst","first","last","verylast"]}const nP=M(""),iP={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};let Ah=class{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{M3().forEach(i=>{t.classList.remove(nP(void 0,iP[i]))}),this.blade.get("positions").forEach(i=>{t.classList.add(nP(void 0,iP[i]))})}),this.viewProps.handleDispose(()=>{e_(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return ai(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return ui(null,Object.assign({},this.viewProps.exportState()))}};class rp extends Ah{constructor(e,t){if(t.value!==t.valueController.value)throw As.shouldNeverHappen();const i=t.valueController.viewProps,s=new Up(e,{blade:t.blade,props:t.props,valueController:t.valueController});super(Object.assign(Object.assign({},t),{view:new kk(e,{props:t.props,viewProps:i}),viewProps:i})),this.labelController=s,this.value=t.value,this.valueController=t.valueController,this.view.valueElement.appendChild(this.valueController.view.element)}importState(e){return ai(e,t=>{var i,s,r;return super.importState(t)&&this.labelController.importProps(t)&&((r=(s=(i=this.valueController).importProps)===null||s===void 0?void 0:s.call(i,e))!==null&&r!==void 0?r:!0)},t=>({value:t.optional.raw}),t=>(t.value&&(this.value.rawValue=t.value),!0))}exportState(){var e,t,i;return ui(()=>super.exportState(),Object.assign(Object.assign({value:this.value.rawValue},this.labelController.exportProps()),(i=(t=(e=this.valueController).exportProps)===null||t===void 0?void 0:t.call(e))!==null&&i!==void 0?i:{}))}}function Sk(n,e){for(;n.length<e;)n.push(void 0)}function T3(n){const e=[];return Sk(e,n),e}function D3(n){const e=n.indexOf(void 0);return e<0?n:n.slice(0,e)}function O3(n,e){const t=[...D3(n),e];return t.length>n.length?t.splice(0,t.length-n.length):Sk(t,n.length),t}let R3=class extends Ho{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const i=t.bind(this);return this.controller.buttonController.emitter.on(e,()=>{i(new zo(this))}),this}};function j3(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function Ur(n,e){return t=>{j3(n,e,t)}}function n_(n,e){Qn(n,t=>{e.textContent=t??""})}const mm=M("btn");let N3=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(mm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(mm("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(mm("t")),n_(t.props.value("title"),s),this.buttonElement.appendChild(s)}},Lk=class{constructor(e,t){this.emitter=new Tt,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new N3(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return ai(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return ui(null,{title:this.props.get("title")})}onClick_(){this.emitter.emit("click",{sender:this})}},sP=class extends Ah{constructor(e,t){const i=new Lk(e,{props:t.buttonProps,viewProps:t.viewProps}),s=new Up(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:t.viewProps}),this.buttonController=i,this.labelController=s}importState(e){return ai(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return ui(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}},B3=class{constructor(e){const[t,i]=e.split("-"),s=t.split(".");this.major=parseInt(s[0],10),this.minor=parseInt(s[1],10),this.patch=parseInt(s[2],10),this.prerelease=i??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}};const I3=new B3("2.0.0-beta.2");function ze(n){return Object.assign({core:I3},n)}ze({id:"button",type:"blade",accept(n){const e=Fe(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new sP(n.document,{blade:n.blade,buttonProps:A.fromObject({title:n.params.title}),labelProps:A.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof sP?new R3(n.controller):null}});function F3(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function K3(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function U3(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function H3(n){return Uw(n)?"refresh"in n&&typeof n.refresh=="function":!1}function z3(n,e){if(!J0.isBindable(n))throw As.notBindable();return new J0(n,e)}let q3=class{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new Tt,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,i){const s=i??{},r=this.controller_.element.ownerDocument,o=this.pool_.createBinding(r,z3(e,t),s),l=this.pool_.createBindingApi(o);return this.add(l,s.index)}addFolder(e){return K3(this,e)}addButton(e){return F3(this,e)}addTab(e){return U3(this,e)}add(e,t){const i=e.controller;return this.controller_.rack.add(i,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,i=this.pool_.createBlade(t,e),s=this.pool_.createApi(i);return this.add(s,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.children.forEach(e=>{H3(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,i=this.pool_.createApi(t),s=x3(t.value)?t.value.binding:null;this.emitter_.emit("change",new Ip(i,s?s.target.read():t.value.rawValue,e.options.last))}},i_=class extends Ho{constructor(e,t){super(e),this.rackApi_=new q3(e.rackController,t)}},s_=class extends Ah{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return ai(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((i,s)=>i.importState(t.children[s])))}exportState(){return ui(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}};function Hv(n){return"rackController"in n}let G3=class{constructor(e){this.emitter=new Tt,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw As.shouldNeverHappen();const i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(r=>{this.cache_.add(r)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.allItems().forEach(s=>{this.cache_.delete(s)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}};function Y3(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(kc(i)&&i.value===e)return i}return null}function X3(n){return Hv(n)?n.rackController.rack.bcSet_:null}let W3=class{constructor(e){var t,i;this.emitter=new Tt,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new G3(X3),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var i;(i=e.parent)===null||i===void 0||i.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),kc(i))i.value.emitter.on("change",this.onChildValueChange_);else if(Hv(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.on("layout",this.onRackLayout_),r.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const i=e.item;if(kc(i))i.value.emitter.off("change",this.onChildValueChange_);else if(Hv(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.off("layout",this.onRackLayout_),r.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(s=>!s.viewProps.get("hidden")),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach(s=>{const r=[];s===t&&(r.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&r.push("veryfirst")),s===i&&(r.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&r.push("verylast")),s.blade.set("positions",r)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=Y3(this.find(kc),e.sender);if(!t)throw As.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}},r_=class{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new W3({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let i=this.rack.children.length-1;i>=0;i--)this.rack.children[i].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&$k(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&e_(e.bladeController.view.element)}};function Ak(){return new A({positions:Ie([],{equals:N5})})}let Hp=class Mk extends A{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=A.createCore(t);return new Mk(i)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!Le(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const i=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};ei(this,"expanded",i),ei(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}};function Z3(n,e){let t=0;return $3(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),sp(e),t=e.clientHeight,n.set("temporaryExpanded",null),sp(e)}),t}function rP(n,e){e.style.height=n.styleHeight}function zp(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),Le(n.get("expandedHeight"))){const t=Z3(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),sp(e)}),n.emitter.on("change",()=>{rP(n,e)}),rP(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}let Q3=class extends i_{constructor(e,t){super(e,t),this.emitter_=new Tt,this.controller.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",new g3(this,i.sender.rawValue))}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.rackApi_.refresh()}};const Tk=M("cnt");let J3=class{constructor(e,t){var i;this.className_=M((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),Tk()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),ei(this.foldable_,"completed",Ur(this.element,this.className_(void 0,"cpl")));const s=e.createElement("button");s.classList.add(this.className_("b")),ei(t.props,"title",u=>{Le(u)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const r=e.createElement("div");r.classList.add(this.className_("i")),this.element.appendChild(r);const o=e.createElement("div");o.classList.add(this.className_("t")),n_(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}},oP=class extends s_{constructor(e,t){var i;const s=Hp.create((i=t.expanded)!==null&&i!==void 0?i:!0),r=new J3(e,{foldable:s,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new r_({blade:t.blade,element:r.containerElement,root:t.root,viewProps:t.viewProps}),view:r})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=s,zp(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return ai(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return ui(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}};ze({id:"folder",type:"blade",accept(n){const e=Fe(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new oP(n.document,{blade:n.blade,expanded:n.params.expanded,props:A.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof oP?new Q3(n.controller,n.pool):null}});const eK=M("");function lP(n,e){return Ur(n,eK(void 0,e))}let _o=class Dk extends A{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=H5(Ie(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,i,s;const r=e??{};return new Dk(A.createCore({disabled:(t=r.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(i=r.hidden)!==null&&i!==void 0?i:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){Qn(this.globalDisabled_,lP(e,"disabled")),ei(this,"hidden",lP(e,"hidden"))}bindDisabled(e){Qn(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){Qn(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const i=e.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}};const aP=M("tbp");let tK=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(aP()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(aP("c")),this.element.appendChild(i),this.containerElement=i}};const Wa=M("tbi");let nK=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Wa()),t.viewProps.bindClassModifiers(this.element),ei(t.props,"selected",r=>{r?this.element.classList.add(Wa(void 0,"sel")):this.element.classList.remove(Wa(void 0,"sel"))});const i=e.createElement("button");i.classList.add(Wa("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(Wa("t")),n_(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}},iK=class{constructor(e,t){this.emitter=new Tt,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new nK(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}},zv=class extends s_{constructor(e,t){const i=new tK(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new r_({blade:t.blade,element:i.containerElement,viewProps:t.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new iK(e,{props:t.itemProps,viewProps:_o.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,ei(this.props,"selected",s=>{this.itemController.props.set("selected",s),this.viewProps.set("hidden",!s)})}get itemController(){return this.ic_}importState(e){return ai(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return ui(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}},sK=class extends i_{constructor(e,t){super(e,t),this.emitter_=new Tt,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,i=new zv(t,{blade:Ak(),itemProps:A.fromObject({selected:!1,title:e.title}),props:A.fromObject({selected:!1}),viewProps:_o.create()}),s=this.pool_.createApi(i);return this.rackApi_.add(s,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}onSelect_(e){this.emitter_.emit("select",new C3(this,e.rawValue))}},rK=class extends i_{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}refresh(){this.rackApi_.refresh()}};const uP=-1;let oK=class{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=Ie(!0),this.selectedIndex=Ie(uP),this.items_=[]}add(e,t){const i=t??this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=uP,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,i)=>{t.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,i)=>{t.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(i=>i===e.sender);this.items_.forEach((i,s)=>{i.rawValue=s===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}};const Za=M("tab");let lK=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Za(),Tk()),t.viewProps.bindClassModifiers(this.element),Qn(t.empty,Ur(this.element,Za(void 0,"nop")));const i=e.createElement("div");i.classList.add(Za("t")),this.element.appendChild(i),this.itemsElement=i;const s=e.createElement("div");s.classList.add(Za("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(Za("c")),this.element.appendChild(r),this.contentsElement=r}},hP=class extends s_{constructor(e,t){const i=new oK,s=new lK(e,{empty:i.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new r_({blade:t.blade,element:s.contentsElement,viewProps:t.viewProps}),view:s}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=this.rackController.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.tab=i}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;$k(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;e_(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}};ze({id:"tab",type:"blade",accept(n){const e=Fe(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new hP(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const i=new zv(n.document,{blade:Ak(),itemProps:A.fromObject({selected:!1,title:t.title}),props:A.fromObject({selected:!1}),viewProps:_o.create()});e.add(i)}),e},api(n){return n.controller instanceof hP?new sK(n.controller,n.pool):n.controller instanceof zv?new rK(n.controller,n.pool):null}});let o_=class extends Jw{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}},aK=class{constructor(){this.disabled=!1,this.emitter=new Tt}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}},uK=class{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new Tt,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}},Ea=class{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,i)=>i.constrain(t),e)}};function Uu(n,e){if(n instanceof e)return n;if(n instanceof Ea){const t=n.constraints.reduce((i,s)=>i||(s instanceof e?s:null),null);if(t)return t}return null}let qp=class{constructor(e){this.values=A.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(s=>s.value===e).length>0?e:t[0].value}};function Gp(n){var e;const t=Uv;if(Array.isArray(n))return(e=Fe({items:n},i=>({items:i.required.array(i.required.object({text:i.required.string,value:i.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function Ok(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function l_(n){return Le(n)?null:new qp(Ok(n))}const vm=M("lst");let hK=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(vm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(vm("s")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const s=e.createElement("div");s.classList.add(vm("m")),s.appendChild(Kp(e,"dropdown")),this.element.appendChild(s),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,ei(this.props_,"options",r=>{Vk(this.selectElement),r.forEach(o=>{const l=e.createElement("option");l.textContent=o.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}},ea=class{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new hK(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return ai(e,null,t=>({options:t.required.custom(Gp)}),t=>(this.props.set("options",Ok(t.options)),!0))}exportProps(){return ui(null,{options:this.props.get("options")})}};const cP=M("pop");let cK=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(cP()),t.viewProps.bindClassModifiers(this.element),Qn(t.shows,Ur(this.element,cP(void 0,"v")))}},a_=class{constructor(e,t){this.shows=Ie(!1),this.viewProps=t.viewProps,this.view=new cK(e,{shows:this.shows,viewProps:this.viewProps})}};const pP=M("txt");let pK=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(pP()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(pP("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}},Yp=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new pK(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Le(s)||(this.value.rawValue=s),this.view.refresh()}};function dK(n){return String(n)}function u_(n){return n==="false"?!1:!!n}function dP(n){return dK(n)}function mK(n){return e=>n.reduce((t,i)=>t!==null?t:i(e),null)}const vK=_t(0);function op(n){return vK(n)+"%"}function h_(n){return String(n)}function qv(n){return n}function qo({primary:n,secondary:e,forward:t,backward:i}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}n.emitter.on("change",o=>{r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),e.emitter.on("change",o=>{r(()=>{n.setRawValue(i(n.rawValue,e.rawValue),o.options)}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function at(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function bo(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function oi(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function fK(n){return n==="ArrowUp"||n==="ArrowDown"}function lp(n){return fK(n)||n==="ArrowLeft"||n==="ArrowRight"}function fm(n,e){var t,i;const s=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:n.pageX-(((t=s&&s.scrollX)!==null&&t!==void 0?t:0)+r.left),y:n.pageY-(((i=s&&s.scrollY)!==null&&i!==void 0?i:0)+r.top)}}let Ns=class{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new Tt,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(fm(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(fm(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(fm(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-s.left,y:i.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}};const Mn=M("txt");let wK=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Mn(),Mn(void 0,"num")),t.arrayPosition&&this.element.classList.add(Mn(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(Mn("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Mn()),this.inputElement.classList.add(Mn("i"));const s=e.createElement("div");s.classList.add(Mn("k")),this.element.appendChild(s),this.knobElement=s;const r=e.createElementNS(lt,"svg");r.classList.add(Mn("g")),this.knobElement.appendChild(r);const o=e.createElementNS(lt,"path");o.classList.add(Mn("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=e.createElementNS(lt,"path");l.classList.add(Mn("gh")),r.appendChild(l),this.guideHeadElem_=l;const a=e.createElement("div");a.classList.add(M("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(Mn(void 0,"drg"));return}this.element.classList.add(Mn(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),i=t+(t>0?-1:t<0?1:0),s=Te(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+s},0 L${i},4 L${i+s},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}},Mh=class{constructor(e,t){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(i=t.sliderProps)!==null&&i!==void 0?i:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=Ie(null),this.view=new wK(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new Ns(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,i;const s=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),r=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("max");let o=e;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Le(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const t=at(this.props.get("keyScale"),bo(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){at(this.props.get("keyScale"),bo(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}};const wm=M("sld");let _K=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(wm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(wm("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const s=e.createElement("div");s.classList.add(wm("k")),this.trackElement.appendChild(s),this.knobElement=s,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=Te(S(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}},bK=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new _K(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ns(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(S(Te(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=at(this.props.get("keyScale"),oi(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){at(this.props.get("keyScale"),oi(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const _m=M("sldtxt");let gK=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(_m());const i=e.createElement("div");i.classList.add(_m("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(_m("t")),this.textView_=t.textView,s.appendChild(this.textView_.element),this.element.appendChild(s)}},mP=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new bK(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new Mh(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new gK(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return ai(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const i=this.sliderC_.props;return i.set("max",t.max),i.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return ui(null,{max:e.get("max"),min:e.get("min")})}};function CK(n){return{sliderProps:new A({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new A({formatter:Ie(n.formatter),keyScale:n.keyScale,pointerScale:Ie(n.pointerScale)})}}const PK={containerUnitSize:"cnt-usz"};function Rk(n){return`--${PK[n]}`}class jk{constructor(e,t){const i=M(t.viewName);this.element=e.createElement("div"),this.element.classList.add(i()),t.viewProps.bindClassModifiers(this.element)}}function Hu(n){return Zw(n)}function _r(n){if(Kv(n))return Fe(n,Hu)}function ds(n,e){if(!n)return;const t=[],i=Yw(n,e);i&&t.push(i);const s=Xw(n);return s&&t.push(s),new Ea(t)}function Nk(n){if(n==="inline"||n==="popup")return n}function Hr(n,e){n.write(e)}const cc=M("ckb");let yK=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(cc()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(cc("l")),this.element.appendChild(i);const s=e.createElement("input");s.classList.add(cc("i")),s.type="checkbox",i.appendChild(s),this.inputElement=s,t.viewProps.bindDisabled(this.inputElement);const r=e.createElement("div");r.classList.add(cc("w")),i.appendChild(r);const o=Kp(e,"check");r.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}},EK=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new yK(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked}};function xK(n){const e=[],t=l_(n.options);return t&&e.push(t),new Ea(e)}ze({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Fe(e,i=>({options:i.optional.custom(Gp),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>u_,constraint:n=>xK(n.params),writer:n=>Hr},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&Uu(i,qp);return s?new ea(e,{props:new A({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new EK(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof ea?new o_(n.controller):null}});const Xr=M("col");let $K=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Xr()),t.foldable.bindExpandedClass(this.element,Xr(void 0,"expanded")),ei(t.foldable,"completed",Ur(this.element,Xr(void 0,"cpl")));const i=e.createElement("div");i.classList.add(Xr("h")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Xr("s")),i.appendChild(s),this.swatchElement=s;const r=e.createElement("div");if(r.classList.add(Xr("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(Xr("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};function VK(n,e,t){const i=Te(n/255,0,1),s=Te(e/255,0,1),r=Te(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u=0,h=0;const c=(l+o)/2;return a!==0&&(h=a/(1-Math.abs(o+l-1)),i===o?u=(s-r)/a:s===o?u=2+(r-i)/a:u=4+(i-s)/a,u=u/6+(u<0?1:0)),[u*360,h*100,c*100]}function kK(n,e,t){const i=(n%360+360)%360,s=Te(e/100,0,1),r=Te(t/100,0,1),o=(1-Math.abs(2*r-1))*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o/2;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function SK(n,e,t){const i=Te(n/255,0,1),s=Te(e/255,0,1),r=Te(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u;a===0?u=0:o===i?u=60*(((s-r)/a%6+6)%6):o===s?u=60*((r-i)/a+2):u=60*((i-s)/a+4);const h=o===0?0:a/o,c=o;return[u,h*100,c*100]}function Bk(n,e,t){const i=Ek(n,360),s=Te(e/100,0,1),r=Te(t/100,0,1),o=r*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function LK(n,e,t){const i=t+e*(100-Math.abs(2*t-100))/200;return[n,i!==0?e*(100-Math.abs(2*t-100))/i:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function AK(n,e,t){const i=100-Math.abs(t*(200-e)/100-100);return[n,i!==0?e*t/i:0,t*(200-e)/(2*100)]}function Ei(n){return[n[0],n[1],n[2]]}function Xp(n,e){return[n[0],n[1],n[2],e]}const MK={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:LK,rgb:kK},hsv:{hsl:AK,hsv:(n,e,t)=>[n,e,t],rgb:Bk},rgb:{hsl:VK,hsv:SK,rgb:(n,e,t)=>[n,e,t]}};function ta(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function TK(n,e){return n===e?e:Ek(n,e)}function Ik(n,e,t){var i;const s=ta(e,t);return[e==="rgb"?Te(n[0],0,s[0]):TK(n[0],s[0]),Te(n[1],0,s[1]),Te(n[2],0,s[2]),Te((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function vP(n,e,t,i){const s=ta(e,t),r=ta(e,i);return n.map((o,l)=>o/s[l]*r[l])}function Fk(n,e,t){const i=vP(n,e.mode,e.type,"int"),s=MK[e.mode][t.mode](...i);return vP(s,t.mode,"int",t.type)}let ue=class Kk{static black(){return new Kk([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=Ik(e,t,this.type)}getComponents(e){return Xp(Fk(Ei(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const qs=M("colp");let DK=class{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(qs()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(qs("hsv"));const s=e.createElement("div");s.classList.add(qs("sv")),this.svPaletteView_=t.svPaletteView,s.appendChild(this.svPaletteView_.element),i.appendChild(s);const r=e.createElement("div");r.classList.add(qs("h")),this.hPaletteView_=t.hPaletteView,r.appendChild(this.hPaletteView_.element),i.appendChild(r),this.element.appendChild(i);const o=e.createElement("div");if(o.classList.add(qs("rgb")),this.textsView_=t.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const l=e.createElement("div");l.classList.add(qs("a"));const a=e.createElement("div");a.classList.add(qs("ap")),a.appendChild(this.alphaViews_.palette.element),l.appendChild(a);const u=e.createElement("div");u.classList.add(qs("at")),u.appendChild(this.alphaViews_.text.element),l.appendChild(u),this.element.appendChild(l)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}};function OK(n){return n==="int"?"int":n==="float"?"float":void 0}function c_(n){return Fe(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(OK)}),expanded:e.optional.boolean,picker:e.optional.custom(Nk),readonly:e.optional.constant(!1)}))}function go(n){return n?.1:1}function Uk(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}let p_=class{constructor(e,t){this.type="float",this.mode=t,this.comps_=Ik(e,t,this.type)}getComponents(e){return Xp(Fk(Ei(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const RK={int:(n,e)=>new ue(n,e),float:(n,e)=>new p_(n,e)};function d_(n,e,t){return RK[t](n,e)}function jK(n){return n.type==="float"}function NK(n){return n.type==="int"}function BK(n){const e=n.getComponents(),t=ta(n.mode,"int");return new ue([Math.round(S(e[0],0,1,0,t[0])),Math.round(S(e[1],0,1,0,t[1])),Math.round(S(e[2],0,1,0,t[2])),e[3]],n.mode)}function IK(n){const e=n.getComponents(),t=ta(n.mode,"int");return new p_([S(e[0],0,t[0],0,1),S(e[1],0,t[1],0,1),S(e[2],0,t[2],0,1),e[3]],n.mode)}function Kt(n,e){if(n.type===e)return n;if(NK(n)&&e==="float")return IK(n);if(jK(n)&&e==="int")return BK(n);throw As.shouldNeverHappen()}function FK(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function Hn(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const KK={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function Hk(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),i=e[2];return KK[i](t)}function zk(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Hn(e[1],255),Hn(e[2],255),Hn(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function UK(n){const e=zk(n);return e?new ue(e,"rgb"):null}function qk(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Hn(e[1],255),Hn(e[2],255),Hn(e[3],255),Hn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function HK(n){const e=qk(n);return e?new ue(e,"rgb"):null}function Gk(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Hk(e[1]),Hn(e[2],100),Hn(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function zK(n){const e=Gk(n);return e?new ue(e,"hsl"):null}function Yk(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Hk(e[1]),Hn(e[2],100),Hn(e[3],100),Hn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function qK(n){const e=Yk(n);return e?new ue(e,"hsl"):null}function Xk(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function GK(n){const e=Xk(n);return e?new ue(e,"rgb"):null}function Wk(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),S(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),S(parseInt(t[4],16),0,255,0,1)]:null}function YK(n){const e=Wk(n);return e?new ue(e,"rgb"):null}function Zk(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function XK(n){return e=>{const t=Zk(e);return t?d_(t,"rgb",n):null}}function Qk(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function WK(n){return e=>{const t=Qk(e);return t?d_(t,"rgb",n):null}}const ZK=[{parser:Xk,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:Wk,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:zk,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:qk,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:Gk,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:Yk,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:Zk,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:Qk,result:{alpha:!0,mode:"rgb",notation:"object"}}];function QK(n){return ZK.reduce((e,{parser:t,result:i})=>e||(t(n)?i:null),null)}function JK(n,e="int"){const t=QK(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function Th(n){const e=[GK,YK,UK,HK,zK,qK];e.push(XK("int"),WK("int"));const t=mK(e);return i=>{const s=t(i);return s?Kt(s,n):null}}function e6(n){const e=Th("int");if(typeof n!="string")return ue.black();const t=e(n);return t??ue.black()}function Jk(n){const e=Te(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function m_(n,e="#"){const t=Ei(n.getComponents("rgb")).map(Jk).join("");return`${e}${t}`}function v_(n,e="#"){const t=n.getComponents("rgb"),i=[t[0],t[1],t[2],t[3]*255].map(Jk).join("");return`${e}${i}`}function e1(n){const e=_t(0),t=Kt(n,"int");return`rgb(${Ei(t.getComponents("rgb")).map(s=>e(s)).join(", ")})`}function Sc(n){const e=_t(2),t=_t(0);return`rgba(${Kt(n,"int").getComponents("rgb").map((r,o)=>(o===3?e:t)(r)).join(", ")})`}function t6(n){const e=[_t(0),op,op],t=Kt(n,"int");return`hsl(${Ei(t.getComponents("hsl")).map((s,r)=>e[r](s)).join(", ")})`}function n6(n){const e=[_t(0),op,op,_t(2)];return`hsla(${Kt(n,"int").getComponents("hsl").map((s,r)=>e[r](s)).join(", ")})`}function t1(n,e){const t=_t(e==="float"?2:0),i=["r","g","b"],s=Kt(n,e);return`{${Ei(s.getComponents("rgb")).map((o,l)=>`${i[l]}: ${t(o)}`).join(", ")}}`}function i6(n){return e=>t1(e,n)}function n1(n,e){const t=_t(2),i=_t(e==="float"?2:0),s=["r","g","b","a"];return`{${Kt(n,e).getComponents("rgb").map((l,a)=>{const u=a===3?t:i;return`${s[a]}: ${u(l)}`}).join(", ")}}`}function s6(n){return e=>n1(e,n)}const r6=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:m_},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:v_},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:e1},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:Sc},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:t6},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:n6},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:i6(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:s6(e)}],[])];function i1(n){return r6.reduce((e,t)=>e||(FK(t.format,n)?t.stringifier:null),null)}const Qa=M("apl");let o6=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Qa()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Qa("b")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Qa("c")),i.appendChild(s),this.colorElem_=s;const r=e.createElement("div");r.classList.add(Qa("m")),this.element.appendChild(r),this.markerElem_=r;const o=e.createElement("div");o.classList.add(Qa("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new ue([t[0],t[1],t[2],0],"rgb"),s=new ue([t[0],t[1],t[2],255],"rgb"),r=["to right",Sc(i),Sc(s)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=Sc(e);const o=S(t[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}},l6=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new o6(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ns(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,s=this.value.rawValue,[r,o,l]=s.getComponents("hsv");this.value.setRawValue(new ue([r,o,l,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=at(go(!0),oi(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new ue([s,r,o,l+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){at(go(!0),oi(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const sl=M("coltxt");function a6(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((i,s)=>{const r=n.createElement("option");return r.textContent=s.text,r.value=s.value,i.appendChild(r),i},n.createDocumentFragment())),e}let u6=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(sl()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(sl("m")),this.modeElem_=a6(e),this.modeElem_.classList.add(sl("ms")),i.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const s=e.createElement("div");s.classList.add(sl("mm")),s.appendChild(Kp(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(sl("w")),this.element.appendChild(r),this.inputsElem_=r,this.inputViews_=t.inputViews,this.applyInputViews_(),Qn(t.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){Vk(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const i=e.createElement("div");i.classList.add(sl("c")),i.appendChild(t.element),this.inputsElem_.appendChild(i)})}};function h6(n){return _t(n==="float"?2:0)}function c6(n,e,t){const i=ta(n,e)[t];return new Lh({min:0,max:i})}function p6(n,e,t){return new Mh(n,{arrayPosition:t===0?"fst":t===2?"lst":"mid",parser:e.parser,props:A.fromObject({formatter:h6(e.colorType),keyScale:go(!1),pointerScale:e.colorType==="float"?.01:1}),value:Ie(0,{constraint:c6(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function d6(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:ri,viewProps:e.viewProps};return[0,1,2].map(i=>{const s=p6(n,t,i);return qo({primary:e.value,secondary:s.value,forward(r){return Kt(r,e.colorType).getComponents(e.colorMode)[i]},backward(r,o){const l=e.colorMode,u=Kt(r,e.colorType).getComponents(l);u[i]=o;const h=d_(Xp(Ei(u),u[3]),l,e.colorType);return Kt(h,"int")}}),s})}function m6(n,e){const t=new Yp(n,{parser:Th("int"),props:A.fromObject({formatter:m_}),value:Ie(ue.black()),viewProps:e.viewProps});return qo({primary:e.value,secondary:t.value,forward:i=>new ue(Ei(i.getComponents()),i.mode),backward:(i,s)=>new ue(Xp(Ei(s.getComponents(i.mode)),i.getComponents()[3]),i.mode)}),[t]}function v6(n){return n!=="hex"}let f6=class{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=Ie(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new u6(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return v6(t)?d6(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):m6(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(i=>i.view)}};const bm=M("hpl");let w6=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(bm()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(bm("c")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(bm("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=e1(new ue([t,100,100],"hsv"));const i=S(t,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}},_6=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new w6(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ns(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=S(Te(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),s=this.value.rawValue,[,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new ue([i,r,o,l],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=at(go(!1),oi(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new ue([s+t,r,o,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){at(go(!1),oi(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const gm=M("svp"),fP=64;let b6=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(gm()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=fP,i.width=fP,i.classList.add(gm("c")),this.element.appendChild(i),this.canvasElement=i;const s=e.createElement("div");s.classList.add(gm("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=V3(this.canvasElement);if(!e)return;const i=this.value.rawValue.getComponents("hsv"),s=this.canvasElement.width,r=this.canvasElement.height,o=e.getImageData(0,0,s,r),l=o.data;for(let h=0;h<r;h++)for(let c=0;c<s;c++){const d=S(c,0,s,0,100),p=S(h,0,r,100,0),v=Bk(i[0],d,p),m=(h*s+c)*4;l[m]=v[0],l[m+1]=v[1],l[m+2]=v[2],l[m+3]=255}e.putImageData(o,0,0);const a=S(i[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const u=S(i[2],0,100,100,0);this.markerElem_.style.top=`${u}%`}onValueChange_(){this.update_()}},g6=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new b6(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ns(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=S(e.point.x,0,e.bounds.width,0,100),s=S(e.point.y,0,e.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new ue([r,i,s,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){lp(e.key)&&e.preventDefault();const[t,i,s,r]=this.value.rawValue.getComponents("hsv"),o=go(!1),l=at(o,oi(e)),a=at(o,bo(e));l===0&&a===0||this.value.setRawValue(new ue([t,i+l,s+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=go(!1),i=at(t,oi(e)),s=at(t,bo(e));i===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},C6=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new _6(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new g6(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new l6(e,{value:this.value,viewProps:this.viewProps}),text:new Mh(e,{parser:ri,props:A.fromObject({pointerScale:.01,keyScale:.1,formatter:_t(2)}),value:Ie(0,{constraint:new Lh({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&qo({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.getComponents()[3],backward:(i,s)=>{const r=i.getComponents();return r[3]=s,new ue(r,i.mode)}}),this.textsC_=new f6(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new DK(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}};const Cm=M("colsw");let P6=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(Cm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Cm("sw")),this.element.appendChild(i),this.swatchElem_=i;const s=e.createElement("button");s.classList.add(Cm("b")),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=v_(e)}onValueChange_(){this.update_()}},y6=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new P6(e,{value:this.value,viewProps:this.viewProps})}},f_=class{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Hp.create(t.expanded),this.swatchC_=new y6(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new Yp(e,{parser:t.parser,props:A.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new $K(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new a_(e,{viewProps:this.viewProps}):null;const s=new C6(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),qo({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),zp(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=t_(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!Fp(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}};function E6(n){return Ei(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function x6(n){return n.getComponents("rgb").reduce((e,t,i)=>{const s=Math.floor(i===3?t*255:t)&255;return e<<8|s},0)>>>0}function $6(n){return new ue([n>>16&255,n>>8&255,n&255],"rgb")}function V6(n){return new ue([n>>24&255,n>>16&255,n>>8&255,S(n&255,0,255,0,1)],"rgb")}function k6(n){return typeof n!="number"?ue.black():$6(n)}function S6(n){return typeof n!="number"?ue.black():V6(n)}function Lc(n,e){return typeof n!="object"||Le(n)?!1:e in n&&typeof n[e]=="number"}function s1(n){return Lc(n,"r")&&Lc(n,"g")&&Lc(n,"b")}function r1(n){return s1(n)&&Lc(n,"a")}function o1(n){return s1(n)}function w_(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),i=e.getComponents();for(let s=0;s<t.length;s++)if(t[s]!==i[s])return!1;return!0}function wP(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function L6(n){const e=i1(n);return e?(t,i)=>{Hr(t,e(i))}:null}function A6(n){const e=n?x6:E6;return(t,i)=>{Hr(t,e(i))}}function M6(n,e,t){const s=Kt(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b),n.writeProperty("a",s.a)}function T6(n,e,t){const s=Kt(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b)}function D6(n,e){return(t,i)=>{n?M6(t,i,e):T6(t,i,e)}}function O6(n){var e;return!!(!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function R6(n){return n?e=>v_(e,"0x"):e=>m_(e,"0x")}function j6(n){return"color"in n||n.view==="color"}ze({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!j6(e))return null;const t=c_(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:O6(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?S6:k6,equals:w_,writer:n=>A6(n.params.supportsAlpha)},controller:n=>{var e,t;return new f_(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:R6(n.params.supportsAlpha),parser:Th("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function N6(n,e){if(!o1(n))return Kt(ue.black(),e);if(e==="int"){const t=wP(n);return new ue(t,"rgb")}if(e==="float"){const t=wP(n);return new p_(t,"rgb")}return Kt(ue.black(),"int")}function B6(n){return r1(n)}function I6(n){return e=>{const t=N6(e,n);return Kt(t,"int")}}function F6(n,e){return t=>n?n1(t,e):t1(t,e)}ze({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!o1(n))return null;const i=c_(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{colorType:(t=Uk(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>I6(n.params.colorType),equals:w_,writer:n=>D6(B6(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const i=r1(n.initialValue);return new f_(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:F6(i,n.params.colorType),parser:Th("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:i,value:n.value,viewProps:n.viewProps})}});ze({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=JK(n,Uk(e));if(!t)return null;const i=i1(t);if(!i)return null;const s=c_(e);return s?{initialValue:n,params:Object.assign(Object.assign({},s),{format:t,stringifier:i})}:null},binding:{reader:()=>e6,equals:w_,writer:n=>{const e=L6(n.params.format);if(!e)throw As.notBindable();return e}},controller:n=>{var e,t;return new f_(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:Th("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});let Wp=class{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((i,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(i))!==null&&o!==void 0?o:i});return this.asm_.fromComponents(t)}};const _P=M("pndtxt");let K6=class{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(_P()),this.textViews.forEach(i=>{const s=e.createElement("div");s.classList.add(_P("a")),s.appendChild(i.element),this.element.appendChild(s)})}};function U6(n,e,t){return new Mh(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:Ie(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}let xa=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((i,s)=>U6(e,t,s)),this.acs_.forEach((i,s)=>{qo({primary:this.value,secondary:i.value,forward:r=>t.assembly.toComponents(r)[s],backward:(r,o)=>{const l=t.assembly.toComponents(r);return l[s]=o,t.assembly.fromComponents(l)}})}),this.view=new K6(e,{textViews:this.acs_.map(i=>i.view)})}get textControllers(){return this.acs_}},H6=class extends Jw{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}};function z6(n,e){const t=[],i=Yw(n,e);i&&t.push(i);const s=Xw(n);s&&t.push(s);const r=l_(n.options);return r&&t.push(r),new Ea(t)}ze({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=Fe(e,i=>Object.assign(Object.assign({},Zw(i)),{options:i.optional.custom(Gp),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Gw,constraint:n=>z6(n.params,n.initialValue),writer:n=>Hr},controller:n=>{const e=n.value,t=n.constraint,i=t&&Uu(t,qp);if(i)return new ea(n.document,{props:new A({options:i.values.value("options")}),value:e,viewProps:n.viewProps});const s=Ww(n.params,e.rawValue),r=t&&Uu(t,Lh);return r?new mP(n.document,Object.assign(Object.assign({},CK(Object.assign(Object.assign({},s),{keyScale:Ie(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:ri,value:e,viewProps:n.viewProps})):new Mh(n.document,{parser:ri,props:A.fromObject(s),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof mP?new H6(n.controller):n.controller.valueController instanceof ea?new o_(n.controller):null}});let $r=class{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(Le(e))return!1;const t=e.x,i=e.y;return!(typeof t!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}};const l1={toComponents:n=>n.getComponents(),fromComponents:n=>new $r(...n)},rl=M("p2d");let q6=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(rl()),t.viewProps.bindClassModifiers(this.element),Qn(t.expanded,Ur(this.element,rl(void 0,"expanded")));const i=e.createElement("div");i.classList.add(rl("h")),this.element.appendChild(i);const s=e.createElement("button");s.classList.add(rl("b")),s.appendChild(Kp(e,"p2dpad")),t.viewProps.bindDisabled(s),i.appendChild(s),this.buttonElement=s;const r=e.createElement("div");if(r.classList.add(rl("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(rl("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};const Gs=M("p2dp");let G6=class{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(Gs()),t.layout==="popup"&&this.element.classList.add(Gs(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Gs("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=e.createElementNS(lt,"svg");s.classList.add(Gs("g")),this.padElement.appendChild(s),this.svgElem_=s;const r=e.createElementNS(lt,"line");r.classList.add(Gs("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=e.createElementNS(lt,"line");o.classList.add(Gs("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const l=e.createElementNS(lt,"line");l.classList.add(Gs("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const a=e.createElement("div");a.classList.add(Gs("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.props_.get("max"),s=S(e,-i,+i,0,100),r=S(t,-i,+i,0,100),o=this.props_.get("invertsY")?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${s}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${s}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}};function bP(n,e,t){return[at(e[0],oi(n)),at(e[1],bo(n))*(t?1:-1)]}let Y6=class{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new G6(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Ns(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.props.get("max"),s=S(e.point.x,0,e.bounds.width,-i,+i),r=S(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new $r(s,r),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){lp(e.key)&&e.preventDefault();const[t,i]=bP(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(new $r(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=bP(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},X6=class{constructor(e,t){var i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Hp.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new a_(e,{viewProps:this.viewProps}):null;const r=new Y6(e,{layout:t.pickerLayout,props:new A({invertsY:Ie(t.invertsY),max:Ie(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.textC_=new xa(e,{assembly:l1,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new q6(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),qo({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),zp(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=t_(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!Fp(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}};function W6(n){return $r.isObject(n)?new $r(n.x,n.y):new $r}function Z6(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function Q6(n,e){return new Wp({assembly:l1,components:[ds(Object.assign(Object.assign({},n),n.x),e.x),ds(Object.assign(Object.assign({},n),n.y),e.y)]})}function gP(n,e){var t,i;if(!Le(n.min)||!Le(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((i=n.max)!==null&&i!==void 0?i:0));const s=xk(n);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function J6(n,e){var t,i;const s=gP(wo(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),r=gP(wo(n,(i=n.y)!==null&&i!==void 0?i:{}),e.y);return Math.max(s,r)}function e4(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}ze({id:"input-point2d",type:"input",accept:(n,e)=>{if(!$r.isObject(n))return null;const t=Fe(e,i=>Object.assign(Object.assign({},Hu(i)),{expanded:i.optional.boolean,picker:i.optional.custom(Nk),readonly:i.optional.constant(!1),x:i.optional.custom(_r),y:i.optional.object(Object.assign(Object.assign({},Hu(i)),{inverted:i.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>W6,constraint:n=>Q6(n.params,n.initialValue),equals:$r.equals,writer:()=>Z6},controller:n=>{var e,t;const i=n.document,s=n.value,r=n.constraint,o=[n.params.x,n.params.y];return new X6(i,{axes:s.rawValue.getComponents().map((l,a)=>{var u;return Qw({constraint:r.components[a],initialValue:l,params:wo(n.params,(u=o[a])!==null&&u!==void 0?u:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:e4(n.params),max:J6(n.params,s.rawValue),parser:ri,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:n.viewProps})}});let Rl=class{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(Le(e))return!1;const t=e.x,i=e.y,s=e.z;return!(typeof t!="number"||typeof i!="number"||typeof s!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}};const a1={toComponents:n=>n.getComponents(),fromComponents:n=>new Rl(...n)};function t4(n){return Rl.isObject(n)?new Rl(n.x,n.y,n.z):new Rl}function n4(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function i4(n,e){return new Wp({assembly:a1,components:[ds(Object.assign(Object.assign({},n),n.x),e.x),ds(Object.assign(Object.assign({},n),n.y),e.y),ds(Object.assign(Object.assign({},n),n.z),e.z)]})}ze({id:"input-point3d",type:"input",accept:(n,e)=>{if(!Rl.isObject(n))return null;const t=Fe(e,i=>Object.assign(Object.assign({},Hu(i)),{readonly:i.optional.constant(!1),x:i.optional.custom(_r),y:i.optional.custom(_r),z:i.optional.custom(_r)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>t4,constraint:n=>i4(n.params,n.initialValue),equals:Rl.equals,writer:n=>n4},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z];return new xa(n.document,{assembly:a1,axes:e.rawValue.getComponents().map((s,r)=>{var o;return Qw({constraint:t.components[r],initialValue:s,params:wo(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:ri,value:e,viewProps:n.viewProps})}});let jl=class{constructor(e=0,t=0,i=0,s=0){this.x=e,this.y=t,this.z=i,this.w=s}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(Le(e))return!1;const t=e.x,i=e.y,s=e.z,r=e.w;return!(typeof t!="number"||typeof i!="number"||typeof s!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}};const u1={toComponents:n=>n.getComponents(),fromComponents:n=>new jl(...n)};function s4(n){return jl.isObject(n)?new jl(n.x,n.y,n.z,n.w):new jl}function r4(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function o4(n,e){return new Wp({assembly:u1,components:[ds(Object.assign(Object.assign({},n),n.x),e.x),ds(Object.assign(Object.assign({},n),n.y),e.y),ds(Object.assign(Object.assign({},n),n.z),e.z),ds(Object.assign(Object.assign({},n),n.w),e.w)]})}ze({id:"input-point4d",type:"input",accept:(n,e)=>{if(!jl.isObject(n))return null;const t=Fe(e,i=>Object.assign(Object.assign({},Hu(i)),{readonly:i.optional.constant(!1),w:i.optional.custom(_r),x:i.optional.custom(_r),y:i.optional.custom(_r),z:i.optional.custom(_r)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>s4,constraint:n=>o4(n.params,n.initialValue),equals:jl.equals,writer:n=>r4},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z,n.params.w];return new xa(n.document,{assembly:u1,axes:e.rawValue.getComponents().map((s,r)=>{var o;return Qw({constraint:t.components[r],initialValue:s,params:wo(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:ri,value:e,viewProps:n.viewProps})}});function l4(n){const e=[],t=l_(n.options);return t&&e.push(t),new Ea(e)}ze({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=Fe(e,i=>({readonly:i.optional.constant(!1),options:i.optional.custom(Gp)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>h_,constraint:n=>l4(n.params),writer:n=>Hr},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&Uu(i,qp);return s?new ea(e,{props:new A({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new Yp(e,{parser:r=>r,props:A.fromObject({formatter:qv}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof ea?new o_(n.controller):null}});const Dh={monitor:{defaultInterval:200,defaultRows:3}},CP=M("mll");let a4=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(CP()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(CP("i")),i.style.height=`calc(var(${Rk("containerUnitSize")}) * ${t.rows})`,i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach(s=>{s!==void 0&&i.push(this.formatter_(s))}),e.textContent=i.join(`
`),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}},__=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new a4(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}};const PP=M("sgl");let u4=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(PP()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(PP("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}},b_=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new u4(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}};ze({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Fe(e,i=>({readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>u_},controller:n=>{var e;return n.value.rawValue.length===1?new b_(n.document,{formatter:dP,value:n.value,viewProps:n.viewProps}):new __(n.document,{formatter:dP,rows:(e=n.params.rows)!==null&&e!==void 0?e:Dh.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});let h4=class extends Jw{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}};const Ys=M("grl");let c4=class{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Ys()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(lt,"svg");i.classList.add(Ys("g")),i.style.height=`calc(var(${Rk("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(lt,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=e.createElement("div");r.classList.add(Ys("t"),M("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,i=this.props_.get("min"),s=this.props_.get("max"),r=[];this.value.rawValue.forEach((h,c)=>{if(h===void 0)return;const d=S(c,0,t,0,e.width),p=S(h,i,s,e.height,0);r.push([d,p].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,l=this.value.rawValue[this.cursor_.rawValue];if(l===void 0){o.classList.remove(Ys("t","a"));return}const a=S(this.cursor_.rawValue,0,t,0,e.width),u=S(l,i,s,e.height,0);o.style.left=`${a}px`,o.style.top=`${u}px`,o.textContent=`${this.formatter_(l)}`,o.classList.contains(Ys("t","a"))||(o.classList.add(Ys("t","a"),Ys("t","in")),sp(o),o.classList.remove(Ys("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}},g_=class{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=Ie(-1),this.view=new c4(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!Fp(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new Ns(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return ai(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return ui(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(S(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(S(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}};function Gv(n){return Le(n.format)?_t(2):n.format}function p4(n){var e;return n.value.rawValue.length===1?new b_(n.document,{formatter:Gv(n.params),value:n.value,viewProps:n.viewProps}):new __(n.document,{formatter:Gv(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Dh.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function d4(n){var e,t,i;return new g_(n.document,{formatter:Gv(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Dh.monitor.defaultRows,props:A.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(i=n.params.min)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function yP(n){return n.view==="graph"}ze({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=Fe(e,i=>({format:i.optional.function,max:i.optional.number,min:i.optional.number,readonly:i.required.constant(!0),rows:i.optional.number,view:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>yP(n)?64:1,reader:n=>Gw},controller:n=>yP(n.params)?d4(n):p4(n),api:n=>n.controller.valueController instanceof g_?new h4(n.controller):null});ze({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=Fe(e,i=>({multiline:i.optional.boolean,readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>h_},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new __(n.document,{formatter:qv,rows:(e=n.params.rows)!==null&&e!==void 0?e:Dh.monitor.defaultRows,value:t,viewProps:n.viewProps}):new b_(n.document,{formatter:qv,value:t,viewProps:n.viewProps})}});class m4{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get title(){var e;return(e=this.controller_.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller_.props.set("title",e)}on(e,t){const i=t.bind(this);return this.controller_.emitter.on(e,()=>{i(new zo(this))}),this}}class v4 extends zo{constructor(e,t,i){super(e),this.cell=t,this.index=i}}class f4 extends Ho{constructor(e){super(e),this.cellToApiMap_=new Map,this.emitter_=new Tt;const t=this.controller.valueController;t.cellControllers.forEach((i,s)=>{const r=new m4(i);this.cellToApiMap_.set(i,r),i.emitter.on("click",()=>{const o=s%t.size[0],l=Math.floor(s/t.size[0]);this.emitter_.emit("click",{event:new v4(this,r,[o,l])})})})}cell(e,t){const i=this.controller.valueController,s=i.cellControllers[t*i.size[0]+e];return this.cellToApiMap_.get(s)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s.event)}),this}}class w4{constructor(e,t){this.size=t.size;const[i,s]=this.size,r=[];for(let o=0;o<s;o++)for(let l=0;l<i;l++){const a=new Lk(e,{props:A.fromObject(Object.assign({},t.cellConfig(l,o))),viewProps:_o.create()});r.push(a)}this.cellCs_=r,this.viewProps=_o.create(),this.viewProps.handleDispose(()=>{this.cellCs_.forEach(o=>{o.viewProps.set("disposed",!0)})}),this.view=new jk(e,{viewProps:this.viewProps,viewName:"btngrid"}),this.view.element.style.gridTemplateColumns=`repeat(${i}, 1fr)`,this.cellCs_.forEach(o=>{this.view.element.appendChild(o.view.element)})}get cellControllers(){return this.cellCs_}}class EP extends Ah{constructor(e,t){const i=t.valueController,s=new Up(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:i.viewProps}),this.valueController=i,this.labelController=s}}ze({id:"buttongrid",type:"blade",accept(n){const e=Fe(n,t=>({cells:t.required.function,size:t.required.array(t.required.number),view:t.required.constant("buttongrid"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new EP(n.document,{blade:n.blade,labelProps:A.fromObject({label:n.params.label}),valueController:new w4(n.document,{cellConfig:n.params.cells,size:n.params.size})})},api(n){return n.controller instanceof EP?new f4(n.controller):null}});class _4 extends Ho{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get value(){return this.controller.valueController.value.rawValue}set value(e){this.controller.valueController.value.rawValue=e}on(e,t){const i=t.bind(this);return this.controller.valueController.value.emitter.on(e,s=>{i(new Ip(this,s.rawValue,s.options.last))}),this}}function Tn(n,e,t){return n*(1-t)+e*t}const b4=20,g4=.001,Pm=100;function C4(n,e){let t=.25,i=.5,s=-1;for(let r=0;r<b4;r++){const[o,l]=n.curve(i);if(i+=t*(o<e?1:-1),s=l,t*=.5,Math.abs(e-o)<g4)break}return s}class Co{constructor(e=0,t=0,i=1,s=1){this.cache_=[],this.comps_=[e,t,i,s]}get x1(){return this.comps_[0]}get y1(){return this.comps_[1]}get x2(){return this.comps_[2]}get y2(){return this.comps_[3]}static isObject(e){return Le(e)||!Array.isArray(e)?!1:typeof e[0]=="number"&&typeof e[1]=="number"&&typeof e[2]=="number"&&typeof e[3]=="number"}static equals(e,t){return e.x1===t.x1&&e.y1===t.y1&&e.x2===t.x2&&e.y2===t.y2}curve(e){const t=Tn(0,this.x1,e),i=Tn(0,this.y1,e),s=Tn(this.x1,this.x2,e),r=Tn(this.y1,this.y2,e),o=Tn(this.x2,1,e),l=Tn(this.y2,1,e),a=Tn(t,s,e),u=Tn(i,r,e),h=Tn(s,o,e),c=Tn(r,l,e);return[Tn(a,h,e),Tn(u,c,e)]}y(e){if(this.cache_.length===0){const t=[];for(let i=0;i<Pm;i++)t.push(C4(this,S(i,0,Pm-1,0,1)));this.cache_=t}return this.cache_[Math.round(S(Te(e,0,1),0,1,0,Pm-1))]}toObject(){return[this.comps_[0],this.comps_[1],this.comps_[2],this.comps_[3]]}}const h1={toComponents:n=>n.toObject(),fromComponents:n=>new Co(...n)};function P4(n){const e=_t(2);return`cubic-bezier(${n.toObject().map(i=>e(i)).join(", ")})`}const xP=[0,.5,.5,1];function y4(n){const e=n.match(/^cubic-bezier\s*\(\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*,\s*([0-9.]+)\s*\)$/);if(!e)return new Co(...xP);const t=[e[1],e[2],e[3],e[4]].reduce((i,s)=>{if(!i)return null;const r=Number(s);return isNaN(r)?null:[...i,r]},[]);return new Co(...t??xP)}const Wr=M("cbz");class E4{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Wr()),t.viewProps.bindClassModifiers(this.element),t.foldable.bindExpandedClass(this.element,Wr(void 0,"expanded")),ei(t.foldable,"completed",Ur(this.element,Wr(void 0,"cpl")));const i=e.createElement("div");i.classList.add(Wr("h")),this.element.appendChild(i);const s=e.createElement("button");s.classList.add(Wr("b")),t.viewProps.bindDisabled(s);const r=e.createElementNS(lt,"svg");r.innerHTML='<path d="M2 13C8 13 8 3 14 3"/>',s.appendChild(r),i.appendChild(s),this.buttonElement=s;const o=e.createElement("div");if(o.classList.add(Wr("t")),i.appendChild(o),this.textElement=o,t.pickerLayout==="inline"){const l=e.createElement("div");l.classList.add(Wr("p")),this.element.appendChild(l),this.pickerElement=l}else this.pickerElement=null}}const ym=M("cbzp");class x4{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ym()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(ym("g")),this.element.appendChild(i),this.graphElement=i;const s=e.createElement("div");s.classList.add(ym("t")),this.element.appendChild(s),this.textElement=s}}function c1(n,e){const t=new MutationObserver(s=>{for(const r of s)r.type==="childList"&&r.addedNodes.forEach(o=>{o.contains(o)&&(e(),t.disconnect())})}),i=n.ownerDocument;t.observe(i.body,{attributes:!0,childList:!0,subtree:!0})}const Xs=M("cbzg");function $4(n,e){return t=>e(n(t))}class V4{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Xs()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Xs("p")),this.element.appendChild(i),this.previewElement=i;const s=e.createElementNS(lt,"svg");s.classList.add(Xs("g")),this.element.appendChild(s),this.svgElem_=s;const r=e.createElementNS(lt,"path");r.classList.add(Xs("u")),this.svgElem_.appendChild(r),this.guideElem_=r;const o=e.createElementNS(lt,"polyline");o.classList.add(Xs("l")),this.svgElem_.appendChild(o),this.lineElem_=o,this.handleElems_=[e.createElement("div"),e.createElement("div")],this.handleElems_.forEach(l=>{l.classList.add(Xs("h")),this.element.appendChild(l)}),this.vectorElems_=[e.createElementNS(lt,"line"),e.createElementNS(lt,"line")],this.vectorElems_.forEach(l=>{l.classList.add(Xs("v")),this.svgElem_.appendChild(l)}),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_.bind(this)),this.sel_=t.selection,this.handleElems_.forEach((l,a)=>{Qn(this.sel_,$4(u=>u===a,Ur(l,Xs("h","sel"))))}),c1(this.element,()=>{this.refresh()})}getVertMargin_(e){return e*.25}valueToPosition(e,t){const{clientWidth:i,clientHeight:s}=this.element,r=this.getVertMargin_(s);return{x:S(e,0,1,0,i),y:S(t,0,1,s-r,r)}}positionToValue(e,t){const i=this.element.getBoundingClientRect(),s=i.width,r=i.height,o=this.getVertMargin_(r);return{x:Te(S(e,0,s,0,1),0,1),y:S(t,r-o,o,0,1)}}refresh(){this.guideElem_.setAttributeNS(null,"d",[0,1].map(r=>{const o=this.valueToPosition(0,r),l=this.valueToPosition(1,r);return[`M ${o.x},${o.y}`,`L ${l.x},${l.y}`].join(" ")}).join(" "));const e=this.value_.rawValue,t=[];let i=0;for(;;){const r=this.valueToPosition(...e.curve(i));if(t.push([r.x,r.y].join(",")),i>=1)break;i=Math.min(i+.05,1)}this.lineElem_.setAttributeNS(null,"points",t.join(" "));const s=e.toObject();[0,1].forEach(r=>{const o=this.valueToPosition(r,r),l=this.valueToPosition(s[r*2],s[r*2+1]),a=this.vectorElems_[r];a.setAttributeNS(null,"x1",String(o.x)),a.setAttributeNS(null,"y1",String(o.y)),a.setAttributeNS(null,"x2",String(l.x)),a.setAttributeNS(null,"y2",String(l.y));const u=this.handleElems_[r];u.style.left=`${l.x}px`,u.style.top=`${l.y}px`})}onValueChange_(){this.refresh()}}const $P=24,VP=400,kP=1e3,ol=M("cbzprv");class k4{constructor(e,t){this.stopped_=!0,this.startTime_=-1,this.onDispose_=this.onDispose_.bind(this),this.onTimer_=this.onTimer_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ol()),t.viewProps.bindClassModifiers(this.element);const i=e.createElementNS(lt,"svg");i.classList.add(ol("g")),this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(lt,"path");s.classList.add(ol("t")),this.svgElem_.appendChild(s),this.ticksElem_=s;const r=e.createElement("div");r.classList.add(ol("m")),this.element.appendChild(r),this.markerElem_=r,this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_),t.viewProps.handleDispose(this.onDispose_),c1(this.element,()=>{this.refresh()})}play(){this.stop(),this.updateMarker_(0),this.markerElem_.classList.add(ol("m","a")),this.startTime_=new Date().getTime()+VP,this.stopped_=!1,requestAnimationFrame(this.onTimer_)}stop(){this.stopped_=!0,this.markerElem_.classList.remove(ol("m","a"))}onDispose_(){this.stop()}updateMarker_(e){const t=this.value_.rawValue.y(Te(e,0,1));this.markerElem_.style.left=`${t*100}%`}refresh(){const{clientWidth:e,clientHeight:t}=this.svgElem_,i=[],s=this.value_.rawValue;for(let r=0;r<$P;r++){const o=S(r,0,$P-1,0,1),l=S(s.y(o),0,1,0,e);i.push(`M ${l},0 v${t}`)}this.ticksElem_.setAttributeNS(null,"d",i.join(" "))}onTimer_(){if(this.startTime_===null)return;const e=new Date().getTime()-this.startTime_,t=e/kP;this.updateMarker_(t),e>kP+VP&&this.stop(),this.stopped_||requestAnimationFrame(this.onTimer_)}onValueChange_(){this.refresh(),this.play()}}function Yv(n,e,t,i){const s=t-n,r=i-e;return Math.sqrt(s*s+r*r)}function S4(n,e,t,i){const s=Yv(n,e,t,i),r=Math.atan2(i-e,t-n),o=Math.round(r/(Math.PI/4))*Math.PI/4;return{x:n+Math.cos(o)*s,y:e+Math.sin(o)*s}}class L4{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.keyScale_=t.keyScale,this.value=t.value,this.sel_=Ie(0),this.viewProps=t.viewProps,this.view=new V4(e,{selection:this.sel_,value:this.value,viewProps:this.viewProps}),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_),this.prevView_=new k4(e,{value:this.value,viewProps:this.viewProps}),this.prevView_.element.addEventListener("mousedown",s=>{s.stopImmediatePropagation(),s.preventDefault(),this.prevView_.play()}),this.view.previewElement.appendChild(this.prevView_.element);const i=new Ns(this.view.element);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}refresh(){this.view.refresh(),this.prevView_.refresh(),this.prevView_.play()}updateValue_(e,t,i){const s=this.sel_.rawValue,r=this.value.rawValue.toObject(),o=this.view.positionToValue(e.x,e.y),l=t?S4(s,s,o.x,o.y):o;r[s*2]=l.x,r[s*2+1]=l.y,this.value.setRawValue(new Co(...r),i)}onPointerDown_(e){const t=e.data;if(!t.point)return;const i=this.value.rawValue,s=this.view.valueToPosition(i.x1,i.y1),r=Yv(t.point.x,t.point.y,s.x,s.y),o=this.view.valueToPosition(i.x2,i.y2),l=Yv(t.point.x,t.point.y,o.x,o.y);this.sel_.rawValue=r<=l?0:1,this.updateValue_(t.point,e.shiftKey,{forceEmit:!1,last:!1})}onPointerMove_(e){const t=e.data;t.point&&this.updateValue_(t.point,e.shiftKey,{forceEmit:!1,last:!1})}onPointerUp_(e){const t=e.data;t.point&&this.updateValue_(t.point,e.shiftKey,{forceEmit:!0,last:!0})}onKeyDown_(e){lp(e.key)&&e.preventDefault();const t=this.sel_.rawValue,i=this.value.rawValue.toObject(),s=this.keyScale_.rawValue;i[t*2]+=at(s,oi(e)),i[t*2+1]+=at(s,bo(e)),this.value.setRawValue(new Co(...i),{forceEmit:!1,last:!1})}onKeyUp_(e){lp(e.key)&&e.preventDefault();const t=this.keyScale_.rawValue,i=at(t,oi(e)),s=at(t,bo(e));i===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class A4{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new x4(e,{viewProps:this.viewProps}),this.gc_=new L4(e,{keyScale:t.axis.textProps.value("keyScale"),value:this.value,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.gc_.view.element);const i=Object.assign(Object.assign({},t.axis),{constraint:new Hw({max:1,min:0})}),s=Object.assign(Object.assign({},t.axis),{constraint:void 0});this.tc_=new xa(e,{assembly:h1,axes:[i,s,i,s],parser:ri,value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element)}get allFocusableElements(){return[this.gc_.view.element,...this.tc_.view.textViews.map(e=>e.inputElement)]}refresh(){this.gc_.refresh()}}class SP{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Hp.create(t.expanded),this.view=new E4(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("blur",this.onButtonBlur_),this.view.buttonElement.addEventListener("click",this.onButtonClick_),this.tc_=new Yp(e,{parser:y4,props:A.fromObject({formatter:P4}),value:this.value,viewProps:this.viewProps}),this.view.textElement.appendChild(this.tc_.view.element),this.popC_=t.pickerLayout==="popup"?new a_(e,{viewProps:this.viewProps}):null;const i=new A4(e,{axis:t.axis,value:this.value,viewProps:this.viewProps});i.allFocusableElements.forEach(s=>{s.addEventListener("blur",this.onPopupChildBlur_),s.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=i,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Qn(this.popC_.shows,s=>{s&&i.refresh()}),qo({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:s=>s,backward:(s,r)=>r})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),zp(this.foldable_,this.view.pickerElement))}onButtonBlur_(e){if(!this.popC_)return;const t=e.relatedTarget;(!t||!this.popC_.view.element.contains(t))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=t_(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!Fp(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_&&e.key==="Escape"&&(this.popC_.shows.rawValue=!1)}}function M4(){return new Wp({assembly:h1,components:[0,1,2,3].map(n=>n%2===0?new Hw({min:0,max:1}):void 0)})}ze({id:"cubicbezier",type:"blade",accept(n){const e=Fe(n,t=>({value:t.required.array(t.required.number),view:t.required.constant("cubicbezier"),expanded:t.optional.boolean,label:t.optional.string,picker:t.optional.custom(i=>i==="inline"||i==="popup"?i:void 0)}));return e?{params:e}:null},controller(n){var e,t;const i=new Co(...n.params.value),s=Ie(i,{constraint:M4(),equals:Co.equals}),r=new SP(n.document,{axis:{textProps:A.fromObject({keyScale:.1,pointerScale:.01,formatter:_t(2)})},expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:n.viewProps});return new rp(n.document,{blade:n.blade,props:A.fromObject({label:n.params.label}),value:s,valueController:r})},api(n){return!(n.controller instanceof rp)||!(n.controller.valueController instanceof SP)?null:new _4(n.controller)}});class T4 extends Ho{get fps(){return this.controller.valueController.fps}get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}begin(){this.controller.valueController.begin()}end(){this.controller.valueController.end()}on(e,t){const i=t.bind(this);return this.controller.valueController.ticker.emitter.on(e,()=>{i(new zo(this))}),this}}const LP=20;class D4{constructor(){this.start_=null,this.duration_=0,this.fps_=null,this.frameCount_=0,this.timestamps_=[]}get duration(){return this.duration_}get fps(){return this.fps_}begin(e){this.start_=e.getTime()}calculateFps_(e){if(this.timestamps_.length===0)return null;const t=this.timestamps_[0];return 1e3*(this.frameCount_-t.frameCount)/(e-t.time)}compactTimestamps_(){if(this.timestamps_.length<=LP)return;const e=this.timestamps_.length-LP;this.timestamps_.splice(0,e);const t=this.timestamps_[0].frameCount;this.timestamps_.forEach(i=>{i.frameCount-=t}),this.frameCount_-=t}end(e){if(this.start_===null)return;const t=e.getTime();this.duration_=t-this.start_,this.start_=null,this.fps_=this.calculateFps_(t),this.timestamps_.push({frameCount:this.frameCount_,time:t}),++this.frameCount_,this.compactTimestamps_()}}const Ja=M("fps");class O4{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ja()),t.viewProps.bindClassModifiers(this.element),this.graphElement=e.createElement("div"),this.graphElement.classList.add(Ja("g")),this.element.appendChild(this.graphElement);const i=e.createElement("div");i.classList.add(Ja("l")),this.element.appendChild(i);const s=e.createElement("span");s.classList.add(Ja("v")),s.textContent="--",i.appendChild(s),this.valueElement=s;const r=e.createElement("span");r.classList.add(Ja("u")),r.textContent="FPS",i.appendChild(r)}}class R4{constructor(e,t){this.stopwatch_=new D4,this.onTick_=this.onTick_.bind(this),this.ticker=t.ticker,this.ticker.emitter.on("tick",this.onTick_),this.props=t.props,this.value_=t.value,this.viewProps=t.viewProps,this.view=new O4(e,{viewProps:this.viewProps}),this.graphC_=new g_(e,{formatter:_t(0),props:this.props,rows:t.rows,value:this.value_,viewProps:this.viewProps}),this.view.graphElement.appendChild(this.graphC_.view.element),this.viewProps.handleDispose(()=>{this.graphC_.viewProps.set("disposed",!0),this.ticker.dispose()})}get fps(){return this.stopwatch_.fps}begin(){this.stopwatch_.begin(new Date)}end(){this.stopwatch_.end(new Date)}onTick_(){const e=this.fps;if(e!==null){const t=this.value_.rawValue;this.value_.rawValue=O3(t,e),this.view.valueElement.textContent=e.toFixed(0)}}}class AP extends Ah{constructor(e,t){const i=t.valueController,s=new Up(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:i.viewProps}),this.valueController=i,this.labelController=s}}function j4(n,e){return e===0?new aK:new uK(n,e??Dh.monitor.defaultInterval)}ze({id:"fpsgraph",type:"blade",accept(n){const e=Fe(n,t=>({view:t.required.constant("fpsgraph"),interval:t.optional.number,label:t.optional.string,rows:t.optional.number,max:t.optional.number,min:t.optional.number}));return e?{params:e}:null},controller(n){var e,t,i,s;const r=(e=n.params.interval)!==null&&e!==void 0?e:500;return new AP(n.document,{blade:n.blade,labelProps:A.fromObject({label:n.params.label}),valueController:new R4(n.document,{props:A.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:90,min:(i=n.params.min)!==null&&i!==void 0?i:0}),rows:(s=n.params.rows)!==null&&s!==void 0?s:2,ticker:j4(n.document,r),value:Ie(T3(80)),viewProps:n.viewProps})})},api(n){return n.controller instanceof AP?new T4(n.controller):null}});class Jn{constructor(e,t){this.min=e,this.max=t}static isObject(e){if(typeof e!="object"||e===null)return!1;const t=e.min,i=e.max;return!(typeof t!="number"||typeof i!="number")}static equals(e,t){return e.min===t.min&&e.max===t.max}get length(){return this.max-this.min}toObject(){return{min:this.min,max:this.max}}}const p1={fromComponents:n=>new Jn(n[0],n[1]),toComponents:n=>[n.min,n.max]};class d1{constructor(e){this.edge=e}constrain(e){var t,i,s,r,o,l,a,u;if(e.min<=e.max)return new Jn((i=(t=this.edge)===null||t===void 0?void 0:t.constrain(e.min))!==null&&i!==void 0?i:e.min,(r=(s=this.edge)===null||s===void 0?void 0:s.constrain(e.max))!==null&&r!==void 0?r:e.max);const h=(e.min+e.max)/2;return new Jn((l=(o=this.edge)===null||o===void 0?void 0:o.constrain(h))!==null&&l!==void 0?l:h,(u=(a=this.edge)===null||a===void 0?void 0:a.constrain(h))!==null&&u!==void 0?u:h)}}const Em=M("rsltxt");class N4{constructor(e,t){this.sliderView_=t.sliderView,this.textView_=t.textView,this.element=e.createElement("div"),this.element.classList.add(Em());const i=e.createElement("div");i.classList.add(Em("s")),i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Em("t")),s.appendChild(this.textView_.element),this.element.appendChild(s)}}const Zr=M("rsl");class B4{constructor(e,t){this.onSliderPropsChange_=this.onSliderPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.sliderProps_=t.sliderProps,this.sliderProps_.emitter.on("change",this.onSliderPropsChange_),this.element=e.createElement("div"),this.element.classList.add(Zr()),t.viewProps.bindClassModifiers(this.element),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_);const i=e.createElement("div");i.classList.add(Zr("t")),this.element.appendChild(i),this.trackElement=i;const s=e.createElement("div");s.classList.add(Zr("b")),i.appendChild(s),this.barElement=s;const r=["min","max"].map(o=>{const l=e.createElement("div");return l.classList.add(Zr("k"),Zr("k",o)),i.appendChild(l),l});this.knobElements=[r[0],r[1]],this.update_()}valueToX_(e){const t=this.sliderProps_.get("min"),i=this.sliderProps_.get("max");return Te(S(e,t,i,0,1),0,1)*100}update_(){const e=this.value_.rawValue;e.length===0?this.element.classList.add(Zr(void 0,"zero")):this.element.classList.remove(Zr(void 0,"zero"));const t=[this.valueToX_(e.min),this.valueToX_(e.max)];this.barElement.style.left=`${t[0]}%`,this.barElement.style.right=`${100-t[1]}%`,this.knobElements.forEach((i,s)=>{i.style.left=`${t[s]}%`})}onSliderPropsChange_(){this.update_()}onValueChange_(){this.update_()}}class I4{constructor(e,t){this.grabbing_=null,this.grabOffset_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.sliderProps=t.sliderProps,this.viewProps=t.viewProps,this.value=t.value,this.view=new B4(e,{sliderProps:this.sliderProps,value:this.value,viewProps:t.viewProps});const i=new Ns(this.view.trackElement);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}ofs_(){return this.grabbing_==="min"?this.view.knobElements[0].getBoundingClientRect().width/2:this.grabbing_==="max"?-this.view.knobElements[1].getBoundingClientRect().width/2:0}valueFromData_(e){if(!e.point)return null;const t=(e.point.x+this.ofs_())/e.bounds.width,i=this.sliderProps.get("min"),s=this.sliderProps.get("max");return S(t,0,1,i,s)}onPointerDown_(e){if(!e.data.point)return;const t=e.data.point.x/e.data.bounds.width,i=this.value.rawValue,s=this.sliderProps.get("min"),r=this.sliderProps.get("max"),o=S(i.min,s,r,0,1),l=S(i.max,s,r,0,1);Math.abs(l-t)<=.025?this.grabbing_="max":Math.abs(o-t)<=.025?this.grabbing_="min":t>=o&&t<=l?(this.grabbing_="length",this.grabOffset_=S(t-o,0,1,0,r-s)):t<o?(this.grabbing_="min",this.onPointerMove_(e)):t>l&&(this.grabbing_="max",this.onPointerMove_(e))}applyPointToValue_(e,t){const i=this.valueFromData_(e);if(i===null)return;const s=this.sliderProps.get("min"),r=this.sliderProps.get("max");if(this.grabbing_==="min")this.value.setRawValue(new Jn(i,this.value.rawValue.max),t);else if(this.grabbing_==="max")this.value.setRawValue(new Jn(this.value.rawValue.min,i),t);else if(this.grabbing_==="length"){const o=this.value.rawValue.length;let l=i-this.grabOffset_,a=l+o;l<s?(l=s,a=s+o):a>r&&(l=r-o,a=r),this.value.setRawValue(new Jn(l,a),t)}}onPointerMove_(e){this.applyPointToValue_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.applyPointToValue_(e.data,{forceEmit:!0,last:!0}),this.grabbing_=null}}class F4{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sc_=new I4(e,t);const i={constraint:t.constraint,textProps:t.textProps};this.tc_=new xa(e,{assembly:p1,axes:[i,i],parser:t.parser,value:this.value,viewProps:t.viewProps}),this.view=new N4(e,{sliderView:this.sc_.view,textView:this.tc_.view})}get textController(){return this.tc_}}function K4(n){return Jn.isObject(n)?new Jn(n.min,n.max):new Jn(0,0)}function U4(n,e){n.writeProperty("max",e.max),n.writeProperty("min",e.min)}function H4(n){const e=[],t=Xw(n);t&&e.push(t);const i=Yw(n);return i&&e.push(i),new d1(new Ea(e))}ze({id:"input-interval",type:"input",accept:(n,e)=>{if(!Jn.isObject(n))return null;const t=Fe(e,i=>Object.assign(Object.assign({},Zw(i)),{readonly:i.optional.constant(!1)}));return t?{initialValue:new Jn(n.min,n.max),params:t}:null},binding:{reader:n=>K4,constraint:n=>H4(n.params),equals:Jn.equals,writer:n=>U4},controller(n){const e=n.value,t=n.constraint;if(!(t instanceof d1))throw As.shouldNeverHappen();const i=(e.rawValue.min+e.rawValue.max)/2,s=A.fromObject(Ww(n.params,i)),r=t.edge&&Uu(t.edge,Lh);if(r)return new F4(n.document,{constraint:t.edge,parser:ri,sliderProps:new A({keyScale:s.value("keyScale"),max:r.values.value("max"),min:r.values.value("min")}),textProps:s,value:e,viewProps:n.viewProps});const o={constraint:t.edge,textProps:s};return new xa(n.document,{assembly:p1,axes:[o,o],parser:ri,value:e,viewProps:n.viewProps})}});class z4{constructor(e){this.controller_=e}get disabled(){return this.controller_.viewProps.get("disabled")}set disabled(e){this.controller_.viewProps.set("disabled",e)}get title(){var e;return(e=this.controller_.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller_.props.set("title",e)}}class q4 extends Ip{constructor(e,t,i,s,r){super(e,s,r),this.cell=t,this.index=i}}class G4 extends Ho{constructor(e){super(e),this.cellToApiMap_=new Map,this.controller.valueController.cellControllers.forEach(i=>{const s=new z4(i);this.cellToApiMap_.set(i,s)})}get value(){return this.controller.value}cell(e,t){const i=this.controller.valueController,s=i.cellControllers[t*i.size[0]+e];return this.cellToApiMap_.get(s)}on(e,t){const i=t.bind(this);this.controller.value.emitter.on(e,s=>{const r=this.controller.valueController,o=r.findCellByValue(s.rawValue);if(!o)return;const l=this.cellToApiMap_.get(o);if(!l)return;const a=r.cellControllers.indexOf(o);i(new q4(this,l,[a%r.size[0],Math.floor(a/r.size[0])],s.rawValue))})}}const eu=M("rad");class Y4{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(eu()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(eu("l")),this.element.appendChild(i);const s=e.createElement("input");s.classList.add(eu("i")),s.name=t.name,s.type="radio",t.viewProps.bindDisabled(s),i.appendChild(s),this.inputElement=s;const r=e.createElement("div");r.classList.add(eu("b")),i.appendChild(r);const o=e.createElement("div");o.classList.add(eu("t")),r.appendChild(o),ei(t.props,"title",l=>{o.textContent=l})}}class X4{constructor(e,t){this.props=t.props,this.viewProps=t.viewProps,this.view=new Y4(e,{name:t.name,props:this.props,viewProps:this.viewProps})}}class Xv{constructor(e,t){this.cellCs_=[],this.cellValues_=[],this.onCellInputChange_=this.onCellInputChange_.bind(this),this.size=t.size;const[i,s]=this.size;for(let r=0;r<s;r++)for(let o=0;o<i;o++){const l=new X4(e,{name:t.groupName,props:A.fromObject(Object.assign({},t.cellConfig(o,r))),viewProps:_o.create()});this.cellCs_.push(l),this.cellValues_.push(t.cellConfig(o,r).value)}this.value=t.value,Qn(this.value,r=>{const o=this.findCellByValue(r);o&&(o.view.inputElement.checked=!0)}),this.viewProps=_o.create(),this.view=new jk(e,{viewProps:this.viewProps,viewName:"radgrid"}),this.view.element.style.gridTemplateColumns=`repeat(${i}, 1fr)`,this.cellCs_.forEach(r=>{r.view.inputElement.addEventListener("change",this.onCellInputChange_),this.view.element.appendChild(r.view.element)})}get cellControllers(){return this.cellCs_}findCellByValue(e){const t=this.cellValues_.findIndex(i=>i===e);return t<0?null:this.cellCs_[t]}onCellInputChange_(e){const t=e.currentTarget,i=this.cellCs_.findIndex(s=>s.view.inputElement===t);i<0||(this.value.rawValue=this.cellValues_[i])}}(function(){return ze({id:"radiogrid",type:"blade",accept(n){const e=Fe(n,t=>({cells:t.required.function,groupName:t.required.string,size:t.required.array(t.required.number),value:t.required.raw,view:t.required.constant("radiogrid"),label:t.optional.string}));return e?{params:e}:null},controller(n){const e=Ie(n.params.value);return new rp(n.document,{blade:n.blade,props:A.fromObject({label:n.params.label}),value:e,valueController:new Xv(n.document,{groupName:n.params.groupName,cellConfig:n.params.cells,size:n.params.size,value:e})})},api(n){return!(n.controller instanceof rp)||!(n.controller.valueController instanceof Xv)?null:new G4(n.controller)}})})();function C_(n){return ze({id:"input-radiogrid",type:"input",accept(e,t){if(!n.isType(e))return null;const i=Fe(t,s=>({cells:s.required.function,groupName:s.required.string,size:s.required.array(s.required.number),view:s.required.constant("radiogrid")}));return i?{initialValue:e,params:i}:null},binding:n.binding,controller:e=>new Xv(e.document,{cellConfig:e.params.cells,groupName:e.params.groupName,size:e.params.size,value:e.value})})}C_({isType:n=>typeof n=="number",binding:{reader:n=>Gw,writer:n=>Hr}});C_({isType:n=>typeof n=="string",binding:{reader:n=>h_,writer:n=>Hr}});C_({isType:n=>typeof n=="boolean",binding:{reader:n=>u_,writer:n=>Hr}});var W4=Function.prototype.toString,xm=Object.create,Z4=Object.prototype.toString,Q4=function(){function n(){this._keys=[],this._values=[]}return n.prototype.has=function(e){return!!~this._keys.indexOf(e)},n.prototype.get=function(e){return this._values[this._keys.indexOf(e)]},n.prototype.set=function(e,t){this._keys.push(e),this._values.push(t)},n}();function J4(){return new Q4}function eU(){return new WeakMap}var tU=typeof WeakMap<"u"?eU:J4;function P_(n){if(!n)return xm(null);var e=n.constructor;if(e===Object)return n===Object.prototype?{}:xm(n);if(~W4.call(e).indexOf("[native code]"))try{return new e}catch{}return xm(n)}function nU(n){var e="";return n.global&&(e+="g"),n.ignoreCase&&(e+="i"),n.multiline&&(e+="m"),n.unicode&&(e+="u"),n.sticky&&(e+="y"),e}function iU(n){return n.flags}var sU=/test/g.flags==="g"?iU:nU;function m1(n){var e=Z4.call(n);return e.substring(8,e.length-1)}function rU(n){return n[Symbol.toStringTag]||m1(n)}var oU=typeof Symbol<"u"?rU:m1,lU=Object.defineProperty,aU=Object.getOwnPropertyDescriptor,v1=Object.getOwnPropertyNames,y_=Object.getOwnPropertySymbols,f1=Object.prototype,w1=f1.hasOwnProperty,uU=f1.propertyIsEnumerable,_1=typeof y_=="function";function hU(n){return v1(n).concat(y_(n))}var cU=_1?hU:v1;function Zp(n,e,t){for(var i=cU(n),s=0,r=i.length,o=void 0,l=void 0;s<r;++s)if(o=i[s],!(o==="callee"||o==="caller")){if(l=aU(n,o),!l){e[o]=t.copier(n[o],t);continue}!l.get&&!l.set&&(l.value=t.copier(l.value,t));try{lU(e,o,l)}catch{e[o]=l.value}}return e}function pU(n,e){var t=new e.Constructor;e.cache.set(n,t);for(var i=0,s=n.length;i<s;++i)t[i]=e.copier(n[i],e);return t}function dU(n,e){var t=new e.Constructor;return e.cache.set(n,t),Zp(n,t,e)}function b1(n,e){return n.slice(0)}function mU(n,e){return n.slice(0,n.size,n.type)}function vU(n,e){return new e.Constructor(b1(n.buffer))}function fU(n,e){return new e.Constructor(n.getTime())}function g1(n,e){var t=new e.Constructor;return e.cache.set(n,t),n.forEach(function(i,s){t.set(s,e.copier(i,e))}),t}function wU(n,e){return Zp(n,g1(n,e),e)}function _U(n,e){var t=P_(e.prototype);e.cache.set(n,t);for(var i in n)w1.call(n,i)&&(t[i]=e.copier(n[i],e));return t}function bU(n,e){var t=P_(e.prototype);e.cache.set(n,t);for(var i in n)w1.call(n,i)&&(t[i]=e.copier(n[i],e));for(var s=y_(n),r=0,o=s.length,l=void 0;r<o;++r)l=s[r],uU.call(n,l)&&(t[l]=e.copier(n[l],e));return t}var gU=_1?bU:_U;function CU(n,e){var t=P_(e.prototype);return e.cache.set(n,t),Zp(n,t,e)}function $m(n,e){return new e.Constructor(n.valueOf())}function PU(n,e){var t=new e.Constructor(n.source,sU(n));return t.lastIndex=n.lastIndex,t}function Ac(n,e){return n}function C1(n,e){var t=new e.Constructor;return e.cache.set(n,t),n.forEach(function(i){t.add(e.copier(i,e))}),t}function yU(n,e){return Zp(n,C1(n,e),e)}var EU=Array.isArray,E_=Object.assign,xU=Object.getPrototypeOf||function(n){return n.__proto__},P1={array:pU,arrayBuffer:b1,blob:mU,dataView:vU,date:fU,error:Ac,map:g1,object:gU,regExp:PU,set:C1},$U=E_({},P1,{array:dU,map:wU,object:CU,set:yU});function VU(n){return{Arguments:n.object,Array:n.array,ArrayBuffer:n.arrayBuffer,Blob:n.blob,Boolean:$m,DataView:n.dataView,Date:n.date,Error:n.error,Float32Array:n.arrayBuffer,Float64Array:n.arrayBuffer,Int8Array:n.arrayBuffer,Int16Array:n.arrayBuffer,Int32Array:n.arrayBuffer,Map:n.map,Number:$m,Object:n.object,Promise:Ac,RegExp:n.regExp,Set:n.set,String:$m,WeakMap:Ac,WeakSet:Ac,Uint8Array:n.arrayBuffer,Uint8ClampedArray:n.arrayBuffer,Uint16Array:n.arrayBuffer,Uint32Array:n.arrayBuffer,Uint64Array:n.arrayBuffer}}function y1(n){var e=E_({},P1,n),t=VU(e),i=t.Array,s=t.Object;function r(o,l){if(l.prototype=l.Constructor=void 0,!o||typeof o!="object")return o;if(l.cache.has(o))return l.cache.get(o);if(l.prototype=xU(o),l.Constructor=l.prototype&&l.prototype.constructor,!l.Constructor||l.Constructor===Object)return s(o,l);if(EU(o))return i(o,l);var a=t[oU(o)];return a?a(o,l):typeof o.then=="function"?o:s(o,l)}return function(l){return r(l,{Constructor:void 0,cache:tU(),copier:r,prototype:void 0})}}function kU(n){return y1(E_({},$U,n))}kU({});var Vm=y1({}),SU=Object.getOwnPropertyNames,LU=Object.getOwnPropertySymbols,AU=Object.prototype.hasOwnProperty;function MP(n,e){return function(i,s,r){return n(i,s,r)&&e(i,s,r)}}function pc(n){return function(t,i,s){if(!t||!i||typeof t!="object"||typeof i!="object")return n(t,i,s);var r=s.cache,o=r.get(t),l=r.get(i);if(o&&l)return o===i&&l===t;r.set(t,i),r.set(i,t);var a=n(t,i,s);return r.delete(t),r.delete(i),a}}function TP(n){return SU(n).concat(LU(n))}var E1=Object.hasOwn||function(n,e){return AU.call(n,e)};function $a(n,e){return n||e?n===e:n===e||n!==n&&e!==e}var x1="_owner",DP=Object.getOwnPropertyDescriptor,OP=Object.keys;function MU(n,e,t){var i=n.length;if(e.length!==i)return!1;for(;i-- >0;)if(!t.equals(n[i],e[i],i,i,n,e,t))return!1;return!0}function TU(n,e){return $a(n.getTime(),e.getTime())}function RP(n,e,t){if(n.size!==e.size)return!1;for(var i={},s=n.entries(),r=0,o,l;(o=s.next())&&!o.done;){for(var a=e.entries(),u=!1,h=0;(l=a.next())&&!l.done;){var c=o.value,d=c[0],p=c[1],v=l.value,m=v[0],f=v[1];!u&&!i[h]&&(u=t.equals(d,m,r,h,n,e,t)&&t.equals(p,f,d,m,n,e,t))&&(i[h]=!0),h++}if(!u)return!1;r++}return!0}function DU(n,e,t){var i=OP(n),s=i.length;if(OP(e).length!==s)return!1;for(var r;s-- >0;)if(r=i[s],r===x1&&(n.$$typeof||e.$$typeof)&&n.$$typeof!==e.$$typeof||!E1(e,r)||!t.equals(n[r],e[r],r,r,n,e,t))return!1;return!0}function tu(n,e,t){var i=TP(n),s=i.length;if(TP(e).length!==s)return!1;for(var r,o,l;s-- >0;)if(r=i[s],r===x1&&(n.$$typeof||e.$$typeof)&&n.$$typeof!==e.$$typeof||!E1(e,r)||!t.equals(n[r],e[r],r,r,n,e,t)||(o=DP(n,r),l=DP(e,r),(o||l)&&(!o||!l||o.configurable!==l.configurable||o.enumerable!==l.enumerable||o.writable!==l.writable)))return!1;return!0}function OU(n,e){return $a(n.valueOf(),e.valueOf())}function RU(n,e){return n.source===e.source&&n.flags===e.flags}function jP(n,e,t){if(n.size!==e.size)return!1;for(var i={},s=n.values(),r,o;(r=s.next())&&!r.done;){for(var l=e.values(),a=!1,u=0;(o=l.next())&&!o.done;)!a&&!i[u]&&(a=t.equals(r.value,o.value,r.value,o.value,n,e,t))&&(i[u]=!0),u++;if(!a)return!1}return!0}function jU(n,e){var t=n.length;if(e.length!==t)return!1;for(;t-- >0;)if(n[t]!==e[t])return!1;return!0}var NU="[object Arguments]",BU="[object Boolean]",IU="[object Date]",FU="[object Map]",KU="[object Number]",UU="[object Object]",HU="[object RegExp]",zU="[object Set]",qU="[object String]",GU=Array.isArray,NP=typeof ArrayBuffer=="function"&&ArrayBuffer.isView?ArrayBuffer.isView:null,BP=Object.assign,YU=Object.prototype.toString.call.bind(Object.prototype.toString);function XU(n){var e=n.areArraysEqual,t=n.areDatesEqual,i=n.areMapsEqual,s=n.areObjectsEqual,r=n.arePrimitiveWrappersEqual,o=n.areRegExpsEqual,l=n.areSetsEqual,a=n.areTypedArraysEqual;return function(h,c,d){if(h===c)return!0;if(h==null||c==null||typeof h!="object"||typeof c!="object")return h!==h&&c!==c;var p=h.constructor;if(p!==c.constructor)return!1;if(p===Object)return s(h,c,d);if(GU(h))return e(h,c,d);if(NP!=null&&NP(h))return a(h,c,d);if(p===Date)return t(h,c,d);if(p===RegExp)return o(h,c,d);if(p===Map)return i(h,c,d);if(p===Set)return l(h,c,d);var v=YU(h);return v===IU?t(h,c,d):v===HU?o(h,c,d):v===FU?i(h,c,d):v===zU?l(h,c,d):v===UU?typeof h.then!="function"&&typeof c.then!="function"&&s(h,c,d):v===NU?s(h,c,d):v===BU||v===KU||v===qU?r(h,c,d):!1}}function WU(n){var e=n.circular,t=n.createCustomConfig,i=n.strict,s={areArraysEqual:i?tu:MU,areDatesEqual:TU,areMapsEqual:i?MP(RP,tu):RP,areObjectsEqual:i?tu:DU,arePrimitiveWrappersEqual:OU,areRegExpsEqual:RU,areSetsEqual:i?MP(jP,tu):jP,areTypedArraysEqual:i?tu:jU};if(t&&(s=BP({},s,t(s))),e){var r=pc(s.areArraysEqual),o=pc(s.areMapsEqual),l=pc(s.areObjectsEqual),a=pc(s.areSetsEqual);s=BP({},s,{areArraysEqual:r,areMapsEqual:o,areObjectsEqual:l,areSetsEqual:a})}return s}function ZU(n){return function(e,t,i,s,r,o,l){return n(e,t,l)}}function QU(n){var e=n.circular,t=n.comparator,i=n.createState,s=n.equals,r=n.strict;if(i)return function(a,u){var h=i(),c=h.cache,d=c===void 0?e?new WeakMap:void 0:c,p=h.meta;return t(a,u,{cache:d,equals:s,meta:p,strict:r})};if(e)return function(a,u){return t(a,u,{cache:new WeakMap,equals:s,meta:void 0,strict:r})};var o={cache:void 0,equals:s,meta:void 0,strict:r};return function(a,u){return t(a,u,o)}}zr();zr({strict:!0});zr({circular:!0});zr({circular:!0,strict:!0});var JU=zr({createInternalComparator:function(){return $a}});zr({strict:!0,createInternalComparator:function(){return $a}});zr({circular:!0,createInternalComparator:function(){return $a}});zr({circular:!0,createInternalComparator:function(){return $a},strict:!0});function zr(n){n===void 0&&(n={});var e=n.circular,t=e===void 0?!1:e,i=n.createInternalComparator,s=n.createState,r=n.strict,o=r===void 0?!1:r,l=WU(n),a=XU(l),u=i?i(a):ZU(a);return QU({circular:t,comparator:a,createState:s,equals:u,strict:o})}function eH(n){let e,t;return e=new Kw({props:{theme:n[7],userCreatedPane:!1,$$slots:{default:[nH]},$$scope:{ctx:n}}}),{c(){fe(e.$$.fragment)},l(i){we(e.$$.fragment,i)},m(i,s){_e(e,i,s),t=!0},p(i,s){const r={};s&128&&(r.theme=i[7]),s&1073741951&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function tH(n){let e,t,i,s;const r=[sH,iH],o=[];function l(a,u){return 0}return e=l(),t=o[e]=r[e](n),{c(){t.c(),i=D()},l(a){t.l(a),i=D()},m(a,u){o[e].m(a,u),k(a,i,u),s=!0},p(a,u){t.p(a,u)},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&P(i),o[e].d(a)}}}function nH(n){let e,t,i,s,r,o,l,a,u;function h(g){n[14](g)}function c(g){n[15](g)}function d(g){n[16](g)}function p(g){n[17](g)}function v(g){n[18](g)}function m(g){n[19](g)}function f(g){n[20](g)}let w={};return n[1]!==void 0&&(w.disabled=n[1]),n[5]!==void 0&&(w.key=n[5]),n[2]!==void 0&&(w.label=n[2]),n[0]!==void 0&&(w.object=n[0]),n[3]!==void 0&&(w.options=n[3]),n[6]!==void 0&&(w.plugin=n[6]),n[4]!==void 0&&(w.ref=n[4]),e=new x_({props:w}),R.push(()=>xe(e,"disabled",h)),R.push(()=>xe(e,"key",c)),R.push(()=>xe(e,"label",d)),R.push(()=>xe(e,"object",p)),R.push(()=>xe(e,"options",v)),R.push(()=>xe(e,"plugin",m)),R.push(()=>xe(e,"ref",f)),e.$on("change",n[21]),{c(){fe(e.$$.fragment)},l(g){we(e.$$.fragment,g)},m(g,L){_e(e,g,L),u=!0},p(g,L){const ye={};!t&&L&2&&(t=!0,ye.disabled=g[1],Ee(()=>t=!1)),!i&&L&32&&(i=!0,ye.key=g[5],Ee(()=>i=!1)),!s&&L&4&&(s=!0,ye.label=g[2],Ee(()=>s=!1)),!r&&L&1&&(r=!0,ye.object=g[0],Ee(()=>r=!1)),!o&&L&8&&(o=!0,ye.options=g[3],Ee(()=>o=!1)),!l&&L&64&&(l=!0,ye.plugin=g[6],Ee(()=>l=!1)),!a&&L&16&&(a=!0,ye.ref=g[4],Ee(()=>a=!1)),e.$set(ye)},i(g){u||(b(e.$$.fragment,g),u=!0)},o(g){y(e.$$.fragment,g),u=!1},d(g){be(e,g)}}}function iH(n){let e,t;return e=new ba({props:{keysAdd:["containerVerticalPadding","containerUnitSize"],theme:n[7]}}),{c(){fe(e.$$.fragment)},l(i){we(e.$$.fragment,i)},m(i,s){_e(e,i,s),t=!0},p(i,s){const r={};s&128&&(r.theme=i[7]),e.$set(r)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function sH(n){let e;return{c(){e=Ue("div"),this.h()},l(t){e=He(t,"DIV",{style:!0}),ke(e).forEach(P),this.h()},h(){Ye(e,"display","none")},m(t,i){k(t,e,i),n[13](e)},p:Xe,i:Xe,o:Xe,d(t){t&&P(e),n[13](null)}}}function rH(n){let e,t,i,s;const r=[tH,eH],o=[];function l(a,u){return a[9]?0:1}return e=l(n),t=o[e]=r[e](n),{c(){t.c(),i=D()},l(a){t.l(a),i=D()},m(a,u){o[e].m(a,u),k(a,i,u),s=!0},p(a,[u]){t.p(a,u)},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&P(i),o[e].d(a)}}}function oH(n,e,t){let i,{object:s}=e,{key:r}=e,{disabled:o=!1}=e,{label:l=void 0}=e,{options:a=void 0}=e,{theme:u=void 0}=e,{ref:h=void 0}=e,{plugin:c=void 0}=e;const d=ao("registerPlugin"),p=ao("parentStore");In(n,p,x=>t(12,i=x));const v=ao("userCreatedPane");let m,f,w;function g(){m&&m.dispose(),c!==void 0&&d(c),t(10,m=i.addBinding(s,r,{index:w,label:l,...a,disabled:o})),t(4,h=m),m.on("change",O)}fh(()=>{t(11,w=f?cV(f):0)}),kp(()=>{m==null||m.dispose()});const L=n$();let ye=Vm(s[r]),C=!1;function qe(x){JU(x[r],ye)||(ye=Vm(x[r]),L("change",{value:Vm(x[r]),origin:C?"internal":"external"}),!C&&m&&(m.off("change",O),m.refresh(),m.on("change",O))),C=!1}function O(){C=!0,t(0,s)}function E(x){R[x?"unshift":"push"](()=>{f=x,t(8,f)})}function Ge(x){o=x,t(1,o)}function ti(x){r=x,t(5,r)}function Jt(x){l=x,t(2,l)}function $(x){s=x,t(0,s)}function J(x){a=x,t(3,a)}function Ke(x){c=x,t(6,c)}function kn(x){h=x,t(4,h)}function ts(x){i$.call(this,n,x)}return n.$$set=x=>{"object"in x&&t(0,s=x.object),"key"in x&&t(5,r=x.key),"disabled"in x&&t(1,o=x.disabled),"label"in x&&t(2,l=x.label),"options"in x&&t(3,a=x.options),"theme"in x&&t(7,u=x.theme),"ref"in x&&t(4,h=x.ref),"plugin"in x&&t(6,c=x.plugin)},n.$$.update=()=>{n.$$.dirty&1026&&m!==void 0&&t(10,m.disabled=o,m),n.$$.dirty&1028&&m!==void 0&&t(10,m.label=l,m),n.$$.dirty&1040,n.$$.dirty&6152&&i!==void 0&&w!==void 0&&g(),n.$$.dirty&4097&&i!==void 0&&qe(s),n.$$.dirty&4224&&u&&i!==void 0&&(v||!hV(i))&&console.warn("Set theme on the <Pane> component, not on its children! (Check nested <Binding> components for a theme prop.)")},[s,o,l,a,h,r,c,u,f,p,m,w,i,E,Ge,ti,Jt,$,J,Ke,kn,ts]}class x_ extends Lt{constructor(e){super(),At(this,e,oH,rH,St,{object:0,key:5,disabled:1,label:2,options:3,theme:7,ref:4,plugin:6})}}function De(n){return n==null}function $_(n){return n!==null&&typeof n=="object"}function Wv(n){return n!==null&&typeof n=="object"}function lH(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Po(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((i,s)=>{const r=n[s],o=e[s];return Wv(r)&&Wv(o)?Object.assign(Object.assign({},i),{[s]:Po(r,o)}):Object.assign(Object.assign({},i),{[s]:s in e?o:r})},{})}function aH(n){return $_(n)?"target"in n:!1}const uH={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};let yo=class Vl{static alreadyDisposed(){return new Vl({type:"alreadydisposed"})}static notBindable(){return new Vl({type:"notbindable"})}static notCompatible(e,t){return new Vl({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new Vl({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new Vl({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=uH[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}},IP=class $1{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const i=this.read();if(!$1.isBindable(i))throw yo.notBindable();if(!(e in i))throw yo.propertyNotFound(e);i[e]=t}},yn=class{constructor(){this.observers_={}}on(e,t){let i=this.observers_[e];return i||(i=this.observers_[e]=[]),i.push({handler:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter(s=>s.handler!==t)),this}emit(e,t){const i=this.observers_[e];i&&i.forEach(s=>{s.handler(t)})}},hH=class{constructor(e,t){var i;this.constraint_=t==null?void 0:t.constraint,this.equals_=(i=t==null?void 0:t.equals)!==null&&i!==void 0?i:(s,r)=>s===r,this.emitter=new yn,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,r=this.rawValue_;this.equals_(r,s)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:i,previousRawValue:r,rawValue:s,sender:this}))}},cH=class{constructor(e){this.emitter=new yn,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.value_;s===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:this.value_,sender:this}))}},pH=class{constructor(e){this.emitter=new yn,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}};function ct(n,e){const t=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!t&&!i?new cH(n):new hH(n,e)}function dH(n){return[new pH(n),(e,t)=>{n.setRawValue(e,t)}]}let Ce=class V1{constructor(e){this.emitter=new yn,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((i,s)=>Object.assign(i,{[s]:ct(e[s])}),{})}static fromObject(e){const t=this.createCore(e);return new V1(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}},Qp=class{constructor(e){this.values=Ce.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(e,i),t)}},mH=class{constructor(e){this.values=Ce.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");let s=e;return De(i)||(s=Math.max(s,i)),De(t)||(s=Math.min(s,t)),s}},vH=class{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,i=Math.round((e-t)/this.step);return t+i*this.step}},fH=class{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}};const wH={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};let _H=class{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=wH[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}};const bH={"+":n=>n,"-":n=>-n,"~":n=>~n};let gH=class{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=bH[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}};function V_(n){return(e,t)=>{for(let i=0;i<n.length;i++){const s=n[i](e,t);if(s!=="")return s}return""}}function zu(n,e){var t;const i=n.substr(e).match(/^\s+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function CH(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function qu(n,e){var t;const i=n.substr(e).match(/^[0-9]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function PH(n,e){const t=qu(n,e);if(t!=="")return t;const i=n.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";const s=qu(n,e);return s===""?"":i+s}function k_(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const i=PH(n,e);return i===""?"":t+i}function k1(n,e){const t=n.substr(e,1);if(t==="0")return t;const i=CH(n,e);return e+=i.length,i===""?"":i+qu(n,e)}function yH(n,e){const t=k1(n,e);if(e+=t.length,t==="")return"";const i=n.substr(e,1);if(e+=i.length,i!==".")return"";const s=qu(n,e);return e+=s.length,t+i+s+k_(n,e)}function EH(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const i=qu(n,e);return e+=i.length,i===""?"":t+i+k_(n,e)}function xH(n,e){const t=k1(n,e);return e+=t.length,t===""?"":t+k_(n,e)}const $H=V_([yH,EH,xH]);function VH(n,e){var t;const i=n.substr(e).match(/^[01]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function kH(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const i=VH(n,e);return i===""?"":t+i}function SH(n,e){var t;const i=n.substr(e).match(/^[0-7]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function LH(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const i=SH(n,e);return i===""?"":t+i}function AH(n,e){var t;const i=n.substr(e).match(/^[0-9a-f]+/i);return(t=i&&i[0])!==null&&t!==void 0?t:""}function MH(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const i=AH(n,e);return i===""?"":t+i}const TH=V_([kH,LH,MH]),DH=V_([TH,$H]);function OH(n,e){const t=DH(n,e);return e+=t.length,t===""?null:{evaluable:new fH(t),cursor:e}}function RH(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const i=L1(n,e);if(!i)return null;e=i.cursor,e+=zu(n,e).length;const s=n.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:i.evaluable,cursor:e}}function jH(n,e){var t;return(t=OH(n,e))!==null&&t!==void 0?t:RH(n,e)}function S1(n,e){const t=jH(n,e);if(t)return t;const i=n.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const s=S1(n,e);return s?(e=s.cursor,{cursor:e,evaluable:new gH(i,s.evaluable)}):null}function NH(n,e,t){t+=zu(e,t).length;const i=n.filter(s=>e.startsWith(s,t))[0];return i?(t+=i.length,t+=zu(e,t).length,{cursor:t,operator:i}):null}function BH(n,e){return(t,i)=>{const s=n(t,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const o=NH(e,t,i);if(!o)break;i=o.cursor;const l=n(t,i);if(!l)return null;i=l.cursor,r=new _H(o.operator,r,l.evaluable)}return r?{cursor:i,evaluable:r}:null}}const IH=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>BH(n,e),S1);function L1(n,e){return e+=zu(n,e).length,IH(n,e)}function FH(n){const e=L1(n,0);return!e||e.cursor+zu(n,e.cursor).length!==n.length?null:e.evaluable}function Nr(n){var e;const t=FH(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function A1(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=Nr(n);if(!De(e))return e}return 0}function hn(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function ne(n,e,t,i,s){const r=(n-e)/(t-e);return i+r*(s-i)}function FP(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function et(n,e,t){return Math.min(Math.max(n,e),t)}function M1(n,e){return(n%e+e)%e}function KH(n,e){return De(n.step)?Math.max(FP(e),2):FP(n.step)}function T1(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function UH(n,e){var t;const i=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function D1(n,e){return De(n.step)?null:new vH(n.step,e)}function O1(n){return!De(n.max)&&!De(n.min)?new Qp({max:n.max,min:n.min}):!De(n.max)||!De(n.min)?new mH({max:n.max,min:n.min}):null}function R1(n,e){var t,i,s;return{formatter:(t=n.format)!==null&&t!==void 0?t:hn(KH(n,e)),keyScale:(i=n.keyScale)!==null&&i!==void 0?i:T1(n),pointerScale:(s=n.pointerScale)!==null&&s!==void 0?s:UH(n,e)}}function j1(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function S_(n){return{constraint:n.constraint,textProps:Ce.fromObject(R1(n.params,n.initialValue))}}let L_=class{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}},Jp=class{constructor(e){this.target=e}},N1=class extends Jp{constructor(e,t,i){super(e),this.value=t,this.last=i??!0}},HH=class extends Jp{constructor(e,t){super(e),this.expanded=t}},zH=class extends Jp{constructor(e,t){super(e),this.index=t}},A_=class extends L_{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new yn,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new N1(this,t.binding.target.read(),e.options.last))}};function qH(n,e){const i=Object.keys(e).reduce((s,r)=>{if(s===void 0)return;const o=e[r],l=o(n[r]);return l.succeeded?Object.assign(Object.assign({},s),{[r]:l.value}):void 0},{});return i}function GH(n,e){return n.reduce((t,i)=>{if(t===void 0)return;const s=e(i);if(!(!s.succeeded||s.value===void 0))return[...t,s.value]},[])}function YH(n){return n===null?!1:typeof n=="object"}function rs(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const i=n(t);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function KP(n){return{custom:e=>rs(e)(n),boolean:rs(e=>typeof e=="boolean"?e:void 0)(n),number:rs(e=>typeof e=="number"?e:void 0)(n),string:rs(e=>typeof e=="string"?e:void 0)(n),function:rs(e=>typeof e=="function"?e:void 0)(n),constant:e=>rs(t=>t===e?e:void 0)(n),raw:rs(e=>e)(n),object:e=>rs(t=>{if(YH(t))return qH(t,e)})(n),array:e=>rs(t=>{if(Array.isArray(t))return GH(t,e)})(n)}}const Zv={optional:KP(!0),required:KP(!1)};function bt(n,e){const t=e(Zv),i=Zv.required.object(t)(n);return i.succeeded?i.value:void 0}function Ui(n,e,t,i){if(e&&!e(n))return!1;const s=bt(n,t);return s?i(s):!1}function Hi(n,e){var t;return Po((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function Mc(n){return"value"in n}function XH(n){if(!$_(n)||!("binding"in n))return!1;const e=n.binding;return aH(e)}const mi="http://www.w3.org/2000/svg";function ap(n){n.offsetHeight}function WH(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function M_(n){return n.ontouchstart!==void 0}function ZH(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const QH={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function ed(n,e){const t=n.createElementNS(mi,"svg");return t.innerHTML=QH[e],t}function B1(n,e,t){n.insertBefore(e,n.children[t])}function T_(n){n.parentElement&&n.parentElement.removeChild(n)}function I1(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function JH(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function F1(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function Ps(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function xi(n,e,t){Ps(n.value(e),t)}const ez="tp";function z(n){return(t,i)=>[ez,"-",n,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}const nu=z("lbl");function tz(n,e){const t=n.createDocumentFragment();return e.split(`
`).map(s=>n.createTextNode(s)).forEach((s,r)=>{r>0&&t.appendChild(n.createElement("br")),t.appendChild(s)}),t}let nz=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(nu()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(nu("l")),xi(t.props,"label",r=>{De(r)?this.element.classList.add(nu(void 0,"nol")):(this.element.classList.remove(nu(void 0,"nol")),JH(i),i.appendChild(tz(e,r)))}),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("div");s.classList.add(nu("v")),this.element.appendChild(s),this.valueElement=s}},iz=class{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new nz(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return Ui(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return Hi(null,{label:this.props.get("label")})}};function sz(){return["veryfirst","first","last","verylast"]}const UP=z(""),HP={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};let K1=class{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{sz().forEach(i=>{t.classList.remove(UP(void 0,HP[i]))}),this.blade.get("positions").forEach(i=>{t.classList.add(UP(void 0,HP[i]))})}),this.viewProps.handleDispose(()=>{T_(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return Ui(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return Hi(null,Object.assign({},this.viewProps.exportState()))}},rz=class extends L_{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const i=t.bind(this);return this.controller.buttonController.emitter.on(e,()=>{i(new Jp(this))}),this}};function oz(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function Va(n,e){return t=>{oz(n,e,t)}}function D_(n,e){Ps(n,t=>{e.textContent=t??""})}const km=z("btn");let lz=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(km()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(km("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(km("t")),D_(t.props.value("title"),s),this.buttonElement.appendChild(s)}},az=class{constructor(e,t){this.emitter=new yn,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new lz(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return Ui(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return Hi(null,{title:this.props.get("title")})}onClick_(){this.emitter.emit("click",{sender:this})}},zP=class extends K1{constructor(e,t){const i=new az(e,{props:t.buttonProps,viewProps:t.viewProps}),s=new iz(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:t.viewProps}),this.buttonController=i,this.labelController=s}importState(e){return Ui(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return Hi(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}},uz=class{constructor(e){const[t,i]=e.split("-"),s=t.split(".");this.major=parseInt(s[0],10),this.minor=parseInt(s[1],10),this.patch=parseInt(s[2],10),this.prerelease=i??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}};const hz=new uz("2.0.1");function Dt(n){return Object.assign({core:hz},n)}Dt({id:"button",type:"blade",accept(n){const e=bt(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new zP(n.document,{blade:n.blade,buttonProps:Ce.fromObject({title:n.params.title}),labelProps:Ce.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof zP?new rz(n.controller):null}});function cz(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function pz(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function dz(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function mz(n){return $_(n)?"refresh"in n&&typeof n.refresh=="function":!1}function vz(n,e){if(!IP.isBindable(n))throw yo.notBindable();return new IP(n,e)}let fz=class{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new yn,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,i){const s=i??{},r=this.controller_.element.ownerDocument,o=this.pool_.createBinding(r,vz(e,t),s),l=this.pool_.createBindingApi(o);return this.add(l,s.index)}addFolder(e){return pz(this,e)}addButton(e){return cz(this,e)}addTab(e){return dz(this,e)}add(e,t){const i=e.controller;return this.controller_.rack.add(i,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,i=this.pool_.createBlade(t,e),s=this.pool_.createApi(i);return this.add(s,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.children.forEach(e=>{mz(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,i=this.pool_.createApi(t),s=XH(t.value)?t.value.binding:null;this.emitter_.emit("change",new N1(i,s?s.target.read():t.value.rawValue,e.options.last))}},O_=class extends L_{constructor(e,t){super(e),this.rackApi_=new fz(e.rackController,t)}refresh(){this.rackApi_.refresh()}},R_=class extends K1{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return Ui(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((i,s)=>i.importState(t.children[s])))}exportState(){return Hi(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}};function Qv(n){return"rackController"in n}let wz=class{constructor(e){this.emitter=new yn,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw yo.shouldNeverHappen();const i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(r=>{this.cache_.add(r)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.allItems().forEach(s=>{this.cache_.delete(s)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}};function _z(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(Mc(i)&&i.value===e)return i}return null}function bz(n){return Qv(n)?n.rackController.rack.bcSet_:null}let gz=class{constructor(e){var t,i;this.emitter=new yn,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new wz(bz),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var i;(i=e.parent)===null||i===void 0||i.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),Mc(i))i.value.emitter.on("change",this.onChildValueChange_);else if(Qv(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.on("layout",this.onRackLayout_),r.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const i=e.item;if(Mc(i))i.value.emitter.off("change",this.onChildValueChange_);else if(Qv(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.off("layout",this.onRackLayout_),r.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(s=>!s.viewProps.get("hidden")),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach(s=>{const r=[];s===t&&(r.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&r.push("veryfirst")),s===i&&(r.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&r.push("verylast")),s.blade.set("positions",r)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=_z(this.find(Mc),e.sender);if(!t)throw yo.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}},j_=class{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new gz({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let i=this.rack.children.length-1;i>=0;i--)this.rack.children[i].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&B1(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&T_(e.bladeController.view.element)}};function U1(){return new Ce({positions:ct([],{equals:lH})})}let N_=class H1 extends Ce{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=Ce.createCore(t);return new H1(i)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!De(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const i=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};xi(this,"expanded",i),xi(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}};function Cz(n,e){let t=0;return WH(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),ap(e),t=e.clientHeight,n.set("temporaryExpanded",null),ap(e)}),t}function qP(n,e){e.style.height=n.styleHeight}function B_(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),De(n.get("expandedHeight"))){const t=Cz(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),ap(e)}),n.emitter.on("change",()=>{qP(n,e)}),qP(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}let Pz=class extends O_{constructor(e,t){super(e,t),this.emitter_=new yn,this.controller.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",new HH(this,i.sender.rawValue))}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}};const z1=z("cnt");let yz=class{constructor(e,t){var i;this.className_=z((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),z1()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),xi(this.foldable_,"completed",Va(this.element,this.className_(void 0,"cpl")));const s=e.createElement("button");s.classList.add(this.className_("b")),xi(t.props,"title",u=>{De(u)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const r=e.createElement("div");r.classList.add(this.className_("i")),this.element.appendChild(r);const o=e.createElement("div");o.classList.add(this.className_("t")),D_(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}},GP=class extends R_{constructor(e,t){var i;const s=N_.create((i=t.expanded)!==null&&i!==void 0?i:!0),r=new yz(e,{foldable:s,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new j_({blade:t.blade,element:r.containerElement,root:t.root,viewProps:t.viewProps}),view:r})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=s,B_(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return Ui(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return Hi(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}};Dt({id:"folder",type:"blade",accept(n){const e=bt(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new GP(n.document,{blade:n.blade,expanded:n.params.expanded,props:Ce.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof GP?new Pz(n.controller,n.pool):null}});const Ez=z("");function YP(n,e){return Va(n,Ez(void 0,e))}let I_=class q1 extends Ce{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=dH(ct(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,i,s;const r=e??{};return new q1(Ce.createCore({disabled:(t=r.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(i=r.hidden)!==null&&i!==void 0?i:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){Ps(this.globalDisabled_,YP(e,"disabled")),xi(this,"hidden",YP(e,"hidden"))}bindDisabled(e){Ps(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){Ps(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const i=e.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}};const XP=z("tbp");let xz=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(XP()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(XP("c")),this.element.appendChild(i),this.containerElement=i}};const iu=z("tbi");let $z=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(iu()),t.viewProps.bindClassModifiers(this.element),xi(t.props,"selected",r=>{r?this.element.classList.add(iu(void 0,"sel")):this.element.classList.remove(iu(void 0,"sel"))});const i=e.createElement("button");i.classList.add(iu("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(iu("t")),D_(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}},Vz=class{constructor(e,t){this.emitter=new yn,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new $z(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}},Jv=class extends R_{constructor(e,t){const i=new xz(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new j_({blade:t.blade,element:i.containerElement,viewProps:t.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Vz(e,{props:t.itemProps,viewProps:I_.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,xi(this.props,"selected",s=>{this.itemController.props.set("selected",s),this.viewProps.set("hidden",!s)})}get itemController(){return this.ic_}importState(e){return Ui(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return Hi(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}},kz=class extends O_{constructor(e,t){super(e,t),this.emitter_=new yn,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,i=new Jv(t,{blade:U1(),itemProps:Ce.fromObject({selected:!1,title:e.title}),props:Ce.fromObject({selected:!1}),viewProps:I_.create()}),s=this.pool_.createApi(i);return this.rackApi_.add(s,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}onSelect_(e){this.emitter_.emit("select",new zH(this,e.rawValue))}},Sz=class extends O_{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}};const WP=-1;let Lz=class{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=ct(!0),this.selectedIndex=ct(WP),this.items_=[]}add(e,t){const i=t??this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=WP,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,i)=>{t.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,i)=>{t.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(i=>i===e.sender);this.items_.forEach((i,s)=>{i.rawValue=s===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}};const su=z("tab");let Az=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(su(),z1()),t.viewProps.bindClassModifiers(this.element),Ps(t.empty,Va(this.element,su(void 0,"nop")));const i=e.createElement("div");i.classList.add(su("t")),this.element.appendChild(i),this.itemsElement=i;const s=e.createElement("div");s.classList.add(su("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(su("c")),this.element.appendChild(r),this.contentsElement=r}},ZP=class extends R_{constructor(e,t){const i=new Lz,s=new Az(e,{empty:i.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new j_({blade:t.blade,element:s.contentsElement,viewProps:t.viewProps}),view:s}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=this.rackController.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.tab=i}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;B1(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;T_(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}};Dt({id:"tab",type:"blade",accept(n){const e=bt(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new ZP(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const i=new Jv(n.document,{blade:U1(),itemProps:Ce.fromObject({selected:!1,title:t.title}),props:Ce.fromObject({selected:!1}),viewProps:I_.create()});e.add(i)}),e},api(n){return n.controller instanceof ZP?new kz(n.controller,n.pool):n.controller instanceof Jv?new Sz(n.controller,n.pool):null}});let F_=class extends A_{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}},Oh=class{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,i)=>i.constrain(t),e)}};function up(n,e){if(n instanceof e)return n;if(n instanceof Oh){const t=n.constraints.reduce((i,s)=>i||(s instanceof e?s:null),null);if(t)return t}return null}let td=class{constructor(e){this.values=Ce.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(s=>s.value===e).length>0?e:t[0].value}};function nd(n){var e;const t=Zv;if(Array.isArray(n))return(e=bt({items:n},i=>({items:i.required.array(i.required.object({text:i.required.string,value:i.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function G1(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function K_(n){return De(n)?null:new td(G1(n))}const Sm=z("lst");let Mz=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(Sm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(Sm("s")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const s=e.createElement("div");s.classList.add(Sm("m")),s.appendChild(ed(e,"dropdown")),this.element.appendChild(s),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,xi(this.props_,"options",r=>{I1(this.selectElement),r.forEach(o=>{const l=e.createElement("option");l.textContent=o.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}},na=class{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Mz(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return Ui(e,null,t=>({options:t.required.custom(nd)}),t=>(this.props.set("options",G1(t.options)),!0))}exportProps(){return Hi(null,{options:this.props.get("options")})}};const QP=z("pop");let Tz=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(QP()),t.viewProps.bindClassModifiers(this.element),Ps(t.shows,Va(this.element,QP(void 0,"v")))}},Y1=class{constructor(e,t){this.shows=ct(!1),this.viewProps=t.viewProps,this.view=new Tz(e,{shows:this.shows,viewProps:this.viewProps})}};const JP=z("txt");let Dz=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(JP()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(JP("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}},U_=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Dz(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);De(s)||(this.value.rawValue=s),this.view.refresh()}};function Oz(n){return String(n)}function X1(n){return n==="false"?!1:!!n}function ey(n){return Oz(n)}function Rz(n){return e=>n.reduce((t,i)=>t!==null?t:i(e),null)}const jz=hn(0);function hp(n){return jz(n)+"%"}function W1(n){return String(n)}function ef(n){return n}function ka({primary:n,secondary:e,forward:t,backward:i}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}n.emitter.on("change",o=>{r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),e.emitter.on("change",o=>{r(()=>{n.setRawValue(i(n.rawValue,e.rawValue),o.options)}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function nn(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function Gu(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function Ms(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function Nz(n){return n==="ArrowUp"||n==="ArrowDown"}function Z1(n){return Nz(n)||n==="ArrowLeft"||n==="ArrowRight"}function Lm(n,e){var t,i;const s=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:n.pageX-(((t=s&&s.scrollX)!==null&&t!==void 0?t:0)+r.left),y:n.pageY-(((i=s&&s.scrollY)!==null&&i!==void 0?i:0)+r.top)}}let Go=class{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new yn,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Lm(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Lm(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Lm(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-s.left,y:i.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}};const Dn=z("txt");let Bz=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Dn(),Dn(void 0,"num")),t.arrayPosition&&this.element.classList.add(Dn(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(Dn("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Dn()),this.inputElement.classList.add(Dn("i"));const s=e.createElement("div");s.classList.add(Dn("k")),this.element.appendChild(s),this.knobElement=s;const r=e.createElementNS(mi,"svg");r.classList.add(Dn("g")),this.knobElement.appendChild(r);const o=e.createElementNS(mi,"path");o.classList.add(Dn("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=e.createElementNS(mi,"path");l.classList.add(Dn("gh")),r.appendChild(l),this.guideHeadElem_=l;const a=e.createElement("div");a.classList.add(z("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(Dn(void 0,"drg"));return}this.element.classList.add(Dn(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),i=t+(t>0?-1:t<0?1:0),s=et(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+s},0 L${i},4 L${i+s},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}},Rh=class{constructor(e,t){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(i=t.sliderProps)!==null&&i!==void 0?i:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=ct(null),this.view=new Bz(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new Go(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,i;const s=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),r=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("max");let o=e;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);De(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const t=nn(this.props.get("keyScale"),Gu(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){nn(this.props.get("keyScale"),Gu(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}};const Am=z("sld");let Iz=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Am()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Am("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const s=e.createElement("div");s.classList.add(Am("k")),this.trackElement.appendChild(s),this.knobElement=s,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=et(ne(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}},Fz=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new Iz(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Go(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(ne(et(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=nn(this.props.get("keyScale"),Ms(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){nn(this.props.get("keyScale"),Ms(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const Mm=z("sldtxt");let Kz=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Mm());const i=e.createElement("div");i.classList.add(Mm("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Mm("t")),this.textView_=t.textView,s.appendChild(this.textView_.element),this.element.appendChild(s)}},ty=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new Fz(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new Rh(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new Kz(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return Ui(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const i=this.sliderC_.props;return i.set("max",t.max),i.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return Hi(null,{max:e.get("max"),min:e.get("min")})}};function Uz(n){return{sliderProps:new Ce({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new Ce({formatter:ct(n.formatter),keyScale:n.keyScale,pointerScale:ct(n.pointerScale)})}}const Hz={containerUnitSize:"cnt-usz"};function Q1(n){return`--${Hz[n]}`}function Yu(n){return j1(n)}function br(n){if(Wv(n))return bt(n,Yu)}function ms(n,e){if(!n)return;const t=[],i=D1(n,e);i&&t.push(i);const s=O1(n);return s&&t.push(s),new Oh(t)}function J1(n){if(n==="inline"||n==="popup")return n}function jh(n,e){n.write(e)}const dc=z("ckb");let zz=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(dc()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(dc("l")),this.element.appendChild(i);const s=e.createElement("input");s.classList.add(dc("i")),s.type="checkbox",i.appendChild(s),this.inputElement=s,t.viewProps.bindDisabled(this.inputElement);const r=e.createElement("div");r.classList.add(dc("w")),i.appendChild(r);const o=ed(e,"check");r.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}},qz=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new zz(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked}};function Gz(n){const e=[],t=K_(n.options);return t&&e.push(t),new Oh(e)}Dt({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=bt(e,i=>({options:i.optional.custom(nd),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>X1,constraint:n=>Gz(n.params),writer:n=>jh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&up(i,td);return s?new na(e,{props:new Ce({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new qz(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof na?new F_(n.controller):null}});const Qr=z("col");let Yz=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Qr()),t.foldable.bindExpandedClass(this.element,Qr(void 0,"expanded")),xi(t.foldable,"completed",Va(this.element,Qr(void 0,"cpl")));const i=e.createElement("div");i.classList.add(Qr("h")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Qr("s")),i.appendChild(s),this.swatchElement=s;const r=e.createElement("div");if(r.classList.add(Qr("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(Qr("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};function Xz(n,e,t){const i=et(n/255,0,1),s=et(e/255,0,1),r=et(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u=0,h=0;const c=(l+o)/2;return a!==0&&(h=a/(1-Math.abs(o+l-1)),i===o?u=(s-r)/a:s===o?u=2+(r-i)/a:u=4+(i-s)/a,u=u/6+(u<0?1:0)),[u*360,h*100,c*100]}function Wz(n,e,t){const i=(n%360+360)%360,s=et(e/100,0,1),r=et(t/100,0,1),o=(1-Math.abs(2*r-1))*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o/2;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function Zz(n,e,t){const i=et(n/255,0,1),s=et(e/255,0,1),r=et(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u;a===0?u=0:o===i?u=60*(((s-r)/a%6+6)%6):o===s?u=60*((r-i)/a+2):u=60*((i-s)/a+4);const h=o===0?0:a/o,c=o;return[u,h*100,c*100]}function eS(n,e,t){const i=M1(n,360),s=et(e/100,0,1),r=et(t/100,0,1),o=r*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function Qz(n,e,t){const i=t+e*(100-Math.abs(2*t-100))/200;return[n,i!==0?e*(100-Math.abs(2*t-100))/i:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function Jz(n,e,t){const i=100-Math.abs(t*(200-e)/100-100);return[n,i!==0?e*t/i:0,t*(200-e)/(2*100)]}function $i(n){return[n[0],n[1],n[2]]}function id(n,e){return[n[0],n[1],n[2],e]}const e8={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:Qz,rgb:Wz},hsv:{hsl:Jz,hsv:(n,e,t)=>[n,e,t],rgb:eS},rgb:{hsl:Xz,hsv:Zz,rgb:(n,e,t)=>[n,e,t]}};function ia(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function t8(n,e){return n===e?e:M1(n,e)}function tS(n,e,t){var i;const s=ia(e,t);return[e==="rgb"?et(n[0],0,s[0]):t8(n[0],s[0]),et(n[1],0,s[1]),et(n[2],0,s[2]),et((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function ny(n,e,t,i){const s=ia(e,t),r=ia(e,i);return n.map((o,l)=>o/s[l]*r[l])}function nS(n,e,t){const i=ny(n,e.mode,e.type,"int"),s=e8[e.mode][t.mode](...i);return ny(s,t.mode,"int",t.type)}let he=class iS{static black(){return new iS([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=tS(e,t,this.type)}getComponents(e){return id(nS($i(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const Ws=z("colp");let n8=class{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Ws()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Ws("hsv"));const s=e.createElement("div");s.classList.add(Ws("sv")),this.svPaletteView_=t.svPaletteView,s.appendChild(this.svPaletteView_.element),i.appendChild(s);const r=e.createElement("div");r.classList.add(Ws("h")),this.hPaletteView_=t.hPaletteView,r.appendChild(this.hPaletteView_.element),i.appendChild(r),this.element.appendChild(i);const o=e.createElement("div");if(o.classList.add(Ws("rgb")),this.textsView_=t.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const l=e.createElement("div");l.classList.add(Ws("a"));const a=e.createElement("div");a.classList.add(Ws("ap")),a.appendChild(this.alphaViews_.palette.element),l.appendChild(a);const u=e.createElement("div");u.classList.add(Ws("at")),u.appendChild(this.alphaViews_.text.element),l.appendChild(u),this.element.appendChild(l)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}};function i8(n){return n==="int"?"int":n==="float"?"float":void 0}function H_(n){return bt(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(i8)}),expanded:e.optional.boolean,picker:e.optional.custom(J1),readonly:e.optional.constant(!1)}))}function Eo(n){return n?.1:1}function sS(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}let z_=class{constructor(e,t){this.type="float",this.mode=t,this.comps_=tS(e,t,this.type)}getComponents(e){return id(nS($i(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const s8={int:(n,e)=>new he(n,e),float:(n,e)=>new z_(n,e)};function q_(n,e,t){return s8[t](n,e)}function r8(n){return n.type==="float"}function o8(n){return n.type==="int"}function l8(n){const e=n.getComponents(),t=ia(n.mode,"int");return new he([Math.round(ne(e[0],0,1,0,t[0])),Math.round(ne(e[1],0,1,0,t[1])),Math.round(ne(e[2],0,1,0,t[2])),e[3]],n.mode)}function a8(n){const e=n.getComponents(),t=ia(n.mode,"int");return new z_([ne(e[0],0,t[0],0,1),ne(e[1],0,t[1],0,1),ne(e[2],0,t[2],0,1),e[3]],n.mode)}function Ut(n,e){if(n.type===e)return n;if(o8(n)&&e==="float")return a8(n);if(r8(n)&&e==="int")return l8(n);throw yo.shouldNeverHappen()}function u8(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function zn(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const h8={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function rS(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),i=e[2];return h8[i](t)}function oS(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[zn(e[1],255),zn(e[2],255),zn(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function c8(n){const e=oS(n);return e?new he(e,"rgb"):null}function lS(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[zn(e[1],255),zn(e[2],255),zn(e[3],255),zn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function p8(n){const e=lS(n);return e?new he(e,"rgb"):null}function aS(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[rS(e[1]),zn(e[2],100),zn(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function d8(n){const e=aS(n);return e?new he(e,"hsl"):null}function uS(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[rS(e[1]),zn(e[2],100),zn(e[3],100),zn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function m8(n){const e=uS(n);return e?new he(e,"hsl"):null}function hS(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function v8(n){const e=hS(n);return e?new he(e,"rgb"):null}function cS(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),ne(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),ne(parseInt(t[4],16),0,255,0,1)]:null}function f8(n){const e=cS(n);return e?new he(e,"rgb"):null}function pS(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function w8(n){return e=>{const t=pS(e);return t?q_(t,"rgb",n):null}}function dS(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function _8(n){return e=>{const t=dS(e);return t?q_(t,"rgb",n):null}}const b8=[{parser:hS,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:cS,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:oS,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:lS,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:aS,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:uS,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:pS,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:dS,result:{alpha:!0,mode:"rgb",notation:"object"}}];function g8(n){return b8.reduce((e,{parser:t,result:i})=>e||(t(n)?i:null),null)}function C8(n,e="int"){const t=g8(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function Nh(n){const e=[v8,f8,c8,p8,d8,m8];e.push(w8("int"),_8("int"));const t=Rz(e);return i=>{const s=t(i);return s?Ut(s,n):null}}function P8(n){const e=Nh("int");if(typeof n!="string")return he.black();const t=e(n);return t??he.black()}function mS(n){const e=et(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function G_(n,e="#"){const t=$i(n.getComponents("rgb")).map(mS).join("");return`${e}${t}`}function Y_(n,e="#"){const t=n.getComponents("rgb"),i=[t[0],t[1],t[2],t[3]*255].map(mS).join("");return`${e}${i}`}function vS(n){const e=hn(0),t=Ut(n,"int");return`rgb(${$i(t.getComponents("rgb")).map(s=>e(s)).join(", ")})`}function Tc(n){const e=hn(2),t=hn(0);return`rgba(${Ut(n,"int").getComponents("rgb").map((r,o)=>(o===3?e:t)(r)).join(", ")})`}function y8(n){const e=[hn(0),hp,hp],t=Ut(n,"int");return`hsl(${$i(t.getComponents("hsl")).map((s,r)=>e[r](s)).join(", ")})`}function E8(n){const e=[hn(0),hp,hp,hn(2)];return`hsla(${Ut(n,"int").getComponents("hsl").map((s,r)=>e[r](s)).join(", ")})`}function fS(n,e){const t=hn(e==="float"?2:0),i=["r","g","b"],s=Ut(n,e);return`{${$i(s.getComponents("rgb")).map((o,l)=>`${i[l]}: ${t(o)}`).join(", ")}}`}function x8(n){return e=>fS(e,n)}function wS(n,e){const t=hn(2),i=hn(e==="float"?2:0),s=["r","g","b","a"];return`{${Ut(n,e).getComponents("rgb").map((l,a)=>{const u=a===3?t:i;return`${s[a]}: ${u(l)}`}).join(", ")}}`}function $8(n){return e=>wS(e,n)}const V8=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:G_},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Y_},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:vS},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:Tc},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:y8},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:E8},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:x8(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:$8(e)}],[])];function _S(n){return V8.reduce((e,t)=>e||(u8(t.format,n)?t.stringifier:null),null)}const ru=z("apl");let k8=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(ru()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(ru("b")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(ru("c")),i.appendChild(s),this.colorElem_=s;const r=e.createElement("div");r.classList.add(ru("m")),this.element.appendChild(r),this.markerElem_=r;const o=e.createElement("div");o.classList.add(ru("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new he([t[0],t[1],t[2],0],"rgb"),s=new he([t[0],t[1],t[2],255],"rgb"),r=["to right",Tc(i),Tc(s)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=Tc(e);const o=ne(t[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}},S8=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new k8(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Go(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,s=this.value.rawValue,[r,o,l]=s.getComponents("hsv");this.value.setRawValue(new he([r,o,l,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=nn(Eo(!0),Ms(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new he([s,r,o,l+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){nn(Eo(!0),Ms(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const ll=z("coltxt");function L8(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((i,s)=>{const r=n.createElement("option");return r.textContent=s.text,r.value=s.value,i.appendChild(r),i},n.createDocumentFragment())),e}let A8=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ll()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(ll("m")),this.modeElem_=L8(e),this.modeElem_.classList.add(ll("ms")),i.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const s=e.createElement("div");s.classList.add(ll("mm")),s.appendChild(ed(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(ll("w")),this.element.appendChild(r),this.inputsElem_=r,this.inputViews_=t.inputViews,this.applyInputViews_(),Ps(t.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){I1(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const i=e.createElement("div");i.classList.add(ll("c")),i.appendChild(t.element),this.inputsElem_.appendChild(i)})}};function M8(n){return hn(n==="float"?2:0)}function T8(n,e,t){const i=ia(n,e)[t];return new Qp({min:0,max:i})}function D8(n,e,t){return new Rh(n,{arrayPosition:t===0?"fst":t===2?"lst":"mid",parser:e.parser,props:Ce.fromObject({formatter:M8(e.colorType),keyScale:Eo(!1),pointerScale:e.colorType==="float"?.01:1}),value:ct(0,{constraint:T8(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function O8(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:Nr,viewProps:e.viewProps};return[0,1,2].map(i=>{const s=D8(n,t,i);return ka({primary:e.value,secondary:s.value,forward(r){return Ut(r,e.colorType).getComponents(e.colorMode)[i]},backward(r,o){const l=e.colorMode,u=Ut(r,e.colorType).getComponents(l);u[i]=o;const h=q_(id($i(u),u[3]),l,e.colorType);return Ut(h,"int")}}),s})}function R8(n,e){const t=new U_(n,{parser:Nh("int"),props:Ce.fromObject({formatter:G_}),value:ct(he.black()),viewProps:e.viewProps});return ka({primary:e.value,secondary:t.value,forward:i=>new he($i(i.getComponents()),i.mode),backward:(i,s)=>new he(id($i(s.getComponents(i.mode)),i.getComponents()[3]),i.mode)}),[t]}function j8(n){return n!=="hex"}let N8=class{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=ct(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new A8(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return j8(t)?O8(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):R8(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(i=>i.view)}};const Tm=z("hpl");let B8=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Tm()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Tm("c")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Tm("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=vS(new he([t,100,100],"hsv"));const i=ne(t,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}},I8=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new B8(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Go(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=ne(et(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),s=this.value.rawValue,[,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new he([i,r,o,l],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=nn(Eo(!1),Ms(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new he([s+t,r,o,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){nn(Eo(!1),Ms(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const Dm=z("svp"),iy=64;let F8=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Dm()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=iy,i.width=iy,i.classList.add(Dm("c")),this.element.appendChild(i),this.canvasElement=i;const s=e.createElement("div");s.classList.add(Dm("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=ZH(this.canvasElement);if(!e)return;const i=this.value.rawValue.getComponents("hsv"),s=this.canvasElement.width,r=this.canvasElement.height,o=e.getImageData(0,0,s,r),l=o.data;for(let h=0;h<r;h++)for(let c=0;c<s;c++){const d=ne(c,0,s,0,100),p=ne(h,0,r,100,0),v=eS(i[0],d,p),m=(h*s+c)*4;l[m]=v[0],l[m+1]=v[1],l[m+2]=v[2],l[m+3]=255}e.putImageData(o,0,0);const a=ne(i[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const u=ne(i[2],0,100,100,0);this.markerElem_.style.top=`${u}%`}onValueChange_(){this.update_()}},K8=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new F8(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Go(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=ne(e.point.x,0,e.bounds.width,0,100),s=ne(e.point.y,0,e.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new he([r,i,s,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){Z1(e.key)&&e.preventDefault();const[t,i,s,r]=this.value.rawValue.getComponents("hsv"),o=Eo(!1),l=nn(o,Ms(e)),a=nn(o,Gu(e));l===0&&a===0||this.value.setRawValue(new he([t,i+l,s+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=Eo(!1),i=nn(t,Ms(e)),s=nn(t,Gu(e));i===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},U8=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new I8(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new K8(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new S8(e,{value:this.value,viewProps:this.viewProps}),text:new Rh(e,{parser:Nr,props:Ce.fromObject({pointerScale:.01,keyScale:.1,formatter:hn(2)}),value:ct(0,{constraint:new Qp({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&ka({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.getComponents()[3],backward:(i,s)=>{const r=i.getComponents();return r[3]=s,new he(r,i.mode)}}),this.textsC_=new N8(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new n8(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}};const Om=z("colsw");let H8=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(Om()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Om("sw")),this.element.appendChild(i),this.swatchElem_=i;const s=e.createElement("button");s.classList.add(Om("b")),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=Y_(e)}onValueChange_(){this.update_()}},z8=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new H8(e,{value:this.value,viewProps:this.viewProps})}},X_=class{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=N_.create(t.expanded),this.swatchC_=new z8(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new U_(e,{parser:t.parser,props:Ce.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new Yz(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new Y1(e,{viewProps:this.viewProps}):null;const s=new U8(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),ka({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),B_(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=F1(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!M_(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}};function q8(n){return $i(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function G8(n){return n.getComponents("rgb").reduce((e,t,i)=>{const s=Math.floor(i===3?t*255:t)&255;return e<<8|s},0)>>>0}function Y8(n){return new he([n>>16&255,n>>8&255,n&255],"rgb")}function X8(n){return new he([n>>24&255,n>>16&255,n>>8&255,ne(n&255,0,255,0,1)],"rgb")}function W8(n){return typeof n!="number"?he.black():Y8(n)}function Z8(n){return typeof n!="number"?he.black():X8(n)}function Dc(n,e){return typeof n!="object"||De(n)?!1:e in n&&typeof n[e]=="number"}function bS(n){return Dc(n,"r")&&Dc(n,"g")&&Dc(n,"b")}function gS(n){return bS(n)&&Dc(n,"a")}function CS(n){return bS(n)}function W_(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),i=e.getComponents();for(let s=0;s<t.length;s++)if(t[s]!==i[s])return!1;return!0}function sy(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function Q8(n){const e=_S(n);return e?(t,i)=>{jh(t,e(i))}:null}function J8(n){const e=n?G8:q8;return(t,i)=>{jh(t,e(i))}}function eq(n,e,t){const s=Ut(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b),n.writeProperty("a",s.a)}function tq(n,e,t){const s=Ut(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b)}function nq(n,e){return(t,i)=>{n?eq(t,i,e):tq(t,i,e)}}function iq(n){var e;return!!(!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function sq(n){return n?e=>Y_(e,"0x"):e=>G_(e,"0x")}function rq(n){return"color"in n||n.view==="color"}Dt({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!rq(e))return null;const t=H_(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:iq(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?Z8:W8,equals:W_,writer:n=>J8(n.params.supportsAlpha)},controller:n=>{var e,t;return new X_(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:sq(n.params.supportsAlpha),parser:Nh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function oq(n,e){if(!CS(n))return Ut(he.black(),e);if(e==="int"){const t=sy(n);return new he(t,"rgb")}if(e==="float"){const t=sy(n);return new z_(t,"rgb")}return Ut(he.black(),"int")}function lq(n){return gS(n)}function aq(n){return e=>{const t=oq(e,n);return Ut(t,"int")}}function uq(n,e){return t=>n?wS(t,e):fS(t,e)}Dt({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!CS(n))return null;const i=H_(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{colorType:(t=sS(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>aq(n.params.colorType),equals:W_,writer:n=>nq(lq(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const i=gS(n.initialValue);return new X_(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:uq(i,n.params.colorType),parser:Nh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:i,value:n.value,viewProps:n.viewProps})}});Dt({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=C8(n,sS(e));if(!t)return null;const i=_S(t);if(!i)return null;const s=H_(e);return s?{initialValue:n,params:Object.assign(Object.assign({},s),{format:t,stringifier:i})}:null},binding:{reader:()=>P8,equals:W_,writer:n=>{const e=Q8(n.params.format);if(!e)throw yo.notBindable();return e}},controller:n=>{var e,t;return new X_(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:Nh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});let Z_=class{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((i,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(i))!==null&&o!==void 0?o:i});return this.asm_.fromComponents(t)}};const ry=z("pndtxt");let hq=class{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(ry()),this.textViews.forEach(i=>{const s=e.createElement("div");s.classList.add(ry("a")),s.appendChild(i.element),this.element.appendChild(s)})}};function cq(n,e,t){return new Rh(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:ct(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}let Q_=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((i,s)=>cq(e,t,s)),this.acs_.forEach((i,s)=>{ka({primary:this.value,secondary:i.value,forward:r=>t.assembly.toComponents(r)[s],backward:(r,o)=>{const l=t.assembly.toComponents(r);return l[s]=o,t.assembly.fromComponents(l)}})}),this.view=new hq(e,{textViews:this.acs_.map(i=>i.view)})}get textControllers(){return this.acs_}},pq=class extends A_{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}};function dq(n,e){const t=[],i=D1(n,e);i&&t.push(i);const s=O1(n);s&&t.push(s);const r=K_(n.options);return r&&t.push(r),new Oh(t)}Dt({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=bt(e,i=>Object.assign(Object.assign({},j1(i)),{options:i.optional.custom(nd),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>A1,constraint:n=>dq(n.params,n.initialValue),writer:n=>jh},controller:n=>{const e=n.value,t=n.constraint,i=t&&up(t,td);if(i)return new na(n.document,{props:new Ce({options:i.values.value("options")}),value:e,viewProps:n.viewProps});const s=R1(n.params,e.rawValue),r=t&&up(t,Qp);return r?new ty(n.document,Object.assign(Object.assign({},Uz(Object.assign(Object.assign({},s),{keyScale:ct(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:Nr,value:e,viewProps:n.viewProps})):new Rh(n.document,{parser:Nr,props:Ce.fromObject(s),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof ty?new pq(n.controller):n.controller.valueController instanceof na?new F_(n.controller):null}});let Vr=class{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(De(e))return!1;const t=e.x,i=e.y;return!(typeof t!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}};const PS={toComponents:n=>n.getComponents(),fromComponents:n=>new Vr(...n)},al=z("p2d");let mq=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(al()),t.viewProps.bindClassModifiers(this.element),Ps(t.expanded,Va(this.element,al(void 0,"expanded")));const i=e.createElement("div");i.classList.add(al("h")),this.element.appendChild(i);const s=e.createElement("button");s.classList.add(al("b")),s.appendChild(ed(e,"p2dpad")),t.viewProps.bindDisabled(s),i.appendChild(s),this.buttonElement=s;const r=e.createElement("div");if(r.classList.add(al("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(al("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};const Zs=z("p2dp");let vq=class{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(Zs()),t.layout==="popup"&&this.element.classList.add(Zs(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Zs("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=e.createElementNS(mi,"svg");s.classList.add(Zs("g")),this.padElement.appendChild(s),this.svgElem_=s;const r=e.createElementNS(mi,"line");r.classList.add(Zs("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=e.createElementNS(mi,"line");o.classList.add(Zs("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const l=e.createElementNS(mi,"line");l.classList.add(Zs("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const a=e.createElement("div");a.classList.add(Zs("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.props_.get("max"),s=ne(e,-i,+i,0,100),r=ne(t,-i,+i,0,100),o=this.props_.get("invertsY")?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${s}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${s}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}};function oy(n,e,t){return[nn(e[0],Ms(n)),nn(e[1],Gu(n))*(t?1:-1)]}let fq=class{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new vq(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Go(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.props.get("max"),s=ne(e.point.x,0,e.bounds.width,-i,+i),r=ne(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new Vr(s,r),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){Z1(e.key)&&e.preventDefault();const[t,i]=oy(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(new Vr(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=oy(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},wq=class{constructor(e,t){var i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=N_.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new Y1(e,{viewProps:this.viewProps}):null;const r=new fq(e,{layout:t.pickerLayout,props:new Ce({invertsY:ct(t.invertsY),max:ct(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.textC_=new Q_(e,{assembly:PS,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new mq(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),ka({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),B_(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=F1(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!M_(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}};function _q(n){return Vr.isObject(n)?new Vr(n.x,n.y):new Vr}function bq(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function gq(n,e){return new Z_({assembly:PS,components:[ms(Object.assign(Object.assign({},n),n.x),e.x),ms(Object.assign(Object.assign({},n),n.y),e.y)]})}function ly(n,e){var t,i;if(!De(n.min)||!De(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((i=n.max)!==null&&i!==void 0?i:0));const s=T1(n);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function Cq(n,e){var t,i;const s=ly(Po(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),r=ly(Po(n,(i=n.y)!==null&&i!==void 0?i:{}),e.y);return Math.max(s,r)}function Pq(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}Dt({id:"input-point2d",type:"input",accept:(n,e)=>{if(!Vr.isObject(n))return null;const t=bt(e,i=>Object.assign(Object.assign({},Yu(i)),{expanded:i.optional.boolean,picker:i.optional.custom(J1),readonly:i.optional.constant(!1),x:i.optional.custom(br),y:i.optional.object(Object.assign(Object.assign({},Yu(i)),{inverted:i.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>_q,constraint:n=>gq(n.params,n.initialValue),equals:Vr.equals,writer:()=>bq},controller:n=>{var e,t;const i=n.document,s=n.value,r=n.constraint,o=[n.params.x,n.params.y];return new wq(i,{axes:s.rawValue.getComponents().map((l,a)=>{var u;return S_({constraint:r.components[a],initialValue:l,params:Po(n.params,(u=o[a])!==null&&u!==void 0?u:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:Pq(n.params),max:Cq(n.params,s.rawValue),parser:Nr,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:n.viewProps})}});let Nl=class{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(De(e))return!1;const t=e.x,i=e.y,s=e.z;return!(typeof t!="number"||typeof i!="number"||typeof s!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}};const yS={toComponents:n=>n.getComponents(),fromComponents:n=>new Nl(...n)};function yq(n){return Nl.isObject(n)?new Nl(n.x,n.y,n.z):new Nl}function Eq(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function xq(n,e){return new Z_({assembly:yS,components:[ms(Object.assign(Object.assign({},n),n.x),e.x),ms(Object.assign(Object.assign({},n),n.y),e.y),ms(Object.assign(Object.assign({},n),n.z),e.z)]})}Dt({id:"input-point3d",type:"input",accept:(n,e)=>{if(!Nl.isObject(n))return null;const t=bt(e,i=>Object.assign(Object.assign({},Yu(i)),{readonly:i.optional.constant(!1),x:i.optional.custom(br),y:i.optional.custom(br),z:i.optional.custom(br)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>yq,constraint:n=>xq(n.params,n.initialValue),equals:Nl.equals,writer:n=>Eq},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z];return new Q_(n.document,{assembly:yS,axes:e.rawValue.getComponents().map((s,r)=>{var o;return S_({constraint:t.components[r],initialValue:s,params:Po(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Nr,value:e,viewProps:n.viewProps})}});let Bl=class{constructor(e=0,t=0,i=0,s=0){this.x=e,this.y=t,this.z=i,this.w=s}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(De(e))return!1;const t=e.x,i=e.y,s=e.z,r=e.w;return!(typeof t!="number"||typeof i!="number"||typeof s!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}};const ES={toComponents:n=>n.getComponents(),fromComponents:n=>new Bl(...n)};function $q(n){return Bl.isObject(n)?new Bl(n.x,n.y,n.z,n.w):new Bl}function Vq(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function kq(n,e){return new Z_({assembly:ES,components:[ms(Object.assign(Object.assign({},n),n.x),e.x),ms(Object.assign(Object.assign({},n),n.y),e.y),ms(Object.assign(Object.assign({},n),n.z),e.z),ms(Object.assign(Object.assign({},n),n.w),e.w)]})}Dt({id:"input-point4d",type:"input",accept:(n,e)=>{if(!Bl.isObject(n))return null;const t=bt(e,i=>Object.assign(Object.assign({},Yu(i)),{readonly:i.optional.constant(!1),w:i.optional.custom(br),x:i.optional.custom(br),y:i.optional.custom(br),z:i.optional.custom(br)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>$q,constraint:n=>kq(n.params,n.initialValue),equals:Bl.equals,writer:n=>Vq},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z,n.params.w];return new Q_(n.document,{assembly:ES,axes:e.rawValue.getComponents().map((s,r)=>{var o;return S_({constraint:t.components[r],initialValue:s,params:Po(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Nr,value:e,viewProps:n.viewProps})}});function Sq(n){const e=[],t=K_(n.options);return t&&e.push(t),new Oh(e)}Dt({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=bt(e,i=>({readonly:i.optional.constant(!1),options:i.optional.custom(nd)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>W1,constraint:n=>Sq(n.params),writer:n=>jh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&up(i,td);return s?new na(e,{props:new Ce({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new U_(e,{parser:r=>r,props:Ce.fromObject({formatter:ef}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof na?new F_(n.controller):null}});const sd={monitor:{defaultInterval:200,defaultRows:3}},ay=z("mll");let Lq=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(ay()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(ay("i")),i.style.height=`calc(var(${Q1("containerUnitSize")}) * ${t.rows})`,i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach(s=>{s!==void 0&&i.push(this.formatter_(s))}),e.textContent=i.join(`
`),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}},J_=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Lq(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}};const uy=z("sgl");let Aq=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(uy()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(uy("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}},eb=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Aq(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}};Dt({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=bt(e,i=>({readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>X1},controller:n=>{var e;return n.value.rawValue.length===1?new eb(n.document,{formatter:ey,value:n.value,viewProps:n.viewProps}):new J_(n.document,{formatter:ey,rows:(e=n.params.rows)!==null&&e!==void 0?e:sd.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});let Mq=class extends A_{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}};const Qs=z("grl");let Tq=class{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Qs()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(mi,"svg");i.classList.add(Qs("g")),i.style.height=`calc(var(${Q1("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(mi,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=e.createElement("div");r.classList.add(Qs("t"),z("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,i=this.props_.get("min"),s=this.props_.get("max"),r=[];this.value.rawValue.forEach((h,c)=>{if(h===void 0)return;const d=ne(c,0,t,0,e.width),p=ne(h,i,s,e.height,0);r.push([d,p].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,l=this.value.rawValue[this.cursor_.rawValue];if(l===void 0){o.classList.remove(Qs("t","a"));return}const a=ne(this.cursor_.rawValue,0,t,0,e.width),u=ne(l,i,s,e.height,0);o.style.left=`${a}px`,o.style.top=`${u}px`,o.textContent=`${this.formatter_(l)}`,o.classList.contains(Qs("t","a"))||(o.classList.add(Qs("t","a"),Qs("t","in")),ap(o),o.classList.remove(Qs("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}},xS=class{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=ct(-1),this.view=new Tq(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!M_(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new Go(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return Ui(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return Hi(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(ne(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(ne(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}};function tf(n){return De(n.format)?hn(2):n.format}function Dq(n){var e;return n.value.rawValue.length===1?new eb(n.document,{formatter:tf(n.params),value:n.value,viewProps:n.viewProps}):new J_(n.document,{formatter:tf(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:sd.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function Oq(n){var e,t,i;return new xS(n.document,{formatter:tf(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:sd.monitor.defaultRows,props:Ce.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(i=n.params.min)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function hy(n){return n.view==="graph"}Dt({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=bt(e,i=>({format:i.optional.function,max:i.optional.number,min:i.optional.number,readonly:i.required.constant(!0),rows:i.optional.number,view:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>hy(n)?64:1,reader:n=>A1},controller:n=>hy(n.params)?Oq(n):Dq(n),api:n=>n.controller.valueController instanceof xS?new Mq(n.controller):null});Dt({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=bt(e,i=>({multiline:i.optional.boolean,readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>W1},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new J_(n.document,{formatter:ef,rows:(e=n.params.rows)!==null&&e!==void 0?e:sd.monitor.defaultRows,value:t,viewProps:n.viewProps}):new eb(n.document,{formatter:ef,value:t,viewProps:n.viewProps})}});function Rq(){const n=`
	<svg width="320" height="50" xmlns="http://www.w3.org/2000/svg">
  <style>
    text {
      font-family: "Menlo", monospace;
      font-size: 12px;
			fill: gray;
    }
  </style>
  <text x="50%" y="55%" text-anchor="middle">
    No Image
  </text>
</svg>`,e=new Blob([n],{type:"image/svg+xml"}),t=new Image;return t.src=URL.createObjectURL(e),t}function cy(n){const e=new Image;return e.crossOrigin="anonymous",e.src=n,e}const Jr=z("img");class jq{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Jr()),t.viewProps.bindClassModifiers(this.element),this.input=e.createElement("input"),this.input.classList.add(Jr("input")),this.input.setAttribute("type","file"),this.input.setAttribute("accept",t.extensions.join(",")),this.image_=e.createElement("img"),this.image_.id="tpimg_"+Math.random().toString(36).slice(2),this.image_.classList.add(Jr("image")),this.image_.classList.add(Jr(`image_${t.imageFit}`)),this.image_.crossOrigin="anonymous",this.image_.onclick=i=>{t.clickCallback?t.clickCallback(i,this.input):this.input.click()},this.element.classList.add(Jr("area_root")),this.element.appendChild(this.image_),this.element.appendChild(this.input)}changeImage(e){this.image_.src=e}changeDraggingState(e){const t=this.element;e?t==null||t.classList.add(Jr("area_dragging")):t==null||t.classList.remove(Jr("area_dragging"))}}let Rm=null;class Nq{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new jq(e,{viewProps:this.viewProps,extensions:t.extensions,imageFit:t.imageFit,clickCallback:t.clickCallback}),this.onFile=this.onFile.bind(this),this.onDrop=this.onDrop.bind(this),this.onDragStart=this.onDragStart.bind(this),this.onDragOver=this.onDragOver.bind(this),this.onDragLeave=this.onDragLeave.bind(this),this.view.input.addEventListener("change",this.onFile),this.view.element.addEventListener("drop",this.onDrop),this.view.element.addEventListener("dragstart",this.onDragStart),this.view.element.addEventListener("dragover",this.onDragOver),this.view.element.addEventListener("dragleave",this.onDragLeave),this.viewProps.handleDispose(()=>{this.view.input.removeEventListener("change",this.onFile),this.view.element.removeEventListener("drop",this.onDrop),this.view.element.removeEventListener("dragstart",this.onDragStart),this.view.element.removeEventListener("dragover",this.onDragOver),this.view.element.removeEventListener("dragleave",this.onDragLeave)}),this.value.emitter.on("change",()=>this.handleValueChange()),this.handleValueChange()}onFile(e){const t=(e==null?void 0:e.target).files;if(!t||!t.length)return;const i=t[0];this.setValue(i)}onDrop(e){e.preventDefault();try{const{dataTransfer:t}=e,i=t==null?void 0:t.files[0];if(i)this.setValue(i);else{const s=t==null?void 0:t.getData("img-id");if(s){const r=document.getElementById(s);this.setValue(r)}else{const r=t==null?void 0:t.getData("url");if(!r)throw new Error("No url");this.setValue(r)}}}catch(t){console.error("Could not parse the dropped image",t)}finally{this.view.changeDraggingState(!1)}}onDragStart(e){var t,i;(t=e.dataTransfer)===null||t===void 0||t.setData("img-id",this.view.image_.id),(i=e.dataTransfer)===null||i===void 0||i.setDragImage(this.view.image_,0,0)}onDragOver(e){e.preventDefault(),this.view.changeDraggingState(!0)}onDragLeave(){this.view.changeDraggingState(!1)}handleImage(e){e instanceof HTMLImageElement?this.updateImage(e.src):typeof e=="string"||!e?((e==="placeholder"||!e)&&(e=this.handlePlaceholderImage().src),this.updateImage(e)):this.setValue(e)}updateImage(e){this.view.changeImage(e)}setValue(e){if(e instanceof HTMLImageElement)this.value.setRawValue(e);else if(e instanceof File){const t=URL.createObjectURL(e)+"#"+e.name;e.src=t;const i=cy(t);this.value.setRawValue(i||e)}else e?this.value.setRawValue(cy(e)):this.value.setRawValue(this.handlePlaceholderImage())}handleValueChange(){this.handleImage(this.value.rawValue)}handlePlaceholderImage(){return Rm||(Rm=Rq()),Rm}}const Bq=[".jpg",".png",".gif"];Dt({id:"input-image",type:"input",accept(n,e){if(!(n instanceof HTMLImageElement||typeof n=="string"))return null;const t=bt(e,i=>({view:i.required.constant("input-image"),acceptUrl:i.optional.boolean,clickCallback:i.optional.function,imageFit:i.optional.custom(s=>s==="contain"||s==="cover"?s:void 0),extensions:i.optional.array(i.required.string)}));return t?{initialValue:n,params:t}:null},binding:{reader(n){return e=>e.src!==void 0?e.src===""?"placeholder":e.src:e},writer(n){return(e,t)=>{e.write(t)}}},controller(n){var e,t;return new Nq(n.document,{value:n.value,imageFit:(e=n.params.imageFit)!==null&&e!==void 0?e:"cover",clickCallback:n.params.clickCallback,viewProps:n.viewProps,extensions:(t=n.params.extensions)!==null&&t!==void 0?t:Bq})}});function Oe(n){return n==null}function tb(n){return n!==null&&typeof n=="object"}function nf(n){return n!==null&&typeof n=="object"}function Iq(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function xo(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((i,s)=>{const r=n[s],o=e[s];return nf(r)&&nf(o)?Object.assign(Object.assign({},i),{[s]:xo(r,o)}):Object.assign(Object.assign({},i),{[s]:s in e?o:r})},{})}function Fq(n){return tb(n)?"target"in n:!1}const Kq={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};let $o=class kl{static alreadyDisposed(){return new kl({type:"alreadydisposed"})}static notBindable(){return new kl({type:"notbindable"})}static notCompatible(e,t){return new kl({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new kl({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new kl({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=Kq[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}},py=class $S{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const i=this.read();if(!$S.isBindable(i))throw $o.notBindable();if(!(e in i))throw $o.propertyNotFound(e);i[e]=t}},En=class{constructor(){this.observers_={}}on(e,t){let i=this.observers_[e];return i||(i=this.observers_[e]=[]),i.push({handler:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter(s=>s.handler!==t)),this}emit(e,t){const i=this.observers_[e];i&&i.forEach(s=>{s.handler(t)})}},Uq=class{constructor(e,t){var i;this.constraint_=t==null?void 0:t.constraint,this.equals_=(i=t==null?void 0:t.equals)!==null&&i!==void 0?i:(s,r)=>s===r,this.emitter=new En,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,r=this.rawValue_;this.equals_(r,s)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:i,previousRawValue:r,rawValue:s,sender:this}))}},Hq=class{constructor(e){this.emitter=new En,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.value_;s===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:this.value_,sender:this}))}},zq=class{constructor(e){this.emitter=new En,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}};function rt(n,e){const t=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!t&&!i?new Hq(n):new Uq(n,e)}function qq(n){return[new zq(n),(e,t)=>{n.setRawValue(e,t)}]}let W=class VS{constructor(e){this.emitter=new En,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((i,s)=>Object.assign(i,{[s]:rt(e[s])}),{})}static fromObject(e){const t=this.createCore(e);return new VS(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}},rd=class{constructor(e){this.values=W.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(e,i),t)}},Gq=class{constructor(e){this.values=W.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");let s=e;return Oe(i)||(s=Math.max(s,i)),Oe(t)||(s=Math.min(s,t)),s}},Yq=class{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,i=Math.round((e-t)/this.step);return t+i*this.step}},Xq=class{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}};const Wq={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};let Zq=class{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=Wq[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}};const Qq={"+":n=>n,"-":n=>-n,"~":n=>~n};let Jq=class{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=Qq[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}};function nb(n){return(e,t)=>{for(let i=0;i<n.length;i++){const s=n[i](e,t);if(s!=="")return s}return""}}function Xu(n,e){var t;const i=n.substr(e).match(/^\s+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function e7(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function Wu(n,e){var t;const i=n.substr(e).match(/^[0-9]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function t7(n,e){const t=Wu(n,e);if(t!=="")return t;const i=n.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";const s=Wu(n,e);return s===""?"":i+s}function ib(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const i=t7(n,e);return i===""?"":t+i}function kS(n,e){const t=n.substr(e,1);if(t==="0")return t;const i=e7(n,e);return e+=i.length,i===""?"":i+Wu(n,e)}function n7(n,e){const t=kS(n,e);if(e+=t.length,t==="")return"";const i=n.substr(e,1);if(e+=i.length,i!==".")return"";const s=Wu(n,e);return e+=s.length,t+i+s+ib(n,e)}function i7(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const i=Wu(n,e);return e+=i.length,i===""?"":t+i+ib(n,e)}function s7(n,e){const t=kS(n,e);return e+=t.length,t===""?"":t+ib(n,e)}const r7=nb([n7,i7,s7]);function o7(n,e){var t;const i=n.substr(e).match(/^[01]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function l7(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const i=o7(n,e);return i===""?"":t+i}function a7(n,e){var t;const i=n.substr(e).match(/^[0-7]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function u7(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const i=a7(n,e);return i===""?"":t+i}function h7(n,e){var t;const i=n.substr(e).match(/^[0-9a-f]+/i);return(t=i&&i[0])!==null&&t!==void 0?t:""}function c7(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const i=h7(n,e);return i===""?"":t+i}const p7=nb([l7,u7,c7]),d7=nb([p7,r7]);function m7(n,e){const t=d7(n,e);return e+=t.length,t===""?null:{evaluable:new Xq(t),cursor:e}}function v7(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const i=LS(n,e);if(!i)return null;e=i.cursor,e+=Xu(n,e).length;const s=n.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:i.evaluable,cursor:e}}function f7(n,e){var t;return(t=m7(n,e))!==null&&t!==void 0?t:v7(n,e)}function SS(n,e){const t=f7(n,e);if(t)return t;const i=n.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const s=SS(n,e);return s?(e=s.cursor,{cursor:e,evaluable:new Jq(i,s.evaluable)}):null}function w7(n,e,t){t+=Xu(e,t).length;const i=n.filter(s=>e.startsWith(s,t))[0];return i?(t+=i.length,t+=Xu(e,t).length,{cursor:t,operator:i}):null}function _7(n,e){return(t,i)=>{const s=n(t,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const o=w7(e,t,i);if(!o)break;i=o.cursor;const l=n(t,i);if(!l)return null;i=l.cursor,r=new Zq(o.operator,r,l.evaluable)}return r?{cursor:i,evaluable:r}:null}}const b7=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>_7(n,e),SS);function LS(n,e){return e+=Xu(n,e).length,b7(n,e)}function g7(n){const e=LS(n,0);return!e||e.cursor+Xu(n,e.cursor).length!==n.length?null:e.evaluable}function Vi(n){var e;const t=g7(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function od(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=Vi(n);if(!Oe(e))return e}return 0}function kt(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function ie(n,e,t,i,s){const r=(n-e)/(t-e);return i+r*(s-i)}function sf(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function We(n,e,t){return Math.min(Math.max(n,e),t)}function AS(n,e){return(n%e+e)%e}function C7(n,e){return Oe(n.step)?Math.max(sf(e),2):sf(n.step)}function MS(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function P7(n,e){var t;const i=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function sb(n,e){return Oe(n.step)?null:new Yq(n.step,e)}function rb(n){return!Oe(n.max)&&!Oe(n.min)?new rd({max:n.max,min:n.min}):!Oe(n.max)||!Oe(n.min)?new Gq({max:n.max,min:n.min}):null}function ld(n,e){var t,i,s;return{formatter:(t=n.format)!==null&&t!==void 0?t:kt(C7(n,e)),keyScale:(i=n.keyScale)!==null&&i!==void 0?i:MS(n),pointerScale:(s=n.pointerScale)!==null&&s!==void 0?s:P7(n,e)}}function ad(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function ob(n){return{constraint:n.constraint,textProps:W.fromObject(ld(n.params,n.initialValue))}}let lb=class{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}},ud=class{constructor(e){this.target=e}},TS=class extends ud{constructor(e,t,i){super(e),this.value=t,this.last=i??!0}},y7=class extends ud{constructor(e,t){super(e),this.expanded=t}},E7=class extends ud{constructor(e,t){super(e),this.index=t}},ab=class extends lb{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new En,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new TS(this,t.binding.target.read(),e.options.last))}};function x7(n,e){const i=Object.keys(e).reduce((s,r)=>{if(s===void 0)return;const o=e[r],l=o(n[r]);return l.succeeded?Object.assign(Object.assign({},s),{[r]:l.value}):void 0},{});return i}function $7(n,e){return n.reduce((t,i)=>{if(t===void 0)return;const s=e(i);if(!(!s.succeeded||s.value===void 0))return[...t,s.value]},[])}function V7(n){return n===null?!1:typeof n=="object"}function os(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const i=n(t);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function dy(n){return{custom:e=>os(e)(n),boolean:os(e=>typeof e=="boolean"?e:void 0)(n),number:os(e=>typeof e=="number"?e:void 0)(n),string:os(e=>typeof e=="string"?e:void 0)(n),function:os(e=>typeof e=="function"?e:void 0)(n),constant:e=>os(t=>t===e?e:void 0)(n),raw:os(e=>e)(n),object:e=>os(t=>{if(V7(t))return x7(t,e)})(n),array:e=>os(t=>{if(Array.isArray(t))return $7(t,e)})(n)}}const rf={optional:dy(!0),required:dy(!1)};function vt(n,e){const t=e(rf),i=rf.required.object(t)(n);return i.succeeded?i.value:void 0}function zi(n,e,t,i){if(e&&!e(n))return!1;const s=vt(n,t);return s?i(s):!1}function qi(n,e){var t;return xo((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function Oc(n){return"value"in n}function k7(n){if(!tb(n)||!("binding"in n))return!1;const e=n.binding;return Fq(e)}const bn="http://www.w3.org/2000/svg";function cp(n){n.offsetHeight}function S7(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function ub(n){return n.ontouchstart!==void 0}function L7(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const A7={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function hd(n,e){const t=n.createElementNS(bn,"svg");return t.innerHTML=A7[e],t}function DS(n,e,t){n.insertBefore(e,n.children[t])}function Zu(n){n.parentElement&&n.parentElement.removeChild(n)}function OS(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function M7(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function RS(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function ys(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function ki(n,e,t){ys(n.value(e),t)}const T7="tp";function j(n){return(t,i)=>[T7,"-",n,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}const ou=j("lbl");function D7(n,e){const t=n.createDocumentFragment();return e.split(`
`).map(s=>n.createTextNode(s)).forEach((s,r)=>{r>0&&t.appendChild(n.createElement("br")),t.appendChild(s)}),t}let O7=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ou()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(ou("l")),ki(t.props,"label",r=>{Oe(r)?this.element.classList.add(ou(void 0,"nol")):(this.element.classList.remove(ou(void 0,"nol")),M7(i),i.appendChild(D7(e,r)))}),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("div");s.classList.add(ou("v")),this.element.appendChild(s),this.valueElement=s}},R7=class{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new O7(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return zi(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return qi(null,{label:this.props.get("label")})}};function j7(){return["veryfirst","first","last","verylast"]}const my=j(""),vy={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};let jS=class{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{j7().forEach(i=>{t.classList.remove(my(void 0,vy[i]))}),this.blade.get("positions").forEach(i=>{t.classList.add(my(void 0,vy[i]))})}),this.viewProps.handleDispose(()=>{Zu(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return zi(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return qi(null,Object.assign({},this.viewProps.exportState()))}},N7=class extends lb{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const i=t.bind(this);return this.controller.buttonController.emitter.on(e,()=>{i(new ud(this))}),this}};function B7(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function Sa(n,e){return t=>{B7(n,e,t)}}function hb(n,e){ys(n,t=>{e.textContent=t??""})}const jm=j("btn");let I7=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(jm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(jm("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(jm("t")),hb(t.props.value("title"),s),this.buttonElement.appendChild(s)}},F7=class{constructor(e,t){this.emitter=new En,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new I7(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return zi(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return qi(null,{title:this.props.get("title")})}onClick_(){this.emitter.emit("click",{sender:this})}},fy=class extends jS{constructor(e,t){const i=new F7(e,{props:t.buttonProps,viewProps:t.viewProps}),s=new R7(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:t.viewProps}),this.buttonController=i,this.labelController=s}importState(e){return zi(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return qi(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}},K7=class{constructor(e){const[t,i]=e.split("-"),s=t.split(".");this.major=parseInt(s[0],10),this.minor=parseInt(s[1],10),this.patch=parseInt(s[2],10),this.prerelease=i??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}};const U7=new K7("2.0.0-beta.2");function gt(n){return Object.assign({core:U7},n)}gt({id:"button",type:"blade",accept(n){const e=vt(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new fy(n.document,{blade:n.blade,buttonProps:W.fromObject({title:n.params.title}),labelProps:W.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof fy?new N7(n.controller):null}});function H7(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function z7(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function q7(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function G7(n){return tb(n)?"refresh"in n&&typeof n.refresh=="function":!1}function Y7(n,e){if(!py.isBindable(n))throw $o.notBindable();return new py(n,e)}let X7=class{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new En,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,i){const s=i??{},r=this.controller_.element.ownerDocument,o=this.pool_.createBinding(r,Y7(e,t),s),l=this.pool_.createBindingApi(o);return this.add(l,s.index)}addFolder(e){return z7(this,e)}addButton(e){return H7(this,e)}addTab(e){return q7(this,e)}add(e,t){const i=e.controller;return this.controller_.rack.add(i,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,i=this.pool_.createBlade(t,e),s=this.pool_.createApi(i);return this.add(s,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.children.forEach(e=>{G7(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,i=this.pool_.createApi(t),s=k7(t.value)?t.value.binding:null;this.emitter_.emit("change",new TS(i,s?s.target.read():t.value.rawValue,e.options.last))}},cb=class extends lb{constructor(e,t){super(e),this.rackApi_=new X7(e.rackController,t)}},pb=class extends jS{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return zi(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((i,s)=>i.importState(t.children[s])))}exportState(){return qi(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}};function of(n){return"rackController"in n}let W7=class{constructor(e){this.emitter=new En,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw $o.shouldNeverHappen();const i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(r=>{this.cache_.add(r)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.allItems().forEach(s=>{this.cache_.delete(s)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}};function Z7(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(Oc(i)&&i.value===e)return i}return null}function Q7(n){return of(n)?n.rackController.rack.bcSet_:null}let J7=class{constructor(e){var t,i;this.emitter=new En,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new W7(Q7),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var i;(i=e.parent)===null||i===void 0||i.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),Oc(i))i.value.emitter.on("change",this.onChildValueChange_);else if(of(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.on("layout",this.onRackLayout_),r.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const i=e.item;if(Oc(i))i.value.emitter.off("change",this.onChildValueChange_);else if(of(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.off("layout",this.onRackLayout_),r.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(s=>!s.viewProps.get("hidden")),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach(s=>{const r=[];s===t&&(r.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&r.push("veryfirst")),s===i&&(r.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&r.push("verylast")),s.blade.set("positions",r)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=Z7(this.find(Oc),e.sender);if(!t)throw $o.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}},db=class{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new J7({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let i=this.rack.children.length-1;i>=0;i--)this.rack.children[i].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&DS(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&Zu(e.bladeController.view.element)}};function NS(){return new W({positions:rt([],{equals:Iq})})}let mb=class BS extends W{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=W.createCore(t);return new BS(i)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!Oe(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const i=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};ki(this,"expanded",i),ki(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}};function e9(n,e){let t=0;return S7(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),cp(e),t=e.clientHeight,n.set("temporaryExpanded",null),cp(e)}),t}function wy(n,e){e.style.height=n.styleHeight}function vb(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),Oe(n.get("expandedHeight"))){const t=e9(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),cp(e)}),n.emitter.on("change",()=>{wy(n,e)}),wy(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}let t9=class extends cb{constructor(e,t){super(e,t),this.emitter_=new En,this.controller.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",new y7(this,i.sender.rawValue))}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.rackApi_.refresh()}};const IS=j("cnt");let n9=class{constructor(e,t){var i;this.className_=j((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),IS()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),ki(this.foldable_,"completed",Sa(this.element,this.className_(void 0,"cpl")));const s=e.createElement("button");s.classList.add(this.className_("b")),ki(t.props,"title",u=>{Oe(u)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const r=e.createElement("div");r.classList.add(this.className_("i")),this.element.appendChild(r);const o=e.createElement("div");o.classList.add(this.className_("t")),hb(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}},_y=class extends pb{constructor(e,t){var i;const s=mb.create((i=t.expanded)!==null&&i!==void 0?i:!0),r=new n9(e,{foldable:s,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new db({blade:t.blade,element:r.containerElement,root:t.root,viewProps:t.viewProps}),view:r})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=s,vb(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return zi(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return qi(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}};gt({id:"folder",type:"blade",accept(n){const e=vt(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new _y(n.document,{blade:n.blade,expanded:n.params.expanded,props:W.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof _y?new t9(n.controller,n.pool):null}});const i9=j("");function by(n,e){return Sa(n,i9(void 0,e))}let fb=class FS extends W{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=qq(rt(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,i,s;const r=e??{};return new FS(W.createCore({disabled:(t=r.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(i=r.hidden)!==null&&i!==void 0?i:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){ys(this.globalDisabled_,by(e,"disabled")),ki(this,"hidden",by(e,"hidden"))}bindDisabled(e){ys(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){ys(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const i=e.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}};const gy=j("tbp");let s9=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(gy()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(gy("c")),this.element.appendChild(i),this.containerElement=i}};const lu=j("tbi");let r9=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(lu()),t.viewProps.bindClassModifiers(this.element),ki(t.props,"selected",r=>{r?this.element.classList.add(lu(void 0,"sel")):this.element.classList.remove(lu(void 0,"sel"))});const i=e.createElement("button");i.classList.add(lu("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(lu("t")),hb(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}},o9=class{constructor(e,t){this.emitter=new En,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new r9(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}},lf=class extends pb{constructor(e,t){const i=new s9(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new db({blade:t.blade,element:i.containerElement,viewProps:t.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new o9(e,{props:t.itemProps,viewProps:fb.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,ki(this.props,"selected",s=>{this.itemController.props.set("selected",s),this.viewProps.set("hidden",!s)})}get itemController(){return this.ic_}importState(e){return zi(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return qi(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}},l9=class extends cb{constructor(e,t){super(e,t),this.emitter_=new En,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,i=new lf(t,{blade:NS(),itemProps:W.fromObject({selected:!1,title:e.title}),props:W.fromObject({selected:!1}),viewProps:fb.create()}),s=this.pool_.createApi(i);return this.rackApi_.add(s,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}onSelect_(e){this.emitter_.emit("select",new E7(this,e.rawValue))}},a9=class extends cb{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}refresh(){this.rackApi_.refresh()}};const Cy=-1;let u9=class{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=rt(!0),this.selectedIndex=rt(Cy),this.items_=[]}add(e,t){const i=t??this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=Cy,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,i)=>{t.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,i)=>{t.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(i=>i===e.sender);this.items_.forEach((i,s)=>{i.rawValue=s===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}};const au=j("tab");let h9=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(au(),IS()),t.viewProps.bindClassModifiers(this.element),ys(t.empty,Sa(this.element,au(void 0,"nop")));const i=e.createElement("div");i.classList.add(au("t")),this.element.appendChild(i),this.itemsElement=i;const s=e.createElement("div");s.classList.add(au("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(au("c")),this.element.appendChild(r),this.contentsElement=r}},Py=class extends pb{constructor(e,t){const i=new u9,s=new h9(e,{empty:i.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new db({blade:t.blade,element:s.contentsElement,viewProps:t.viewProps}),view:s}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=this.rackController.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.tab=i}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;DS(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;Zu(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}};gt({id:"tab",type:"blade",accept(n){const e=vt(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new Py(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const i=new lf(n.document,{blade:NS(),itemProps:W.fromObject({selected:!1,title:t.title}),props:W.fromObject({selected:!1}),viewProps:fb.create()});e.add(i)}),e},api(n){return n.controller instanceof Py?new l9(n.controller,n.pool):n.controller instanceof lf?new a9(n.controller,n.pool):null}});let wb=class extends ab{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}},La=class{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,i)=>i.constrain(t),e)}};function pp(n,e){if(n instanceof e)return n;if(n instanceof La){const t=n.constraints.reduce((i,s)=>i||(s instanceof e?s:null),null);if(t)return t}return null}let cd=class{constructor(e){this.values=W.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(s=>s.value===e).length>0?e:t[0].value}};function pd(n){var e;const t=rf;if(Array.isArray(n))return(e=vt({items:n},i=>({items:i.required.array(i.required.object({text:i.required.string,value:i.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function KS(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function _b(n){return Oe(n)?null:new cd(KS(n))}const Nm=j("lst");let c9=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(Nm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(Nm("s")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const s=e.createElement("div");s.classList.add(Nm("m")),s.appendChild(hd(e,"dropdown")),this.element.appendChild(s),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,ki(this.props_,"options",r=>{OS(this.selectElement),r.forEach(o=>{const l=e.createElement("option");l.textContent=o.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}},sa=class{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new c9(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return zi(e,null,t=>({options:t.required.custom(pd)}),t=>(this.props.set("options",KS(t.options)),!0))}exportProps(){return qi(null,{options:this.props.get("options")})}};const yy=j("pop");let p9=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(yy()),t.viewProps.bindClassModifiers(this.element),ys(t.shows,Sa(this.element,yy(void 0,"v")))}},US=class{constructor(e,t){this.shows=rt(!1),this.viewProps=t.viewProps,this.view=new p9(e,{shows:this.shows,viewProps:this.viewProps})}};const Ey=j("txt");let d9=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Ey()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(Ey("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}},bb=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new d9(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Oe(s)||(this.value.rawValue=s),this.view.refresh()}};function m9(n){return String(n)}function HS(n){return n==="false"?!1:!!n}function xy(n){return m9(n)}function v9(n){return e=>n.reduce((t,i)=>t!==null?t:i(e),null)}const f9=kt(0);function dp(n){return f9(n)+"%"}function zS(n){return String(n)}function af(n){return n}function Aa({primary:n,secondary:e,forward:t,backward:i}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}n.emitter.on("change",o=>{r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),e.emitter.on("change",o=>{r(()=>{n.setRawValue(i(n.rawValue,e.rawValue),o.options)}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function sn(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function Qu(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function Ts(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function w9(n){return n==="ArrowUp"||n==="ArrowDown"}function qS(n){return w9(n)||n==="ArrowLeft"||n==="ArrowRight"}function Bm(n,e){var t,i;const s=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:n.pageX-(((t=s&&s.scrollX)!==null&&t!==void 0?t:0)+r.left),y:n.pageY-(((i=s&&s.scrollY)!==null&&i!==void 0?i:0)+r.top)}}let qr=class{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new En,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Bm(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Bm(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Bm(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-s.left,y:i.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}};const On=j("txt");let _9=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(On(),On(void 0,"num")),t.arrayPosition&&this.element.classList.add(On(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(On("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(On()),this.inputElement.classList.add(On("i"));const s=e.createElement("div");s.classList.add(On("k")),this.element.appendChild(s),this.knobElement=s;const r=e.createElementNS(bn,"svg");r.classList.add(On("g")),this.knobElement.appendChild(r);const o=e.createElementNS(bn,"path");o.classList.add(On("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=e.createElementNS(bn,"path");l.classList.add(On("gh")),r.appendChild(l),this.guideHeadElem_=l;const a=e.createElement("div");a.classList.add(j("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(On(void 0,"drg"));return}this.element.classList.add(On(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),i=t+(t>0?-1:t<0?1:0),s=We(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+s},0 L${i},4 L${i+s},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}},Ma=class{constructor(e,t){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(i=t.sliderProps)!==null&&i!==void 0?i:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=rt(null),this.view=new _9(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new qr(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,i;const s=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),r=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("max");let o=e;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Oe(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const t=sn(this.props.get("keyScale"),Qu(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){sn(this.props.get("keyScale"),Qu(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}};const Im=j("sld");let b9=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Im()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Im("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const s=e.createElement("div");s.classList.add(Im("k")),this.trackElement.appendChild(s),this.knobElement=s,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=We(ie(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}},g9=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new b9(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new qr(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(ie(We(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=sn(this.props.get("keyScale"),Ts(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){sn(this.props.get("keyScale"),Ts(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const Fm=j("sldtxt");let C9=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Fm());const i=e.createElement("div");i.classList.add(Fm("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Fm("t")),this.textView_=t.textView,s.appendChild(this.textView_.element),this.element.appendChild(s)}},$y=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new g9(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new Ma(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new C9(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return zi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const i=this.sliderC_.props;return i.set("max",t.max),i.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return qi(null,{max:e.get("max"),min:e.get("min")})}};function P9(n){return{sliderProps:new W({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new W({formatter:rt(n.formatter),keyScale:n.keyScale,pointerScale:rt(n.pointerScale)})}}const y9={containerUnitSize:"cnt-usz"};function GS(n){return`--${y9[n]}`}function Ju(n){return ad(n)}function gr(n){if(nf(n))return vt(n,Ju)}function vs(n,e){if(!n)return;const t=[],i=sb(n,e);i&&t.push(i);const s=rb(n);return s&&t.push(s),new La(t)}function YS(n){if(n==="inline"||n==="popup")return n}function Yo(n,e){n.write(e)}const mc=j("ckb");let E9=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(mc()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(mc("l")),this.element.appendChild(i);const s=e.createElement("input");s.classList.add(mc("i")),s.type="checkbox",i.appendChild(s),this.inputElement=s,t.viewProps.bindDisabled(this.inputElement);const r=e.createElement("div");r.classList.add(mc("w")),i.appendChild(r);const o=hd(e,"check");r.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}},x9=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new E9(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked}};function $9(n){const e=[],t=_b(n.options);return t&&e.push(t),new La(e)}gt({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=vt(e,i=>({options:i.optional.custom(pd),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>HS,constraint:n=>$9(n.params),writer:n=>Yo},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&pp(i,cd);return s?new sa(e,{props:new W({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new x9(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof sa?new wb(n.controller):null}});const eo=j("col");let V9=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(eo()),t.foldable.bindExpandedClass(this.element,eo(void 0,"expanded")),ki(t.foldable,"completed",Sa(this.element,eo(void 0,"cpl")));const i=e.createElement("div");i.classList.add(eo("h")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(eo("s")),i.appendChild(s),this.swatchElement=s;const r=e.createElement("div");if(r.classList.add(eo("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(eo("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};function k9(n,e,t){const i=We(n/255,0,1),s=We(e/255,0,1),r=We(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u=0,h=0;const c=(l+o)/2;return a!==0&&(h=a/(1-Math.abs(o+l-1)),i===o?u=(s-r)/a:s===o?u=2+(r-i)/a:u=4+(i-s)/a,u=u/6+(u<0?1:0)),[u*360,h*100,c*100]}function S9(n,e,t){const i=(n%360+360)%360,s=We(e/100,0,1),r=We(t/100,0,1),o=(1-Math.abs(2*r-1))*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o/2;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function L9(n,e,t){const i=We(n/255,0,1),s=We(e/255,0,1),r=We(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u;a===0?u=0:o===i?u=60*(((s-r)/a%6+6)%6):o===s?u=60*((r-i)/a+2):u=60*((i-s)/a+4);const h=o===0?0:a/o,c=o;return[u,h*100,c*100]}function XS(n,e,t){const i=AS(n,360),s=We(e/100,0,1),r=We(t/100,0,1),o=r*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function A9(n,e,t){const i=t+e*(100-Math.abs(2*t-100))/200;return[n,i!==0?e*(100-Math.abs(2*t-100))/i:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function M9(n,e,t){const i=100-Math.abs(t*(200-e)/100-100);return[n,i!==0?e*t/i:0,t*(200-e)/(2*100)]}function Si(n){return[n[0],n[1],n[2]]}function dd(n,e){return[n[0],n[1],n[2],e]}const T9={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:A9,rgb:S9},hsv:{hsl:M9,hsv:(n,e,t)=>[n,e,t],rgb:XS},rgb:{hsl:k9,hsv:L9,rgb:(n,e,t)=>[n,e,t]}};function ra(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function D9(n,e){return n===e?e:AS(n,e)}function WS(n,e,t){var i;const s=ra(e,t);return[e==="rgb"?We(n[0],0,s[0]):D9(n[0],s[0]),We(n[1],0,s[1]),We(n[2],0,s[2]),We((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function Vy(n,e,t,i){const s=ra(e,t),r=ra(e,i);return n.map((o,l)=>o/s[l]*r[l])}function ZS(n,e,t){const i=Vy(n,e.mode,e.type,"int"),s=T9[e.mode][t.mode](...i);return Vy(s,t.mode,"int",t.type)}let ce=class QS{static black(){return new QS([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=WS(e,t,this.type)}getComponents(e){return dd(ZS(Si(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const Js=j("colp");let O9=class{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(Js()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Js("hsv"));const s=e.createElement("div");s.classList.add(Js("sv")),this.svPaletteView_=t.svPaletteView,s.appendChild(this.svPaletteView_.element),i.appendChild(s);const r=e.createElement("div");r.classList.add(Js("h")),this.hPaletteView_=t.hPaletteView,r.appendChild(this.hPaletteView_.element),i.appendChild(r),this.element.appendChild(i);const o=e.createElement("div");if(o.classList.add(Js("rgb")),this.textsView_=t.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const l=e.createElement("div");l.classList.add(Js("a"));const a=e.createElement("div");a.classList.add(Js("ap")),a.appendChild(this.alphaViews_.palette.element),l.appendChild(a);const u=e.createElement("div");u.classList.add(Js("at")),u.appendChild(this.alphaViews_.text.element),l.appendChild(u),this.element.appendChild(l)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}};function R9(n){return n==="int"?"int":n==="float"?"float":void 0}function gb(n){return vt(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(R9)}),expanded:e.optional.boolean,picker:e.optional.custom(YS),readonly:e.optional.constant(!1)}))}function Vo(n){return n?.1:1}function JS(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}let Cb=class{constructor(e,t){this.type="float",this.mode=t,this.comps_=WS(e,t,this.type)}getComponents(e){return dd(ZS(Si(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const j9={int:(n,e)=>new ce(n,e),float:(n,e)=>new Cb(n,e)};function Pb(n,e,t){return j9[t](n,e)}function N9(n){return n.type==="float"}function B9(n){return n.type==="int"}function I9(n){const e=n.getComponents(),t=ra(n.mode,"int");return new ce([Math.round(ie(e[0],0,1,0,t[0])),Math.round(ie(e[1],0,1,0,t[1])),Math.round(ie(e[2],0,1,0,t[2])),e[3]],n.mode)}function F9(n){const e=n.getComponents(),t=ra(n.mode,"int");return new Cb([ie(e[0],0,t[0],0,1),ie(e[1],0,t[1],0,1),ie(e[2],0,t[2],0,1),e[3]],n.mode)}function Ht(n,e){if(n.type===e)return n;if(B9(n)&&e==="float")return F9(n);if(N9(n)&&e==="int")return I9(n);throw $o.shouldNeverHappen()}function K9(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function qn(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const U9={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function eL(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),i=e[2];return U9[i](t)}function tL(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[qn(e[1],255),qn(e[2],255),qn(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function H9(n){const e=tL(n);return e?new ce(e,"rgb"):null}function nL(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[qn(e[1],255),qn(e[2],255),qn(e[3],255),qn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function z9(n){const e=nL(n);return e?new ce(e,"rgb"):null}function iL(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[eL(e[1]),qn(e[2],100),qn(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function q9(n){const e=iL(n);return e?new ce(e,"hsl"):null}function sL(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[eL(e[1]),qn(e[2],100),qn(e[3],100),qn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function G9(n){const e=sL(n);return e?new ce(e,"hsl"):null}function rL(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function Y9(n){const e=rL(n);return e?new ce(e,"rgb"):null}function oL(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),ie(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),ie(parseInt(t[4],16),0,255,0,1)]:null}function X9(n){const e=oL(n);return e?new ce(e,"rgb"):null}function lL(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function W9(n){return e=>{const t=lL(e);return t?Pb(t,"rgb",n):null}}function aL(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function Z9(n){return e=>{const t=aL(e);return t?Pb(t,"rgb",n):null}}const Q9=[{parser:rL,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:oL,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:tL,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:nL,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:iL,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:sL,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:lL,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:aL,result:{alpha:!0,mode:"rgb",notation:"object"}}];function J9(n){return Q9.reduce((e,{parser:t,result:i})=>e||(t(n)?i:null),null)}function eG(n,e="int"){const t=J9(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function Bh(n){const e=[Y9,X9,H9,z9,q9,G9];e.push(W9("int"),Z9("int"));const t=v9(e);return i=>{const s=t(i);return s?Ht(s,n):null}}function tG(n){const e=Bh("int");if(typeof n!="string")return ce.black();const t=e(n);return t??ce.black()}function uL(n){const e=We(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function yb(n,e="#"){const t=Si(n.getComponents("rgb")).map(uL).join("");return`${e}${t}`}function Eb(n,e="#"){const t=n.getComponents("rgb"),i=[t[0],t[1],t[2],t[3]*255].map(uL).join("");return`${e}${i}`}function hL(n){const e=kt(0),t=Ht(n,"int");return`rgb(${Si(t.getComponents("rgb")).map(s=>e(s)).join(", ")})`}function Rc(n){const e=kt(2),t=kt(0);return`rgba(${Ht(n,"int").getComponents("rgb").map((r,o)=>(o===3?e:t)(r)).join(", ")})`}function nG(n){const e=[kt(0),dp,dp],t=Ht(n,"int");return`hsl(${Si(t.getComponents("hsl")).map((s,r)=>e[r](s)).join(", ")})`}function iG(n){const e=[kt(0),dp,dp,kt(2)];return`hsla(${Ht(n,"int").getComponents("hsl").map((s,r)=>e[r](s)).join(", ")})`}function cL(n,e){const t=kt(e==="float"?2:0),i=["r","g","b"],s=Ht(n,e);return`{${Si(s.getComponents("rgb")).map((o,l)=>`${i[l]}: ${t(o)}`).join(", ")}}`}function sG(n){return e=>cL(e,n)}function pL(n,e){const t=kt(2),i=kt(e==="float"?2:0),s=["r","g","b","a"];return`{${Ht(n,e).getComponents("rgb").map((l,a)=>{const u=a===3?t:i;return`${s[a]}: ${u(l)}`}).join(", ")}}`}function rG(n){return e=>pL(e,n)}const oG=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:yb},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Eb},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:hL},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:Rc},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:nG},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:iG},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:sG(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:rG(e)}],[])];function dL(n){return oG.reduce((e,t)=>e||(K9(t.format,n)?t.stringifier:null),null)}const uu=j("apl");let lG=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(uu()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(uu("b")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(uu("c")),i.appendChild(s),this.colorElem_=s;const r=e.createElement("div");r.classList.add(uu("m")),this.element.appendChild(r),this.markerElem_=r;const o=e.createElement("div");o.classList.add(uu("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new ce([t[0],t[1],t[2],0],"rgb"),s=new ce([t[0],t[1],t[2],255],"rgb"),r=["to right",Rc(i),Rc(s)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=Rc(e);const o=ie(t[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}},aG=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new lG(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new qr(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,s=this.value.rawValue,[r,o,l]=s.getComponents("hsv");this.value.setRawValue(new ce([r,o,l,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=sn(Vo(!0),Ts(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new ce([s,r,o,l+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){sn(Vo(!0),Ts(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const ul=j("coltxt");function uG(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((i,s)=>{const r=n.createElement("option");return r.textContent=s.text,r.value=s.value,i.appendChild(r),i},n.createDocumentFragment())),e}let hG=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ul()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(ul("m")),this.modeElem_=uG(e),this.modeElem_.classList.add(ul("ms")),i.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const s=e.createElement("div");s.classList.add(ul("mm")),s.appendChild(hd(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(ul("w")),this.element.appendChild(r),this.inputsElem_=r,this.inputViews_=t.inputViews,this.applyInputViews_(),ys(t.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){OS(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const i=e.createElement("div");i.classList.add(ul("c")),i.appendChild(t.element),this.inputsElem_.appendChild(i)})}};function cG(n){return kt(n==="float"?2:0)}function pG(n,e,t){const i=ra(n,e)[t];return new rd({min:0,max:i})}function dG(n,e,t){return new Ma(n,{arrayPosition:t===0?"fst":t===2?"lst":"mid",parser:e.parser,props:W.fromObject({formatter:cG(e.colorType),keyScale:Vo(!1),pointerScale:e.colorType==="float"?.01:1}),value:rt(0,{constraint:pG(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function mG(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:Vi,viewProps:e.viewProps};return[0,1,2].map(i=>{const s=dG(n,t,i);return Aa({primary:e.value,secondary:s.value,forward(r){return Ht(r,e.colorType).getComponents(e.colorMode)[i]},backward(r,o){const l=e.colorMode,u=Ht(r,e.colorType).getComponents(l);u[i]=o;const h=Pb(dd(Si(u),u[3]),l,e.colorType);return Ht(h,"int")}}),s})}function vG(n,e){const t=new bb(n,{parser:Bh("int"),props:W.fromObject({formatter:yb}),value:rt(ce.black()),viewProps:e.viewProps});return Aa({primary:e.value,secondary:t.value,forward:i=>new ce(Si(i.getComponents()),i.mode),backward:(i,s)=>new ce(dd(Si(s.getComponents(i.mode)),i.getComponents()[3]),i.mode)}),[t]}function fG(n){return n!=="hex"}let wG=class{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=rt(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new hG(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return fG(t)?mG(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):vG(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(i=>i.view)}};const Km=j("hpl");let _G=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Km()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Km("c")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Km("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=hL(new ce([t,100,100],"hsv"));const i=ie(t,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}},bG=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new _G(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new qr(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=ie(We(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),s=this.value.rawValue,[,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new ce([i,r,o,l],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=sn(Vo(!1),Ts(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new ce([s+t,r,o,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){sn(Vo(!1),Ts(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const Um=j("svp"),ky=64;let gG=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Um()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=ky,i.width=ky,i.classList.add(Um("c")),this.element.appendChild(i),this.canvasElement=i;const s=e.createElement("div");s.classList.add(Um("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=L7(this.canvasElement);if(!e)return;const i=this.value.rawValue.getComponents("hsv"),s=this.canvasElement.width,r=this.canvasElement.height,o=e.getImageData(0,0,s,r),l=o.data;for(let h=0;h<r;h++)for(let c=0;c<s;c++){const d=ie(c,0,s,0,100),p=ie(h,0,r,100,0),v=XS(i[0],d,p),m=(h*s+c)*4;l[m]=v[0],l[m+1]=v[1],l[m+2]=v[2],l[m+3]=255}e.putImageData(o,0,0);const a=ie(i[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const u=ie(i[2],0,100,100,0);this.markerElem_.style.top=`${u}%`}onValueChange_(){this.update_()}},CG=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new gG(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new qr(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=ie(e.point.x,0,e.bounds.width,0,100),s=ie(e.point.y,0,e.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new ce([r,i,s,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){qS(e.key)&&e.preventDefault();const[t,i,s,r]=this.value.rawValue.getComponents("hsv"),o=Vo(!1),l=sn(o,Ts(e)),a=sn(o,Qu(e));l===0&&a===0||this.value.setRawValue(new ce([t,i+l,s+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=Vo(!1),i=sn(t,Ts(e)),s=sn(t,Qu(e));i===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},PG=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new bG(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new CG(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new aG(e,{value:this.value,viewProps:this.viewProps}),text:new Ma(e,{parser:Vi,props:W.fromObject({pointerScale:.01,keyScale:.1,formatter:kt(2)}),value:rt(0,{constraint:new rd({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Aa({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.getComponents()[3],backward:(i,s)=>{const r=i.getComponents();return r[3]=s,new ce(r,i.mode)}}),this.textsC_=new wG(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new O9(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}};const Hm=j("colsw");let yG=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(Hm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Hm("sw")),this.element.appendChild(i),this.swatchElem_=i;const s=e.createElement("button");s.classList.add(Hm("b")),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=Eb(e)}onValueChange_(){this.update_()}},EG=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new yG(e,{value:this.value,viewProps:this.viewProps})}},xb=class{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=mb.create(t.expanded),this.swatchC_=new EG(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new bb(e,{parser:t.parser,props:W.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new V9(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new US(e,{viewProps:this.viewProps}):null;const s=new PG(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),Aa({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),vb(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=RS(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!ub(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}};function xG(n){return Si(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function $G(n){return n.getComponents("rgb").reduce((e,t,i)=>{const s=Math.floor(i===3?t*255:t)&255;return e<<8|s},0)>>>0}function VG(n){return new ce([n>>16&255,n>>8&255,n&255],"rgb")}function kG(n){return new ce([n>>24&255,n>>16&255,n>>8&255,ie(n&255,0,255,0,1)],"rgb")}function SG(n){return typeof n!="number"?ce.black():VG(n)}function LG(n){return typeof n!="number"?ce.black():kG(n)}function jc(n,e){return typeof n!="object"||Oe(n)?!1:e in n&&typeof n[e]=="number"}function mL(n){return jc(n,"r")&&jc(n,"g")&&jc(n,"b")}function vL(n){return mL(n)&&jc(n,"a")}function fL(n){return mL(n)}function $b(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),i=e.getComponents();for(let s=0;s<t.length;s++)if(t[s]!==i[s])return!1;return!0}function Sy(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function AG(n){const e=dL(n);return e?(t,i)=>{Yo(t,e(i))}:null}function MG(n){const e=n?$G:xG;return(t,i)=>{Yo(t,e(i))}}function TG(n,e,t){const s=Ht(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b),n.writeProperty("a",s.a)}function DG(n,e,t){const s=Ht(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b)}function OG(n,e){return(t,i)=>{n?TG(t,i,e):DG(t,i,e)}}function RG(n){var e;return!!(!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function jG(n){return n?e=>Eb(e,"0x"):e=>yb(e,"0x")}function NG(n){return"color"in n||n.view==="color"}gt({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!NG(e))return null;const t=gb(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:RG(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?LG:SG,equals:$b,writer:n=>MG(n.params.supportsAlpha)},controller:n=>{var e,t;return new xb(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:jG(n.params.supportsAlpha),parser:Bh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function BG(n,e){if(!fL(n))return Ht(ce.black(),e);if(e==="int"){const t=Sy(n);return new ce(t,"rgb")}if(e==="float"){const t=Sy(n);return new Cb(t,"rgb")}return Ht(ce.black(),"int")}function IG(n){return vL(n)}function FG(n){return e=>{const t=BG(e,n);return Ht(t,"int")}}function KG(n,e){return t=>n?pL(t,e):cL(t,e)}gt({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!fL(n))return null;const i=gb(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{colorType:(t=JS(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>FG(n.params.colorType),equals:$b,writer:n=>OG(IG(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const i=vL(n.initialValue);return new xb(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:KG(i,n.params.colorType),parser:Bh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:i,value:n.value,viewProps:n.viewProps})}});gt({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=eG(n,JS(e));if(!t)return null;const i=dL(t);if(!i)return null;const s=gb(e);return s?{initialValue:n,params:Object.assign(Object.assign({},s),{format:t,stringifier:i})}:null},binding:{reader:()=>tG,equals:$b,writer:n=>{const e=AG(n.params.format);if(!e)throw $o.notBindable();return e}},controller:n=>{var e,t;return new xb(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:Bh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});let Vb=class{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((i,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(i))!==null&&o!==void 0?o:i});return this.asm_.fromComponents(t)}};const Ly=j("pndtxt");let UG=class{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(Ly()),this.textViews.forEach(i=>{const s=e.createElement("div");s.classList.add(Ly("a")),s.appendChild(i.element),this.element.appendChild(s)})}};function HG(n,e,t){return new Ma(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:rt(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}let kb=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((i,s)=>HG(e,t,s)),this.acs_.forEach((i,s)=>{Aa({primary:this.value,secondary:i.value,forward:r=>t.assembly.toComponents(r)[s],backward:(r,o)=>{const l=t.assembly.toComponents(r);return l[s]=o,t.assembly.fromComponents(l)}})}),this.view=new UG(e,{textViews:this.acs_.map(i=>i.view)})}get textControllers(){return this.acs_}},zG=class extends ab{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}};function qG(n,e){const t=[],i=sb(n,e);i&&t.push(i);const s=rb(n);s&&t.push(s);const r=_b(n.options);return r&&t.push(r),new La(t)}gt({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=vt(e,i=>Object.assign(Object.assign({},ad(i)),{options:i.optional.custom(pd),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>od,constraint:n=>qG(n.params,n.initialValue),writer:n=>Yo},controller:n=>{const e=n.value,t=n.constraint,i=t&&pp(t,cd);if(i)return new sa(n.document,{props:new W({options:i.values.value("options")}),value:e,viewProps:n.viewProps});const s=ld(n.params,e.rawValue),r=t&&pp(t,rd);return r?new $y(n.document,Object.assign(Object.assign({},P9(Object.assign(Object.assign({},s),{keyScale:rt(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:Vi,value:e,viewProps:n.viewProps})):new Ma(n.document,{parser:Vi,props:W.fromObject(s),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof $y?new zG(n.controller):n.controller.valueController instanceof sa?new wb(n.controller):null}});let kr=class{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(Oe(e))return!1;const t=e.x,i=e.y;return!(typeof t!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}};const wL={toComponents:n=>n.getComponents(),fromComponents:n=>new kr(...n)},hl=j("p2d");let GG=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(hl()),t.viewProps.bindClassModifiers(this.element),ys(t.expanded,Sa(this.element,hl(void 0,"expanded")));const i=e.createElement("div");i.classList.add(hl("h")),this.element.appendChild(i);const s=e.createElement("button");s.classList.add(hl("b")),s.appendChild(hd(e,"p2dpad")),t.viewProps.bindDisabled(s),i.appendChild(s),this.buttonElement=s;const r=e.createElement("div");if(r.classList.add(hl("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(hl("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};const er=j("p2dp");let YG=class{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(er()),t.layout==="popup"&&this.element.classList.add(er(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(er("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=e.createElementNS(bn,"svg");s.classList.add(er("g")),this.padElement.appendChild(s),this.svgElem_=s;const r=e.createElementNS(bn,"line");r.classList.add(er("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=e.createElementNS(bn,"line");o.classList.add(er("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const l=e.createElementNS(bn,"line");l.classList.add(er("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const a=e.createElement("div");a.classList.add(er("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.props_.get("max"),s=ie(e,-i,+i,0,100),r=ie(t,-i,+i,0,100),o=this.props_.get("invertsY")?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${s}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${s}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}};function Ay(n,e,t){return[sn(e[0],Ts(n)),sn(e[1],Qu(n))*(t?1:-1)]}let XG=class{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new YG(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new qr(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.props.get("max"),s=ie(e.point.x,0,e.bounds.width,-i,+i),r=ie(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new kr(s,r),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){qS(e.key)&&e.preventDefault();const[t,i]=Ay(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(new kr(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=Ay(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},WG=class{constructor(e,t){var i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=mb.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new US(e,{viewProps:this.viewProps}):null;const r=new XG(e,{layout:t.pickerLayout,props:new W({invertsY:rt(t.invertsY),max:rt(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.textC_=new kb(e,{assembly:wL,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new GG(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Aa({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),vb(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=RS(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!ub(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}};function ZG(n){return kr.isObject(n)?new kr(n.x,n.y):new kr}function QG(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function JG(n,e){return new Vb({assembly:wL,components:[vs(Object.assign(Object.assign({},n),n.x),e.x),vs(Object.assign(Object.assign({},n),n.y),e.y)]})}function My(n,e){var t,i;if(!Oe(n.min)||!Oe(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((i=n.max)!==null&&i!==void 0?i:0));const s=MS(n);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function eY(n,e){var t,i;const s=My(xo(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),r=My(xo(n,(i=n.y)!==null&&i!==void 0?i:{}),e.y);return Math.max(s,r)}function tY(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}gt({id:"input-point2d",type:"input",accept:(n,e)=>{if(!kr.isObject(n))return null;const t=vt(e,i=>Object.assign(Object.assign({},Ju(i)),{expanded:i.optional.boolean,picker:i.optional.custom(YS),readonly:i.optional.constant(!1),x:i.optional.custom(gr),y:i.optional.object(Object.assign(Object.assign({},Ju(i)),{inverted:i.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>ZG,constraint:n=>JG(n.params,n.initialValue),equals:kr.equals,writer:()=>QG},controller:n=>{var e,t;const i=n.document,s=n.value,r=n.constraint,o=[n.params.x,n.params.y];return new WG(i,{axes:s.rawValue.getComponents().map((l,a)=>{var u;return ob({constraint:r.components[a],initialValue:l,params:xo(n.params,(u=o[a])!==null&&u!==void 0?u:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:tY(n.params),max:eY(n.params,s.rawValue),parser:Vi,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:n.viewProps})}});let Il=class{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(Oe(e))return!1;const t=e.x,i=e.y,s=e.z;return!(typeof t!="number"||typeof i!="number"||typeof s!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}};const _L={toComponents:n=>n.getComponents(),fromComponents:n=>new Il(...n)};function nY(n){return Il.isObject(n)?new Il(n.x,n.y,n.z):new Il}function iY(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function sY(n,e){return new Vb({assembly:_L,components:[vs(Object.assign(Object.assign({},n),n.x),e.x),vs(Object.assign(Object.assign({},n),n.y),e.y),vs(Object.assign(Object.assign({},n),n.z),e.z)]})}gt({id:"input-point3d",type:"input",accept:(n,e)=>{if(!Il.isObject(n))return null;const t=vt(e,i=>Object.assign(Object.assign({},Ju(i)),{readonly:i.optional.constant(!1),x:i.optional.custom(gr),y:i.optional.custom(gr),z:i.optional.custom(gr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>nY,constraint:n=>sY(n.params,n.initialValue),equals:Il.equals,writer:n=>iY},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z];return new kb(n.document,{assembly:_L,axes:e.rawValue.getComponents().map((s,r)=>{var o;return ob({constraint:t.components[r],initialValue:s,params:xo(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Vi,value:e,viewProps:n.viewProps})}});let Fl=class{constructor(e=0,t=0,i=0,s=0){this.x=e,this.y=t,this.z=i,this.w=s}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(Oe(e))return!1;const t=e.x,i=e.y,s=e.z,r=e.w;return!(typeof t!="number"||typeof i!="number"||typeof s!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}};const bL={toComponents:n=>n.getComponents(),fromComponents:n=>new Fl(...n)};function rY(n){return Fl.isObject(n)?new Fl(n.x,n.y,n.z,n.w):new Fl}function oY(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function lY(n,e){return new Vb({assembly:bL,components:[vs(Object.assign(Object.assign({},n),n.x),e.x),vs(Object.assign(Object.assign({},n),n.y),e.y),vs(Object.assign(Object.assign({},n),n.z),e.z),vs(Object.assign(Object.assign({},n),n.w),e.w)]})}gt({id:"input-point4d",type:"input",accept:(n,e)=>{if(!Fl.isObject(n))return null;const t=vt(e,i=>Object.assign(Object.assign({},Ju(i)),{readonly:i.optional.constant(!1),w:i.optional.custom(gr),x:i.optional.custom(gr),y:i.optional.custom(gr),z:i.optional.custom(gr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>rY,constraint:n=>lY(n.params,n.initialValue),equals:Fl.equals,writer:n=>oY},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z,n.params.w];return new kb(n.document,{assembly:bL,axes:e.rawValue.getComponents().map((s,r)=>{var o;return ob({constraint:t.components[r],initialValue:s,params:xo(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Vi,value:e,viewProps:n.viewProps})}});function aY(n){const e=[],t=_b(n.options);return t&&e.push(t),new La(e)}gt({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=vt(e,i=>({readonly:i.optional.constant(!1),options:i.optional.custom(pd)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>zS,constraint:n=>aY(n.params),writer:n=>Yo},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&pp(i,cd);return s?new sa(e,{props:new W({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new bb(e,{parser:r=>r,props:W.fromObject({formatter:af}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof sa?new wb(n.controller):null}});const md={monitor:{defaultInterval:200,defaultRows:3}},Ty=j("mll");let uY=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(Ty()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(Ty("i")),i.style.height=`calc(var(${GS("containerUnitSize")}) * ${t.rows})`,i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach(s=>{s!==void 0&&i.push(this.formatter_(s))}),e.textContent=i.join(`
`),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}},Sb=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new uY(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}};const Dy=j("sgl");let hY=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(Dy()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(Dy("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}},Lb=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new hY(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}};gt({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=vt(e,i=>({readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>HS},controller:n=>{var e;return n.value.rawValue.length===1?new Lb(n.document,{formatter:xy,value:n.value,viewProps:n.viewProps}):new Sb(n.document,{formatter:xy,rows:(e=n.params.rows)!==null&&e!==void 0?e:md.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});let cY=class extends ab{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}};const tr=j("grl");let pY=class{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(tr()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(bn,"svg");i.classList.add(tr("g")),i.style.height=`calc(var(${GS("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(bn,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=e.createElement("div");r.classList.add(tr("t"),j("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,i=this.props_.get("min"),s=this.props_.get("max"),r=[];this.value.rawValue.forEach((h,c)=>{if(h===void 0)return;const d=ie(c,0,t,0,e.width),p=ie(h,i,s,e.height,0);r.push([d,p].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,l=this.value.rawValue[this.cursor_.rawValue];if(l===void 0){o.classList.remove(tr("t","a"));return}const a=ie(this.cursor_.rawValue,0,t,0,e.width),u=ie(l,i,s,e.height,0);o.style.left=`${a}px`,o.style.top=`${u}px`,o.textContent=`${this.formatter_(l)}`,o.classList.contains(tr("t","a"))||(o.classList.add(tr("t","a"),tr("t","in")),cp(o),o.classList.remove(tr("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}},gL=class{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=rt(-1),this.view=new pY(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!ub(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new qr(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return zi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return qi(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(ie(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(ie(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}};function uf(n){return Oe(n.format)?kt(2):n.format}function dY(n){var e;return n.value.rawValue.length===1?new Lb(n.document,{formatter:uf(n.params),value:n.value,viewProps:n.viewProps}):new Sb(n.document,{formatter:uf(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:md.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function mY(n){var e,t,i;return new gL(n.document,{formatter:uf(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:md.monitor.defaultRows,props:W.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(i=n.params.min)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function Oy(n){return n.view==="graph"}gt({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=vt(e,i=>({format:i.optional.function,max:i.optional.number,min:i.optional.number,readonly:i.required.constant(!0),rows:i.optional.number,view:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>Oy(n)?64:1,reader:n=>od},controller:n=>Oy(n.params)?mY(n):dY(n),api:n=>n.controller.valueController instanceof gL?new cY(n.controller):null});gt({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=vt(e,i=>({multiline:i.optional.boolean,readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>zS},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new Sb(n.document,{formatter:af,rows:(e=n.params.rows)!==null&&e!==void 0?e:md.monitor.defaultRows,value:t,viewProps:n.viewProps}):new Lb(n.document,{formatter:af,value:t,viewProps:n.viewProps})}});const ni=j("ckr");class vY{constructor(e,t){this.tickElems_=[],this.labelElems_=[],this.boundsWidth_=-1,this.onShowsTooltipChange_=this.onShowsTooltipChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.formatters_=t.formatters,this.unit_=t.unit,this.element=e.createElement("div"),this.element.classList.add(ni(),ni(void 0,`m${t.seriesId}`)),t.viewProps.bindClassModifiers(this.element),this.value_=t.value,this.value_.emitter.on("change",this.onValueChange_),t.showsTooltip.emitter.on("change",this.onShowsTooltipChange_);const i=e.createElement("div");i.classList.add(ni("w")),this.element.appendChild(i),this.offsetElem_=e.createElement("div"),this.offsetElem_.classList.add(ni("o")),i.appendChild(this.offsetElem_),this.svgElem_=e.createElementNS(bn,"svg"),this.svgElem_.classList.add(ni("g")),this.offsetElem_.appendChild(this.svgElem_),this.tooltipElem_=e.createElement("div"),this.tooltipElem_.classList.add(j("tt")(),ni("tt")),this.element.appendChild(this.tooltipElem_),this.waitToBeAdded_()}waitToBeAdded_(){const e=new IntersectionObserver(t=>{t.forEach(i=>{i.target!==this.element||i.intersectionRatio===0||(this.update(),e.disconnect())})},{root:null});e.observe(this.element)}rebuildScaleIfNeeded_(e){if(this.boundsWidth_===e)return;this.boundsWidth_=e,this.tickElems_.forEach(u=>{Zu(u)}),this.tickElems_=[],this.labelElems_.forEach(u=>{Zu(u)}),this.labelElems_=[];const t=this.element.ownerDocument,i=this.unit_.ticks,s=this.unit_.pixels,l=((Math.ceil(e/2/s)+1)*2+1)*i,a=s/i;for(let u=0;u<l;u++){const h=u*a;if(u%i===0){const c=t.createElementNS(bn,"line");c.classList.add(ni("mjt")),c.setAttributeNS(null,"x1",String(h)),c.setAttributeNS(null,"y1","0"),c.setAttributeNS(null,"x2",String(h)),c.setAttributeNS(null,"y2","2"),this.svgElem_.appendChild(c),this.tickElems_.push(c);const d=t.createElement("div");d.classList.add(ni("l")),d.style.left=`${h}px`,this.offsetElem_.appendChild(d),this.labelElems_.push(d)}else{const c=t.createElementNS(bn,"line");c.classList.add(ni("mnt")),c.setAttributeNS(null,"x1",String(h)),c.setAttributeNS(null,"y1","0"),c.setAttributeNS(null,"x2",String(h)),c.setAttributeNS(null,"y2","2"),this.svgElem_.appendChild(c),this.tickElems_.push(c)}}}updateScale_(e){const t=this.unit_.value,i=this.unit_.pixels,s=this.value_.rawValue,r=Math.ceil(e/2/i)+1,o=s-s%t-t*r,l=u=>1-Math.pow(We(Math.abs(s-u)/(e/2*(t/i)),0,1),10);this.labelElems_.forEach((u,h)=>{const c=o+h*t;u.textContent=this.formatters_.ring(c),u.style.opacity=String(l(c))});const a=this.unit_.ticks;this.tickElems_.forEach((u,h)=>{const c=o+h/a*t;u.style.opacity=String(l(c))})}update(){const e=this.element.getBoundingClientRect().width,t=this.unit_.value,i=this.unit_.pixels,s=this.value_.rawValue,r=Math.ceil(e/2/i)+1,o=(s%t+t*r)*(i/t),l=e/2-o;this.offsetElem_.style.transform=`translateX(${l}px)`,this.tooltipElem_.textContent=this.formatters_.text(s),this.rebuildScaleIfNeeded_(e),this.updateScale_(e)}onValueChange_(){this.update()}onShowsTooltipChange_(e){e.rawValue?this.element.classList.add(ni(void 0,"tt")):this.element.classList.remove(ni(void 0,"tt"))}}class Ab{constructor(e,t){this.ox_=0,this.ov_=0,this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.tooltipEnabled_=t.tooltipEnabled,this.unit_=t.unit,this.showsTooltip_=rt(!1),this.view=new vY(e,{formatters:t.formatters,seriesId:t.seriesId,showsTooltip:this.showsTooltip_,unit:t.unit,value:this.value,viewProps:this.viewProps});const i=new qr(this.view.element);i.emitter.on("down",this.onPointerDown_),i.emitter.on("move",this.onPointerMove_),i.emitter.on("up",this.onPointerUp_)}onPointerDown_(e){const t=e.data;t.point&&(this.ox_=t.point.x,this.ov_=this.value.rawValue,this.tooltipEnabled_&&(this.showsTooltip_.rawValue=!0))}onPointerMove_(e){const t=e.data;if(!t.point)return;const i=t.point.x-this.ox_,s=this.unit_.pixels,r=this.unit_.value;this.value.setRawValue(this.ov_-i/s*r,{forceEmit:!1,last:!1})}onPointerUp_(){this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0}),this.showsTooltip_.rawValue=!1}}const zm=j("ckrtxt");class fY{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(zm());const i=e.createElement("div");i.classList.add(zm("r")),i.appendChild(t.ringView.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(zm("t")),s.appendChild(t.textView.element),this.element.appendChild(s)}}class CL{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.rc_=new Ab(e,{formatters:{ring:t.ringFormatter,text:t.textProps.get("formatter")},seriesId:t.seriesId,tooltipEnabled:!1,unit:t.ringUnit,value:this.value,viewProps:this.viewProps}),this.tc_=new Ma(e,{parser:t.parser,props:t.textProps,value:this.value,viewProps:this.viewProps}),this.view=new fY(e,{ringView:this.rc_.view,textView:this.tc_.view})}}function PL(n){const e=[],t=rb(n);t&&e.push(t);const i=sb(n);return i&&e.push(i),new La(e)}function wY(n){return n===0||n===1||n===2?n:void 0}function Ry(n){return n!==void 0?String(n):"0"}function _Y(n){const e=kt(sf(n.value));return t=>{const i=e(t),s=i.substr(0,1);return i+(s==="-"||s==="+"?" ":"")}}gt({id:"input-ring",type:"input",accept(n,e){if(typeof n!="number")return null;const t=vt(e,i=>Object.assign(Object.assign({},ad(i)),{series:i.optional.custom(wY),unit:i.optional.object({pixels:i.required.number,ticks:i.required.number,value:i.required.number}),view:i.required.constant("cameraring"),wide:i.optional.boolean}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>od,constraint:n=>PL(n.params),writer:n=>Yo},controller(n){var e,t,i;const s=(e=n.params.unit)!==null&&e!==void 0?e:{ticks:5,pixels:40,value:10},r=_Y(s),o=ld(n.params,n.initialValue);if(n.params.wide)return new Ab(n.document,{formatters:{ring:r,text:o.formatter},seriesId:(t=Ry(n.params.series))!==null&&t!==void 0?t:"0",tooltipEnabled:!0,unit:s,value:n.value,viewProps:n.viewProps});const l=W.fromObject(o);return new CL(n.document,{parser:Vi,ringFormatter:r,ringUnit:s,seriesId:(i=Ry(n.params.series))!==null&&i!==void 0?i:"0",textProps:l,value:n.value,viewProps:n.viewProps})}});gt({id:"input-wheel",type:"input",accept(n,e){if(typeof n!="number")return null;const t=vt(e,i=>Object.assign(Object.assign({},ad(i)),{amount:i.optional.number,view:i.required.constant("camerawheel"),wide:i.optional.boolean}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>od,constraint:n=>PL(n.params),writer:n=>Yo},controller(n){var e,t;const i=kt(0),s=ld(n.params,n.initialValue);return n.params.wide?new Ab(n.document,{formatters:{ring:i,text:s.formatter},seriesId:"w",tooltipEnabled:!0,unit:{ticks:10,pixels:40,value:((e=n.params.amount)!==null&&e!==void 0?e:s.pointerScale)*40},value:n.value,viewProps:n.viewProps}):new CL(n.document,{parser:Vi,ringFormatter:i,ringUnit:{ticks:10,pixels:40,value:((t=n.params.amount)!==null&&t!==void 0?t:s.pointerScale)*40},seriesId:"w",textProps:W.fromObject(s),value:n.value,viewProps:n.viewProps})}});function Ve(n){return n==null}function Mb(n){return n!==null&&typeof n=="object"}function hf(n){return n!==null&&typeof n=="object"}function bY(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function ko(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((i,s)=>{const r=n[s],o=e[s];return hf(r)&&hf(o)?Object.assign(Object.assign({},i),{[s]:ko(r,o)}):Object.assign(Object.assign({},i),{[s]:s in e?o:r})},{})}function gY(n){return Mb(n)?"target"in n:!1}const CY={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};let Ds=class Sl{static alreadyDisposed(){return new Sl({type:"alreadydisposed"})}static notBindable(){return new Sl({type:"notbindable"})}static notCompatible(e,t){return new Sl({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new Sl({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new Sl({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=CY[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}},jy=class yL{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const i=this.read();if(!yL.isBindable(i))throw Ds.notBindable();if(!(e in i))throw Ds.propertyNotFound(e);i[e]=t}},xn=class{constructor(){this.observers_={}}on(e,t){let i=this.observers_[e];return i||(i=this.observers_[e]=[]),i.push({handler:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter(s=>s.handler!==t)),this}emit(e,t){const i=this.observers_[e];i&&i.forEach(s=>{s.handler(t)})}},PY=class{constructor(e,t){var i;this.constraint_=t==null?void 0:t.constraint,this.equals_=(i=t==null?void 0:t.equals)!==null&&i!==void 0?i:(s,r)=>s===r,this.emitter=new xn,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,r=this.rawValue_;this.equals_(r,s)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:i,previousRawValue:r,rawValue:s,sender:this}))}},yY=class{constructor(e){this.emitter=new xn,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.value_;s===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:this.value_,sender:this}))}},EY=class{constructor(e){this.emitter=new xn,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}};function ot(n,e){const t=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!t&&!i?new yY(n):new PY(n,e)}function xY(n){return[new EY(n),(e,t)=>{n.setRawValue(e,t)}]}let Z=class EL{constructor(e){this.emitter=new xn,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((i,s)=>Object.assign(i,{[s]:ot(e[s])}),{})}static fromObject(e){const t=this.createCore(e);return new EL(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}},vd=class{constructor(e){this.values=Z.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(e,i),t)}},xL=class{constructor(e){this.values=Z.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");let s=e;return Ve(i)||(s=Math.max(s,i)),Ve(t)||(s=Math.min(s,t)),s}},$L=class{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,i=Math.round((e-t)/this.step);return t+i*this.step}},$Y=class{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}};const VY={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};let kY=class{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=VY[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}};const SY={"+":n=>n,"-":n=>-n,"~":n=>~n};let LY=class{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=SY[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}};function Tb(n){return(e,t)=>{for(let i=0;i<n.length;i++){const s=n[i](e,t);if(s!=="")return s}return""}}function eh(n,e){var t;const i=n.substr(e).match(/^\s+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function AY(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function th(n,e){var t;const i=n.substr(e).match(/^[0-9]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function MY(n,e){const t=th(n,e);if(t!=="")return t;const i=n.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";const s=th(n,e);return s===""?"":i+s}function Db(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const i=MY(n,e);return i===""?"":t+i}function VL(n,e){const t=n.substr(e,1);if(t==="0")return t;const i=AY(n,e);return e+=i.length,i===""?"":i+th(n,e)}function TY(n,e){const t=VL(n,e);if(e+=t.length,t==="")return"";const i=n.substr(e,1);if(e+=i.length,i!==".")return"";const s=th(n,e);return e+=s.length,t+i+s+Db(n,e)}function DY(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const i=th(n,e);return e+=i.length,i===""?"":t+i+Db(n,e)}function OY(n,e){const t=VL(n,e);return e+=t.length,t===""?"":t+Db(n,e)}const RY=Tb([TY,DY,OY]);function jY(n,e){var t;const i=n.substr(e).match(/^[01]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function NY(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const i=jY(n,e);return i===""?"":t+i}function BY(n,e){var t;const i=n.substr(e).match(/^[0-7]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function IY(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const i=BY(n,e);return i===""?"":t+i}function FY(n,e){var t;const i=n.substr(e).match(/^[0-9a-f]+/i);return(t=i&&i[0])!==null&&t!==void 0?t:""}function KY(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const i=FY(n,e);return i===""?"":t+i}const UY=Tb([NY,IY,KY]),HY=Tb([UY,RY]);function zY(n,e){const t=HY(n,e);return e+=t.length,t===""?null:{evaluable:new $Y(t),cursor:e}}function qY(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const i=SL(n,e);if(!i)return null;e=i.cursor,e+=eh(n,e).length;const s=n.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:i.evaluable,cursor:e}}function GY(n,e){var t;return(t=zY(n,e))!==null&&t!==void 0?t:qY(n,e)}function kL(n,e){const t=GY(n,e);if(t)return t;const i=n.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const s=kL(n,e);return s?(e=s.cursor,{cursor:e,evaluable:new LY(i,s.evaluable)}):null}function YY(n,e,t){t+=eh(e,t).length;const i=n.filter(s=>e.startsWith(s,t))[0];return i?(t+=i.length,t+=eh(e,t).length,{cursor:t,operator:i}):null}function XY(n,e){return(t,i)=>{const s=n(t,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const o=YY(e,t,i);if(!o)break;i=o.cursor;const l=n(t,i);if(!l)return null;i=l.cursor,r=new kY(o.operator,r,l.evaluable)}return r?{cursor:i,evaluable:r}:null}}const WY=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>XY(n,e),kL);function SL(n,e){return e+=eh(n,e).length,WY(n,e)}function ZY(n){const e=SL(n,0);return!e||e.cursor+eh(n,e.cursor).length!==n.length?null:e.evaluable}function Li(n){var e;const t=ZY(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function LL(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=Li(n);if(!Ve(e))return e}return 0}function Xt(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function se(n,e,t,i,s){const r=(n-e)/(t-e);return i+r*(s-i)}function Ny(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function tt(n,e,t){return Math.min(Math.max(n,e),t)}function AL(n,e){return(n%e+e)%e}function QY(n,e){return Ve(n.step)?Math.max(Ny(e),2):Ny(n.step)}function ML(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function JY(n,e){var t;const i=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function TL(n,e){return Ve(n.step)?null:new $L(n.step,e)}function DL(n){return!Ve(n.max)&&!Ve(n.min)?new vd({max:n.max,min:n.min}):!Ve(n.max)||!Ve(n.min)?new xL({max:n.max,min:n.min}):null}function OL(n,e){var t,i,s;return{formatter:(t=n.format)!==null&&t!==void 0?t:Xt(QY(n,e)),keyScale:(i=n.keyScale)!==null&&i!==void 0?i:ML(n),pointerScale:(s=n.pointerScale)!==null&&s!==void 0?s:JY(n,e)}}function RL(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function Ob(n){return{constraint:n.constraint,textProps:Z.fromObject(OL(n.params,n.initialValue))}}let Rb=class{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}},fd=class{constructor(e){this.target=e}},jL=class extends fd{constructor(e,t,i){super(e),this.value=t,this.last=i??!0}},eX=class extends fd{constructor(e,t){super(e),this.expanded=t}},tX=class extends fd{constructor(e,t){super(e),this.index=t}},jb=class extends Rb{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new xn,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new jL(this,t.binding.target.read(),e.options.last))}};function nX(n,e){const i=Object.keys(e).reduce((s,r)=>{if(s===void 0)return;const o=e[r],l=o(n[r]);return l.succeeded?Object.assign(Object.assign({},s),{[r]:l.value}):void 0},{});return i}function iX(n,e){return n.reduce((t,i)=>{if(t===void 0)return;const s=e(i);if(!(!s.succeeded||s.value===void 0))return[...t,s.value]},[])}function sX(n){return n===null?!1:typeof n=="object"}function ls(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const i=n(t);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function By(n){return{custom:e=>ls(e)(n),boolean:ls(e=>typeof e=="boolean"?e:void 0)(n),number:ls(e=>typeof e=="number"?e:void 0)(n),string:ls(e=>typeof e=="string"?e:void 0)(n),function:ls(e=>typeof e=="function"?e:void 0)(n),constant:e=>ls(t=>t===e?e:void 0)(n),raw:ls(e=>e)(n),object:e=>ls(t=>{if(sX(t))return nX(t,e)})(n),array:e=>ls(t=>{if(Array.isArray(t))return iX(t,e)})(n)}}const cf={optional:By(!0),required:By(!1)};function ft(n,e){const t=e(cf),i=cf.required.object(t)(n);return i.succeeded?i.value:void 0}function Gi(n,e,t,i){if(e&&!e(n))return!1;const s=ft(n,t);return s?i(s):!1}function Yi(n,e){var t;return ko((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function Nc(n){return"value"in n}function rX(n){if(!Mb(n)||!("binding"in n))return!1;const e=n.binding;return gY(e)}const ut="http://www.w3.org/2000/svg";function mp(n){n.offsetHeight}function oX(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function wd(n){return n.ontouchstart!==void 0}function lX(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const aX={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function _d(n,e){const t=n.createElementNS(ut,"svg");return t.innerHTML=aX[e],t}function NL(n,e,t){n.insertBefore(e,n.children[t])}function Nb(n){n.parentElement&&n.parentElement.removeChild(n)}function BL(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function uX(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function Bb(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function Es(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function li(n,e,t){Es(n.value(e),t)}const hX="tp";function N(n){return(t,i)=>[hX,"-",n,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}const hu=N("lbl");function cX(n,e){const t=n.createDocumentFragment();return e.split(`
`).map(s=>n.createTextNode(s)).forEach((s,r)=>{r>0&&t.appendChild(n.createElement("br")),t.appendChild(s)}),t}let pX=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(hu()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(hu("l")),li(t.props,"label",r=>{Ve(r)?this.element.classList.add(hu(void 0,"nol")):(this.element.classList.remove(hu(void 0,"nol")),uX(i),i.appendChild(cX(e,r)))}),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("div");s.classList.add(hu("v")),this.element.appendChild(s),this.valueElement=s}},dX=class{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new pX(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return Gi(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return Yi(null,{label:this.props.get("label")})}};function mX(){return["veryfirst","first","last","verylast"]}const Iy=N(""),Fy={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};let IL=class{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{mX().forEach(i=>{t.classList.remove(Iy(void 0,Fy[i]))}),this.blade.get("positions").forEach(i=>{t.classList.add(Iy(void 0,Fy[i]))})}),this.viewProps.handleDispose(()=>{Nb(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return Gi(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return Yi(null,Object.assign({},this.viewProps.exportState()))}},vX=class extends Rb{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const i=t.bind(this);return this.controller.buttonController.emitter.on(e,()=>{i(new fd(this))}),this}};function fX(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function Xo(n,e){return t=>{fX(n,e,t)}}function Ib(n,e){Es(n,t=>{e.textContent=t??""})}const qm=N("btn");let wX=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(qm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(qm("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(qm("t")),Ib(t.props.value("title"),s),this.buttonElement.appendChild(s)}},_X=class{constructor(e,t){this.emitter=new xn,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new wX(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return Gi(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return Yi(null,{title:this.props.get("title")})}onClick_(){this.emitter.emit("click",{sender:this})}},Ky=class extends IL{constructor(e,t){const i=new _X(e,{props:t.buttonProps,viewProps:t.viewProps}),s=new dX(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:t.viewProps}),this.buttonController=i,this.labelController=s}importState(e){return Gi(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return Yi(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}},bX=class{constructor(e){const[t,i]=e.split("-"),s=t.split(".");this.major=parseInt(s[0],10),this.minor=parseInt(s[1],10),this.patch=parseInt(s[2],10),this.prerelease=i??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}};const gX=new bX("2.0.1");function Ct(n){return Object.assign({core:gX},n)}Ct({id:"button",type:"blade",accept(n){const e=ft(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new Ky(n.document,{blade:n.blade,buttonProps:Z.fromObject({title:n.params.title}),labelProps:Z.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof Ky?new vX(n.controller):null}});function CX(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function PX(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function yX(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function EX(n){return Mb(n)?"refresh"in n&&typeof n.refresh=="function":!1}function xX(n,e){if(!jy.isBindable(n))throw Ds.notBindable();return new jy(n,e)}let $X=class{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new xn,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,i){const s=i??{},r=this.controller_.element.ownerDocument,o=this.pool_.createBinding(r,xX(e,t),s),l=this.pool_.createBindingApi(o);return this.add(l,s.index)}addFolder(e){return PX(this,e)}addButton(e){return CX(this,e)}addTab(e){return yX(this,e)}add(e,t){const i=e.controller;return this.controller_.rack.add(i,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,i=this.pool_.createBlade(t,e),s=this.pool_.createApi(i);return this.add(s,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.children.forEach(e=>{EX(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,i=this.pool_.createApi(t),s=rX(t.value)?t.value.binding:null;this.emitter_.emit("change",new jL(i,s?s.target.read():t.value.rawValue,e.options.last))}},Fb=class extends Rb{constructor(e,t){super(e),this.rackApi_=new $X(e.rackController,t)}refresh(){this.rackApi_.refresh()}},Kb=class extends IL{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return Gi(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((i,s)=>i.importState(t.children[s])))}exportState(){return Yi(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}};function pf(n){return"rackController"in n}let VX=class{constructor(e){this.emitter=new xn,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw Ds.shouldNeverHappen();const i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(r=>{this.cache_.add(r)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.allItems().forEach(s=>{this.cache_.delete(s)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}};function kX(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(Nc(i)&&i.value===e)return i}return null}function SX(n){return pf(n)?n.rackController.rack.bcSet_:null}let LX=class{constructor(e){var t,i;this.emitter=new xn,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new VX(SX),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var i;(i=e.parent)===null||i===void 0||i.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),Nc(i))i.value.emitter.on("change",this.onChildValueChange_);else if(pf(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.on("layout",this.onRackLayout_),r.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const i=e.item;if(Nc(i))i.value.emitter.off("change",this.onChildValueChange_);else if(pf(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.off("layout",this.onRackLayout_),r.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(s=>!s.viewProps.get("hidden")),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach(s=>{const r=[];s===t&&(r.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&r.push("veryfirst")),s===i&&(r.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&r.push("verylast")),s.blade.set("positions",r)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=kX(this.find(Nc),e.sender);if(!t)throw Ds.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}},Ub=class{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new LX({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let i=this.rack.children.length-1;i>=0;i--)this.rack.children[i].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&NL(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&Nb(e.bladeController.view.element)}};function FL(){return new Z({positions:ot([],{equals:bY})})}let bd=class KL extends Z{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=Z.createCore(t);return new KL(i)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!Ve(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const i=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};li(this,"expanded",i),li(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}};function AX(n,e){let t=0;return oX(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),mp(e),t=e.clientHeight,n.set("temporaryExpanded",null),mp(e)}),t}function Uy(n,e){e.style.height=n.styleHeight}function gd(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),Ve(n.get("expandedHeight"))){const t=AX(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),mp(e)}),n.emitter.on("change",()=>{Uy(n,e)}),Uy(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}let MX=class extends Fb{constructor(e,t){super(e,t),this.emitter_=new xn,this.controller.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",new eX(this,i.sender.rawValue))}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}};const UL=N("cnt");let TX=class{constructor(e,t){var i;this.className_=N((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),UL()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),li(this.foldable_,"completed",Xo(this.element,this.className_(void 0,"cpl")));const s=e.createElement("button");s.classList.add(this.className_("b")),li(t.props,"title",u=>{Ve(u)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const r=e.createElement("div");r.classList.add(this.className_("i")),this.element.appendChild(r);const o=e.createElement("div");o.classList.add(this.className_("t")),Ib(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}},Hy=class extends Kb{constructor(e,t){var i;const s=bd.create((i=t.expanded)!==null&&i!==void 0?i:!0),r=new TX(e,{foldable:s,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Ub({blade:t.blade,element:r.containerElement,root:t.root,viewProps:t.viewProps}),view:r})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=s,gd(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return Gi(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return Yi(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}};Ct({id:"folder",type:"blade",accept(n){const e=ft(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new Hy(n.document,{blade:n.blade,expanded:n.params.expanded,props:Z.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof Hy?new MX(n.controller,n.pool):null}});const DX=N("");function zy(n,e){return Xo(n,DX(void 0,e))}let Hb=class HL extends Z{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=xY(ot(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,i,s;const r=e??{};return new HL(Z.createCore({disabled:(t=r.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(i=r.hidden)!==null&&i!==void 0?i:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){Es(this.globalDisabled_,zy(e,"disabled")),li(this,"hidden",zy(e,"hidden"))}bindDisabled(e){Es(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){Es(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const i=e.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}};const qy=N("tbp");let OX=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(qy()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(qy("c")),this.element.appendChild(i),this.containerElement=i}};const cu=N("tbi");let RX=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(cu()),t.viewProps.bindClassModifiers(this.element),li(t.props,"selected",r=>{r?this.element.classList.add(cu(void 0,"sel")):this.element.classList.remove(cu(void 0,"sel"))});const i=e.createElement("button");i.classList.add(cu("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(cu("t")),Ib(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}},jX=class{constructor(e,t){this.emitter=new xn,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new RX(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}},df=class extends Kb{constructor(e,t){const i=new OX(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new Ub({blade:t.blade,element:i.containerElement,viewProps:t.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new jX(e,{props:t.itemProps,viewProps:Hb.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,li(this.props,"selected",s=>{this.itemController.props.set("selected",s),this.viewProps.set("hidden",!s)})}get itemController(){return this.ic_}importState(e){return Gi(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return Yi(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}},NX=class extends Fb{constructor(e,t){super(e,t),this.emitter_=new xn,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,i=new df(t,{blade:FL(),itemProps:Z.fromObject({selected:!1,title:e.title}),props:Z.fromObject({selected:!1}),viewProps:Hb.create()}),s=this.pool_.createApi(i);return this.rackApi_.add(s,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}onSelect_(e){this.emitter_.emit("select",new tX(this,e.rawValue))}},BX=class extends Fb{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}};const Gy=-1;let IX=class{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=ot(!0),this.selectedIndex=ot(Gy),this.items_=[]}add(e,t){const i=t??this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=Gy,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,i)=>{t.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,i)=>{t.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(i=>i===e.sender);this.items_.forEach((i,s)=>{i.rawValue=s===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}};const pu=N("tab");let FX=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(pu(),UL()),t.viewProps.bindClassModifiers(this.element),Es(t.empty,Xo(this.element,pu(void 0,"nop")));const i=e.createElement("div");i.classList.add(pu("t")),this.element.appendChild(i),this.itemsElement=i;const s=e.createElement("div");s.classList.add(pu("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(pu("c")),this.element.appendChild(r),this.contentsElement=r}},Yy=class extends Kb{constructor(e,t){const i=new IX,s=new FX(e,{empty:i.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new Ub({blade:t.blade,element:s.contentsElement,viewProps:t.viewProps}),view:s}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=this.rackController.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.tab=i}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;NL(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;Nb(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}};Ct({id:"tab",type:"blade",accept(n){const e=ft(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new Yy(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const i=new df(n.document,{blade:FL(),itemProps:Z.fromObject({selected:!1,title:t.title}),props:Z.fromObject({selected:!1}),viewProps:Hb.create()});e.add(i)}),e},api(n){return n.controller instanceof Yy?new NX(n.controller,n.pool):n.controller instanceof df?new BX(n.controller,n.pool):null}});let zb=class extends jb{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}},Ta=class{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,i)=>i.constrain(t),e)}};function vp(n,e){if(n instanceof e)return n;if(n instanceof Ta){const t=n.constraints.reduce((i,s)=>i||(s instanceof e?s:null),null);if(t)return t}return null}let Cd=class{constructor(e){this.values=Z.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(s=>s.value===e).length>0?e:t[0].value}};function Pd(n){var e;const t=cf;if(Array.isArray(n))return(e=ft({items:n},i=>({items:i.required.array(i.required.object({text:i.required.string,value:i.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function zL(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function qb(n){return Ve(n)?null:new Cd(zL(n))}const Gm=N("lst");let KX=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(Gm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(Gm("s")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const s=e.createElement("div");s.classList.add(Gm("m")),s.appendChild(_d(e,"dropdown")),this.element.appendChild(s),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,li(this.props_,"options",r=>{BL(this.selectElement),r.forEach(o=>{const l=e.createElement("option");l.textContent=o.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}},oa=class{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new KX(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return Gi(e,null,t=>({options:t.required.custom(Pd)}),t=>(this.props.set("options",zL(t.options)),!0))}exportProps(){return Yi(null,{options:this.props.get("options")})}};const Xy=N("pop");let UX=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Xy()),t.viewProps.bindClassModifiers(this.element),Es(t.shows,Xo(this.element,Xy(void 0,"v")))}},Gb=class{constructor(e,t){this.shows=ot(!1),this.viewProps=t.viewProps,this.view=new UX(e,{shows:this.shows,viewProps:this.viewProps})}};const Wy=N("txt");let HX=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Wy()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(Wy("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}},Yb=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new HX(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Ve(s)||(this.value.rawValue=s),this.view.refresh()}};function zX(n){return String(n)}function qL(n){return n==="false"?!1:!!n}function Zy(n){return zX(n)}function qX(n){return e=>n.reduce((t,i)=>t!==null?t:i(e),null)}const GX=Xt(0);function fp(n){return GX(n)+"%"}function GL(n){return String(n)}function mf(n){return n}function Wo({primary:n,secondary:e,forward:t,backward:i}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}n.emitter.on("change",o=>{r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),e.emitter.on("change",o=>{r(()=>{n.setRawValue(i(n.rawValue,e.rawValue),o.options)}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function Vt(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function la(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function Ai(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function YX(n){return n==="ArrowUp"||n==="ArrowDown"}function Xb(n){return YX(n)||n==="ArrowLeft"||n==="ArrowRight"}function Ym(n,e){var t,i;const s=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:n.pageX-(((t=s&&s.scrollX)!==null&&t!==void 0?t:0)+r.left),y:n.pageY-(((i=s&&s.scrollY)!==null&&i!==void 0?i:0)+r.top)}}let xt=class{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new xn,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Ym(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Ym(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Ym(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-s.left,y:i.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}};const Rn=N("txt");let XX=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Rn(),Rn(void 0,"num")),t.arrayPosition&&this.element.classList.add(Rn(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(Rn("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Rn()),this.inputElement.classList.add(Rn("i"));const s=e.createElement("div");s.classList.add(Rn("k")),this.element.appendChild(s),this.knobElement=s;const r=e.createElementNS(ut,"svg");r.classList.add(Rn("g")),this.knobElement.appendChild(r);const o=e.createElementNS(ut,"path");o.classList.add(Rn("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=e.createElementNS(ut,"path");l.classList.add(Rn("gh")),r.appendChild(l),this.guideHeadElem_=l;const a=e.createElement("div");a.classList.add(N("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(Rn(void 0,"drg"));return}this.element.classList.add(Rn(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),i=t+(t>0?-1:t<0?1:0),s=tt(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+s},0 L${i},4 L${i+s},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}},Ih=class{constructor(e,t){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(i=t.sliderProps)!==null&&i!==void 0?i:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=ot(null),this.view=new XX(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new xt(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,i;const s=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),r=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("max");let o=e;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Ve(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const t=Vt(this.props.get("keyScale"),la(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){Vt(this.props.get("keyScale"),la(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}};const Xm=N("sld");let WX=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Xm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Xm("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const s=e.createElement("div");s.classList.add(Xm("k")),this.trackElement.appendChild(s),this.knobElement=s,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=tt(se(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}},ZX=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new WX(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xt(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(se(tt(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Vt(this.props.get("keyScale"),Ai(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){Vt(this.props.get("keyScale"),Ai(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const Wm=N("sldtxt");let QX=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Wm());const i=e.createElement("div");i.classList.add(Wm("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Wm("t")),this.textView_=t.textView,s.appendChild(this.textView_.element),this.element.appendChild(s)}},Qy=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new ZX(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new Ih(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new QX(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return Gi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const i=this.sliderC_.props;return i.set("max",t.max),i.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return Yi(null,{max:e.get("max"),min:e.get("min")})}};function JX(n){return{sliderProps:new Z({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new Z({formatter:ot(n.formatter),keyScale:n.keyScale,pointerScale:ot(n.pointerScale)})}}const eW={containerUnitSize:"cnt-usz"};function YL(n){return`--${eW[n]}`}function nh(n){return RL(n)}function Bt(n){if(hf(n))return ft(n,nh)}function fs(n,e){if(!n)return;const t=[],i=TL(n,e);i&&t.push(i);const s=DL(n);return s&&t.push(s),new Ta(t)}function yd(n){if(n==="inline"||n==="popup")return n}function Fh(n,e){n.write(e)}const vc=N("ckb");let tW=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(vc()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(vc("l")),this.element.appendChild(i);const s=e.createElement("input");s.classList.add(vc("i")),s.type="checkbox",i.appendChild(s),this.inputElement=s,t.viewProps.bindDisabled(this.inputElement);const r=e.createElement("div");r.classList.add(vc("w")),i.appendChild(r);const o=_d(e,"check");r.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}},nW=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new tW(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked}};function iW(n){const e=[],t=qb(n.options);return t&&e.push(t),new Ta(e)}Ct({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=ft(e,i=>({options:i.optional.custom(Pd),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>qL,constraint:n=>iW(n.params),writer:n=>Fh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&vp(i,Cd);return s?new oa(e,{props:new Z({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new nW(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof oa?new zb(n.controller):null}});const to=N("col");let sW=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(to()),t.foldable.bindExpandedClass(this.element,to(void 0,"expanded")),li(t.foldable,"completed",Xo(this.element,to(void 0,"cpl")));const i=e.createElement("div");i.classList.add(to("h")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(to("s")),i.appendChild(s),this.swatchElement=s;const r=e.createElement("div");if(r.classList.add(to("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(to("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};function rW(n,e,t){const i=tt(n/255,0,1),s=tt(e/255,0,1),r=tt(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u=0,h=0;const c=(l+o)/2;return a!==0&&(h=a/(1-Math.abs(o+l-1)),i===o?u=(s-r)/a:s===o?u=2+(r-i)/a:u=4+(i-s)/a,u=u/6+(u<0?1:0)),[u*360,h*100,c*100]}function oW(n,e,t){const i=(n%360+360)%360,s=tt(e/100,0,1),r=tt(t/100,0,1),o=(1-Math.abs(2*r-1))*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o/2;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function lW(n,e,t){const i=tt(n/255,0,1),s=tt(e/255,0,1),r=tt(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u;a===0?u=0:o===i?u=60*(((s-r)/a%6+6)%6):o===s?u=60*((r-i)/a+2):u=60*((i-s)/a+4);const h=o===0?0:a/o,c=o;return[u,h*100,c*100]}function XL(n,e,t){const i=AL(n,360),s=tt(e/100,0,1),r=tt(t/100,0,1),o=r*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function aW(n,e,t){const i=t+e*(100-Math.abs(2*t-100))/200;return[n,i!==0?e*(100-Math.abs(2*t-100))/i:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function uW(n,e,t){const i=100-Math.abs(t*(200-e)/100-100);return[n,i!==0?e*t/i:0,t*(200-e)/(2*100)]}function Mi(n){return[n[0],n[1],n[2]]}function Ed(n,e){return[n[0],n[1],n[2],e]}const hW={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:aW,rgb:oW},hsv:{hsl:uW,hsv:(n,e,t)=>[n,e,t],rgb:XL},rgb:{hsl:rW,hsv:lW,rgb:(n,e,t)=>[n,e,t]}};function aa(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function cW(n,e){return n===e?e:AL(n,e)}function WL(n,e,t){var i;const s=aa(e,t);return[e==="rgb"?tt(n[0],0,s[0]):cW(n[0],s[0]),tt(n[1],0,s[1]),tt(n[2],0,s[2]),tt((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function Jy(n,e,t,i){const s=aa(e,t),r=aa(e,i);return n.map((o,l)=>o/s[l]*r[l])}function ZL(n,e,t){const i=Jy(n,e.mode,e.type,"int"),s=hW[e.mode][t.mode](...i);return Jy(s,t.mode,"int",t.type)}let pe=class QL{static black(){return new QL([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=WL(e,t,this.type)}getComponents(e){return Ed(ZL(Mi(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const nr=N("colp");let pW=class{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(nr()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(nr("hsv"));const s=e.createElement("div");s.classList.add(nr("sv")),this.svPaletteView_=t.svPaletteView,s.appendChild(this.svPaletteView_.element),i.appendChild(s);const r=e.createElement("div");r.classList.add(nr("h")),this.hPaletteView_=t.hPaletteView,r.appendChild(this.hPaletteView_.element),i.appendChild(r),this.element.appendChild(i);const o=e.createElement("div");if(o.classList.add(nr("rgb")),this.textsView_=t.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const l=e.createElement("div");l.classList.add(nr("a"));const a=e.createElement("div");a.classList.add(nr("ap")),a.appendChild(this.alphaViews_.palette.element),l.appendChild(a);const u=e.createElement("div");u.classList.add(nr("at")),u.appendChild(this.alphaViews_.text.element),l.appendChild(u),this.element.appendChild(l)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}};function dW(n){return n==="int"?"int":n==="float"?"float":void 0}function Wb(n){return ft(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(dW)}),expanded:e.optional.boolean,picker:e.optional.custom(yd),readonly:e.optional.constant(!1)}))}function So(n){return n?.1:1}function JL(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}let Zb=class{constructor(e,t){this.type="float",this.mode=t,this.comps_=WL(e,t,this.type)}getComponents(e){return Ed(ZL(Mi(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const mW={int:(n,e)=>new pe(n,e),float:(n,e)=>new Zb(n,e)};function Qb(n,e,t){return mW[t](n,e)}function vW(n){return n.type==="float"}function fW(n){return n.type==="int"}function wW(n){const e=n.getComponents(),t=aa(n.mode,"int");return new pe([Math.round(se(e[0],0,1,0,t[0])),Math.round(se(e[1],0,1,0,t[1])),Math.round(se(e[2],0,1,0,t[2])),e[3]],n.mode)}function _W(n){const e=n.getComponents(),t=aa(n.mode,"int");return new Zb([se(e[0],0,t[0],0,1),se(e[1],0,t[1],0,1),se(e[2],0,t[2],0,1),e[3]],n.mode)}function zt(n,e){if(n.type===e)return n;if(fW(n)&&e==="float")return _W(n);if(vW(n)&&e==="int")return wW(n);throw Ds.shouldNeverHappen()}function bW(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function Gn(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const gW={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function eA(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),i=e[2];return gW[i](t)}function tA(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Gn(e[1],255),Gn(e[2],255),Gn(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function CW(n){const e=tA(n);return e?new pe(e,"rgb"):null}function nA(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Gn(e[1],255),Gn(e[2],255),Gn(e[3],255),Gn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function PW(n){const e=nA(n);return e?new pe(e,"rgb"):null}function iA(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[eA(e[1]),Gn(e[2],100),Gn(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function yW(n){const e=iA(n);return e?new pe(e,"hsl"):null}function sA(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[eA(e[1]),Gn(e[2],100),Gn(e[3],100),Gn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function EW(n){const e=sA(n);return e?new pe(e,"hsl"):null}function rA(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function xW(n){const e=rA(n);return e?new pe(e,"rgb"):null}function oA(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),se(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),se(parseInt(t[4],16),0,255,0,1)]:null}function $W(n){const e=oA(n);return e?new pe(e,"rgb"):null}function lA(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function VW(n){return e=>{const t=lA(e);return t?Qb(t,"rgb",n):null}}function aA(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function kW(n){return e=>{const t=aA(e);return t?Qb(t,"rgb",n):null}}const SW=[{parser:rA,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:oA,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:tA,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:nA,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:iA,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:sA,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:lA,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:aA,result:{alpha:!0,mode:"rgb",notation:"object"}}];function LW(n){return SW.reduce((e,{parser:t,result:i})=>e||(t(n)?i:null),null)}function AW(n,e="int"){const t=LW(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function Kh(n){const e=[xW,$W,CW,PW,yW,EW];e.push(VW("int"),kW("int"));const t=qX(e);return i=>{const s=t(i);return s?zt(s,n):null}}function MW(n){const e=Kh("int");if(typeof n!="string")return pe.black();const t=e(n);return t??pe.black()}function uA(n){const e=tt(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function Jb(n,e="#"){const t=Mi(n.getComponents("rgb")).map(uA).join("");return`${e}${t}`}function eg(n,e="#"){const t=n.getComponents("rgb"),i=[t[0],t[1],t[2],t[3]*255].map(uA).join("");return`${e}${i}`}function hA(n){const e=Xt(0),t=zt(n,"int");return`rgb(${Mi(t.getComponents("rgb")).map(s=>e(s)).join(", ")})`}function Bc(n){const e=Xt(2),t=Xt(0);return`rgba(${zt(n,"int").getComponents("rgb").map((r,o)=>(o===3?e:t)(r)).join(", ")})`}function TW(n){const e=[Xt(0),fp,fp],t=zt(n,"int");return`hsl(${Mi(t.getComponents("hsl")).map((s,r)=>e[r](s)).join(", ")})`}function DW(n){const e=[Xt(0),fp,fp,Xt(2)];return`hsla(${zt(n,"int").getComponents("hsl").map((s,r)=>e[r](s)).join(", ")})`}function cA(n,e){const t=Xt(e==="float"?2:0),i=["r","g","b"],s=zt(n,e);return`{${Mi(s.getComponents("rgb")).map((o,l)=>`${i[l]}: ${t(o)}`).join(", ")}}`}function OW(n){return e=>cA(e,n)}function pA(n,e){const t=Xt(2),i=Xt(e==="float"?2:0),s=["r","g","b","a"];return`{${zt(n,e).getComponents("rgb").map((l,a)=>{const u=a===3?t:i;return`${s[a]}: ${u(l)}`}).join(", ")}}`}function RW(n){return e=>pA(e,n)}const jW=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:Jb},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:eg},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:hA},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:Bc},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:TW},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:DW},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:OW(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:RW(e)}],[])];function dA(n){return jW.reduce((e,t)=>e||(bW(t.format,n)?t.stringifier:null),null)}const du=N("apl");let NW=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(du()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(du("b")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(du("c")),i.appendChild(s),this.colorElem_=s;const r=e.createElement("div");r.classList.add(du("m")),this.element.appendChild(r),this.markerElem_=r;const o=e.createElement("div");o.classList.add(du("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new pe([t[0],t[1],t[2],0],"rgb"),s=new pe([t[0],t[1],t[2],255],"rgb"),r=["to right",Bc(i),Bc(s)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=Bc(e);const o=se(t[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}},BW=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new NW(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,s=this.value.rawValue,[r,o,l]=s.getComponents("hsv");this.value.setRawValue(new pe([r,o,l,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Vt(So(!0),Ai(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new pe([s,r,o,l+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Vt(So(!0),Ai(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const cl=N("coltxt");function IW(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((i,s)=>{const r=n.createElement("option");return r.textContent=s.text,r.value=s.value,i.appendChild(r),i},n.createDocumentFragment())),e}let FW=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(cl()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(cl("m")),this.modeElem_=IW(e),this.modeElem_.classList.add(cl("ms")),i.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const s=e.createElement("div");s.classList.add(cl("mm")),s.appendChild(_d(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(cl("w")),this.element.appendChild(r),this.inputsElem_=r,this.inputViews_=t.inputViews,this.applyInputViews_(),Es(t.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){BL(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const i=e.createElement("div");i.classList.add(cl("c")),i.appendChild(t.element),this.inputsElem_.appendChild(i)})}};function KW(n){return Xt(n==="float"?2:0)}function UW(n,e,t){const i=aa(n,e)[t];return new vd({min:0,max:i})}function HW(n,e,t){return new Ih(n,{arrayPosition:t===0?"fst":t===2?"lst":"mid",parser:e.parser,props:Z.fromObject({formatter:KW(e.colorType),keyScale:So(!1),pointerScale:e.colorType==="float"?.01:1}),value:ot(0,{constraint:UW(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function zW(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:Li,viewProps:e.viewProps};return[0,1,2].map(i=>{const s=HW(n,t,i);return Wo({primary:e.value,secondary:s.value,forward(r){return zt(r,e.colorType).getComponents(e.colorMode)[i]},backward(r,o){const l=e.colorMode,u=zt(r,e.colorType).getComponents(l);u[i]=o;const h=Qb(Ed(Mi(u),u[3]),l,e.colorType);return zt(h,"int")}}),s})}function qW(n,e){const t=new Yb(n,{parser:Kh("int"),props:Z.fromObject({formatter:Jb}),value:ot(pe.black()),viewProps:e.viewProps});return Wo({primary:e.value,secondary:t.value,forward:i=>new pe(Mi(i.getComponents()),i.mode),backward:(i,s)=>new pe(Ed(Mi(s.getComponents(i.mode)),i.getComponents()[3]),i.mode)}),[t]}function GW(n){return n!=="hex"}let YW=class{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=ot(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new FW(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return GW(t)?zW(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):qW(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(i=>i.view)}};const Zm=N("hpl");let XW=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Zm()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Zm("c")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Zm("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=hA(new pe([t,100,100],"hsv"));const i=se(t,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}},WW=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new XW(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=se(tt(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),s=this.value.rawValue,[,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new pe([i,r,o,l],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=Vt(So(!1),Ai(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new pe([s+t,r,o,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){Vt(So(!1),Ai(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const Qm=N("svp"),eE=64;let ZW=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Qm()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=eE,i.width=eE,i.classList.add(Qm("c")),this.element.appendChild(i),this.canvasElement=i;const s=e.createElement("div");s.classList.add(Qm("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=lX(this.canvasElement);if(!e)return;const i=this.value.rawValue.getComponents("hsv"),s=this.canvasElement.width,r=this.canvasElement.height,o=e.getImageData(0,0,s,r),l=o.data;for(let h=0;h<r;h++)for(let c=0;c<s;c++){const d=se(c,0,s,0,100),p=se(h,0,r,100,0),v=XL(i[0],d,p),m=(h*s+c)*4;l[m]=v[0],l[m+1]=v[1],l[m+2]=v[2],l[m+3]=255}e.putImageData(o,0,0);const a=se(i[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const u=se(i[2],0,100,100,0);this.markerElem_.style.top=`${u}%`}onValueChange_(){this.update_()}},QW=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new ZW(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xt(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=se(e.point.x,0,e.bounds.width,0,100),s=se(e.point.y,0,e.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new pe([r,i,s,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){Xb(e.key)&&e.preventDefault();const[t,i,s,r]=this.value.rawValue.getComponents("hsv"),o=So(!1),l=Vt(o,Ai(e)),a=Vt(o,la(e));l===0&&a===0||this.value.setRawValue(new pe([t,i+l,s+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=So(!1),i=Vt(t,Ai(e)),s=Vt(t,la(e));i===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},JW=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new WW(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new QW(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new BW(e,{value:this.value,viewProps:this.viewProps}),text:new Ih(e,{parser:Li,props:Z.fromObject({pointerScale:.01,keyScale:.1,formatter:Xt(2)}),value:ot(0,{constraint:new vd({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Wo({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.getComponents()[3],backward:(i,s)=>{const r=i.getComponents();return r[3]=s,new pe(r,i.mode)}}),this.textsC_=new YW(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new pW(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}};const Jm=N("colsw");let eZ=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(Jm()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Jm("sw")),this.element.appendChild(i),this.swatchElem_=i;const s=e.createElement("button");s.classList.add(Jm("b")),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=eg(e)}onValueChange_(){this.update_()}},tZ=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new eZ(e,{value:this.value,viewProps:this.viewProps})}},tg=class{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=bd.create(t.expanded),this.swatchC_=new tZ(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new Yb(e,{parser:t.parser,props:Z.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new sW(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new Gb(e,{viewProps:this.viewProps}):null;const s=new JW(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),Wo({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),gd(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=Bb(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!wd(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}};function nZ(n){return Mi(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function iZ(n){return n.getComponents("rgb").reduce((e,t,i)=>{const s=Math.floor(i===3?t*255:t)&255;return e<<8|s},0)>>>0}function sZ(n){return new pe([n>>16&255,n>>8&255,n&255],"rgb")}function rZ(n){return new pe([n>>24&255,n>>16&255,n>>8&255,se(n&255,0,255,0,1)],"rgb")}function oZ(n){return typeof n!="number"?pe.black():sZ(n)}function lZ(n){return typeof n!="number"?pe.black():rZ(n)}function Ic(n,e){return typeof n!="object"||Ve(n)?!1:e in n&&typeof n[e]=="number"}function mA(n){return Ic(n,"r")&&Ic(n,"g")&&Ic(n,"b")}function vA(n){return mA(n)&&Ic(n,"a")}function fA(n){return mA(n)}function ng(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),i=e.getComponents();for(let s=0;s<t.length;s++)if(t[s]!==i[s])return!1;return!0}function tE(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function aZ(n){const e=dA(n);return e?(t,i)=>{Fh(t,e(i))}:null}function uZ(n){const e=n?iZ:nZ;return(t,i)=>{Fh(t,e(i))}}function hZ(n,e,t){const s=zt(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b),n.writeProperty("a",s.a)}function cZ(n,e,t){const s=zt(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b)}function pZ(n,e){return(t,i)=>{n?hZ(t,i,e):cZ(t,i,e)}}function dZ(n){var e;return!!(!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function mZ(n){return n?e=>eg(e,"0x"):e=>Jb(e,"0x")}function vZ(n){return"color"in n||n.view==="color"}Ct({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!vZ(e))return null;const t=Wb(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:dZ(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?lZ:oZ,equals:ng,writer:n=>uZ(n.params.supportsAlpha)},controller:n=>{var e,t;return new tg(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:mZ(n.params.supportsAlpha),parser:Kh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function fZ(n,e){if(!fA(n))return zt(pe.black(),e);if(e==="int"){const t=tE(n);return new pe(t,"rgb")}if(e==="float"){const t=tE(n);return new Zb(t,"rgb")}return zt(pe.black(),"int")}function wZ(n){return vA(n)}function _Z(n){return e=>{const t=fZ(e,n);return zt(t,"int")}}function bZ(n,e){return t=>n?pA(t,e):cA(t,e)}Ct({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!fA(n))return null;const i=Wb(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{colorType:(t=JL(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>_Z(n.params.colorType),equals:ng,writer:n=>pZ(wZ(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const i=vA(n.initialValue);return new tg(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:bZ(i,n.params.colorType),parser:Kh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:i,value:n.value,viewProps:n.viewProps})}});Ct({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=AW(n,JL(e));if(!t)return null;const i=dA(t);if(!i)return null;const s=Wb(e);return s?{initialValue:n,params:Object.assign(Object.assign({},s),{format:t,stringifier:i})}:null},binding:{reader:()=>MW,equals:ng,writer:n=>{const e=aZ(n.params.format);if(!e)throw Ds.notBindable();return e}},controller:n=>{var e,t;return new tg(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:Kh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});let Lo=class{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((i,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(i))!==null&&o!==void 0?o:i});return this.asm_.fromComponents(t)}};const nE=N("pndtxt");let gZ=class{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(nE()),this.textViews.forEach(i=>{const s=e.createElement("div");s.classList.add(nE("a")),s.appendChild(i.element),this.element.appendChild(s)})}};function CZ(n,e,t){return new Ih(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:ot(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}let xd=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((i,s)=>CZ(e,t,s)),this.acs_.forEach((i,s)=>{Wo({primary:this.value,secondary:i.value,forward:r=>t.assembly.toComponents(r)[s],backward:(r,o)=>{const l=t.assembly.toComponents(r);return l[s]=o,t.assembly.fromComponents(l)}})}),this.view=new gZ(e,{textViews:this.acs_.map(i=>i.view)})}get textControllers(){return this.acs_}},PZ=class extends jb{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}};function yZ(n,e){const t=[],i=TL(n,e);i&&t.push(i);const s=DL(n);s&&t.push(s);const r=qb(n.options);return r&&t.push(r),new Ta(t)}Ct({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=ft(e,i=>Object.assign(Object.assign({},RL(i)),{options:i.optional.custom(Pd),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>LL,constraint:n=>yZ(n.params,n.initialValue),writer:n=>Fh},controller:n=>{const e=n.value,t=n.constraint,i=t&&vp(t,Cd);if(i)return new oa(n.document,{props:new Z({options:i.values.value("options")}),value:e,viewProps:n.viewProps});const s=OL(n.params,e.rawValue),r=t&&vp(t,vd);return r?new Qy(n.document,Object.assign(Object.assign({},JX(Object.assign(Object.assign({},s),{keyScale:ot(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:Li,value:e,viewProps:n.viewProps})):new Ih(n.document,{parser:Li,props:Z.fromObject(s),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof Qy?new PZ(n.controller):n.controller.valueController instanceof oa?new zb(n.controller):null}});let Sr=class{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(Ve(e))return!1;const t=e.x,i=e.y;return!(typeof t!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}};const wA={toComponents:n=>n.getComponents(),fromComponents:n=>new Sr(...n)},pl=N("p2d");let EZ=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(pl()),t.viewProps.bindClassModifiers(this.element),Es(t.expanded,Xo(this.element,pl(void 0,"expanded")));const i=e.createElement("div");i.classList.add(pl("h")),this.element.appendChild(i);const s=e.createElement("button");s.classList.add(pl("b")),s.appendChild(_d(e,"p2dpad")),t.viewProps.bindDisabled(s),i.appendChild(s),this.buttonElement=s;const r=e.createElement("div");if(r.classList.add(pl("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(pl("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};const ir=N("p2dp");let xZ=class{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(ir()),t.layout==="popup"&&this.element.classList.add(ir(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(ir("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=e.createElementNS(ut,"svg");s.classList.add(ir("g")),this.padElement.appendChild(s),this.svgElem_=s;const r=e.createElementNS(ut,"line");r.classList.add(ir("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=e.createElementNS(ut,"line");o.classList.add(ir("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const l=e.createElementNS(ut,"line");l.classList.add(ir("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const a=e.createElement("div");a.classList.add(ir("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.props_.get("max"),s=se(e,-i,+i,0,100),r=se(t,-i,+i,0,100),o=this.props_.get("invertsY")?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${s}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${s}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}};function iE(n,e,t){return[Vt(e[0],Ai(n)),Vt(e[1],la(n))*(t?1:-1)]}let $Z=class{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new xZ(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new xt(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.props.get("max"),s=se(e.point.x,0,e.bounds.width,-i,+i),r=se(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new Sr(s,r),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){Xb(e.key)&&e.preventDefault();const[t,i]=iE(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(new Sr(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=iE(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},VZ=class{constructor(e,t){var i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=bd.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new Gb(e,{viewProps:this.viewProps}):null;const r=new $Z(e,{layout:t.pickerLayout,props:new Z({invertsY:ot(t.invertsY),max:ot(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.textC_=new xd(e,{assembly:wA,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new EZ(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Wo({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),gd(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=Bb(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!wd(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}};function kZ(n){return Sr.isObject(n)?new Sr(n.x,n.y):new Sr}function SZ(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function LZ(n,e){return new Lo({assembly:wA,components:[fs(Object.assign(Object.assign({},n),n.x),e.x),fs(Object.assign(Object.assign({},n),n.y),e.y)]})}function sE(n,e){var t,i;if(!Ve(n.min)||!Ve(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((i=n.max)!==null&&i!==void 0?i:0));const s=ML(n);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function AZ(n,e){var t,i;const s=sE(ko(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),r=sE(ko(n,(i=n.y)!==null&&i!==void 0?i:{}),e.y);return Math.max(s,r)}function MZ(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}Ct({id:"input-point2d",type:"input",accept:(n,e)=>{if(!Sr.isObject(n))return null;const t=ft(e,i=>Object.assign(Object.assign({},nh(i)),{expanded:i.optional.boolean,picker:i.optional.custom(yd),readonly:i.optional.constant(!1),x:i.optional.custom(Bt),y:i.optional.object(Object.assign(Object.assign({},nh(i)),{inverted:i.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>kZ,constraint:n=>LZ(n.params,n.initialValue),equals:Sr.equals,writer:()=>SZ},controller:n=>{var e,t;const i=n.document,s=n.value,r=n.constraint,o=[n.params.x,n.params.y];return new VZ(i,{axes:s.rawValue.getComponents().map((l,a)=>{var u;return Ob({constraint:r.components[a],initialValue:l,params:ko(n.params,(u=o[a])!==null&&u!==void 0?u:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:MZ(n.params),max:AZ(n.params,s.rawValue),parser:Li,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:n.viewProps})}});let Kl=class{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(Ve(e))return!1;const t=e.x,i=e.y,s=e.z;return!(typeof t!="number"||typeof i!="number"||typeof s!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}};const _A={toComponents:n=>n.getComponents(),fromComponents:n=>new Kl(...n)};function TZ(n){return Kl.isObject(n)?new Kl(n.x,n.y,n.z):new Kl}function DZ(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function OZ(n,e){return new Lo({assembly:_A,components:[fs(Object.assign(Object.assign({},n),n.x),e.x),fs(Object.assign(Object.assign({},n),n.y),e.y),fs(Object.assign(Object.assign({},n),n.z),e.z)]})}Ct({id:"input-point3d",type:"input",accept:(n,e)=>{if(!Kl.isObject(n))return null;const t=ft(e,i=>Object.assign(Object.assign({},nh(i)),{readonly:i.optional.constant(!1),x:i.optional.custom(Bt),y:i.optional.custom(Bt),z:i.optional.custom(Bt)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>TZ,constraint:n=>OZ(n.params,n.initialValue),equals:Kl.equals,writer:n=>DZ},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z];return new xd(n.document,{assembly:_A,axes:e.rawValue.getComponents().map((s,r)=>{var o;return Ob({constraint:t.components[r],initialValue:s,params:ko(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Li,value:e,viewProps:n.viewProps})}});let Ul=class{constructor(e=0,t=0,i=0,s=0){this.x=e,this.y=t,this.z=i,this.w=s}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(Ve(e))return!1;const t=e.x,i=e.y,s=e.z,r=e.w;return!(typeof t!="number"||typeof i!="number"||typeof s!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}};const bA={toComponents:n=>n.getComponents(),fromComponents:n=>new Ul(...n)};function RZ(n){return Ul.isObject(n)?new Ul(n.x,n.y,n.z,n.w):new Ul}function jZ(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function NZ(n,e){return new Lo({assembly:bA,components:[fs(Object.assign(Object.assign({},n),n.x),e.x),fs(Object.assign(Object.assign({},n),n.y),e.y),fs(Object.assign(Object.assign({},n),n.z),e.z),fs(Object.assign(Object.assign({},n),n.w),e.w)]})}Ct({id:"input-point4d",type:"input",accept:(n,e)=>{if(!Ul.isObject(n))return null;const t=ft(e,i=>Object.assign(Object.assign({},nh(i)),{readonly:i.optional.constant(!1),w:i.optional.custom(Bt),x:i.optional.custom(Bt),y:i.optional.custom(Bt),z:i.optional.custom(Bt)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>RZ,constraint:n=>NZ(n.params,n.initialValue),equals:Ul.equals,writer:n=>jZ},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z,n.params.w];return new xd(n.document,{assembly:bA,axes:e.rawValue.getComponents().map((s,r)=>{var o;return Ob({constraint:t.components[r],initialValue:s,params:ko(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Li,value:e,viewProps:n.viewProps})}});function BZ(n){const e=[],t=qb(n.options);return t&&e.push(t),new Ta(e)}Ct({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=ft(e,i=>({readonly:i.optional.constant(!1),options:i.optional.custom(Pd)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>GL,constraint:n=>BZ(n.params),writer:n=>Fh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&vp(i,Cd);return s?new oa(e,{props:new Z({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new Yb(e,{parser:r=>r,props:Z.fromObject({formatter:mf}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof oa?new zb(n.controller):null}});const $d={monitor:{defaultInterval:200,defaultRows:3}},rE=N("mll");let IZ=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(rE()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(rE("i")),i.style.height=`calc(var(${YL("containerUnitSize")}) * ${t.rows})`,i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach(s=>{s!==void 0&&i.push(this.formatter_(s))}),e.textContent=i.join(`
`),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}},ig=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new IZ(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}};const oE=N("sgl");let FZ=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(oE()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(oE("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}},sg=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new FZ(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}};Ct({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=ft(e,i=>({readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>qL},controller:n=>{var e;return n.value.rawValue.length===1?new sg(n.document,{formatter:Zy,value:n.value,viewProps:n.viewProps}):new ig(n.document,{formatter:Zy,rows:(e=n.params.rows)!==null&&e!==void 0?e:$d.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});let KZ=class extends jb{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}};const sr=N("grl");let UZ=class{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(sr()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(ut,"svg");i.classList.add(sr("g")),i.style.height=`calc(var(${YL("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(ut,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=e.createElement("div");r.classList.add(sr("t"),N("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,i=this.props_.get("min"),s=this.props_.get("max"),r=[];this.value.rawValue.forEach((h,c)=>{if(h===void 0)return;const d=se(c,0,t,0,e.width),p=se(h,i,s,e.height,0);r.push([d,p].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,l=this.value.rawValue[this.cursor_.rawValue];if(l===void 0){o.classList.remove(sr("t","a"));return}const a=se(this.cursor_.rawValue,0,t,0,e.width),u=se(l,i,s,e.height,0);o.style.left=`${a}px`,o.style.top=`${u}px`,o.textContent=`${this.formatter_(l)}`,o.classList.contains(sr("t","a"))||(o.classList.add(sr("t","a"),sr("t","in")),mp(o),o.classList.remove(sr("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}},gA=class{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=ot(-1),this.view=new UZ(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!wd(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new xt(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return Gi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return Yi(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(se(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(se(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}};function vf(n){return Ve(n.format)?Xt(2):n.format}function HZ(n){var e;return n.value.rawValue.length===1?new sg(n.document,{formatter:vf(n.params),value:n.value,viewProps:n.viewProps}):new ig(n.document,{formatter:vf(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:$d.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function zZ(n){var e,t,i;return new gA(n.document,{formatter:vf(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:$d.monitor.defaultRows,props:Z.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(i=n.params.min)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function lE(n){return n.view==="graph"}Ct({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=ft(e,i=>({format:i.optional.function,max:i.optional.number,min:i.optional.number,readonly:i.required.constant(!0),rows:i.optional.number,view:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>lE(n)?64:1,reader:n=>LL},controller:n=>lE(n.params)?zZ(n):HZ(n),api:n=>n.controller.valueController instanceof gA?new KZ(n.controller):null});Ct({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=ft(e,i=>({multiline:i.optional.boolean,readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>GL},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new ig(n.document,{formatter:mf,rows:(e=n.params.rows)!==null&&e!==void 0?e:$d.monitor.defaultRows,value:t,viewProps:n.viewProps}):new sg(n.document,{formatter:mf,value:t,viewProps:n.viewProps})}});class CA{multiply(e){return this.format(this.quat.multiply(e.quat))}premultiply(e){return this.format(e.multiply(this))}slerp(e,t){return this.format(this.quat.slerp(e.quat,t))}}function PA(n,e,t){return Math.min(Math.max(n,e),t)}function qZ(n,e){return Math.floor(n/e)*e}function GZ(n,e){return n-qZ(n,e)}function Vu(n){return GZ(n+Math.PI,Math.PI*2)-Math.PI}class Lr extends CA{static fromQuaternion(e,t,i){const s=e.toMat3(),[r,o,l,a]=t==="XYZ"?[0,1,2,1]:t==="XZY"?[0,2,1,-1]:t==="YXZ"?[1,0,2,-1]:t==="YZX"?[1,2,0,1]:t==="ZXY"?[2,0,1,1]:[2,1,0,-1],u=[0,0,0],h=s[l+r*3];return u[o]=-a*Math.asin(PA(h,-1,1)),Math.abs(h)<.999999?(u[r]=a*Math.atan2(s[l+o*3],s[l*4]),u[l]=a*Math.atan2(s[o+r*3],s[r*4])):u[r]=a*Math.atan2(-s[o+l*3],s[o*4]),Math.abs(u[r])+Math.abs(u[l])>Math.PI&&(u[r]=Vu(u[r]+Math.PI),u[o]=Vu(Math.PI-u[o]),u[l]=Vu(u[l]+Math.PI)),new Lr(...u,t).reunit(i)}constructor(e,t,i,s,r){super(),this.x=e??0,this.y=t??0,this.z=i??0,this.order=s??"XYZ",this.unit=r??"rad"}get quat(){return I.fromEuler(this)}getComponents(){return[this.x,this.y,this.z]}toEuler(e,t){return this.reorder(e).reunit(t)}format(e){return e instanceof Lr?e.reorder(this.order):e.toEuler(this.order,this.unit)}reorder(e){return e===this.order?this:this.quat.toEuler(e,this.unit)}reunit(e){const t={deg:Math.PI/180,rad:1,turn:2*Math.PI}[this.unit],i={deg:180/Math.PI,rad:1,turn:.5/Math.PI}[e],s=t*i;return new Lr(s*this.x,s*this.y,s*this.z,this.order,e)}}class I extends CA{static fromAxisAngle(e,t){const i=t/2,s=Math.sin(i);return new I(e.x*s,e.y*s,e.z*s,Math.cos(i))}static fromEuler(e){const t=e.reunit("rad"),[i,s,r,o]=t.order==="XYZ"?[0,1,2,1]:t.order==="XZY"?[0,2,1,-1]:t.order==="YXZ"?[1,0,2,-1]:t.order==="YZX"?[1,2,0,1]:t.order==="ZXY"?[2,0,1,1]:[2,1,0,-1],l=t.getComponents(),a=.5*l[i],u=.5*o*l[s],h=.5*l[r],c=Math.cos(a),d=Math.cos(u),p=Math.cos(h),v=Math.sin(a),m=Math.sin(u),f=Math.sin(h),w=[0,0,0,p*d*c+f*m*v];return w[i]=p*d*v-f*m*c,w[s]=o*(p*m*c+f*d*v),w[r]=f*d*c-p*m*v,new I(...w)}static lookRotation(e,t){const{normal:i,tangent:s,binormal:r}=e.orthoNormalize(t),o=r.x,l=s.x,a=i.x,u=r.y,h=s.y,c=i.y,d=r.z,p=s.z,v=i.z,m=o+h+v;if(m>0){const f=.5/Math.sqrt(m+1);return new I((p-c)*f,(a-d)*f,(u-l)*f,.25/f)}else if(o>h&&o>v){const f=2*Math.sqrt(1+o-h-v);return new I(.25*f,(l+u)/f,(a+d)/f,(p-c)/f)}else if(h>v){const f=2*Math.sqrt(1+h-o-v);return new I((l+u)/f,.25*f,(c+p)/f,(a-d)/f)}else{const f=2*Math.sqrt(1+v-o-h);return new I((a+d)/f,(c+p)/f,.25*f,(u-l)/f)}}constructor(e,t,i,s){super(),this.x=e??0,this.y=t??0,this.z=i??0,this.w=s??1}get quat(){return this}getComponents(){return[this.x,this.y,this.z,this.w]}toEuler(e,t){return Lr.fromQuaternion(this,e,t)}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z+this.w*this.w}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const e=this.length;return e===0?new I:new I(this.x/e,this.y/e,this.z/e,this.w/e)}get negated(){return new I(-this.x,-this.y,-this.z,-this.w)}get ban360s(){return this.w<0?this.negated:this}multiply(e){const t=e.quat;return new I(this.w*t.x+this.x*t.w+this.y*t.z-this.z*t.y,this.w*t.y-this.x*t.z+this.y*t.w+this.z*t.x,this.w*t.z+this.x*t.y-this.y*t.x+this.z*t.w,this.w*t.w-this.x*t.x-this.y*t.y-this.z*t.z)}format(e){return e.quat}slerp(e,t){let i=e.quat;if(t===0)return this;if(t===1)return i;const s=this.ban360s;i=i.ban360s;let r=s.w*i.w+s.x*i.x+s.y*i.y+s.z*i.z;if(r<0&&(i=i.negated,r=-r),r>=1)return s;const o=1-r*r;if(o<=Number.EPSILON){const c=1-t;return new I(c*s.x+t*i.x,c*s.y+t*i.y,c*s.z+t*i.z,c*s.w+t*i.w).normalized}const l=Math.sqrt(o),a=Math.atan2(l,r),u=Math.sin((1-t)*a)/l,h=Math.sin(t*a)/l;return new I(s.x*u+i.x*h,s.y*u+i.y*h,s.z*u+i.z*h,s.w*u+i.w*h)}toMat3(){const{x:e,y:t,z:i,w:s}=this;return[1-2*t*t-2*i*i,2*e*t+2*i*s,2*e*i-2*t*s,2*e*t-2*i*s,1-2*e*e-2*i*i,2*t*i+2*e*s,2*e*i+2*t*s,2*t*i-2*e*s,1-2*e*e-2*t*t]}}class yA{constructor(){this.offset=[0,0,-5],this.fov=30,this.aspect=1,this.viewport=[0,0,1,1]}project(e){const t=(this.viewport[0]+this.viewport[2])*.5,i=(this.viewport[1]+this.viewport[3])*.5,s=this.viewport[2]-this.viewport[0],r=this.viewport[3]-this.viewport[1],o=1/Math.tan(this.fov*Math.PI/360),l=-(e.z+this.offset[2]),a=t+(e.x+this.offset[0])/l*o*s*.5/this.aspect,u=i-(e.y+this.offset[1])/l*o*r*.5;return[a,u]}}class Se{constructor(e,t,i){this.element=e.createElementNS(ut,"path"),this.vertices=t,this.projector=i}setRotation(e){let t="";return this.vertices.forEach((i,s)=>{const r=i.applyQuaternion(e),[o,l]=this.projector.project(r);t+=`${s===0?"M":"L"}${o} ${l}`}),this.element.setAttributeNS(null,"d",t),this}}class F{constructor(e,t,i){this.x=e??0,this.y=t??0,this.z=i??0}getComponents(){return[this.x,this.y,this.z]}get lengthSq(){return this.x*this.x+this.y*this.y+this.z*this.z}get length(){return Math.sqrt(this.lengthSq)}get normalized(){const e=this.length;return e===0?new F:new F(this.x/e,this.y/e,this.z/e)}get negated(){return new F(-this.x,-this.y,-this.z)}add(e){return new F(this.x+e.x,this.y+e.y,this.z+e.z)}sub(e){return new F(this.x-e.x,this.y-e.y,this.z-e.z)}scale(e){return new F(this.x*e,this.y*e,this.z*e)}dot(e){return this.x*e.x+this.y*e.y+this.z*e.z}cross(e){return new F(this.y*e.z-this.z*e.y,this.z*e.x-this.x*e.z,this.x*e.y-this.y*e.x)}orthoNormalize(e){const t=this.normalized;e=e.normalized;let i=t.dot(e);i===1&&(Math.abs(t.y)>Math.abs(t.z)?e=new F(0,0,1):e=new F(0,1,0),i=t.dot(e)),e=e.sub(t.scale(i)).normalized;const s=e.cross(t);return{normal:t,tangent:e,binormal:s}}applyQuaternion(e){const t=e.w*this.x+e.y*this.z-e.z*this.y,i=e.w*this.y+e.z*this.x-e.x*this.z,s=e.w*this.z+e.x*this.y-e.y*this.x,r=-e.x*this.x-e.y*this.y-e.z*this.z;return new F(t*e.w+r*-e.x+i*-e.z-s*-e.y,i*e.w+r*-e.y+s*-e.x-t*-e.z,s*e.w+r*-e.z+t*-e.y-i*-e.x)}}function Nt(n,e){const t=e.z>0?new I(0,0,0,1):new I(0,0,1,0);return Math.abs(n.z)>.9999?t:I.lookRotation(n,e)}function wp(n,e,t,i,s,r=1){const o=[];for(let l=0;l<t;l++){const a=n+e*l/(t-1),u=new F;u[i]=r*Math.cos(a),u[s]=r*Math.sin(a),o.push(u)}return o}const V=N("rotationgizmo"),dl=new F(0,0,0),YZ=new F(1,0,0),XZ=new F(0,1,0),no=new F(0,0,1),ml=new F(0,0,-1),aE=new F(.7,0,0),uE=new F(0,.7,0),hE=new F(0,0,.7),cE=new F(-.7,0,0),pE=new F(0,-.7,0),dE=new F(0,0,-.7),mE=new I(0,0,0,1);function vl(n,e,t){const i=n.createElementNS(ut,"g"),s=n.createElementNS(ut,"circle");s.classList.add(V(e)),s.setAttributeNS(null,"cx","0"),s.setAttributeNS(null,"cy","0"),s.setAttributeNS(null,"r","8"),i.appendChild(s);const r=n.createElementNS(ut,"text");return r.classList.add(V("labeltext")),r.setAttributeNS(null,"y","4"),r.setAttributeNS(null,"text-anchor","middle"),r.setAttributeNS(null,"font-size","10"),r.textContent=t,i.appendChild(r),i}class WZ{get xArcBElement(){return this.xArcBC_.element}get yArcBElement(){return this.yArcBC_.element}get zArcBElement(){return this.zArcBC_.element}get xArcFElement(){return this.xArcFC_.element}get yArcFElement(){return this.yArcFC_.element}get zArcFElement(){return this.zArcFC_.element}get rArcElement(){return this.rArcC_.element}constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.onModeChange_=this.onModeChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(V()),t.pickerLayout==="popup"&&this.element.classList.add(V(void 0,"p"));const i=e.createElement("div");i.classList.add(V("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=e.createElementNS(ut,"svg");s.classList.add(V("g")),this.padElement.appendChild(s),this.svgElem_=s,this.projector_=new yA,this.projector_.viewport=[0,0,136,136];const r=wp(0,Math.PI,33,"x","y"),o=wp(0,2*Math.PI,65,"x","y",1.1);this.xArcB_=new Se(e,r,this.projector_),this.xArcB_.element.classList.add(V("arcx")),this.svgElem_.appendChild(this.xArcB_.element),this.yArcB_=new Se(e,r,this.projector_),this.yArcB_.element.classList.add(V("arcy")),this.svgElem_.appendChild(this.yArcB_.element),this.zArcB_=new Se(e,r,this.projector_),this.zArcB_.element.classList.add(V("arcz")),this.svgElem_.appendChild(this.zArcB_.element),this.xArcBC_=new Se(e,r,this.projector_),this.xArcBC_.element.classList.add(V("arcc")),this.svgElem_.appendChild(this.xArcBC_.element),this.yArcBC_=new Se(e,r,this.projector_),this.yArcBC_.element.classList.add(V("arcc")),this.svgElem_.appendChild(this.yArcBC_.element),this.zArcBC_=new Se(e,r,this.projector_),this.zArcBC_.element.classList.add(V("arcc")),this.svgElem_.appendChild(this.zArcBC_.element);const l=e.createElementNS(ut,"g");s.classList.add(V("axes")),this.svgElem_.appendChild(l),this.axesElem_=l,this.xAxis_=new Se(e,[dl,aE],this.projector_),this.xAxis_.element.classList.add(V("axisx")),this.axesElem_.appendChild(this.xAxis_.element),this.yAxis_=new Se(e,[dl,uE],this.projector_),this.yAxis_.element.classList.add(V("axisy")),this.axesElem_.appendChild(this.yAxis_.element),this.zAxis_=new Se(e,[dl,hE],this.projector_),this.zAxis_.element.classList.add(V("axisz")),this.axesElem_.appendChild(this.zAxis_.element),this.xnAxis_=new Se(e,[dl,cE],this.projector_),this.xnAxis_.element.classList.add(V("axisn")),this.axesElem_.appendChild(this.xnAxis_.element),this.ynAxis_=new Se(e,[dl,pE],this.projector_),this.ynAxis_.element.classList.add(V("axisn")),this.axesElem_.appendChild(this.ynAxis_.element),this.znAxis_=new Se(e,[dl,dE],this.projector_),this.znAxis_.element.classList.add(V("axisn")),this.axesElem_.appendChild(this.znAxis_.element),this.xArcF_=new Se(e,r,this.projector_),this.xArcF_.element.classList.add(V("arcx")),this.svgElem_.appendChild(this.xArcF_.element),this.yArcF_=new Se(e,r,this.projector_),this.yArcF_.element.classList.add(V("arcy")),this.svgElem_.appendChild(this.yArcF_.element),this.zArcF_=new Se(e,r,this.projector_),this.zArcF_.element.classList.add(V("arcz")),this.svgElem_.appendChild(this.zArcF_.element),this.xArcFC_=new Se(e,r,this.projector_),this.xArcFC_.element.classList.add(V("arcc")),this.svgElem_.appendChild(this.xArcFC_.element),this.yArcFC_=new Se(e,r,this.projector_),this.yArcFC_.element.classList.add(V("arcc")),this.svgElem_.appendChild(this.yArcFC_.element),this.zArcFC_=new Se(e,r,this.projector_),this.zArcFC_.element.classList.add(V("arcc")),this.svgElem_.appendChild(this.zArcFC_.element),this.rArc_=new Se(e,o,this.projector_),this.rArc_.element.classList.add(V("arcr")),this.rArc_.setRotation(mE),this.svgElem_.appendChild(this.rArc_.element),this.rArcC_=new Se(e,o,this.projector_),this.rArcC_.element.classList.add(V("arcc")),this.rArcC_.setRotation(mE),this.svgElem_.appendChild(this.rArcC_.element);const a=e.createElementNS(ut,"g");s.classList.add(V("labels")),this.svgElem_.appendChild(a),this.labelsElem_=a,this.xLabel=vl(e,"labelcirclex","X"),this.labelsElem_.appendChild(this.xLabel),this.yLabel=vl(e,"labelcircley","Y"),this.labelsElem_.appendChild(this.yLabel),this.zLabel=vl(e,"labelcirclez","Z"),this.labelsElem_.appendChild(this.zLabel),this.xnLabel=vl(e,"labelcirclen","-X"),this.labelsElem_.appendChild(this.xnLabel),this.ynLabel=vl(e,"labelcirclen","-Y"),this.labelsElem_.appendChild(this.ynLabel),this.znLabel=vl(e,"labelcirclen","-Z"),this.labelsElem_.appendChild(this.znLabel);const u=()=>{this.xArcB_.element.classList.add(V("arcx_hover")),this.xArcF_.element.classList.add(V("arcx_hover"))},h=()=>{this.xArcB_.element.classList.remove(V("arcx_hover")),this.xArcF_.element.classList.remove(V("arcx_hover"))};this.xArcBC_.element.addEventListener("mouseenter",u),this.xArcBC_.element.addEventListener("mouseleave",h),this.xArcFC_.element.addEventListener("mouseenter",u),this.xArcFC_.element.addEventListener("mouseleave",h);const c=()=>{this.yArcB_.element.classList.add(V("arcy_hover")),this.yArcF_.element.classList.add(V("arcy_hover"))},d=()=>{this.yArcB_.element.classList.remove(V("arcy_hover")),this.yArcF_.element.classList.remove(V("arcy_hover"))};this.yArcBC_.element.addEventListener("mouseenter",c),this.yArcBC_.element.addEventListener("mouseleave",d),this.yArcFC_.element.addEventListener("mouseenter",c),this.yArcFC_.element.addEventListener("mouseleave",d);const p=()=>{this.zArcB_.element.classList.add(V("arcz_hover")),this.zArcF_.element.classList.add(V("arcz_hover"))},v=()=>{this.zArcB_.element.classList.remove(V("arcz_hover")),this.zArcF_.element.classList.remove(V("arcz_hover"))};this.zArcBC_.element.addEventListener("mouseenter",p),this.zArcBC_.element.addEventListener("mouseleave",v),this.zArcFC_.element.addEventListener("mouseenter",p),this.zArcFC_.element.addEventListener("mouseleave",v);const m=()=>{this.rArc_.element.classList.add(V("arcr_hover"))},f=()=>{this.rArc_.element.classList.remove(V("arcr_hover"))};this.rArcC_.element.addEventListener("mouseenter",m),this.rArcC_.element.addEventListener("mouseleave",f),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,t.mode.emitter.on("change",this.onModeChange_),this.mode_=t.mode,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const e=this.value.rawValue.quat.normalized;this.xAxis_.setRotation(e),this.yAxis_.setRotation(e),this.zAxis_.setRotation(e),this.xnAxis_.setRotation(e),this.ynAxis_.setRotation(e),this.znAxis_.setRotation(e);const t=YZ.applyQuaternion(e),i=XZ.applyQuaternion(e),s=no.applyQuaternion(e),r=t.negated,o=i.negated,l=s.negated;[{el:this.xAxis_.element,v:t},{el:this.yAxis_.element,v:i},{el:this.zAxis_.element,v:s},{el:this.xnAxis_.element,v:r},{el:this.ynAxis_.element,v:o},{el:this.znAxis_.element,v:l}].map(({el:a,v:u})=>(this.axesElem_.removeChild(a),{el:a,v:u})).sort((a,u)=>a.v.z-u.v.z).forEach(({el:a})=>{this.axesElem_.appendChild(a)}),this.xArcB_.setRotation(Nt(t,ml)),this.yArcB_.setRotation(Nt(i,ml)),this.zArcB_.setRotation(Nt(s,ml)),this.xArcBC_.setRotation(Nt(t,ml)),this.yArcBC_.setRotation(Nt(i,ml)),this.zArcBC_.setRotation(Nt(s,ml)),this.xArcF_.setRotation(Nt(t,no)),this.yArcF_.setRotation(Nt(i,no)),this.zArcF_.setRotation(Nt(s,no)),this.xArcFC_.setRotation(Nt(t,no)),this.yArcFC_.setRotation(Nt(i,no)),this.zArcFC_.setRotation(Nt(s,no)),[{el:this.xLabel,v:aE},{el:this.yLabel,v:uE},{el:this.zLabel,v:hE},{el:this.xnLabel,v:cE},{el:this.ynLabel,v:pE},{el:this.znLabel,v:dE}].forEach(({el:a,v:u})=>{const[h,c]=this.projector_.project(u.applyQuaternion(e));a.setAttributeNS(null,"transform",`translate( ${h}, ${c} )`)}),[{el:this.xLabel,v:t},{el:this.yLabel,v:i},{el:this.zLabel,v:s},{el:this.xnLabel,v:r},{el:this.ynLabel,v:o},{el:this.znLabel,v:l}].map(({el:a,v:u})=>(this.labelsElem_.removeChild(a),{el:a,v:u})).sort((a,u)=>a.v.z-u.v.z).forEach(({el:a})=>{this.labelsElem_.appendChild(a)})}onValueChange_(){this.update_()}onFoldableChange_(){this.update_()}onModeChange_(){const e=this.mode_.rawValue,t=e==="angle-x"?"add":"remove",i=e==="angle-y"?"add":"remove",s=e==="angle-z"?"add":"remove",r=e==="angle-r"?"add":"remove";this.xArcB_.element.classList[t](V("arcx_active")),this.yArcB_.element.classList[i](V("arcy_active")),this.zArcB_.element.classList[s](V("arcz_active")),this.xArcF_.element.classList[t](V("arcx_active")),this.yArcF_.element.classList[i](V("arcy_active")),this.zArcF_.element.classList[s](V("arcz_active")),this.rArc_.element.classList[r](V("arcr_active"))}}function EA(n){return PA(n,0,1)}function ZZ(n){if(n<=0)return 0;if(n>=1)return 1;const e=1-n,t=e*(e*(e*(e*(e*(e*(e*-6+7))))));return EA(1-t)}function QZ(n,e,t){return EA((t-n)/(e-n))}const Br=1/Math.sqrt(2),JZ=new F(1,0,0),eQ=new F(0,1,0),tQ=new F(0,0,1),nQ=new I(0,0,0,1),iQ=new I(Br,0,0,Br),sQ=new I(0,-Br,0,Br),rQ=new I(-Br,0,0,Br),oQ=new I(0,Br,0,Br),lQ=new I(0,1,0,0);class aQ{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.mode_=ot("free"),this.view=new WZ(e,{value:this.value,mode:this.mode_,viewProps:this.viewProps,pickerLayout:t.pickerLayout}),this.ptHandler_=new xt(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_);const i=new xt(this.view.xArcBElement);i.emitter.on("down",()=>this.changeModeIfNotAuto_("angle-x")),i.emitter.on("up",()=>this.changeModeIfNotAuto_("free"));const s=new xt(this.view.xArcFElement);s.emitter.on("down",()=>this.changeModeIfNotAuto_("angle-x")),s.emitter.on("up",()=>this.changeModeIfNotAuto_("free"));const r=new xt(this.view.yArcBElement);r.emitter.on("down",()=>this.changeModeIfNotAuto_("angle-y")),r.emitter.on("up",()=>this.changeModeIfNotAuto_("free"));const o=new xt(this.view.yArcFElement);o.emitter.on("down",()=>this.changeModeIfNotAuto_("angle-y")),o.emitter.on("up",()=>this.changeModeIfNotAuto_("free"));const l=new xt(this.view.zArcBElement);l.emitter.on("down",()=>this.changeModeIfNotAuto_("angle-z")),l.emitter.on("up",()=>this.changeModeIfNotAuto_("free"));const a=new xt(this.view.zArcFElement);a.emitter.on("down",()=>this.changeModeIfNotAuto_("angle-z")),a.emitter.on("up",()=>this.changeModeIfNotAuto_("free"));const u=new xt(this.view.rArcElement);u.emitter.on("down",()=>this.changeModeIfNotAuto_("angle-r")),u.emitter.on("up",()=>this.changeModeIfNotAuto_("free")),[{el:this.view.xLabel,q:sQ},{el:this.view.yLabel,q:iQ},{el:this.view.zLabel,q:nQ},{el:this.view.xnLabel,q:oQ},{el:this.view.ynLabel,q:rQ},{el:this.view.znLabel,q:lQ}].forEach(({el:h,q:c})=>{new xt(h).emitter.on("down",()=>this.autoRotate_(c))}),this.px_=null,this.py_=null,this.angleState_=null}handlePointerEvent_(e){if(!e.point)return;const t=this.mode_.rawValue,i=e.point.x,s=e.point.y;if(t!=="auto")if(t==="free"){if(this.px_!=null&&this.py_!=null){const r=i-this.px_,o=s-this.py_,l=Math.sqrt(r*r+o*o);if(l===0)return;const a=new F(o/l,r/l,0),u=I.fromAxisAngle(a,l/68);this.value.rawValue=this.value.rawValue.premultiply(u)}this.px_=i,this.py_=s}else if(t==="angle-r"){const r=e.bounds.width/2,o=e.bounds.height/2,l=Math.atan2(s-o,i-r);if(this.angleState_==null){const a=new F(0,0,1);this.angleState_={initialRotation:this.value.rawValue,initialAngle:l,axis:a,reverseAngle:!0}}else{const{initialRotation:a,initialAngle:u,axis:h}=this.angleState_,c=-Vu(l-u),d=I.fromAxisAngle(h,c);this.value.rawValue=a.premultiply(d)}}else{const r=e.bounds.width/2,o=e.bounds.height/2,l=Math.atan2(s-o,i-r);if(this.angleState_==null){const a=t==="angle-x"?JZ:t==="angle-y"?eQ:tQ,u=a.applyQuaternion(this.value.rawValue.quat).z>0;this.angleState_={initialRotation:this.value.rawValue,initialAngle:l,axis:a,reverseAngle:u}}else{const{initialRotation:a,initialAngle:u,axis:h,reverseAngle:c}=this.angleState_;let d=Vu(l-u);d=c?-d:d;const p=I.fromAxisAngle(h,d);this.value.rawValue=a.multiply(p)}}}onPointerDown_(e){this.handlePointerEvent_(e.data)}onPointerMove_(e){this.handlePointerEvent_(e.data)}onPointerUp_(){this.px_=null,this.py_=null,this.angleState_=null}onPadKeyDown_(e){Xb(e.key)&&e.preventDefault();const t=Vt(1,Ai(e)),i=Vt(1,la(e));if(t!==0||i!==0){const s=new F(-i,t,0),r=I.fromAxisAngle(s,Math.PI/16);this.value.rawValue=this.value.rawValue.premultiply(r)}}changeModeIfNotAuto_(e){this.mode_.rawValue!=="auto"&&(this.mode_.rawValue=e)}autoRotate_(e){this.mode_.rawValue="auto";const t=this.value.rawValue,i=Date.now(),s=()=>{const r=Date.now(),o=ZZ(QZ(0,300,r-i));if(this.value.rawValue=t.slerp(e,o),o===1){this.mode_.rawValue="free";return}requestAnimationFrame(s)};requestAnimationFrame(s)}}const io=N("rotationswatch"),uQ=new F(1,0,0),hQ=new F(0,1,0),fc=new F(0,0,1),cQ=new I(0,0,0,1);class pQ{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(io()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(io("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElementNS(ut,"svg");s.classList.add(io("g")),i.appendChild(s),this.svgElem_=s,this.projector_=new yA,this.projector_.viewport=[0,0,20,20];const r=wp(0,Math.PI,33,"x","y"),o=wp(0,2*Math.PI,65,"x","y");this.rArc_=new Se(e,o,this.projector_),this.rArc_.element.classList.add(io("arcr")),s.appendChild(this.rArc_.element),this.rArc_.setRotation(cQ),this.xArc_=new Se(e,r,this.projector_),this.xArc_.element.classList.add(io("arc")),s.appendChild(this.xArc_.element),this.yArc_=new Se(e,r,this.projector_),this.yArc_.element.classList.add(io("arc")),s.appendChild(this.yArc_.element),this.zArc_=new Se(e,r,this.projector_),this.zArc_.element.classList.add(io("arc")),s.appendChild(this.zArc_.element),this.update_()}update_(){const e=this.value.rawValue.quat.normalized,t=uQ.applyQuaternion(e),i=hQ.applyQuaternion(e),s=fc.applyQuaternion(e);this.xArc_.setRotation(Nt(t,fc)),this.yArc_.setRotation(Nt(i,fc)),this.zArc_.setRotation(Nt(s,fc))}onValueChange_(){this.update_()}}class dQ{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new pQ(e,{value:this.value,viewProps:this.viewProps})}}const rr=N("rotation");class mQ{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(rr()),t.foldable.bindExpandedClass(this.element,rr(void 0,"expanded")),li(t.foldable,"completed",Xo(this.element,rr(void 0,"cpl"))),t.rotationMode==="quaternion"&&this.element.classList.add(rr("quat"));const i=e.createElement("div");i.classList.add(rr("h")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(rr("s")),i.appendChild(s),this.swatchElement=s;const r=e.createElement("div");if(r.classList.add(rr("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(rr("g")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}}class xA{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=bd.create(t.expanded),this.swatchC_=new dQ(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new xd(e,{assembly:t.assembly,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new mQ(e,{rotationMode:t.rotationMode,foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new Gb(e,{viewProps:this.viewProps}):null;const s=new aQ(e,{value:this.value,viewProps:this.viewProps,pickerLayout:t.pickerLayout});s.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.gizmoC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),Wo({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.gizmoC_.view.element),gd(this.foldable_,this.view.pickerElement))}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.gizmoC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=Bb(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!wd(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function ev(n,e){const t=Math.pow(.1,n);return{baseStep:t,constraint:e,textProps:Z.fromObject({formatter:Xt(n),keyScale:t,pointerScale:t})}}function lo(n){if(!n)return;const e=[];return Ve(n.step)||e.push(new $L(n.step)),(!Ve(n.max)||!Ve(n.min))&&e.push(new xL({max:n.max,min:n.min})),new Ta(e)}function vE(n,e){return{toComponents:t=>t.getComponents(),fromComponents:t=>new Lr(t[0],t[1],t[2],n,e)}}function fE(n,e,t){return typeof(n==null?void 0:n.x)=="number"&&typeof(n==null?void 0:n.y)=="number"&&typeof(n==null?void 0:n.z)=="number"?new Lr(n.x,n.y,n.z,e,t):new Lr(0,0,0,e,t)}function vQ(n){switch(n){case"XYZ":case"XZY":case"YXZ":case"YZX":case"ZXY":case"ZYX":return n;default:return}}function fQ(n){switch(n){case"rad":case"deg":case"turn":return n;default:return}}Ct({id:"rotation",type:"input",accept(n,e){var t,i;const s=ft(e,r=>({view:r.required.constant("rotation"),label:r.optional.string,picker:r.optional.custom(yd),expanded:r.optional.boolean,rotationMode:r.required.constant("euler"),x:r.optional.custom(Bt),y:r.optional.custom(Bt),z:r.optional.custom(Bt),order:r.optional.custom(vQ),unit:r.optional.custom(fQ)}));return s?{initialValue:fE(n,(t=s.order)!==null&&t!==void 0?t:"XYZ",(i=s.unit)!==null&&i!==void 0?i:"rad"),params:s}:null},binding:{reader({params:n}){return e=>{var t,i;return fE(e,(t=n.order)!==null&&t!==void 0?t:"XYZ",(i=n.unit)!==null&&i!==void 0?i:"rad")}},constraint({params:n}){var e,t;return new Lo({assembly:vE((e=n.order)!==null&&e!==void 0?e:"XYZ",(t=n.unit)!==null&&t!==void 0?t:"rad"),components:[lo("x"in n?n.x:void 0),lo("y"in n?n.y:void 0),lo("z"in n?n.z:void 0)]})},writer(n){return(e,t)=>{e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z)}}},controller({document:n,value:e,constraint:t,params:i,viewProps:s}){var r,o;if(!(t instanceof Lo))throw Ds.shouldNeverHappen();const l="expanded"in i?i.expanded:void 0,a="picker"in i?i.picker:void 0,u=(r=i.unit)!==null&&r!==void 0?r:"rad",h={rad:2,deg:0,turn:2}[u];return new xA(n,{axes:[ev(h,t.components[0]),ev(h,t.components[1]),ev(h,t.components[2])],assembly:vE((o=i.order)!==null&&o!==void 0?o:"XYZ",u),rotationMode:"euler",expanded:l??!1,parser:Li,pickerLayout:a??"popup",value:e,viewProps:s})}});const wE={toComponents:n=>[n.x,n.y,n.z,n.w],fromComponents:n=>new I(n[0],n[1],n[2],n[3])};function wc(n){return{baseStep:.01,constraint:n,textProps:Z.fromObject({formatter:e=>Math.abs(e)<.995?e.toFixed(2).replace("0.","."):e.toFixed(1),keyScale:.01,pointerScale:.01})}}function _E(n){return typeof(n==null?void 0:n.x)=="number"&&typeof(n==null?void 0:n.y)=="number"&&typeof(n==null?void 0:n.z)=="number"&&typeof(n==null?void 0:n.w)=="number"?new I(n.x,n.y,n.z,n.w):new I(0,0,0,1)}Ct({id:"rotation",type:"input",accept(n,e){const t=ft(e,i=>({view:i.required.constant("rotation"),label:i.optional.string,picker:i.optional.custom(yd),expanded:i.optional.boolean,rotationMode:i.optional.constant("quaternion"),x:i.optional.custom(Bt),y:i.optional.custom(Bt),z:i.optional.custom(Bt),w:i.optional.custom(Bt)}));return t?{initialValue:_E(n),params:t}:null},binding:{reader(n){return e=>_E(e)},constraint({params:n}){return new Lo({assembly:wE,components:[lo("x"in n?n.x:void 0),lo("y"in n?n.y:void 0),lo("z"in n?n.z:void 0),lo("w"in n?n.w:void 0)]})},writer(n){return(e,t)=>{e.writeProperty("x",t.x),e.writeProperty("y",t.y),e.writeProperty("z",t.z),e.writeProperty("w",t.w)}}},controller({document:n,value:e,constraint:t,params:i,viewProps:s}){if(!(t instanceof Lo))throw Ds.shouldNeverHappen();const r="expanded"in i?i.expanded:void 0,o="picker"in i?i.picker:void 0;return new xA(n,{axes:[wc(t.components[0]),wc(t.components[1]),wc(t.components[2]),wc(t.components[3])],assembly:wE,rotationMode:"quaternion",expanded:r??!1,parser:Li,pickerLayout:o??"popup",value:e,viewProps:s})}});function Re(n){return n==null}function rg(n){return n!==null&&typeof n=="object"}function ff(n){return n!==null&&typeof n=="object"}function wQ(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Ao(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((i,s)=>{const r=n[s],o=e[s];return ff(r)&&ff(o)?Object.assign(Object.assign({},i),{[s]:Ao(r,o)}):Object.assign(Object.assign({},i),{[s]:s in e?o:r})},{})}function _Q(n){return rg(n)?"target"in n:!1}const bQ={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};let Mo=class Ll{static alreadyDisposed(){return new Ll({type:"alreadydisposed"})}static notBindable(){return new Ll({type:"notbindable"})}static notCompatible(e,t){return new Ll({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new Ll({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new Ll({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=bQ[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}},bE=class $A{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const i=this.read();if(!$A.isBindable(i))throw Mo.notBindable();if(!(e in i))throw Mo.propertyNotFound(e);i[e]=t}},$n=class{constructor(){this.observers_={}}on(e,t,i){var s;let r=this.observers_[e];return r||(r=this.observers_[e]=[]),r.push({handler:t,key:(s=i==null?void 0:i.key)!==null&&s!==void 0?s:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter(s=>s.key!==t)),this}emit(e,t){const i=this.observers_[e];i&&i.forEach(s=>{s.handler(t)})}},gQ=class{constructor(e,t){var i;this.constraint_=t==null?void 0:t.constraint,this.equals_=(i=t==null?void 0:t.equals)!==null&&i!==void 0?i:(s,r)=>s===r,this.emitter=new $n,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,r=this.rawValue_;this.equals_(r,s)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:i,previousRawValue:r,rawValue:s,sender:this}))}},CQ=class{constructor(e){this.emitter=new $n,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.value_;s===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:this.value_,sender:this}))}},PQ=class{constructor(e){this.emitter=new $n,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}};function pt(n,e){const t=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!t&&!i?new CQ(n):new gQ(n,e)}function yQ(n){return[new PQ(n),(e,t)=>{n.setRawValue(e,t)}]}let Pe=class VA{constructor(e){this.emitter=new $n,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((i,s)=>Object.assign(i,{[s]:pt(e[s])}),{})}static fromObject(e){const t=this.createCore(e);return new VA(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}},Vd=class{constructor(e){this.values=Pe.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(e,i),t)}},EQ=class{constructor(e){this.values=Pe.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");let s=e;return Re(i)||(s=Math.max(s,i)),Re(t)||(s=Math.min(s,t)),s}},xQ=class{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,i=Math.round((e-t)/this.step);return t+i*this.step}},$Q=class{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}};const VQ={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};let kQ=class{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=VQ[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}};const SQ={"+":n=>n,"-":n=>-n,"~":n=>~n};let LQ=class{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=SQ[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}};function og(n){return(e,t)=>{for(let i=0;i<n.length;i++){const s=n[i](e,t);if(s!=="")return s}return""}}function ih(n,e){var t;const i=n.substr(e).match(/^\s+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function AQ(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function sh(n,e){var t;const i=n.substr(e).match(/^[0-9]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function MQ(n,e){const t=sh(n,e);if(t!=="")return t;const i=n.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";const s=sh(n,e);return s===""?"":i+s}function lg(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const i=MQ(n,e);return i===""?"":t+i}function kA(n,e){const t=n.substr(e,1);if(t==="0")return t;const i=AQ(n,e);return e+=i.length,i===""?"":i+sh(n,e)}function TQ(n,e){const t=kA(n,e);if(e+=t.length,t==="")return"";const i=n.substr(e,1);if(e+=i.length,i!==".")return"";const s=sh(n,e);return e+=s.length,t+i+s+lg(n,e)}function DQ(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const i=sh(n,e);return e+=i.length,i===""?"":t+i+lg(n,e)}function OQ(n,e){const t=kA(n,e);return e+=t.length,t===""?"":t+lg(n,e)}const RQ=og([TQ,DQ,OQ]);function jQ(n,e){var t;const i=n.substr(e).match(/^[01]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function NQ(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const i=jQ(n,e);return i===""?"":t+i}function BQ(n,e){var t;const i=n.substr(e).match(/^[0-7]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function IQ(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const i=BQ(n,e);return i===""?"":t+i}function FQ(n,e){var t;const i=n.substr(e).match(/^[0-9a-f]+/i);return(t=i&&i[0])!==null&&t!==void 0?t:""}function KQ(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const i=FQ(n,e);return i===""?"":t+i}const UQ=og([NQ,IQ,KQ]),HQ=og([UQ,RQ]);function zQ(n,e){const t=HQ(n,e);return e+=t.length,t===""?null:{evaluable:new $Q(t),cursor:e}}function qQ(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const i=LA(n,e);if(!i)return null;e=i.cursor,e+=ih(n,e).length;const s=n.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:i.evaluable,cursor:e}}function GQ(n,e){var t;return(t=zQ(n,e))!==null&&t!==void 0?t:qQ(n,e)}function SA(n,e){const t=GQ(n,e);if(t)return t;const i=n.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const s=SA(n,e);return s?(e=s.cursor,{cursor:e,evaluable:new LQ(i,s.evaluable)}):null}function YQ(n,e,t){t+=ih(e,t).length;const i=n.filter(s=>e.startsWith(s,t))[0];return i?(t+=i.length,t+=ih(e,t).length,{cursor:t,operator:i}):null}function XQ(n,e){return(t,i)=>{const s=n(t,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const o=YQ(e,t,i);if(!o)break;i=o.cursor;const l=n(t,i);if(!l)return null;i=l.cursor,r=new kQ(o.operator,r,l.evaluable)}return r?{cursor:i,evaluable:r}:null}}const WQ=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>XQ(n,e),SA);function LA(n,e){return e+=ih(n,e).length,WQ(n,e)}function ZQ(n){const e=LA(n,0);return!e||e.cursor+ih(n,e.cursor).length!==n.length?null:e.evaluable}function Ir(n){var e;const t=ZQ(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function AA(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=Ir(n);if(!Re(e))return e}return 0}function cn(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function re(n,e,t,i,s){const r=(n-e)/(t-e);return i+r*(s-i)}function gE(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function nt(n,e,t){return Math.min(Math.max(n,e),t)}function MA(n,e){return(n%e+e)%e}function QQ(n,e){return Re(n.step)?Math.max(gE(e),2):gE(n.step)}function TA(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function JQ(n,e){var t;const i=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function DA(n,e){return Re(n.step)?null:new xQ(n.step,e)}function OA(n){return!Re(n.max)&&!Re(n.min)?new Vd({max:n.max,min:n.min}):!Re(n.max)||!Re(n.min)?new EQ({max:n.max,min:n.min}):null}function RA(n,e){var t,i,s;return{formatter:(t=n.format)!==null&&t!==void 0?t:cn(QQ(n,e)),keyScale:(i=n.keyScale)!==null&&i!==void 0?i:TA(n),pointerScale:(s=n.pointerScale)!==null&&s!==void 0?s:JQ(n,e)}}function jA(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function ag(n){return{constraint:n.constraint,textProps:Pe.fromObject(RA(n.params,n.initialValue))}}let ug=class{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}},kd=class{constructor(e){this.target=e}},NA=class extends kd{constructor(e,t,i){super(e),this.value=t,this.last=i??!0}},eJ=class extends kd{constructor(e,t){super(e),this.expanded=t}},tJ=class extends kd{constructor(e,t){super(e),this.index=t}};class nJ extends kd{constructor(e,t){super(e),this.native=t}}let hg=class extends ug{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new $n,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new NA(this,t.binding.target.read(),e.options.last))}};function iJ(n,e){const i=Object.keys(e).reduce((s,r)=>{if(s===void 0)return;const o=e[r],l=o(n[r]);return l.succeeded?Object.assign(Object.assign({},s),{[r]:l.value}):void 0},{});return i}function sJ(n,e){return n.reduce((t,i)=>{if(t===void 0)return;const s=e(i);if(!(!s.succeeded||s.value===void 0))return[...t,s.value]},[])}function rJ(n){return n===null?!1:typeof n=="object"}function as(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const i=n(t);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function CE(n){return{custom:e=>as(e)(n),boolean:as(e=>typeof e=="boolean"?e:void 0)(n),number:as(e=>typeof e=="number"?e:void 0)(n),string:as(e=>typeof e=="string"?e:void 0)(n),function:as(e=>typeof e=="function"?e:void 0)(n),constant:e=>as(t=>t===e?e:void 0)(n),raw:as(e=>e)(n),object:e=>as(t=>{if(rJ(t))return iJ(t,e)})(n),array:e=>as(t=>{if(Array.isArray(t))return sJ(t,e)})(n)}}const wf={optional:CE(!0),required:CE(!1)};function Pt(n,e){const t=e(wf),i=wf.required.object(t)(n);return i.succeeded?i.value:void 0}function Xi(n,e,t,i){if(e&&!e(n))return!1;const s=Pt(n,t);return s?i(s):!1}function Wi(n,e){var t;return Ao((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function Fc(n){return"value"in n}function oJ(n){if(!rg(n)||!("binding"in n))return!1;const e=n.binding;return _Q(e)}const vi="http://www.w3.org/2000/svg";function _p(n){n.offsetHeight}function lJ(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function cg(n){return n.ontouchstart!==void 0}function aJ(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const uJ={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Sd(n,e){const t=n.createElementNS(vi,"svg");return t.innerHTML=uJ[e],t}function BA(n,e,t){n.insertBefore(e,n.children[t])}function pg(n){n.parentElement&&n.parentElement.removeChild(n)}function IA(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function hJ(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function FA(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function xs(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function Ti(n,e,t){xs(n.value(e),t)}const cJ="tp";function q(n){return(t,i)=>[cJ,"-",n,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}const mu=q("lbl");function pJ(n,e){const t=n.createDocumentFragment();return e.split(`
`).map(s=>n.createTextNode(s)).forEach((s,r)=>{r>0&&t.appendChild(n.createElement("br")),t.appendChild(s)}),t}let dJ=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(mu()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(mu("l")),Ti(t.props,"label",r=>{Re(r)?this.element.classList.add(mu(void 0,"nol")):(this.element.classList.remove(mu(void 0,"nol")),hJ(i),i.appendChild(pJ(e,r)))}),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("div");s.classList.add(mu("v")),this.element.appendChild(s),this.valueElement=s}},mJ=class{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new dJ(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return Xi(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return Wi(null,{label:this.props.get("label")})}};function vJ(){return["veryfirst","first","last","verylast"]}const PE=q(""),yE={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};let KA=class{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{vJ().forEach(i=>{t.classList.remove(PE(void 0,yE[i]))}),this.blade.get("positions").forEach(i=>{t.classList.add(PE(void 0,yE[i]))})}),this.viewProps.handleDispose(()=>{pg(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return Xi(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return Wi(null,Object.assign({},this.viewProps.exportState()))}},fJ=class extends ug{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const i=t.bind(this);return this.controller.buttonController.emitter.on(e,r=>{i(new nJ(this,r.nativeEvent))}),this}off(e,t){return this.controller.buttonController.emitter.off(e,t),this}};function wJ(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function Da(n,e){return t=>{wJ(n,e,t)}}function dg(n,e){xs(n,t=>{e.textContent=t??""})}const tv=q("btn");let _J=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(tv()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(tv("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(tv("t")),dg(t.props.value("title"),s),this.buttonElement.appendChild(s)}},bJ=class{constructor(e,t){this.emitter=new $n,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new _J(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return Xi(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return Wi(null,{title:this.props.get("title")})}onClick_(e){this.emitter.emit("click",{nativeEvent:e,sender:this})}},EE=class extends KA{constructor(e,t){const i=new bJ(e,{props:t.buttonProps,viewProps:t.viewProps}),s=new mJ(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:t.viewProps}),this.buttonController=i,this.labelController=s}importState(e){return Xi(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return Wi(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}},gJ=class{constructor(e){const[t,i]=e.split("-"),s=t.split(".");this.major=parseInt(s[0],10),this.minor=parseInt(s[1],10),this.patch=parseInt(s[2],10),this.prerelease=i??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}};const CJ=new gJ("2.0.3");function Ot(n){return Object.assign({core:CJ},n)}Ot({id:"button",type:"blade",accept(n){const e=Pt(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new EE(n.document,{blade:n.blade,buttonProps:Pe.fromObject({title:n.params.title}),labelProps:Pe.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof EE?new fJ(n.controller):null}});function PJ(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function yJ(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function EJ(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function xJ(n){return rg(n)?"refresh"in n&&typeof n.refresh=="function":!1}function $J(n,e){if(!bE.isBindable(n))throw Mo.notBindable();return new bE(n,e)}let VJ=class{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new $n,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,i){const s=i??{},r=this.controller_.element.ownerDocument,o=this.pool_.createBinding(r,$J(e,t),s),l=this.pool_.createBindingApi(o);return this.add(l,s.index)}addFolder(e){return yJ(this,e)}addButton(e){return PJ(this,e)}addTab(e){return EJ(this,e)}add(e,t){const i=e.controller;return this.controller_.rack.add(i,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,i=this.pool_.createBlade(t,e),s=this.pool_.createApi(i);return this.add(s,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}refresh(){this.children.forEach(e=>{xJ(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,i=this.pool_.createApi(t),s=oJ(t.value)?t.value.binding:null;this.emitter_.emit("change",new NA(i,s?s.target.read():t.value.rawValue,e.options.last))}},mg=class extends ug{constructor(e,t){super(e),this.rackApi_=new VJ(e.rackController,t)}refresh(){this.rackApi_.refresh()}},vg=class extends KA{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return Xi(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((i,s)=>i.importState(t.children[s])))}exportState(){return Wi(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}};function _f(n){return"rackController"in n}let kJ=class{constructor(e){this.emitter=new $n,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw Mo.shouldNeverHappen();const i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(r=>{this.cache_.add(r)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.allItems().forEach(s=>{this.cache_.delete(s)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}};function SJ(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(Fc(i)&&i.value===e)return i}return null}function LJ(n){return _f(n)?n.rackController.rack.bcSet_:null}let AJ=class{constructor(e){var t,i;this.emitter=new $n,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new kJ(LJ),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var i;(i=e.parent)===null||i===void 0||i.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),Fc(i))i.value.emitter.on("change",this.onChildValueChange_);else if(_f(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.on("layout",this.onRackLayout_),r.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const i=e.item;if(Fc(i))i.value.emitter.off("change",this.onChildValueChange_);else if(_f(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.off("layout",this.onRackLayout_),r.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(s=>!s.viewProps.get("hidden")),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach(s=>{const r=[];s===t&&(r.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&r.push("veryfirst")),s===i&&(r.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&r.push("verylast")),s.blade.set("positions",r)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=SJ(this.find(Fc),e.sender);if(!t)throw Mo.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}},fg=class{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new AJ({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let i=this.rack.children.length-1;i>=0;i--)this.rack.children[i].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&BA(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&pg(e.bladeController.view.element)}};function UA(){return new Pe({positions:pt([],{equals:wQ})})}let wg=class HA extends Pe{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=Pe.createCore(t);return new HA(i)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!Re(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const i=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};Ti(this,"expanded",i),Ti(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}};function MJ(n,e){let t=0;return lJ(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),_p(e),t=e.clientHeight,n.set("temporaryExpanded",null),_p(e)}),t}function xE(n,e){e.style.height=n.styleHeight}function _g(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),Re(n.get("expandedHeight"))){const t=MJ(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),_p(e)}),n.emitter.on("change",()=>{xE(n,e)}),xE(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}let TJ=class extends mg{constructor(e,t){super(e,t),this.emitter_=new $n,this.controller.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",new eJ(this,i.sender.rawValue))}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}};const zA=q("cnt");let DJ=class{constructor(e,t){var i;this.className_=q((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),zA()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),Ti(this.foldable_,"completed",Da(this.element,this.className_(void 0,"cpl")));const s=e.createElement("button");s.classList.add(this.className_("b")),Ti(t.props,"title",u=>{Re(u)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const r=e.createElement("div");r.classList.add(this.className_("i")),this.element.appendChild(r);const o=e.createElement("div");o.classList.add(this.className_("t")),dg(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}},$E=class extends vg{constructor(e,t){var i;const s=wg.create((i=t.expanded)!==null&&i!==void 0?i:!0),r=new DJ(e,{foldable:s,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new fg({blade:t.blade,element:r.containerElement,root:t.root,viewProps:t.viewProps}),view:r})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=s,_g(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return Xi(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return Wi(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}};Ot({id:"folder",type:"blade",accept(n){const e=Pt(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new $E(n.document,{blade:n.blade,expanded:n.params.expanded,props:Pe.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof $E?new TJ(n.controller,n.pool):null}});const OJ=q("");function VE(n,e){return Da(n,OJ(void 0,e))}let bg=class qA extends Pe{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=yQ(pt(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,i,s;const r=e??{};return new qA(Pe.createCore({disabled:(t=r.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(i=r.hidden)!==null&&i!==void 0?i:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){xs(this.globalDisabled_,VE(e,"disabled")),Ti(this,"hidden",VE(e,"hidden"))}bindDisabled(e){xs(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){xs(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const i=e.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}};const kE=q("tbp");let RJ=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(kE()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(kE("c")),this.element.appendChild(i),this.containerElement=i}};const vu=q("tbi");let jJ=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(vu()),t.viewProps.bindClassModifiers(this.element),Ti(t.props,"selected",r=>{r?this.element.classList.add(vu(void 0,"sel")):this.element.classList.remove(vu(void 0,"sel"))});const i=e.createElement("button");i.classList.add(vu("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(vu("t")),dg(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}},NJ=class{constructor(e,t){this.emitter=new $n,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new jJ(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}},bf=class extends vg{constructor(e,t){const i=new RJ(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new fg({blade:t.blade,element:i.containerElement,viewProps:t.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new NJ(e,{props:t.itemProps,viewProps:bg.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,Ti(this.props,"selected",s=>{this.itemController.props.set("selected",s),this.viewProps.set("hidden",!s)})}get itemController(){return this.ic_}importState(e){return Xi(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return Wi(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}},BJ=class extends mg{constructor(e,t){super(e,t),this.emitter_=new $n,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,i=new bf(t,{blade:UA(),itemProps:Pe.fromObject({selected:!1,title:e.title}),props:Pe.fromObject({selected:!1}),viewProps:bg.create()}),s=this.pool_.createApi(i);return this.rackApi_.add(s,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)},{key:t}),this}off(e,t){return this.emitter_.off(e,t),this}onSelect_(e){this.emitter_.emit("select",new tJ(this,e.rawValue))}},IJ=class extends mg{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}};const SE=-1;let FJ=class{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=pt(!0),this.selectedIndex=pt(SE),this.items_=[]}add(e,t){const i=t??this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=SE,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,i)=>{t.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,i)=>{t.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(i=>i===e.sender);this.items_.forEach((i,s)=>{i.rawValue=s===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}};const fu=q("tab");let KJ=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(fu(),zA()),t.viewProps.bindClassModifiers(this.element),xs(t.empty,Da(this.element,fu(void 0,"nop")));const i=e.createElement("div");i.classList.add(fu("t")),this.element.appendChild(i),this.itemsElement=i;const s=e.createElement("div");s.classList.add(fu("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(fu("c")),this.element.appendChild(r),this.contentsElement=r}},LE=class extends vg{constructor(e,t){const i=new FJ,s=new KJ(e,{empty:i.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new fg({blade:t.blade,element:s.contentsElement,viewProps:t.viewProps}),view:s}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=this.rackController.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.tab=i}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;BA(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;pg(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}};Ot({id:"tab",type:"blade",accept(n){const e=Pt(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new LE(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const i=new bf(n.document,{blade:UA(),itemProps:Pe.fromObject({selected:!1,title:t.title}),props:Pe.fromObject({selected:!1}),viewProps:bg.create()});e.add(i)}),e},api(n){return n.controller instanceof LE?new BJ(n.controller,n.pool):n.controller instanceof bf?new IJ(n.controller,n.pool):null}});let gg=class extends hg{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}},Uh=class{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,i)=>i.constrain(t),e)}};function bp(n,e){if(n instanceof e)return n;if(n instanceof Uh){const t=n.constraints.reduce((i,s)=>i||(s instanceof e?s:null),null);if(t)return t}return null}let Ld=class{constructor(e){this.values=Pe.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(s=>s.value===e).length>0?e:t[0].value}};function Ad(n){var e;const t=wf;if(Array.isArray(n))return(e=Pt({items:n},i=>({items:i.required.array(i.required.object({text:i.required.string,value:i.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function GA(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function Cg(n){return Re(n)?null:new Ld(GA(n))}const nv=q("lst");let UJ=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(nv()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(nv("s")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const s=e.createElement("div");s.classList.add(nv("m")),s.appendChild(Sd(e,"dropdown")),this.element.appendChild(s),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,Ti(this.props_,"options",r=>{IA(this.selectElement),r.forEach(o=>{const l=e.createElement("option");l.textContent=o.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}},ua=class{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new UJ(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return Xi(e,null,t=>({options:t.required.custom(Ad)}),t=>(this.props.set("options",GA(t.options)),!0))}exportProps(){return Wi(null,{options:this.props.get("options")})}};const AE=q("pop");let HJ=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(AE()),t.viewProps.bindClassModifiers(this.element),xs(t.shows,Da(this.element,AE(void 0,"v")))}},YA=class{constructor(e,t){this.shows=pt(!1),this.viewProps=t.viewProps,this.view=new HJ(e,{shows:this.shows,viewProps:this.viewProps})}};const ME=q("txt");let zJ=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ME()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(ME("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}},Pg=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new zJ(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Re(s)||(this.value.rawValue=s),this.view.refresh()}};function qJ(n){return String(n)}function XA(n){return n==="false"?!1:!!n}function TE(n){return qJ(n)}function GJ(n){return e=>n.reduce((t,i)=>t!==null?t:i(e),null)}const YJ=cn(0);function gp(n){return YJ(n)+"%"}function WA(n){return String(n)}function gf(n){return n}function Oa({primary:n,secondary:e,forward:t,backward:i}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}n.emitter.on("change",o=>{r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),e.emitter.on("change",o=>{r(()=>{n.setRawValue(i(n.rawValue,e.rawValue),o.options)}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function rn(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function rh(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function Os(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function XJ(n){return n==="ArrowUp"||n==="ArrowDown"}function ZA(n){return XJ(n)||n==="ArrowLeft"||n==="ArrowRight"}function iv(n,e){var t,i;const s=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:n.pageX-(((t=s&&s.scrollX)!==null&&t!==void 0?t:0)+r.left),y:n.pageY-(((i=s&&s.scrollY)!==null&&i!==void 0?i:0)+r.top)}}let Zo=class{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new $n,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(iv(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(iv(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(iv(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-s.left,y:i.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}};const jn=q("txt");let WJ=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(jn(),jn(void 0,"num")),t.arrayPosition&&this.element.classList.add(jn(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(jn("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(jn()),this.inputElement.classList.add(jn("i"));const s=e.createElement("div");s.classList.add(jn("k")),this.element.appendChild(s),this.knobElement=s;const r=e.createElementNS(vi,"svg");r.classList.add(jn("g")),this.knobElement.appendChild(r);const o=e.createElementNS(vi,"path");o.classList.add(jn("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=e.createElementNS(vi,"path");l.classList.add(jn("gh")),r.appendChild(l),this.guideHeadElem_=l;const a=e.createElement("div");a.classList.add(q("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(jn(void 0,"drg"));return}this.element.classList.add(jn(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),i=t+(t>0?-1:t<0?1:0),s=nt(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+s},0 L${i},4 L${i+s},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}},Hh=class{constructor(e,t){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(i=t.sliderProps)!==null&&i!==void 0?i:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=pt(null),this.view=new WJ(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new Zo(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,i;const s=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),r=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("max");let o=e;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Re(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const t=rn(this.props.get("keyScale"),rh(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){rn(this.props.get("keyScale"),rh(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}};const sv=q("sld");let ZJ=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(sv()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(sv("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const s=e.createElement("div");s.classList.add(sv("k")),this.trackElement.appendChild(s),this.knobElement=s,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=nt(re(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}},QJ=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new ZJ(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Zo(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(re(nt(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=rn(this.props.get("keyScale"),Os(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){rn(this.props.get("keyScale"),Os(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const rv=q("sldtxt");let JJ=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(rv());const i=e.createElement("div");i.classList.add(rv("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(rv("t")),this.textView_=t.textView,s.appendChild(this.textView_.element),this.element.appendChild(s)}},DE=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new QJ(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new Hh(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new JJ(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return Xi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const i=this.sliderC_.props;return i.set("max",t.max),i.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return Wi(null,{max:e.get("max"),min:e.get("min")})}};function eee(n){return{sliderProps:new Pe({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new Pe({formatter:pt(n.formatter),keyScale:n.keyScale,pointerScale:pt(n.pointerScale)})}}const tee={containerUnitSize:"cnt-usz"};function QA(n){return`--${tee[n]}`}function oh(n){return jA(n)}function Cr(n){if(ff(n))return Pt(n,oh)}function ws(n,e){if(!n)return;const t=[],i=DA(n,e);i&&t.push(i);const s=OA(n);return s&&t.push(s),new Uh(t)}function JA(n){if(n==="inline"||n==="popup")return n}function zh(n,e){n.write(e)}const _c=q("ckb");let nee=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(_c()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(_c("l")),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("input");s.classList.add(_c("i")),s.type="checkbox",this.labelElement.appendChild(s),this.inputElement=s,t.viewProps.bindDisabled(this.inputElement);const r=e.createElement("div");r.classList.add(_c("w")),this.labelElement.appendChild(r);const o=Sd(e,"check");r.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}},iee=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.onLabelMouseDown_=this.onLabelMouseDown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new nee(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.labelElement.addEventListener("mousedown",this.onLabelMouseDown_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked,e.preventDefault(),e.stopPropagation()}onLabelMouseDown_(e){e.preventDefault()}};function see(n){const e=[],t=Cg(n.options);return t&&e.push(t),new Uh(e)}Ot({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Pt(e,i=>({options:i.optional.custom(Ad),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>XA,constraint:n=>see(n.params),writer:n=>zh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&bp(i,Ld);return s?new ua(e,{props:new Pe({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new iee(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof ua?new gg(n.controller):null}});const so=q("col");let ree=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(so()),t.foldable.bindExpandedClass(this.element,so(void 0,"expanded")),Ti(t.foldable,"completed",Da(this.element,so(void 0,"cpl")));const i=e.createElement("div");i.classList.add(so("h")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(so("s")),i.appendChild(s),this.swatchElement=s;const r=e.createElement("div");if(r.classList.add(so("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(so("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};function oee(n,e,t){const i=nt(n/255,0,1),s=nt(e/255,0,1),r=nt(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u=0,h=0;const c=(l+o)/2;return a!==0&&(h=a/(1-Math.abs(o+l-1)),i===o?u=(s-r)/a:s===o?u=2+(r-i)/a:u=4+(i-s)/a,u=u/6+(u<0?1:0)),[u*360,h*100,c*100]}function lee(n,e,t){const i=(n%360+360)%360,s=nt(e/100,0,1),r=nt(t/100,0,1),o=(1-Math.abs(2*r-1))*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o/2;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function aee(n,e,t){const i=nt(n/255,0,1),s=nt(e/255,0,1),r=nt(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u;a===0?u=0:o===i?u=60*(((s-r)/a%6+6)%6):o===s?u=60*((r-i)/a+2):u=60*((i-s)/a+4);const h=o===0?0:a/o,c=o;return[u,h*100,c*100]}function e2(n,e,t){const i=MA(n,360),s=nt(e/100,0,1),r=nt(t/100,0,1),o=r*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function uee(n,e,t){const i=t+e*(100-Math.abs(2*t-100))/200;return[n,i!==0?e*(100-Math.abs(2*t-100))/i:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function hee(n,e,t){const i=100-Math.abs(t*(200-e)/100-100);return[n,i!==0?e*t/i:0,t*(200-e)/(2*100)]}function Di(n){return[n[0],n[1],n[2]]}function Md(n,e){return[n[0],n[1],n[2],e]}const cee={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:uee,rgb:lee},hsv:{hsl:hee,hsv:(n,e,t)=>[n,e,t],rgb:e2},rgb:{hsl:oee,hsv:aee,rgb:(n,e,t)=>[n,e,t]}};function ha(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function pee(n,e){return n===e?e:MA(n,e)}function t2(n,e,t){var i;const s=ha(e,t);return[e==="rgb"?nt(n[0],0,s[0]):pee(n[0],s[0]),nt(n[1],0,s[1]),nt(n[2],0,s[2]),nt((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function OE(n,e,t,i){const s=ha(e,t),r=ha(e,i);return n.map((o,l)=>o/s[l]*r[l])}function n2(n,e,t){const i=OE(n,e.mode,e.type,"int"),s=cee[e.mode][t.mode](...i);return OE(s,t.mode,"int",t.type)}let de=class i2{static black(){return new i2([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=t2(e,t,this.type)}getComponents(e){return Md(n2(Di(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const or=q("colp");let dee=class{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(or()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(or("hsv"));const s=e.createElement("div");s.classList.add(or("sv")),this.svPaletteView_=t.svPaletteView,s.appendChild(this.svPaletteView_.element),i.appendChild(s);const r=e.createElement("div");r.classList.add(or("h")),this.hPaletteView_=t.hPaletteView,r.appendChild(this.hPaletteView_.element),i.appendChild(r),this.element.appendChild(i);const o=e.createElement("div");if(o.classList.add(or("rgb")),this.textsView_=t.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const l=e.createElement("div");l.classList.add(or("a"));const a=e.createElement("div");a.classList.add(or("ap")),a.appendChild(this.alphaViews_.palette.element),l.appendChild(a);const u=e.createElement("div");u.classList.add(or("at")),u.appendChild(this.alphaViews_.text.element),l.appendChild(u),this.element.appendChild(l)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}};function mee(n){return n==="int"?"int":n==="float"?"float":void 0}function yg(n){return Pt(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(mee)}),expanded:e.optional.boolean,picker:e.optional.custom(JA),readonly:e.optional.constant(!1)}))}function To(n){return n?.1:1}function s2(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}let Eg=class{constructor(e,t){this.type="float",this.mode=t,this.comps_=t2(e,t,this.type)}getComponents(e){return Md(n2(Di(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const vee={int:(n,e)=>new de(n,e),float:(n,e)=>new Eg(n,e)};function xg(n,e,t){return vee[t](n,e)}function fee(n){return n.type==="float"}function wee(n){return n.type==="int"}function _ee(n){const e=n.getComponents(),t=ha(n.mode,"int");return new de([Math.round(re(e[0],0,1,0,t[0])),Math.round(re(e[1],0,1,0,t[1])),Math.round(re(e[2],0,1,0,t[2])),e[3]],n.mode)}function bee(n){const e=n.getComponents(),t=ha(n.mode,"int");return new Eg([re(e[0],0,t[0],0,1),re(e[1],0,t[1],0,1),re(e[2],0,t[2],0,1),e[3]],n.mode)}function qt(n,e){if(n.type===e)return n;if(wee(n)&&e==="float")return bee(n);if(fee(n)&&e==="int")return _ee(n);throw Mo.shouldNeverHappen()}function gee(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function Yn(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const Cee={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function r2(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),i=e[2];return Cee[i](t)}function o2(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Yn(e[1],255),Yn(e[2],255),Yn(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function Pee(n){const e=o2(n);return e?new de(e,"rgb"):null}function l2(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Yn(e[1],255),Yn(e[2],255),Yn(e[3],255),Yn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function yee(n){const e=l2(n);return e?new de(e,"rgb"):null}function a2(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[r2(e[1]),Yn(e[2],100),Yn(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function Eee(n){const e=a2(n);return e?new de(e,"hsl"):null}function u2(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[r2(e[1]),Yn(e[2],100),Yn(e[3],100),Yn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function xee(n){const e=u2(n);return e?new de(e,"hsl"):null}function h2(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function $ee(n){const e=h2(n);return e?new de(e,"rgb"):null}function c2(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),re(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),re(parseInt(t[4],16),0,255,0,1)]:null}function Vee(n){const e=c2(n);return e?new de(e,"rgb"):null}function p2(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function kee(n){return e=>{const t=p2(e);return t?xg(t,"rgb",n):null}}function d2(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function See(n){return e=>{const t=d2(e);return t?xg(t,"rgb",n):null}}const Lee=[{parser:h2,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:c2,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:o2,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:l2,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:a2,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:u2,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:p2,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:d2,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Aee(n){return Lee.reduce((e,{parser:t,result:i})=>e||(t(n)?i:null),null)}function Mee(n,e="int"){const t=Aee(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function qh(n){const e=[$ee,Vee,Pee,yee,Eee,xee];e.push(kee("int"),See("int"));const t=GJ(e);return i=>{const s=t(i);return s?qt(s,n):null}}function Tee(n){const e=qh("int");if(typeof n!="string")return de.black();const t=e(n);return t??de.black()}function m2(n){const e=nt(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function $g(n,e="#"){const t=Di(n.getComponents("rgb")).map(m2).join("");return`${e}${t}`}function Vg(n,e="#"){const t=n.getComponents("rgb"),i=[t[0],t[1],t[2],t[3]*255].map(m2).join("");return`${e}${i}`}function v2(n){const e=cn(0),t=qt(n,"int");return`rgb(${Di(t.getComponents("rgb")).map(s=>e(s)).join(", ")})`}function Kc(n){const e=cn(2),t=cn(0);return`rgba(${qt(n,"int").getComponents("rgb").map((r,o)=>(o===3?e:t)(r)).join(", ")})`}function Dee(n){const e=[cn(0),gp,gp],t=qt(n,"int");return`hsl(${Di(t.getComponents("hsl")).map((s,r)=>e[r](s)).join(", ")})`}function Oee(n){const e=[cn(0),gp,gp,cn(2)];return`hsla(${qt(n,"int").getComponents("hsl").map((s,r)=>e[r](s)).join(", ")})`}function f2(n,e){const t=cn(e==="float"?2:0),i=["r","g","b"],s=qt(n,e);return`{${Di(s.getComponents("rgb")).map((o,l)=>`${i[l]}: ${t(o)}`).join(", ")}}`}function Ree(n){return e=>f2(e,n)}function w2(n,e){const t=cn(2),i=cn(e==="float"?2:0),s=["r","g","b","a"];return`{${qt(n,e).getComponents("rgb").map((l,a)=>{const u=a===3?t:i;return`${s[a]}: ${u(l)}`}).join(", ")}}`}function jee(n){return e=>w2(e,n)}const Nee=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:$g},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:Vg},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:v2},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:Kc},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:Dee},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:Oee},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:Ree(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:jee(e)}],[])];function _2(n){return Nee.reduce((e,t)=>e||(gee(t.format,n)?t.stringifier:null),null)}const wu=q("apl");let Bee=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(wu()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(wu("b")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(wu("c")),i.appendChild(s),this.colorElem_=s;const r=e.createElement("div");r.classList.add(wu("m")),this.element.appendChild(r),this.markerElem_=r;const o=e.createElement("div");o.classList.add(wu("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new de([t[0],t[1],t[2],0],"rgb"),s=new de([t[0],t[1],t[2],255],"rgb"),r=["to right",Kc(i),Kc(s)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=Kc(e);const o=re(t[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}},Iee=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Bee(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Zo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,s=this.value.rawValue,[r,o,l]=s.getComponents("hsv");this.value.setRawValue(new de([r,o,l,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=rn(To(!0),Os(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new de([s,r,o,l+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){rn(To(!0),Os(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const fl=q("coltxt");function Fee(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((i,s)=>{const r=n.createElement("option");return r.textContent=s.text,r.value=s.value,i.appendChild(r),i},n.createDocumentFragment())),e}let Kee=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(fl()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(fl("m")),this.modeElem_=Fee(e),this.modeElem_.classList.add(fl("ms")),i.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const s=e.createElement("div");s.classList.add(fl("mm")),s.appendChild(Sd(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(fl("w")),this.element.appendChild(r),this.inputsElem_=r,this.inputViews_=t.inputViews,this.applyInputViews_(),xs(t.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){IA(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const i=e.createElement("div");i.classList.add(fl("c")),i.appendChild(t.element),this.inputsElem_.appendChild(i)})}};function Uee(n){return cn(n==="float"?2:0)}function Hee(n,e,t){const i=ha(n,e)[t];return new Vd({min:0,max:i})}function zee(n,e,t){return new Hh(n,{arrayPosition:t===0?"fst":t===2?"lst":"mid",parser:e.parser,props:Pe.fromObject({formatter:Uee(e.colorType),keyScale:To(!1),pointerScale:e.colorType==="float"?.01:1}),value:pt(0,{constraint:Hee(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function qee(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:Ir,viewProps:e.viewProps};return[0,1,2].map(i=>{const s=zee(n,t,i);return Oa({primary:e.value,secondary:s.value,forward(r){return qt(r,e.colorType).getComponents(e.colorMode)[i]},backward(r,o){const l=e.colorMode,u=qt(r,e.colorType).getComponents(l);u[i]=o;const h=xg(Md(Di(u),u[3]),l,e.colorType);return qt(h,"int")}}),s})}function Gee(n,e){const t=new Pg(n,{parser:qh("int"),props:Pe.fromObject({formatter:$g}),value:pt(de.black()),viewProps:e.viewProps});return Oa({primary:e.value,secondary:t.value,forward:i=>new de(Di(i.getComponents()),i.mode),backward:(i,s)=>new de(Md(Di(s.getComponents(i.mode)),i.getComponents()[3]),i.mode)}),[t]}function Yee(n){return n!=="hex"}let Xee=class{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=pt(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new Kee(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return Yee(t)?qee(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):Gee(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(i=>i.view)}};const ov=q("hpl");let Wee=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(ov()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(ov("c")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(ov("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=v2(new de([t,100,100],"hsv"));const i=re(t,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}},Zee=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Wee(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Zo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=re(nt(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),s=this.value.rawValue,[,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new de([i,r,o,l],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=rn(To(!1),Os(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new de([s+t,r,o,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){rn(To(!1),Os(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const lv=q("svp"),RE=64;let Qee=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(lv()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=RE,i.width=RE,i.classList.add(lv("c")),this.element.appendChild(i),this.canvasElement=i;const s=e.createElement("div");s.classList.add(lv("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=aJ(this.canvasElement);if(!e)return;const i=this.value.rawValue.getComponents("hsv"),s=this.canvasElement.width,r=this.canvasElement.height,o=e.getImageData(0,0,s,r),l=o.data;for(let h=0;h<r;h++)for(let c=0;c<s;c++){const d=re(c,0,s,0,100),p=re(h,0,r,100,0),v=e2(i[0],d,p),m=(h*s+c)*4;l[m]=v[0],l[m+1]=v[1],l[m+2]=v[2],l[m+3]=255}e.putImageData(o,0,0);const a=re(i[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const u=re(i[2],0,100,100,0);this.markerElem_.style.top=`${u}%`}onValueChange_(){this.update_()}},Jee=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Qee(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Zo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=re(e.point.x,0,e.bounds.width,0,100),s=re(e.point.y,0,e.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new de([r,i,s,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){ZA(e.key)&&e.preventDefault();const[t,i,s,r]=this.value.rawValue.getComponents("hsv"),o=To(!1),l=rn(o,Os(e)),a=rn(o,rh(e));l===0&&a===0||this.value.setRawValue(new de([t,i+l,s+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=To(!1),i=rn(t,Os(e)),s=rn(t,rh(e));i===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},ete=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new Zee(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Jee(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new Iee(e,{value:this.value,viewProps:this.viewProps}),text:new Hh(e,{parser:Ir,props:Pe.fromObject({pointerScale:.01,keyScale:.1,formatter:cn(2)}),value:pt(0,{constraint:new Vd({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Oa({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.getComponents()[3],backward:(i,s)=>{const r=i.getComponents();return r[3]=s,new de(r,i.mode)}}),this.textsC_=new Xee(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new dee(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}};const av=q("colsw");let tte=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(av()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(av("sw")),this.element.appendChild(i),this.swatchElem_=i;const s=e.createElement("button");s.classList.add(av("b")),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=Vg(e)}onValueChange_(){this.update_()}},nte=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new tte(e,{value:this.value,viewProps:this.viewProps})}},kg=class{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=wg.create(t.expanded),this.swatchC_=new nte(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new Pg(e,{parser:t.parser,props:Pe.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new ree(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new YA(e,{viewProps:this.viewProps}):null;const s=new ete(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),Oa({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),_g(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=FA(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!cg(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}};function ite(n){return Di(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function ste(n){return n.getComponents("rgb").reduce((e,t,i)=>{const s=Math.floor(i===3?t*255:t)&255;return e<<8|s},0)>>>0}function rte(n){return new de([n>>16&255,n>>8&255,n&255],"rgb")}function ote(n){return new de([n>>24&255,n>>16&255,n>>8&255,re(n&255,0,255,0,1)],"rgb")}function lte(n){return typeof n!="number"?de.black():rte(n)}function ate(n){return typeof n!="number"?de.black():ote(n)}function Uc(n,e){return typeof n!="object"||Re(n)?!1:e in n&&typeof n[e]=="number"}function b2(n){return Uc(n,"r")&&Uc(n,"g")&&Uc(n,"b")}function g2(n){return b2(n)&&Uc(n,"a")}function C2(n){return b2(n)}function Sg(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),i=e.getComponents();for(let s=0;s<t.length;s++)if(t[s]!==i[s])return!1;return!0}function jE(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function ute(n){const e=_2(n);return e?(t,i)=>{zh(t,e(i))}:null}function hte(n){const e=n?ste:ite;return(t,i)=>{zh(t,e(i))}}function cte(n,e,t){const s=qt(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b),n.writeProperty("a",s.a)}function pte(n,e,t){const s=qt(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b)}function dte(n,e){return(t,i)=>{n?cte(t,i,e):pte(t,i,e)}}function mte(n){var e;return!!(!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function vte(n){return n?e=>Vg(e,"0x"):e=>$g(e,"0x")}function fte(n){return"color"in n||n.view==="color"}Ot({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!fte(e))return null;const t=yg(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:mte(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?ate:lte,equals:Sg,writer:n=>hte(n.params.supportsAlpha)},controller:n=>{var e,t;return new kg(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:vte(n.params.supportsAlpha),parser:qh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function wte(n,e){if(!C2(n))return qt(de.black(),e);if(e==="int"){const t=jE(n);return new de(t,"rgb")}if(e==="float"){const t=jE(n);return new Eg(t,"rgb")}return qt(de.black(),"int")}function _te(n){return g2(n)}function bte(n){return e=>{const t=wte(e,n);return qt(t,"int")}}function gte(n,e){return t=>n?w2(t,e):f2(t,e)}Ot({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!C2(n))return null;const i=yg(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{colorType:(t=s2(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>bte(n.params.colorType),equals:Sg,writer:n=>dte(_te(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const i=g2(n.initialValue);return new kg(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:gte(i,n.params.colorType),parser:qh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:i,value:n.value,viewProps:n.viewProps})}});Ot({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=Mee(n,s2(e));if(!t)return null;const i=_2(t);if(!i)return null;const s=yg(e);return s?{initialValue:n,params:Object.assign(Object.assign({},s),{format:t,stringifier:i})}:null},binding:{reader:()=>Tee,equals:Sg,writer:n=>{const e=ute(n.params.format);if(!e)throw Mo.notBindable();return e}},controller:n=>{var e,t;return new kg(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:qh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});let Lg=class{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((i,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(i))!==null&&o!==void 0?o:i});return this.asm_.fromComponents(t)}};const NE=q("pndtxt");let Cte=class{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(NE()),this.textViews.forEach(i=>{const s=e.createElement("div");s.classList.add(NE("a")),s.appendChild(i.element),this.element.appendChild(s)})}};function Pte(n,e,t){return new Hh(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:pt(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}let Ag=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((i,s)=>Pte(e,t,s)),this.acs_.forEach((i,s)=>{Oa({primary:this.value,secondary:i.value,forward:r=>t.assembly.toComponents(r)[s],backward:(r,o)=>{const l=t.assembly.toComponents(r);return l[s]=o,t.assembly.fromComponents(l)}})}),this.view=new Cte(e,{textViews:this.acs_.map(i=>i.view)})}get textControllers(){return this.acs_}},yte=class extends hg{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}};function Ete(n,e){const t=[],i=DA(n,e);i&&t.push(i);const s=OA(n);s&&t.push(s);const r=Cg(n.options);return r&&t.push(r),new Uh(t)}Ot({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=Pt(e,i=>Object.assign(Object.assign({},jA(i)),{options:i.optional.custom(Ad),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>AA,constraint:n=>Ete(n.params,n.initialValue),writer:n=>zh},controller:n=>{const e=n.value,t=n.constraint,i=t&&bp(t,Ld);if(i)return new ua(n.document,{props:new Pe({options:i.values.value("options")}),value:e,viewProps:n.viewProps});const s=RA(n.params,e.rawValue),r=t&&bp(t,Vd);return r?new DE(n.document,Object.assign(Object.assign({},eee(Object.assign(Object.assign({},s),{keyScale:pt(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:Ir,value:e,viewProps:n.viewProps})):new Hh(n.document,{parser:Ir,props:Pe.fromObject(s),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof DE?new yte(n.controller):n.controller.valueController instanceof ua?new gg(n.controller):null}});let Ar=class{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(Re(e))return!1;const t=e.x,i=e.y;return!(typeof t!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}};const P2={toComponents:n=>n.getComponents(),fromComponents:n=>new Ar(...n)},wl=q("p2d");let xte=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(wl()),t.viewProps.bindClassModifiers(this.element),xs(t.expanded,Da(this.element,wl(void 0,"expanded")));const i=e.createElement("div");i.classList.add(wl("h")),this.element.appendChild(i);const s=e.createElement("button");s.classList.add(wl("b")),s.appendChild(Sd(e,"p2dpad")),t.viewProps.bindDisabled(s),i.appendChild(s),this.buttonElement=s;const r=e.createElement("div");if(r.classList.add(wl("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(wl("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};const lr=q("p2dp");let $te=class{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(lr()),t.layout==="popup"&&this.element.classList.add(lr(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(lr("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=e.createElementNS(vi,"svg");s.classList.add(lr("g")),this.padElement.appendChild(s),this.svgElem_=s;const r=e.createElementNS(vi,"line");r.classList.add(lr("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=e.createElementNS(vi,"line");o.classList.add(lr("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const l=e.createElementNS(vi,"line");l.classList.add(lr("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const a=e.createElement("div");a.classList.add(lr("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.props_.get("max"),s=re(e,-i,+i,0,100),r=re(t,-i,+i,0,100),o=this.props_.get("invertsY")?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${s}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${s}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}};function BE(n,e,t){return[rn(e[0],Os(n)),rn(e[1],rh(n))*(t?1:-1)]}let Vte=class{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new $te(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Zo(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.props.get("max"),s=re(e.point.x,0,e.bounds.width,-i,+i),r=re(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new Ar(s,r),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){ZA(e.key)&&e.preventDefault();const[t,i]=BE(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(new Ar(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=BE(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},kte=class{constructor(e,t){var i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=wg.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new YA(e,{viewProps:this.viewProps}):null;const r=new Vte(e,{layout:t.pickerLayout,props:new Pe({invertsY:pt(t.invertsY),max:pt(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.textC_=new Ag(e,{assembly:P2,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new xte(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Oa({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),_g(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=FA(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!cg(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}};function Ste(n){return Ar.isObject(n)?new Ar(n.x,n.y):new Ar}function Lte(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function Ate(n,e){return new Lg({assembly:P2,components:[ws(Object.assign(Object.assign({},n),n.x),e.x),ws(Object.assign(Object.assign({},n),n.y),e.y)]})}function IE(n,e){var t,i;if(!Re(n.min)||!Re(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((i=n.max)!==null&&i!==void 0?i:0));const s=TA(n);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function Mte(n,e){var t,i;const s=IE(Ao(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),r=IE(Ao(n,(i=n.y)!==null&&i!==void 0?i:{}),e.y);return Math.max(s,r)}function Tte(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}Ot({id:"input-point2d",type:"input",accept:(n,e)=>{if(!Ar.isObject(n))return null;const t=Pt(e,i=>Object.assign(Object.assign({},oh(i)),{expanded:i.optional.boolean,picker:i.optional.custom(JA),readonly:i.optional.constant(!1),x:i.optional.custom(Cr),y:i.optional.object(Object.assign(Object.assign({},oh(i)),{inverted:i.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>Ste,constraint:n=>Ate(n.params,n.initialValue),equals:Ar.equals,writer:()=>Lte},controller:n=>{var e,t;const i=n.document,s=n.value,r=n.constraint,o=[n.params.x,n.params.y];return new kte(i,{axes:s.rawValue.getComponents().map((l,a)=>{var u;return ag({constraint:r.components[a],initialValue:l,params:Ao(n.params,(u=o[a])!==null&&u!==void 0?u:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:Tte(n.params),max:Mte(n.params,s.rawValue),parser:Ir,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:n.viewProps})}});let Hl=class{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(Re(e))return!1;const t=e.x,i=e.y,s=e.z;return!(typeof t!="number"||typeof i!="number"||typeof s!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}};const y2={toComponents:n=>n.getComponents(),fromComponents:n=>new Hl(...n)};function Dte(n){return Hl.isObject(n)?new Hl(n.x,n.y,n.z):new Hl}function Ote(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function Rte(n,e){return new Lg({assembly:y2,components:[ws(Object.assign(Object.assign({},n),n.x),e.x),ws(Object.assign(Object.assign({},n),n.y),e.y),ws(Object.assign(Object.assign({},n),n.z),e.z)]})}Ot({id:"input-point3d",type:"input",accept:(n,e)=>{if(!Hl.isObject(n))return null;const t=Pt(e,i=>Object.assign(Object.assign({},oh(i)),{readonly:i.optional.constant(!1),x:i.optional.custom(Cr),y:i.optional.custom(Cr),z:i.optional.custom(Cr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Dte,constraint:n=>Rte(n.params,n.initialValue),equals:Hl.equals,writer:n=>Ote},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z];return new Ag(n.document,{assembly:y2,axes:e.rawValue.getComponents().map((s,r)=>{var o;return ag({constraint:t.components[r],initialValue:s,params:Ao(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Ir,value:e,viewProps:n.viewProps})}});let zl=class{constructor(e=0,t=0,i=0,s=0){this.x=e,this.y=t,this.z=i,this.w=s}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(Re(e))return!1;const t=e.x,i=e.y,s=e.z,r=e.w;return!(typeof t!="number"||typeof i!="number"||typeof s!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}};const E2={toComponents:n=>n.getComponents(),fromComponents:n=>new zl(...n)};function jte(n){return zl.isObject(n)?new zl(n.x,n.y,n.z,n.w):new zl}function Nte(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function Bte(n,e){return new Lg({assembly:E2,components:[ws(Object.assign(Object.assign({},n),n.x),e.x),ws(Object.assign(Object.assign({},n),n.y),e.y),ws(Object.assign(Object.assign({},n),n.z),e.z),ws(Object.assign(Object.assign({},n),n.w),e.w)]})}Ot({id:"input-point4d",type:"input",accept:(n,e)=>{if(!zl.isObject(n))return null;const t=Pt(e,i=>Object.assign(Object.assign({},oh(i)),{readonly:i.optional.constant(!1),w:i.optional.custom(Cr),x:i.optional.custom(Cr),y:i.optional.custom(Cr),z:i.optional.custom(Cr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>jte,constraint:n=>Bte(n.params,n.initialValue),equals:zl.equals,writer:n=>Nte},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z,n.params.w];return new Ag(n.document,{assembly:E2,axes:e.rawValue.getComponents().map((s,r)=>{var o;return ag({constraint:t.components[r],initialValue:s,params:Ao(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Ir,value:e,viewProps:n.viewProps})}});function Ite(n){const e=[],t=Cg(n.options);return t&&e.push(t),new Uh(e)}Ot({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=Pt(e,i=>({readonly:i.optional.constant(!1),options:i.optional.custom(Ad)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>WA,constraint:n=>Ite(n.params),writer:n=>zh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&bp(i,Ld);return s?new ua(e,{props:new Pe({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new Pg(e,{parser:r=>r,props:Pe.fromObject({formatter:gf}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof ua?new gg(n.controller):null}});const Td={monitor:{defaultInterval:200,defaultRows:3}},FE=q("mll");let Fte=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(FE()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(FE("i")),i.style.height=`calc(var(${QA("containerUnitSize")}) * ${t.rows})`,i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach(s=>{s!==void 0&&i.push(this.formatter_(s))}),e.textContent=i.join(`
`),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}},Mg=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Fte(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}};const KE=q("sgl");let Kte=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(KE()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(KE("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}},Tg=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Kte(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}};Ot({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Pt(e,i=>({readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>XA},controller:n=>{var e;return n.value.rawValue.length===1?new Tg(n.document,{formatter:TE,value:n.value,viewProps:n.viewProps}):new Mg(n.document,{formatter:TE,rows:(e=n.params.rows)!==null&&e!==void 0?e:Td.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});let Ute=class extends hg{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}};const ar=q("grl");let Hte=class{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ar()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(vi,"svg");i.classList.add(ar("g")),i.style.height=`calc(var(${QA("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(vi,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=e.createElement("div");r.classList.add(ar("t"),q("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const{clientWidth:e,clientHeight:t}=this.element,i=this.value.rawValue.length-1,s=this.props_.get("min"),r=this.props_.get("max"),o=[];this.value.rawValue.forEach((c,d)=>{if(c===void 0)return;const p=re(d,0,i,0,e),v=re(c,s,r,t,0);o.push([p,v].join(","))}),this.lineElem_.setAttributeNS(null,"points",o.join(" "));const l=this.tooltipElem_,a=this.value.rawValue[this.cursor_.rawValue];if(a===void 0){l.classList.remove(ar("t","a"));return}const u=re(this.cursor_.rawValue,0,i,0,e),h=re(a,s,r,t,0);l.style.left=`${u}px`,l.style.top=`${h}px`,l.textContent=`${this.formatter_(a)}`,l.classList.contains(ar("t","a"))||(l.classList.add(ar("t","a"),ar("t","in")),_p(l),l.classList.remove(ar("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}},x2=class{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=pt(-1),this.view=new Hte(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!cg(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new Zo(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return Xi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return Wi(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const{clientWidth:t}=this.view.element;this.cursor_.rawValue=Math.floor(re(e.offsetX,0,t,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(re(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}};function Cf(n){return Re(n.format)?cn(2):n.format}function zte(n){var e;return n.value.rawValue.length===1?new Tg(n.document,{formatter:Cf(n.params),value:n.value,viewProps:n.viewProps}):new Mg(n.document,{formatter:Cf(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Td.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function qte(n){var e,t,i;return new x2(n.document,{formatter:Cf(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Td.monitor.defaultRows,props:Pe.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(i=n.params.min)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function UE(n){return n.view==="graph"}Ot({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=Pt(e,i=>({format:i.optional.function,max:i.optional.number,min:i.optional.number,readonly:i.required.constant(!0),rows:i.optional.number,view:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>UE(n)?64:1,reader:n=>AA},controller:n=>UE(n.params)?qte(n):zte(n),api:n=>n.controller.valueController instanceof x2?new Ute(n.controller):null});Ot({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=Pt(e,i=>({multiline:i.optional.boolean,readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>WA},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new Mg(n.document,{formatter:gf,rows:(e=n.params.rows)!==null&&e!==void 0?e:Td.monitor.defaultRows,value:t,viewProps:n.viewProps}):new Tg(n.document,{formatter:gf,value:t,viewProps:n.viewProps})}});const HE=q("txtr");class Gte{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(HE()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.rows=t.rows,i.cols=22,i.placeholder=t.placeholder,i.classList.add(HE("i")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){this.inputElement.value=this.value_.rawValue}onChange_(){this.refresh()}}class Yte{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.rows=t.rows,this.placeholder=t.placeholder,this.view=new Gte(e,{value:this.value,viewProps:this.viewProps,rows:this.rows,placeholder:this.placeholder}),this.view.inputElement.addEventListener("keyup",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value;this.value.rawValue=i,this.view.refresh()}}Ot({id:"input-template",type:"input",accept(n,e){if(typeof n!="string")return null;const t=Pt(e,i=>({view:i.required.constant("textarea"),rows:i.optional.number,placeholder:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{reader(n){return e=>typeof e=="string"?e:""},writer(n){return(e,t)=>{e.write(t)}}},controller(n){var e,t;return new Yte(n.document,{value:n.value,rows:(e=n.params.rows)!==null&&e!==void 0?e:3,placeholder:(t=n.params.placeholder)!==null&&t!==void 0?t:"Enter text here",viewProps:n.viewProps})}});function Xte(n){let e,t;return e=new Kw({props:{theme:n[4],userCreatedPane:!1,$$slots:{default:[Qte]},$$scope:{ctx:n}}}),{c(){fe(e.$$.fragment)},l(i){we(e.$$.fragment,i)},m(i,s){_e(e,i,s),t=!0},p(i,s){const r={};s&16&&(r.theme=i[4]),s&16399&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function Wte(n){let e,t,i,s;const r=[ene,Jte],o=[];function l(a,u){return 0}return e=l(),t=o[e]=r[e](n),{c(){t.c(),i=D()},l(a){t.l(a),i=D()},m(a,u){o[e].m(a,u),k(a,i,u),s=!0},p(a,u){t.p(a,u)},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&P(i),o[e].d(a)}}}function Zte(n){let e;const t=n[11].default,i=mn(t,n,n[14],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&16384)&&vn(i,t,s,s[14],e?wn(t,s[14],r,null):fn(s[14]),null)},i(s){e||(b(i,s),e=!0)},o(s){y(i,s),e=!1},d(s){i&&i.d(s)}}}function Qte(n){let e,t,i;function s(o){n[13](o)}let r={disabled:n[2],title:n[1],userExpandable:n[3],$$slots:{default:[Zte]},$$scope:{ctx:n}};return n[0]!==void 0&&(r.expanded=n[0]),e=new Pf({props:r}),R.push(()=>xe(e,"expanded",s)),{c(){fe(e.$$.fragment)},l(o){we(e.$$.fragment,o)},m(o,l){_e(e,o,l),i=!0},p(o,l){const a={};l&4&&(a.disabled=o[2]),l&2&&(a.title=o[1]),l&8&&(a.userExpandable=o[3]),l&16384&&(a.$$scope={dirty:l,ctx:o}),!t&&l&1&&(t=!0,a.expanded=o[0],Ee(()=>t=!1)),e.$set(a)},i(o){i||(b(e.$$.fragment,o),i=!0)},o(o){y(e.$$.fragment,o),i=!1},d(o){be(e,o)}}}function Jte(n){let e,t,i,s;e=new ba({props:{keysAdd:["containerUnitSize"],theme:n[4]}});let r=n[0]&&zE(n);return{c(){fe(e.$$.fragment),t=wi(),r&&r.c(),i=D()},l(o){we(e.$$.fragment,o),t=_i(o),r&&r.l(o),i=D()},m(o,l){_e(e,o,l),k(o,t,l),r&&r.m(o,l),k(o,i,l),s=!0},p(o,l){const a={};l&16&&(a.theme=o[4]),e.$set(a),o[0]?r?(r.p(o,l),l&1&&b(r,1)):(r=zE(o),r.c(),b(r,1),r.m(i.parentNode,i)):r&&(Bi(),y(r,1,1,()=>{r=null}),Ii())},i(o){s||(b(e.$$.fragment,o),b(r),s=!0)},o(o){y(e.$$.fragment,o),y(r),s=!1},d(o){o&&(P(t),P(i)),be(e,o),r&&r.d(o)}}}function ene(n){let e,t;const i=n[11].default,s=mn(i,n,n[14],null);return{c(){e=Ue("div"),s&&s.c(),this.h()},l(r){e=He(r,"DIV",{style:!0});var o=ke(e);s&&s.l(o),o.forEach(P),this.h()},h(){Ye(e,"display","none")},m(r,o){k(r,e,o),s&&s.m(e,null),n[12](e),t=!0},p(r,o){s&&s.p&&(!t||o&16384)&&vn(s,i,r,r[14],t?wn(i,r[14],o,null):fn(r[14]),null)},i(r){t||(b(s,r),t=!0)},o(r){y(s,r),t=!1},d(r){r&&P(e),s&&s.d(r),n[12](null)}}}function zE(n){let e,t,i;e=new ba({props:{keysAdd:["containerVerticalPadding","containerVerticalPadding"],theme:n[4]}});const s=n[11].default,r=mn(s,n,n[14],null);return{c(){fe(e.$$.fragment),t=wi(),r&&r.c()},l(o){we(e.$$.fragment,o),t=_i(o),r&&r.l(o)},m(o,l){_e(e,o,l),k(o,t,l),r&&r.m(o,l),i=!0},p(o,l){const a={};l&16&&(a.theme=o[4]),e.$set(a),r&&r.p&&(!i||l&16384)&&vn(r,s,o,o[14],i?wn(s,o[14],l,null):fn(o[14]),null)},i(o){i||(b(e.$$.fragment,o),b(r,o),i=!0)},o(o){y(e.$$.fragment,o),y(r,o),i=!1},d(o){o&&P(t),be(e,o),r&&r.d(o)}}}function tne(n){let e,t,i,s;const r=[Wte,Xte],o=[];function l(a,u){return a[6]?0:1}return e=l(n),t=o[e]=r[e](n),{c(){t.c(),i=D()},l(a){t.l(a),i=D()},m(a,u){o[e].m(a,u),k(a,i,u),s=!0},p(a,[u]){t.p(a,u)},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&P(i),o[e].d(a)}}}function nne(n,e,t){let i,s,{$$slots:r={},$$scope:o}=e,{title:l="Folder"}=e,{disabled:a=!1}=e,{expanded:u=!0}=e,{userExpandable:h=!0}=e,{theme:c=void 0}=e;const d=ao("parentStore");In(n,d,C=>t(10,i=C));const p=ci();In(n,p,C=>t(15,s=C));const v=ao("userCreatedPane");let m,f,w;$u("parentStore",p);function g(){Rf(p,s=i.addFolder({disabled:a,expanded:u,index:f,title:l}),s),s.on("fold",()=>{t(0,u=s.expanded)}),t(9,w=s)}fh(()=>{t(8,f=m?cV(m):0)}),kp(()=>{s==null||s.dispose()});function L(C){R[C?"unshift":"push"](()=>{m=C,t(5,m)})}function ye(C){u=C,t(0,u)}return n.$$set=C=>{"title"in C&&t(1,l=C.title),"disabled"in C&&t(2,a=C.disabled),"expanded"in C&&t(0,u=C.expanded),"userExpandable"in C&&t(3,h=C.userExpandable),"theme"in C&&t(4,c=C.theme),"$$scope"in C&&t(14,o=C.$$scope)},n.$$.update=()=>{n.$$.dirty&514&&w&&t(9,w.title=l,w),n.$$.dirty&516&&w&&t(9,w.disabled=a,w),n.$$.dirty&513&&w&&u!==void 0&&t(9,w.expanded=u,w),n.$$.dirty&1792&&i&&!w&&f!==void 0&&g(),n.$$.dirty&520&&w&&pV(h,w.element,"tp-fldv_b","tp-fldv_m"),n.$$.dirty&1040&&c&&i&&(v||!hV(i))&&console.warn("Set theme on the <Pane> component, not on its children! (Check nested <Folder> components for a theme prop.)")},[u,l,a,h,c,m,d,p,f,w,i,r,L,ye,o]}class Pf extends Lt{constructor(e){super(),At(this,e,nne,tne,St,{title:1,disabled:2,expanded:0,userExpandable:3,theme:4})}}var uv={local:{},session:{}};function ine(n){return n==="local"?localStorage:sessionStorage}function qE(n,e,t){var i,s;const r=(i=void 0)!=null?i:JSON,o=(s=void 0)!=null?s:"local",l=typeof window<"u"&&typeof document<"u",a=l?ine(o):null;function u(h,c){a==null||a.setItem(h,r.stringify(c))}if(!uv[o][n]){const h=ci(e,p=>{const v=a==null?void 0:a.getItem(n);if(v&&p(r.parse(v)),l&&o=="local"){const m=f=>{f.key===n&&p(f.newValue?r.parse(f.newValue):null)};return window.addEventListener("storage",m),()=>window.removeEventListener("storage",m)}}),{subscribe:c,set:d}=h;uv[o][n]={set(p){u(n,p),d(p)},update(p){return h.update(v=>{const m=p(v);return u(n,m),m})},subscribe:c}}return uv[o][n]}const{window:sne}=FT;function rne(n){let e;const t=n[25].default,i=mn(t,n,n[32],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r[1]&2)&&vn(i,t,s,s[32],e?wn(t,s[32],r,null):fn(s[32]),null)},i(s){e||(b(i,s),e=!0)},o(s){y(i,s),e=!1},d(s){i&&i.d(s)}}}function one(n){let e,t,i,s,r,o=`${n[2]}px`,l=`${n[3]}px`,a=`${n[4]}px`,u,h,c;const d=[{scale:n[8]},{title:n[7]},Rr(n[16],"position")];function p(f){n[26](f)}function v(f){n[27](f)}let m={$$slots:{default:[rne]},$$scope:{ctx:n}};for(let f=0;f<d.length;f+=1)m=wt(m,d[f]);return n[1]!==void 0&&(m.expanded=n[1]),n[0]!==void 0&&(m.tpPane=n[0]),t=new Fw({props:m}),R.push(()=>xe(t,"expanded",p)),R.push(()=>xe(t,"tpPane",v)),{c(){e=Ue("div"),fe(t.$$.fragment),this.h()},l(f){e=He(f,"DIV",{class:!0});var w=ke(e);we(t.$$.fragment,w),w.forEach(P),this.h()},h(){X(e,"class","draggable-container svelte-1a19eql"),jT(()=>n[28].call(e)),Fn(e,"not-collapsable",!n[6]),Fn(e,"not-resizable",!n[5]),Ye(e,"left",o),Ye(e,"padding",n[9]),Ye(e,"top",l),Ye(e,"width",a),Ye(e,"z-index",n[14])},m(f,w){k(f,e,w),_e(t,e,null),r=NT(e,n[28].bind(e)),n[29](e),u=!0,h||(c=[si(sne,"resize",n[15]),si(e,"focus",n[30],!0),si(e,"pointerdown",n[31],!0)],h=!0)},p(f,w){const g=w[0]&65920?Bo(d,[w[0]&256&&{scale:f[8]},w[0]&128&&{title:f[7]},w[0]&65536&&va(Rr(f[16],"position"))]):{};w[1]&2&&(g.$$scope={dirty:w,ctx:f}),!i&&w[0]&2&&(i=!0,g.expanded=f[1],Ee(()=>i=!1)),!s&&w[0]&1&&(s=!0,g.tpPane=f[0],Ee(()=>s=!1)),t.$set(g),(!u||w[0]&64)&&Fn(e,"not-collapsable",!f[6]),(!u||w[0]&32)&&Fn(e,"not-resizable",!f[5]),w[0]&4&&o!==(o=`${f[2]}px`)&&Ye(e,"left",o),w[0]&512&&Ye(e,"padding",f[9]),w[0]&8&&l!==(l=`${f[3]}px`)&&Ye(e,"top",l),w[0]&16&&a!==(a=`${f[4]}px`)&&Ye(e,"width",a),w[0]&16384&&Ye(e,"z-index",f[14])},i(f){u||(b(t.$$.fragment,f),u=!0)},o(f){y(t.$$.fragment,f),u=!1},d(f){f&&P(e),be(t),r(),n[29](null),h=!1,vh(c)}}}const bc="svelte-tweakpane-ui-draggable-position-",lne="1",_l=[];let hv=1e3;function ane(n,e,t){let i;const s=["storePositionLocally","localStoreId","tpPane","expanded","collapseChildrenToFit","x","y","width","resizable","userExpandable","minWidth","maxWidth","title","scale","padding"];let r=bi(e,s),o,l=Xe,a=()=>(l(),l=BT(v,_=>t(40,o=_)),v);n.$$.on_destroy.push(()=>l());let{$$slots:u={},$$scope:h}=e,{storePositionLocally:c=!0}=e,{localStoreId:d=lne}=e,{tpPane:p=void 0}=e,v;c&&a(v=qE(`${bc}${d}`,{x:0,y:0,expanded:!0,width:350}));let{expanded:m=(o==null?void 0:o.expanded)??!0}=e,{collapseChildrenToFit:f=!1}=e,{x:w=(o==null?void 0:o.x)??0}=e,{y:g=(o==null?void 0:o.y)??0}=e,{width:L=(o==null?void 0:o.width)??256}=e,{resizable:ye=!0}=e,{userExpandable:C=!0}=e,{minWidth:qe=200}=e,{maxWidth:O=600}=e,{title:E="Tweakpane"}=e,{scale:Ge=1}=e,{padding:ti="0"}=e,Jt,$,J,Ke,kn,ts,x,Bs,Yd=hv;function PT(){d!==void 0&&(_l.includes(d)&&console.warn('Multiple instances of <Pane> with `mode="draggable"` and `storePositionLocally=true` detected. You must explicitly set unique localStoreId property on each component to avoid collisions.'),_l.push(d))}function yT(){d&&(_l.splice(_l.indexOf(d),1),localStorage.removeItem(`${bc}${d}`))}function ET(_){_!==void 0&&v!==void 0&&m!==void 0&&L!==void 0&&w!==void 0&&g!==void 0&&a(t(10,v=qE(`${bc}${d}`,{x:w,y:g,expanded:m,width:L})))}function jC(){if(w!==void 0&&g!==void 0&&L!==void 0){const _=x,Sn=Bs;t(23,x=document.documentElement.clientWidth),t(24,Bs=document.documentElement.clientHeight);const hi=x-_,Ia=Bs-Sn,MT=(w+L/2)/x,TT=(g+kn/2)/Bs;!Number.isNaN(hi)&&MT>=.5&&t(2,w+=hi),!Number.isNaN(Ia)&&TT>=.5&&t(3,g+=Ia)}}const sc=_=>{_.stopPropagation()};let NC=0,Xd=0,BC=0,Wd=0;const rc=_=>{_.stopPropagation(),_.target&&L!==void 0&&_.target===J&&t(4,L=L<i?i:qe)},oc=_=>{w!==void 0&&g!==void 0&&_.button===0&&_.target instanceof HTMLElement&&(Wd=0,_.target.setPointerCapture(_.pointerId),_.target.addEventListener("pointermove",lc),_.target.addEventListener("pointerup",ac),NC=L??0,Xd=w-_.pageX,BC=g-_.pageY)},lc=_=>{_.target instanceof HTMLElement&&L!==void 0&&qe!==void 0&&w!==void 0&&g!==void 0&&(_.target===$?(Wd+=Math.hypot(_.movementX,_.movementY),t(2,w=_.pageX+Xd),t(3,g=_.pageY+BC)):_.target===J&&t(4,L=rm(_.pageX+Xd+NC-w,qe,i)))},ac=_=>{_.stopImmediatePropagation(),_.target instanceof HTMLElement&&(_.target.releasePointerCapture(_.pointerId),_.target.removeEventListener("pointermove",lc),_.target.removeEventListener("pointerup",ac),_.target===$&&Wd<3&&C&&p&&t(0,p.expanded=!p.expanded,p))},IC=_=>{_.preventDefault()};fh(()=>{var Sn;jC(),p?Jt.append(p.element):console.warn("no tpPane in draggable"),Jt.addEventListener("touchmove",IC,{passive:!1});const _=Jt.querySelector(".tp-rotv_t");_&&($=_,$.addEventListener("click",sc),$.addEventListener("dblclick",rc),$.addEventListener("pointerdown",oc),J=(Sn=$.parentElement)==null?void 0:Sn.appendChild(document.createElement("div")),J&&(J.className="tp-custom-width-handle",J.textContent="",J.addEventListener("click",sc),J.addEventListener("dblclick",rc),J.addEventListener("pointerdown",oc)))}),kp(()=>{$&&($.removeEventListener("click",sc),$.removeEventListener("dblclick",rc),$.removeEventListener("pointerdown",oc),$.removeEventListener("pointermove",lc),$.removeEventListener("pointerup",ac)),J&&(J.removeEventListener("click",sc),J.removeEventListener("dblclick",rc),J.removeEventListener("pointerdown",oc),J.removeEventListener("pointermove",lc),J.removeEventListener("pointerup",ac)),Jt&&Jt.removeEventListener("touchmove",IC),d!==void 0&&_l.splice(_l.indexOf(d),1)});function xT(_){J&&(J.style.display=_?"block":"none")}function FC(_,Sn=Number.MAX_SAFE_INTEGER){if(Sn>0)for(const hi of _)if("expanded"in hi)hi.expanded&&(Sn--,hi.expanded=!1),"children"in hi&&FC(hi.children,Sn);else{const Ia=iN(hi);Ia&&nN(hi)&&(Sn--,Ia.click())}}function $T(_){m=_,t(1,m)}function VT(_){p=_,t(0,p)}function kT(){Ke=this.clientHeight,ts=this.clientWidth,t(12,Ke),t(13,ts)}function ST(_){R[_?"unshift":"push"](()=>{Jt=_,t(11,Jt)})}const LT=()=>{t(14,Yd=++hv)},AT=()=>{t(14,Yd=++hv)};return n.$$set=_=>{e=wt(wt({},e),Wl(_)),t(16,r=bi(e,s)),"storePositionLocally"in _&&t(17,c=_.storePositionLocally),"localStoreId"in _&&t(18,d=_.localStoreId),"tpPane"in _&&t(0,p=_.tpPane),"expanded"in _&&t(1,m=_.expanded),"collapseChildrenToFit"in _&&t(19,f=_.collapseChildrenToFit),"x"in _&&t(2,w=_.x),"y"in _&&t(3,g=_.y),"width"in _&&t(4,L=_.width),"resizable"in _&&t(5,ye=_.resizable),"userExpandable"in _&&t(6,C=_.userExpandable),"minWidth"in _&&t(20,qe=_.minWidth),"maxWidth"in _&&t(21,O=_.maxWidth),"title"in _&&t(7,E=_.title),"scale"in _&&t(8,Ge=_.scale),"padding"in _&&t(9,ti=_.padding),"$$scope"in _&&t(32,h=_.$$scope)},n.$$.update=()=>{if(n.$$.dirty[0]&33&&p&&ye&&xT(ye),n.$$.dirty[0]&6400&&Jt)if(Ge===void 0||Ge===1)t(22,kn=Ke);else{const _=window.getComputedStyle(Jt),Sn=Number.parseFloat(_.paddingTop)+Number.parseFloat(_.paddingBottom);t(22,kn=(Ke-Sn)*Ge+Sn)}n.$$.dirty[0]&33038365&&kn!==void 0&&x!==void 0&&Bs!==void 0&&w!==void 0&&g!==void 0&&L!==void 0&&qe!==void 0&&O!==void 0&&(f&&kn>Bs&&p&&FC(p.children),t(2,w=rm(w,0,Math.max(0,x-ts))),t(3,g=rm(g,0,Math.max(0,Bs-kn))),x<ts&&t(4,L=Math.max(qe,Math.min(O,x)))),n.$$.dirty[0]&10485764&&(i=Math.min(O??600,x-(w??0))),n.$$.dirty[0]&393216&&c&&PT(),n.$$.dirty[0]&393216&&!c&&yT(),n.$$.dirty[0]&262144&&d!==`${bc}${d}`&&ET(d),n.$$.dirty[0]&394270&&c&&d!==void 0&&w!==void 0&&g!==void 0&&L!==void 0&&m!==void 0&&(v==null||v.set({x:w,y:g,expanded:m,width:L}))},[p,m,w,g,L,ye,C,E,Ge,ti,v,Jt,Ke,ts,Yd,jC,r,c,d,f,qe,O,kn,x,Bs,u,$T,VT,kT,ST,LT,AT,h]}class une extends Lt{constructor(e){super(),At(this,e,ane,one,St,{storePositionLocally:17,localStoreId:18,tpPane:0,expanded:1,collapseChildrenToFit:19,x:2,y:3,width:4,resizable:5,userExpandable:6,minWidth:20,maxWidth:21,title:7,scale:8,padding:9},null,[-1,-1])}}function hne(n){let e;const t=n[8].default,i=mn(t,n,n[11],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&2048)&&vn(i,t,s,s[11],e?wn(t,s[11],r,null):fn(s[11]),null)},i(s){e||(b(i,s),e=!0)},o(s){y(i,s),e=!1},d(s){i&&i.d(s)}}}function cne(n){let e,t,i,s,r;const o=[{title:n[2]},Rr(n[3],"position")];function l(h){n[9](h)}function a(h){n[10](h)}let u={$$slots:{default:[hne]},$$scope:{ctx:n}};for(let h=0;h<o.length;h+=1)u=wt(u,o[h]);return n[1]!==void 0&&(u.expanded=n[1]),n[0]!==void 0&&(u.tpPane=n[0]),t=new Fw({props:u}),R.push(()=>xe(t,"expanded",l)),R.push(()=>xe(t,"tpPane",a)),{c(){e=Ue("div"),fe(t.$$.fragment),this.h()},l(h){e=He(h,"DIV",{style:!0});var c=ke(e);we(t.$$.fragment,c),c.forEach(P),this.h()},h(){Ye(e,"display","none")},m(h,c){k(h,e,c),_e(t,e,null),r=!0},p(h,[c]){const d=c&12?Bo(o,[c&4&&{title:h[2]},c&8&&va(Rr(h[3],"position"))]):{};c&2048&&(d.$$scope={dirty:c,ctx:h}),!i&&c&2&&(i=!0,d.expanded=h[1],Ee(()=>i=!1)),!s&&c&1&&(s=!0,d.tpPane=h[0],Ee(()=>s=!1)),t.$set(d)},i(h){r||(b(t.$$.fragment,h),r=!0)},o(h){y(t.$$.fragment,h),r=!1},d(h){h&&P(e),be(t)}}}function pne(n,e,t){const i=["expanded","x","y","width","title","tpPane"];let s=bi(e,i),{$$slots:r={},$$scope:o}=e,{expanded:l=void 0}=e,{x:a=void 0}=e,{y:u=void 0}=e,{width:h=void 0}=e,{title:c="Tweakpane"}=e,{tpPane:d=void 0}=e,p;function v(f){l=f,t(1,l)}function m(f){d=f,t(0,d)}return n.$$set=f=>{e=wt(wt({},e),Wl(f)),t(3,s=bi(e,i)),"expanded"in f&&t(1,l=f.expanded),"x"in f&&t(4,a=f.x),"y"in f&&t(5,u=f.y),"width"in f&&t(6,h=f.width),"title"in f&&t(2,c=f.title),"tpPane"in f&&t(0,d=f.tpPane),"$$scope"in f&&t(11,o=f.$$scope)},n.$$.update=()=>{n.$$.dirty&1&&d!=null&&d.element.parentElement&&t(7,p=d.element.parentElement),n.$$.dirty&144&&p!==void 0&&a!==void 0&&(p.style.setProperty("right","unset"),p.style.setProperty("left",`${a}px`)),n.$$.dirty&160&&p!==void 0&&u!==void 0&&p.style.setProperty("top",`${u}px`),n.$$.dirty&192&&p!==void 0&&h!==void 0&&p.style.setProperty("width",`${h}px`)},[d,l,c,s,a,u,h,p,r,v,m,o]}class dne extends Lt{constructor(e){super(),At(this,e,pne,cne,St,{expanded:1,x:4,y:5,width:6,title:2,tpPane:0})}}function mne(n){let e,t,i,s;const r=[_ne,wne],o=[];function l(a,u){return 0}return e=l(),t=o[e]=r[e](n),{c(){t.c(),i=D()},l(a){t.l(a),i=D()},m(a,u){o[e].m(a,u),k(a,i,u),s=!0},p(a,u){t.p(a,u)},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&P(i),o[e].d(a)}}}function vne(n){let e,t,i,s;const r=[{width:n[1]},Rr(n[6],"storePositionLocally")];function o(u){n[13](u)}function l(u){n[14](u)}let a={$$slots:{default:[gne]},$$scope:{ctx:n}};for(let u=0;u<r.length;u+=1)a=wt(a,r[u]);return n[0]!==void 0&&(a.expanded=n[0]),n[2]!==void 0&&(a.tpPane=n[2]),e=new Kw({props:a}),R.push(()=>xe(e,"expanded",o)),R.push(()=>xe(e,"tpPane",l)),{c(){fe(e.$$.fragment)},l(u){we(e.$$.fragment,u)},m(u,h){_e(e,u,h),s=!0},p(u,h){const c=h&66?Bo(r,[h&2&&{width:u[1]},h&64&&va(Rr(u[6],"storePositionLocally"))]):{};h&524288&&(c.$$scope={dirty:h,ctx:u}),!t&&h&1&&(t=!0,c.expanded=u[0],Ee(()=>t=!1)),!i&&h&4&&(i=!0,c.tpPane=u[2],Ee(()=>i=!1)),e.$set(c)},i(u){s||(b(e.$$.fragment,u),s=!0)},o(u){y(e.$$.fragment,u),s=!1},d(u){be(e,u)}}}function fne(n){let e,t,i,s;const r=[Pne,Cne],o=[];function l(a,u){return 0}return e=l(),t=o[e]=r[e](n),{c(){t.c(),i=D()},l(a){t.l(a),i=D()},m(a,u){o[e].m(a,u),k(a,i,u),s=!0},p(a,u){t.p(a,u)},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&P(i),o[e].d(a)}}}function wne(n){let e,t;const i=n[7].default,s=mn(i,n,n[19],null);return{c(){e=Ue("div"),s&&s.c(),this.h()},l(r){e=He(r,"DIV",{style:!0});var o=ke(e);s&&s.l(o),o.forEach(P),this.h()},h(){Ye(e,"display","none")},m(r,o){k(r,e,o),s&&s.m(e,null),t=!0},p(r,o){s&&s.p&&(!t||o&524288)&&vn(s,i,r,r[19],t?wn(i,r[19],o,null):fn(r[19]),null)},i(r){t||(b(s,r),t=!0)},o(r){y(s,r),t=!1},d(r){r&&P(e),s&&s.d(r)}}}function _ne(n){let e,t,i,s,r,o;const l=[{width:n[1]},n[6]];function a(p){n[15](p)}function u(p){n[16](p)}function h(p){n[17](p)}function c(p){n[18](p)}let d={$$slots:{default:[bne]},$$scope:{ctx:n}};for(let p=0;p<l.length;p+=1)d=wt(d,l[p]);return n[0]!==void 0&&(d.expanded=n[0]),n[2]!==void 0&&(d.tpPane=n[2]),n[3]!==void 0&&(d.x=n[3]),n[4]!==void 0&&(d.y=n[4]),e=new dne({props:d}),R.push(()=>xe(e,"expanded",a)),R.push(()=>xe(e,"tpPane",u)),R.push(()=>xe(e,"x",h)),R.push(()=>xe(e,"y",c)),{c(){fe(e.$$.fragment)},l(p){we(e.$$.fragment,p)},m(p,v){_e(e,p,v),o=!0},p(p,v){const m=v&66?Bo(l,[v&2&&{width:p[1]},v&64&&va(p[6])]):{};v&524288&&(m.$$scope={dirty:v,ctx:p}),!t&&v&1&&(t=!0,m.expanded=p[0],Ee(()=>t=!1)),!i&&v&4&&(i=!0,m.tpPane=p[2],Ee(()=>i=!1)),!s&&v&8&&(s=!0,m.x=p[3],Ee(()=>s=!1)),!r&&v&16&&(r=!0,m.y=p[4],Ee(()=>r=!1)),e.$set(m)},i(p){o||(b(e.$$.fragment,p),o=!0)},o(p){y(e.$$.fragment,p),o=!1},d(p){be(e,p)}}}function bne(n){let e;const t=n[7].default,i=mn(t,n,n[19],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&524288)&&vn(i,t,s,s[19],e?wn(t,s[19],r,null):fn(s[19]),null)},i(s){e||(b(i,s),e=!0)},o(s){y(i,s),e=!1},d(s){i&&i.d(s)}}}function gne(n){let e;const t=n[7].default,i=mn(t,n,n[19],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&524288)&&vn(i,t,s,s[19],e?wn(t,s[19],r,null):fn(s[19]),null)},i(s){e||(b(i,s),e=!0)},o(s){y(i,s),e=!1},d(s){i&&i.d(s)}}}function Cne(n){let e,t;const i=n[7].default,s=mn(i,n,n[19],null);return{c(){e=Ue("div"),s&&s.c(),this.h()},l(r){e=He(r,"DIV",{style:!0});var o=ke(e);s&&s.l(o),o.forEach(P),this.h()},h(){Ye(e,"display","none")},m(r,o){k(r,e,o),s&&s.m(e,null),t=!0},p(r,o){s&&s.p&&(!t||o&524288)&&vn(s,i,r,r[19],t?wn(i,r[19],o,null):fn(r[19]),null)},i(r){t||(b(s,r),t=!0)},o(r){y(s,r),t=!1},d(r){r&&P(e),s&&s.d(r)}}}function Pne(n){let e,t,i,s,r,o,l;const a=[n[6]];function u(m){n[8](m)}function h(m){n[9](m)}function c(m){n[10](m)}function d(m){n[11](m)}function p(m){n[12](m)}let v={$$slots:{default:[yne]},$$scope:{ctx:n}};for(let m=0;m<a.length;m+=1)v=wt(v,a[m]);return n[0]!==void 0&&(v.expanded=n[0]),n[2]!==void 0&&(v.tpPane=n[2]),n[1]!==void 0&&(v.width=n[1]),n[3]!==void 0&&(v.x=n[3]),n[4]!==void 0&&(v.y=n[4]),e=new une({props:v}),R.push(()=>xe(e,"expanded",u)),R.push(()=>xe(e,"tpPane",h)),R.push(()=>xe(e,"width",c)),R.push(()=>xe(e,"x",d)),R.push(()=>xe(e,"y",p)),{c(){fe(e.$$.fragment)},l(m){we(e.$$.fragment,m)},m(m,f){_e(e,m,f),l=!0},p(m,f){const w=f&64?Bo(a,[va(m[6])]):{};f&524288&&(w.$$scope={dirty:f,ctx:m}),!t&&f&1&&(t=!0,w.expanded=m[0],Ee(()=>t=!1)),!i&&f&4&&(i=!0,w.tpPane=m[2],Ee(()=>i=!1)),!s&&f&2&&(s=!0,w.width=m[1],Ee(()=>s=!1)),!r&&f&8&&(r=!0,w.x=m[3],Ee(()=>r=!1)),!o&&f&16&&(o=!0,w.y=m[4],Ee(()=>o=!1)),e.$set(w)},i(m){l||(b(e.$$.fragment,m),l=!0)},o(m){y(e.$$.fragment,m),l=!1},d(m){be(e,m)}}}function yne(n){let e;const t=n[7].default,i=mn(t,n,n[19],null);return{c(){i&&i.c()},l(s){i&&i.l(s)},m(s,r){i&&i.m(s,r),e=!0},p(s,r){i&&i.p&&(!e||r&524288)&&vn(i,t,s,s[19],e?wn(t,s[19],r,null):fn(s[19]),null)},i(s){e||(b(i,s),e=!0)},o(s){y(i,s),e=!1},d(s){i&&i.d(s)}}}function Ene(n){let e,t,i,s;const r=[fne,vne,mne],o=[];function l(a,u){return a[5]===void 0||a[5]==="draggable"?0:a[5]==="inline"?1:a[5]==="fixed"?2:-1}return~(e=l(n))&&(t=o[e]=r[e](n)),{c(){t&&t.c(),i=D()},l(a){t&&t.l(a),i=D()},m(a,u){~e&&o[e].m(a,u),k(a,i,u),s=!0},p(a,[u]){let h=e;e=l(a),e===h?~e&&o[e].p(a,u):(t&&(Bi(),y(o[h],1,1,()=>{o[h]=null}),Ii()),~e?(t=o[e],t?t.p(a,u):(t=o[e]=r[e](a),t.c()),b(t,1),t.m(i.parentNode,i)):t=null)},i(a){s||(b(t),s=!0)},o(a){y(t),s=!1},d(a){a&&P(i),~e&&o[e].d(a)}}}function xne(n,e,t){const i=["expanded","position","width","tpPane","x","y"];let s=bi(e,i),{$$slots:r={},$$scope:o}=e,{expanded:l=void 0}=e,{position:a=void 0}=e,{width:u=void 0}=e,{tpPane:h=void 0}=e,{x:c=void 0}=e,{y:d=void 0}=e;IT(()=>{(e.position==="inline"||e.position==="fixed")&&(t(3,c=e.x),t(4,d=e.y),t(1,u=e.width),t(0,l=e.expanded))});function p(E){l=E,t(0,l)}function v(E){h=E,t(2,h)}function m(E){u=E,t(1,u)}function f(E){c=E,t(3,c)}function w(E){d=E,t(4,d)}function g(E){l=E,t(0,l)}function L(E){h=E,t(2,h)}function ye(E){l=E,t(0,l)}function C(E){h=E,t(2,h)}function qe(E){c=E,t(3,c)}function O(E){d=E,t(4,d)}return n.$$set=E=>{t(20,e=wt(wt({},e),Wl(E))),t(6,s=bi(e,i)),"expanded"in E&&t(0,l=E.expanded),"position"in E&&t(5,a=E.position),"width"in E&&t(1,u=E.width),"tpPane"in E&&t(2,h=E.tpPane),"x"in E&&t(3,c=E.x),"y"in E&&t(4,d=E.y),"$$scope"in E&&t(19,o=E.$$scope)},e=Wl(e),[l,u,h,c,d,a,s,r,p,v,m,f,w,g,L,ye,C,qe,O,o]}class $ne extends Lt{constructor(e){super(),At(this,e,xne,Ene,St,{expanded:0,position:5,width:1,tpPane:2,x:3,y:4})}}function je(n){return n==null}function Dg(n){return n!==null&&typeof n=="object"}function yf(n){return n!==null&&typeof n=="object"}function Vne(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function Do(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((i,s)=>{const r=n[s],o=e[s];return yf(r)&&yf(o)?Object.assign(Object.assign({},i),{[s]:Do(r,o)}):Object.assign(Object.assign({},i),{[s]:s in e?o:r})},{})}function kne(n){return Dg(n)?"target"in n:!1}const Sne={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};let Oo=class Al{static alreadyDisposed(){return new Al({type:"alreadydisposed"})}static notBindable(){return new Al({type:"notbindable"})}static notCompatible(e,t){return new Al({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new Al({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new Al({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=Sne[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}},GE=class $2{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const i=this.read();if(!$2.isBindable(i))throw Oo.notBindable();if(!(e in i))throw Oo.propertyNotFound(e);i[e]=t}},Qt=class{constructor(){this.observers_={}}on(e,t){let i=this.observers_[e];return i||(i=this.observers_[e]=[]),i.push({handler:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter(s=>s.handler!==t)),this}emit(e,t){const i=this.observers_[e];i&&i.forEach(s=>{s.handler(t)})}},Lne=class{constructor(e,t){var i;this.constraint_=t==null?void 0:t.constraint,this.equals_=(i=t==null?void 0:t.equals)!==null&&i!==void 0?i:(s,r)=>s===r,this.emitter=new Qt,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,r=this.rawValue_;this.equals_(r,s)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:i,previousRawValue:r,rawValue:s,sender:this}))}},Ane=class{constructor(e){this.emitter=new Qt,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.value_;s===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:this.value_,sender:this}))}},Mne=class{constructor(e){this.emitter=new Qt,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}};function dt(n,e){const t=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!t&&!i?new Ane(n):new Lne(n,e)}function Tne(n){return[new Mne(n),(e,t)=>{n.setRawValue(e,t)}]}let ve=class V2{constructor(e){this.emitter=new Qt,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((i,s)=>Object.assign(i,{[s]:dt(e[s])}),{})}static fromObject(e){const t=this.createCore(e);return new V2(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}},Dd=class{constructor(e){this.values=ve.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(e,i),t)}},Dne=class{constructor(e){this.values=ve.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");let s=e;return je(i)||(s=Math.max(s,i)),je(t)||(s=Math.min(s,t)),s}},One=class{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,i=Math.round((e-t)/this.step);return t+i*this.step}},Rne=class{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}};const jne={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};let Nne=class{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=jne[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}};const Bne={"+":n=>n,"-":n=>-n,"~":n=>~n};let Ine=class{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=Bne[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}};function Og(n){return(e,t)=>{for(let i=0;i<n.length;i++){const s=n[i](e,t);if(s!=="")return s}return""}}function lh(n,e){var t;const i=n.substr(e).match(/^\s+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Fne(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function ah(n,e){var t;const i=n.substr(e).match(/^[0-9]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Kne(n,e){const t=ah(n,e);if(t!=="")return t;const i=n.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";const s=ah(n,e);return s===""?"":i+s}function Rg(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const i=Kne(n,e);return i===""?"":t+i}function k2(n,e){const t=n.substr(e,1);if(t==="0")return t;const i=Fne(n,e);return e+=i.length,i===""?"":i+ah(n,e)}function Une(n,e){const t=k2(n,e);if(e+=t.length,t==="")return"";const i=n.substr(e,1);if(e+=i.length,i!==".")return"";const s=ah(n,e);return e+=s.length,t+i+s+Rg(n,e)}function Hne(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const i=ah(n,e);return e+=i.length,i===""?"":t+i+Rg(n,e)}function zne(n,e){const t=k2(n,e);return e+=t.length,t===""?"":t+Rg(n,e)}const qne=Og([Une,Hne,zne]);function Gne(n,e){var t;const i=n.substr(e).match(/^[01]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Yne(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const i=Gne(n,e);return i===""?"":t+i}function Xne(n,e){var t;const i=n.substr(e).match(/^[0-7]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Wne(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const i=Xne(n,e);return i===""?"":t+i}function Zne(n,e){var t;const i=n.substr(e).match(/^[0-9a-f]+/i);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Qne(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const i=Zne(n,e);return i===""?"":t+i}const Jne=Og([Yne,Wne,Qne]),eie=Og([Jne,qne]);function tie(n,e){const t=eie(n,e);return e+=t.length,t===""?null:{evaluable:new Rne(t),cursor:e}}function nie(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const i=L2(n,e);if(!i)return null;e=i.cursor,e+=lh(n,e).length;const s=n.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:i.evaluable,cursor:e}}function iie(n,e){var t;return(t=tie(n,e))!==null&&t!==void 0?t:nie(n,e)}function S2(n,e){const t=iie(n,e);if(t)return t;const i=n.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const s=S2(n,e);return s?(e=s.cursor,{cursor:e,evaluable:new Ine(i,s.evaluable)}):null}function sie(n,e,t){t+=lh(e,t).length;const i=n.filter(s=>e.startsWith(s,t))[0];return i?(t+=i.length,t+=lh(e,t).length,{cursor:t,operator:i}):null}function rie(n,e){return(t,i)=>{const s=n(t,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const o=sie(e,t,i);if(!o)break;i=o.cursor;const l=n(t,i);if(!l)return null;i=l.cursor,r=new Nne(o.operator,r,l.evaluable)}return r?{cursor:i,evaluable:r}:null}}const oie=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>rie(n,e),S2);function L2(n,e){return e+=lh(n,e).length,oie(n,e)}function lie(n){const e=L2(n,0);return!e||e.cursor+lh(n,e.cursor).length!==n.length?null:e.evaluable}function Fr(n){var e;const t=lie(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function A2(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=Fr(n);if(!je(e))return e}return 0}function pn(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function oe(n,e,t,i,s){const r=(n-e)/(t-e);return i+r*(s-i)}function YE(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function it(n,e,t){return Math.min(Math.max(n,e),t)}function M2(n,e){return(n%e+e)%e}function aie(n,e){return je(n.step)?Math.max(YE(e),2):YE(n.step)}function T2(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function uie(n,e){var t;const i=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function D2(n,e){return je(n.step)?null:new One(n.step,e)}function O2(n){return!je(n.max)&&!je(n.min)?new Dd({max:n.max,min:n.min}):!je(n.max)||!je(n.min)?new Dne({max:n.max,min:n.min}):null}function R2(n,e){var t,i,s;return{formatter:(t=n.format)!==null&&t!==void 0?t:pn(aie(n,e)),keyScale:(i=n.keyScale)!==null&&i!==void 0?i:T2(n),pointerScale:(s=n.pointerScale)!==null&&s!==void 0?s:uie(n,e)}}function j2(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function jg(n){return{constraint:n.constraint,textProps:ve.fromObject(R2(n.params,n.initialValue))}}let Od=class{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}},Rd=class{constructor(e){this.target=e}},N2=class extends Rd{constructor(e,t,i){super(e),this.value=t,this.last=i??!0}},hie=class extends Rd{constructor(e,t){super(e),this.expanded=t}},cie=class extends Rd{constructor(e,t){super(e),this.index=t}},Ng=class extends Od{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Qt,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new N2(this,t.binding.target.read(),e.options.last))}};function pie(n,e){const i=Object.keys(e).reduce((s,r)=>{if(s===void 0)return;const o=e[r],l=o(n[r]);return l.succeeded?Object.assign(Object.assign({},s),{[r]:l.value}):void 0},{});return i}function die(n,e){return n.reduce((t,i)=>{if(t===void 0)return;const s=e(i);if(!(!s.succeeded||s.value===void 0))return[...t,s.value]},[])}function mie(n){return n===null?!1:typeof n=="object"}function us(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const i=n(t);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function XE(n){return{custom:e=>us(e)(n),boolean:us(e=>typeof e=="boolean"?e:void 0)(n),number:us(e=>typeof e=="number"?e:void 0)(n),string:us(e=>typeof e=="string"?e:void 0)(n),function:us(e=>typeof e=="function"?e:void 0)(n),constant:e=>us(t=>t===e?e:void 0)(n),raw:us(e=>e)(n),object:e=>us(t=>{if(mie(t))return pie(t,e)})(n),array:e=>us(t=>{if(Array.isArray(t))return die(t,e)})(n)}}const Ef={optional:XE(!0),required:XE(!1)};function yt(n,e){const t=e(Ef),i=Ef.required.object(t)(n);return i.succeeded?i.value:void 0}function Zi(n,e,t,i){if(e&&!e(n))return!1;const s=yt(n,t);return s?i(s):!1}function Qi(n,e){var t;return Do((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function Hc(n){return"value"in n}function vie(n){if(!Dg(n)||!("binding"in n))return!1;const e=n.binding;return kne(e)}const fi="http://www.w3.org/2000/svg";function Cp(n){n.offsetHeight}function fie(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function Bg(n){return n.ontouchstart!==void 0}function wie(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const _ie={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function jd(n,e){const t=n.createElementNS(fi,"svg");return t.innerHTML=_ie[e],t}function B2(n,e,t){n.insertBefore(e,n.children[t])}function Ig(n){n.parentElement&&n.parentElement.removeChild(n)}function I2(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function bie(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function F2(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function $s(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function Oi(n,e,t){$s(n.value(e),t)}const gie="tp";function G(n){return(t,i)=>[gie,"-",n,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}const _u=G("lbl");function Cie(n,e){const t=n.createDocumentFragment();return e.split(`
`).map(s=>n.createTextNode(s)).forEach((s,r)=>{r>0&&t.appendChild(n.createElement("br")),t.appendChild(s)}),t}let Pie=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(_u()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(_u("l")),Oi(t.props,"label",r=>{je(r)?this.element.classList.add(_u(void 0,"nol")):(this.element.classList.remove(_u(void 0,"nol")),bie(i),i.appendChild(Cie(e,r)))}),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("div");s.classList.add(_u("v")),this.element.appendChild(s),this.valueElement=s}},K2=class{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new Pie(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return Zi(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return Qi(null,{label:this.props.get("label")})}};function yie(){return["veryfirst","first","last","verylast"]}const WE=G(""),ZE={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};let Fg=class{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{yie().forEach(i=>{t.classList.remove(WE(void 0,ZE[i]))}),this.blade.get("positions").forEach(i=>{t.classList.add(WE(void 0,ZE[i]))})}),this.viewProps.handleDispose(()=>{Ig(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return Zi(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return Qi(null,Object.assign({},this.viewProps.exportState()))}},Eie=class extends Od{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const i=t.bind(this);return this.controller.buttonController.emitter.on(e,()=>{i(new Rd(this))}),this}};function xie(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function Ra(n,e){return t=>{xie(n,e,t)}}function Kg(n,e){$s(n,t=>{e.textContent=t??""})}const cv=G("btn");let $ie=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(cv()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(cv("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(cv("t")),Kg(t.props.value("title"),s),this.buttonElement.appendChild(s)}},Vie=class{constructor(e,t){this.emitter=new Qt,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new $ie(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return Zi(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return Qi(null,{title:this.props.get("title")})}onClick_(){this.emitter.emit("click",{sender:this})}},QE=class extends Fg{constructor(e,t){const i=new Vie(e,{props:t.buttonProps,viewProps:t.viewProps}),s=new K2(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:t.viewProps}),this.buttonController=i,this.labelController=s}importState(e){return Zi(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return Qi(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}},kie=class{constructor(e){const[t,i]=e.split("-"),s=t.split(".");this.major=parseInt(s[0],10),this.minor=parseInt(s[1],10),this.patch=parseInt(s[2],10),this.prerelease=i??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}};const Sie=new kie("2.0.1");function Rt(n){return Object.assign({core:Sie},n)}Rt({id:"button",type:"blade",accept(n){const e=yt(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new QE(n.document,{blade:n.blade,buttonProps:ve.fromObject({title:n.params.title}),labelProps:ve.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof QE?new Eie(n.controller):null}});function Lie(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function Aie(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function Mie(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function Tie(n){return Dg(n)?"refresh"in n&&typeof n.refresh=="function":!1}function Die(n,e){if(!GE.isBindable(n))throw Oo.notBindable();return new GE(n,e)}let Oie=class{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new Qt,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,i){const s=i??{},r=this.controller_.element.ownerDocument,o=this.pool_.createBinding(r,Die(e,t),s),l=this.pool_.createBindingApi(o);return this.add(l,s.index)}addFolder(e){return Aie(this,e)}addButton(e){return Lie(this,e)}addTab(e){return Mie(this,e)}add(e,t){const i=e.controller;return this.controller_.rack.add(i,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,i=this.pool_.createBlade(t,e),s=this.pool_.createApi(i);return this.add(s,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.children.forEach(e=>{Tie(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,i=this.pool_.createApi(t),s=vie(t.value)?t.value.binding:null;this.emitter_.emit("change",new N2(i,s?s.target.read():t.value.rawValue,e.options.last))}},Ug=class extends Od{constructor(e,t){super(e),this.rackApi_=new Oie(e.rackController,t)}refresh(){this.rackApi_.refresh()}},Hg=class extends Fg{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return Zi(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((i,s)=>i.importState(t.children[s])))}exportState(){return Qi(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}};function xf(n){return"rackController"in n}let Rie=class{constructor(e){this.emitter=new Qt,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw Oo.shouldNeverHappen();const i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(r=>{this.cache_.add(r)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.allItems().forEach(s=>{this.cache_.delete(s)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}};function jie(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(Hc(i)&&i.value===e)return i}return null}function Nie(n){return xf(n)?n.rackController.rack.bcSet_:null}let Bie=class{constructor(e){var t,i;this.emitter=new Qt,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new Rie(Nie),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var i;(i=e.parent)===null||i===void 0||i.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),Hc(i))i.value.emitter.on("change",this.onChildValueChange_);else if(xf(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.on("layout",this.onRackLayout_),r.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const i=e.item;if(Hc(i))i.value.emitter.off("change",this.onChildValueChange_);else if(xf(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.off("layout",this.onRackLayout_),r.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(s=>!s.viewProps.get("hidden")),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach(s=>{const r=[];s===t&&(r.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&r.push("veryfirst")),s===i&&(r.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&r.push("verylast")),s.blade.set("positions",r)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=jie(this.find(Hc),e.sender);if(!t)throw Oo.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}},zg=class{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new Bie({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let i=this.rack.children.length-1;i>=0;i--)this.rack.children[i].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&B2(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&Ig(e.bladeController.view.element)}};function U2(){return new ve({positions:dt([],{equals:Vne})})}let qg=class H2 extends ve{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=ve.createCore(t);return new H2(i)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!je(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const i=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};Oi(this,"expanded",i),Oi(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}};function Iie(n,e){let t=0;return fie(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),Cp(e),t=e.clientHeight,n.set("temporaryExpanded",null),Cp(e)}),t}function JE(n,e){e.style.height=n.styleHeight}function Gg(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),je(n.get("expandedHeight"))){const t=Iie(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),Cp(e)}),n.emitter.on("change",()=>{JE(n,e)}),JE(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}let Fie=class extends Ug{constructor(e,t){super(e,t),this.emitter_=new Qt,this.controller.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",new hie(this,i.sender.rawValue))}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}};const z2=G("cnt");let Kie=class{constructor(e,t){var i;this.className_=G((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),z2()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),Oi(this.foldable_,"completed",Ra(this.element,this.className_(void 0,"cpl")));const s=e.createElement("button");s.classList.add(this.className_("b")),Oi(t.props,"title",u=>{je(u)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const r=e.createElement("div");r.classList.add(this.className_("i")),this.element.appendChild(r);const o=e.createElement("div");o.classList.add(this.className_("t")),Kg(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}},ex=class extends Hg{constructor(e,t){var i;const s=qg.create((i=t.expanded)!==null&&i!==void 0?i:!0),r=new Kie(e,{foldable:s,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new zg({blade:t.blade,element:r.containerElement,root:t.root,viewProps:t.viewProps}),view:r})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=s,Gg(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return Zi(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return Qi(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}};Rt({id:"folder",type:"blade",accept(n){const e=yt(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new ex(n.document,{blade:n.blade,expanded:n.params.expanded,props:ve.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof ex?new Fie(n.controller,n.pool):null}});const Uie=G("");function tx(n,e){return Ra(n,Uie(void 0,e))}let Yg=class q2 extends ve{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=Tne(dt(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,i,s;const r=e??{};return new q2(ve.createCore({disabled:(t=r.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(i=r.hidden)!==null&&i!==void 0?i:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){$s(this.globalDisabled_,tx(e,"disabled")),Oi(this,"hidden",tx(e,"hidden"))}bindDisabled(e){$s(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){$s(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const i=e.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}};const nx=G("tbp");let Hie=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(nx()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(nx("c")),this.element.appendChild(i),this.containerElement=i}};const bu=G("tbi");let zie=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(bu()),t.viewProps.bindClassModifiers(this.element),Oi(t.props,"selected",r=>{r?this.element.classList.add(bu(void 0,"sel")):this.element.classList.remove(bu(void 0,"sel"))});const i=e.createElement("button");i.classList.add(bu("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(bu("t")),Kg(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}},qie=class{constructor(e,t){this.emitter=new Qt,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new zie(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}},$f=class extends Hg{constructor(e,t){const i=new Hie(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new zg({blade:t.blade,element:i.containerElement,viewProps:t.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new qie(e,{props:t.itemProps,viewProps:Yg.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,Oi(this.props,"selected",s=>{this.itemController.props.set("selected",s),this.viewProps.set("hidden",!s)})}get itemController(){return this.ic_}importState(e){return Zi(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return Qi(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}},Gie=class extends Ug{constructor(e,t){super(e,t),this.emitter_=new Qt,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,i=new $f(t,{blade:U2(),itemProps:ve.fromObject({selected:!1,title:e.title}),props:ve.fromObject({selected:!1}),viewProps:Yg.create()}),s=this.pool_.createApi(i);return this.rackApi_.add(s,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}onSelect_(e){this.emitter_.emit("select",new cie(this,e.rawValue))}},Yie=class extends Ug{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}};const ix=-1;let Xie=class{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=dt(!0),this.selectedIndex=dt(ix),this.items_=[]}add(e,t){const i=t??this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=ix,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,i)=>{t.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,i)=>{t.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(i=>i===e.sender);this.items_.forEach((i,s)=>{i.rawValue=s===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}};const gu=G("tab");let Wie=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(gu(),z2()),t.viewProps.bindClassModifiers(this.element),$s(t.empty,Ra(this.element,gu(void 0,"nop")));const i=e.createElement("div");i.classList.add(gu("t")),this.element.appendChild(i),this.itemsElement=i;const s=e.createElement("div");s.classList.add(gu("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(gu("c")),this.element.appendChild(r),this.contentsElement=r}},sx=class extends Hg{constructor(e,t){const i=new Xie,s=new Wie(e,{empty:i.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new zg({blade:t.blade,element:s.contentsElement,viewProps:t.viewProps}),view:s}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=this.rackController.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.tab=i}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;B2(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;Ig(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}};Rt({id:"tab",type:"blade",accept(n){const e=yt(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new sx(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const i=new $f(n.document,{blade:U2(),itemProps:ve.fromObject({selected:!1,title:t.title}),props:ve.fromObject({selected:!1}),viewProps:Yg.create()});e.add(i)}),e},api(n){return n.controller instanceof sx?new Gie(n.controller,n.pool):n.controller instanceof $f?new Yie(n.controller,n.pool):null}});let Xg=class extends Ng{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}};class Zie{constructor(){this.disabled=!1,this.emitter=new Qt}dispose(){}tick(){this.disabled||this.emitter.emit("tick",{sender:this})}}class Qie{constructor(e,t){this.disabled_=!1,this.timerId_=null,this.onTick_=this.onTick_.bind(this),this.doc_=e,this.emitter=new Qt,this.interval_=t,this.setTimer_()}get disabled(){return this.disabled_}set disabled(e){this.disabled_=e,this.disabled_?this.clearTimer_():this.setTimer_()}dispose(){this.clearTimer_()}clearTimer_(){if(this.timerId_===null)return;const e=this.doc_.defaultView;e&&e.clearInterval(this.timerId_),this.timerId_=null}setTimer_(){if(this.clearTimer_(),this.interval_<=0)return;const e=this.doc_.defaultView;e&&(this.timerId_=e.setInterval(this.onTick_,this.interval_))}onTick_(){this.disabled_||this.emitter.emit("tick",{sender:this})}}let Gh=class{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,i)=>i.constrain(t),e)}};function Pp(n,e){if(n instanceof e)return n;if(n instanceof Gh){const t=n.constraints.reduce((i,s)=>i||(s instanceof e?s:null),null);if(t)return t}return null}let Nd=class{constructor(e){this.values=ve.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(s=>s.value===e).length>0?e:t[0].value}};function Bd(n){var e;const t=Ef;if(Array.isArray(n))return(e=yt({items:n},i=>({items:i.required.array(i.required.object({text:i.required.string,value:i.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function G2(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function Wg(n){return je(n)?null:new Nd(G2(n))}const pv=G("lst");let Jie=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(pv()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(pv("s")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const s=e.createElement("div");s.classList.add(pv("m")),s.appendChild(jd(e,"dropdown")),this.element.appendChild(s),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,Oi(this.props_,"options",r=>{I2(this.selectElement),r.forEach(o=>{const l=e.createElement("option");l.textContent=o.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}},ca=class{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Jie(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return Zi(e,null,t=>({options:t.required.custom(Bd)}),t=>(this.props.set("options",G2(t.options)),!0))}exportProps(){return Qi(null,{options:this.props.get("options")})}};const rx=G("pop");let ese=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(rx()),t.viewProps.bindClassModifiers(this.element),$s(t.shows,Ra(this.element,rx(void 0,"v")))}},Y2=class{constructor(e,t){this.shows=dt(!1),this.viewProps=t.viewProps,this.view=new ese(e,{shows:this.shows,viewProps:this.viewProps})}};const ox=G("txt");let tse=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(ox()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(ox("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}},Zg=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new tse(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);je(s)||(this.value.rawValue=s),this.view.refresh()}};function nse(n){return String(n)}function X2(n){return n==="false"?!1:!!n}function lx(n){return nse(n)}function ise(n){return e=>n.reduce((t,i)=>t!==null?t:i(e),null)}const sse=pn(0);function yp(n){return sse(n)+"%"}function W2(n){return String(n)}function Vf(n){return n}function ja({primary:n,secondary:e,forward:t,backward:i}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}n.emitter.on("change",o=>{r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),e.emitter.on("change",o=>{r(()=>{n.setRawValue(i(n.rawValue,e.rawValue),o.options)}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function on(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function uh(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function Rs(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function rse(n){return n==="ArrowUp"||n==="ArrowDown"}function Z2(n){return rse(n)||n==="ArrowLeft"||n==="ArrowRight"}function dv(n,e){var t,i;const s=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:n.pageX-(((t=s&&s.scrollX)!==null&&t!==void 0?t:0)+r.left),y:n.pageY-(((i=s&&s.scrollY)!==null&&i!==void 0?i:0)+r.top)}}let Qo=class{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new Qt,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(dv(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(dv(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(dv(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-s.left,y:i.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}};const Nn=G("txt");let ose=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Nn(),Nn(void 0,"num")),t.arrayPosition&&this.element.classList.add(Nn(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(Nn("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Nn()),this.inputElement.classList.add(Nn("i"));const s=e.createElement("div");s.classList.add(Nn("k")),this.element.appendChild(s),this.knobElement=s;const r=e.createElementNS(fi,"svg");r.classList.add(Nn("g")),this.knobElement.appendChild(r);const o=e.createElementNS(fi,"path");o.classList.add(Nn("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=e.createElementNS(fi,"path");l.classList.add(Nn("gh")),r.appendChild(l),this.guideHeadElem_=l;const a=e.createElement("div");a.classList.add(G("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(Nn(void 0,"drg"));return}this.element.classList.add(Nn(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),i=t+(t>0?-1:t<0?1:0),s=it(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+s},0 L${i},4 L${i+s},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}},Yh=class{constructor(e,t){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(i=t.sliderProps)!==null&&i!==void 0?i:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=dt(null),this.view=new ose(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new Qo(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,i;const s=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),r=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("max");let o=e;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);je(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const t=on(this.props.get("keyScale"),uh(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){on(this.props.get("keyScale"),uh(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}};const mv=G("sld");let lse=class{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(mv()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(mv("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const s=e.createElement("div");s.classList.add(mv("k")),this.trackElement.appendChild(s),this.knobElement=s,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=it(oe(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}},ase=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new lse(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Qo(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(oe(it(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=on(this.props.get("keyScale"),Rs(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){on(this.props.get("keyScale"),Rs(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const vv=G("sldtxt");let use=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(vv());const i=e.createElement("div");i.classList.add(vv("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(vv("t")),this.textView_=t.textView,s.appendChild(this.textView_.element),this.element.appendChild(s)}},ax=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new ase(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new Yh(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new use(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return Zi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const i=this.sliderC_.props;return i.set("max",t.max),i.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return Qi(null,{max:e.get("max"),min:e.get("min")})}};function hse(n){return{sliderProps:new ve({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new ve({formatter:dt(n.formatter),keyScale:n.keyScale,pointerScale:dt(n.pointerScale)})}}const cse={containerUnitSize:"cnt-usz"};function Q2(n){return`--${cse[n]}`}function hh(n){return j2(n)}function Pr(n){if(yf(n))return yt(n,hh)}function _s(n,e){if(!n)return;const t=[],i=D2(n,e);i&&t.push(i);const s=O2(n);return s&&t.push(s),new Gh(t)}function J2(n){if(n==="inline"||n==="popup")return n}function Xh(n,e){n.write(e)}const gc=G("ckb");let pse=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(gc()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(gc("l")),this.element.appendChild(i);const s=e.createElement("input");s.classList.add(gc("i")),s.type="checkbox",i.appendChild(s),this.inputElement=s,t.viewProps.bindDisabled(this.inputElement);const r=e.createElement("div");r.classList.add(gc("w")),i.appendChild(r);const o=jd(e,"check");r.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}},dse=class{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new pse(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked}};function mse(n){const e=[],t=Wg(n.options);return t&&e.push(t),new Gh(e)}Rt({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=yt(e,i=>({options:i.optional.custom(Bd),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>X2,constraint:n=>mse(n.params),writer:n=>Xh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&Pp(i,Nd);return s?new ca(e,{props:new ve({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new dse(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof ca?new Xg(n.controller):null}});const ro=G("col");let vse=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(ro()),t.foldable.bindExpandedClass(this.element,ro(void 0,"expanded")),Oi(t.foldable,"completed",Ra(this.element,ro(void 0,"cpl")));const i=e.createElement("div");i.classList.add(ro("h")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(ro("s")),i.appendChild(s),this.swatchElement=s;const r=e.createElement("div");if(r.classList.add(ro("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(ro("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};function fse(n,e,t){const i=it(n/255,0,1),s=it(e/255,0,1),r=it(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u=0,h=0;const c=(l+o)/2;return a!==0&&(h=a/(1-Math.abs(o+l-1)),i===o?u=(s-r)/a:s===o?u=2+(r-i)/a:u=4+(i-s)/a,u=u/6+(u<0?1:0)),[u*360,h*100,c*100]}function wse(n,e,t){const i=(n%360+360)%360,s=it(e/100,0,1),r=it(t/100,0,1),o=(1-Math.abs(2*r-1))*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o/2;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function _se(n,e,t){const i=it(n/255,0,1),s=it(e/255,0,1),r=it(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u;a===0?u=0:o===i?u=60*(((s-r)/a%6+6)%6):o===s?u=60*((r-i)/a+2):u=60*((i-s)/a+4);const h=o===0?0:a/o,c=o;return[u,h*100,c*100]}function eM(n,e,t){const i=M2(n,360),s=it(e/100,0,1),r=it(t/100,0,1),o=r*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function bse(n,e,t){const i=t+e*(100-Math.abs(2*t-100))/200;return[n,i!==0?e*(100-Math.abs(2*t-100))/i:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function gse(n,e,t){const i=100-Math.abs(t*(200-e)/100-100);return[n,i!==0?e*t/i:0,t*(200-e)/(2*100)]}function Ri(n){return[n[0],n[1],n[2]]}function Id(n,e){return[n[0],n[1],n[2],e]}const Cse={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:bse,rgb:wse},hsv:{hsl:gse,hsv:(n,e,t)=>[n,e,t],rgb:eM},rgb:{hsl:fse,hsv:_se,rgb:(n,e,t)=>[n,e,t]}};function pa(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function Pse(n,e){return n===e?e:M2(n,e)}function tM(n,e,t){var i;const s=pa(e,t);return[e==="rgb"?it(n[0],0,s[0]):Pse(n[0],s[0]),it(n[1],0,s[1]),it(n[2],0,s[2]),it((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function ux(n,e,t,i){const s=pa(e,t),r=pa(e,i);return n.map((o,l)=>o/s[l]*r[l])}function nM(n,e,t){const i=ux(n,e.mode,e.type,"int"),s=Cse[e.mode][t.mode](...i);return ux(s,t.mode,"int",t.type)}let me=class iM{static black(){return new iM([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=tM(e,t,this.type)}getComponents(e){return Id(nM(Ri(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const ur=G("colp");let yse=class{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(ur()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(ur("hsv"));const s=e.createElement("div");s.classList.add(ur("sv")),this.svPaletteView_=t.svPaletteView,s.appendChild(this.svPaletteView_.element),i.appendChild(s);const r=e.createElement("div");r.classList.add(ur("h")),this.hPaletteView_=t.hPaletteView,r.appendChild(this.hPaletteView_.element),i.appendChild(r),this.element.appendChild(i);const o=e.createElement("div");if(o.classList.add(ur("rgb")),this.textsView_=t.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const l=e.createElement("div");l.classList.add(ur("a"));const a=e.createElement("div");a.classList.add(ur("ap")),a.appendChild(this.alphaViews_.palette.element),l.appendChild(a);const u=e.createElement("div");u.classList.add(ur("at")),u.appendChild(this.alphaViews_.text.element),l.appendChild(u),this.element.appendChild(l)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}};function Ese(n){return n==="int"?"int":n==="float"?"float":void 0}function Qg(n){return yt(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(Ese)}),expanded:e.optional.boolean,picker:e.optional.custom(J2),readonly:e.optional.constant(!1)}))}function Ro(n){return n?.1:1}function sM(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}let Jg=class{constructor(e,t){this.type="float",this.mode=t,this.comps_=tM(e,t,this.type)}getComponents(e){return Id(nM(Ri(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}};const xse={int:(n,e)=>new me(n,e),float:(n,e)=>new Jg(n,e)};function eC(n,e,t){return xse[t](n,e)}function $se(n){return n.type==="float"}function Vse(n){return n.type==="int"}function kse(n){const e=n.getComponents(),t=pa(n.mode,"int");return new me([Math.round(oe(e[0],0,1,0,t[0])),Math.round(oe(e[1],0,1,0,t[1])),Math.round(oe(e[2],0,1,0,t[2])),e[3]],n.mode)}function Sse(n){const e=n.getComponents(),t=pa(n.mode,"int");return new Jg([oe(e[0],0,t[0],0,1),oe(e[1],0,t[1],0,1),oe(e[2],0,t[2],0,1),e[3]],n.mode)}function Gt(n,e){if(n.type===e)return n;if(Vse(n)&&e==="float")return Sse(n);if($se(n)&&e==="int")return kse(n);throw Oo.shouldNeverHappen()}function Lse(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function Xn(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const Ase={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function rM(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),i=e[2];return Ase[i](t)}function oM(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Xn(e[1],255),Xn(e[2],255),Xn(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function Mse(n){const e=oM(n);return e?new me(e,"rgb"):null}function lM(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Xn(e[1],255),Xn(e[2],255),Xn(e[3],255),Xn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function Tse(n){const e=lM(n);return e?new me(e,"rgb"):null}function aM(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[rM(e[1]),Xn(e[2],100),Xn(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function Dse(n){const e=aM(n);return e?new me(e,"hsl"):null}function uM(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[rM(e[1]),Xn(e[2],100),Xn(e[3],100),Xn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function Ose(n){const e=uM(n);return e?new me(e,"hsl"):null}function hM(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function Rse(n){const e=hM(n);return e?new me(e,"rgb"):null}function cM(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),oe(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),oe(parseInt(t[4],16),0,255,0,1)]:null}function jse(n){const e=cM(n);return e?new me(e,"rgb"):null}function pM(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function Nse(n){return e=>{const t=pM(e);return t?eC(t,"rgb",n):null}}function dM(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function Bse(n){return e=>{const t=dM(e);return t?eC(t,"rgb",n):null}}const Ise=[{parser:hM,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:cM,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:oM,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:lM,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:aM,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:uM,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:pM,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:dM,result:{alpha:!0,mode:"rgb",notation:"object"}}];function Fse(n){return Ise.reduce((e,{parser:t,result:i})=>e||(t(n)?i:null),null)}function Kse(n,e="int"){const t=Fse(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function Wh(n){const e=[Rse,jse,Mse,Tse,Dse,Ose];e.push(Nse("int"),Bse("int"));const t=ise(e);return i=>{const s=t(i);return s?Gt(s,n):null}}function Use(n){const e=Wh("int");if(typeof n!="string")return me.black();const t=e(n);return t??me.black()}function mM(n){const e=it(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function tC(n,e="#"){const t=Ri(n.getComponents("rgb")).map(mM).join("");return`${e}${t}`}function nC(n,e="#"){const t=n.getComponents("rgb"),i=[t[0],t[1],t[2],t[3]*255].map(mM).join("");return`${e}${i}`}function vM(n){const e=pn(0),t=Gt(n,"int");return`rgb(${Ri(t.getComponents("rgb")).map(s=>e(s)).join(", ")})`}function zc(n){const e=pn(2),t=pn(0);return`rgba(${Gt(n,"int").getComponents("rgb").map((r,o)=>(o===3?e:t)(r)).join(", ")})`}function Hse(n){const e=[pn(0),yp,yp],t=Gt(n,"int");return`hsl(${Ri(t.getComponents("hsl")).map((s,r)=>e[r](s)).join(", ")})`}function zse(n){const e=[pn(0),yp,yp,pn(2)];return`hsla(${Gt(n,"int").getComponents("hsl").map((s,r)=>e[r](s)).join(", ")})`}function fM(n,e){const t=pn(e==="float"?2:0),i=["r","g","b"],s=Gt(n,e);return`{${Ri(s.getComponents("rgb")).map((o,l)=>`${i[l]}: ${t(o)}`).join(", ")}}`}function qse(n){return e=>fM(e,n)}function wM(n,e){const t=pn(2),i=pn(e==="float"?2:0),s=["r","g","b","a"];return`{${Gt(n,e).getComponents("rgb").map((l,a)=>{const u=a===3?t:i;return`${s[a]}: ${u(l)}`}).join(", ")}}`}function Gse(n){return e=>wM(e,n)}const Yse=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:tC},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:nC},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:vM},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:zc},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:Hse},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:zse},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:qse(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:Gse(e)}],[])];function _M(n){return Yse.reduce((e,t)=>e||(Lse(t.format,n)?t.stringifier:null),null)}const Cu=G("apl");let Xse=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Cu()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Cu("b")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Cu("c")),i.appendChild(s),this.colorElem_=s;const r=e.createElement("div");r.classList.add(Cu("m")),this.element.appendChild(r),this.markerElem_=r;const o=e.createElement("div");o.classList.add(Cu("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new me([t[0],t[1],t[2],0],"rgb"),s=new me([t[0],t[1],t[2],255],"rgb"),r=["to right",zc(i),zc(s)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=zc(e);const o=oe(t[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}},Wse=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Xse(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Qo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,s=this.value.rawValue,[r,o,l]=s.getComponents("hsv");this.value.setRawValue(new me([r,o,l,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=on(Ro(!0),Rs(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new me([s,r,o,l+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){on(Ro(!0),Rs(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const bl=G("coltxt");function Zse(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((i,s)=>{const r=n.createElement("option");return r.textContent=s.text,r.value=s.value,i.appendChild(r),i},n.createDocumentFragment())),e}let Qse=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(bl()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(bl("m")),this.modeElem_=Zse(e),this.modeElem_.classList.add(bl("ms")),i.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const s=e.createElement("div");s.classList.add(bl("mm")),s.appendChild(jd(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(bl("w")),this.element.appendChild(r),this.inputsElem_=r,this.inputViews_=t.inputViews,this.applyInputViews_(),$s(t.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){I2(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const i=e.createElement("div");i.classList.add(bl("c")),i.appendChild(t.element),this.inputsElem_.appendChild(i)})}};function Jse(n){return pn(n==="float"?2:0)}function ere(n,e,t){const i=pa(n,e)[t];return new Dd({min:0,max:i})}function tre(n,e,t){return new Yh(n,{arrayPosition:t===0?"fst":t===2?"lst":"mid",parser:e.parser,props:ve.fromObject({formatter:Jse(e.colorType),keyScale:Ro(!1),pointerScale:e.colorType==="float"?.01:1}),value:dt(0,{constraint:ere(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function nre(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:Fr,viewProps:e.viewProps};return[0,1,2].map(i=>{const s=tre(n,t,i);return ja({primary:e.value,secondary:s.value,forward(r){return Gt(r,e.colorType).getComponents(e.colorMode)[i]},backward(r,o){const l=e.colorMode,u=Gt(r,e.colorType).getComponents(l);u[i]=o;const h=eC(Id(Ri(u),u[3]),l,e.colorType);return Gt(h,"int")}}),s})}function ire(n,e){const t=new Zg(n,{parser:Wh("int"),props:ve.fromObject({formatter:tC}),value:dt(me.black()),viewProps:e.viewProps});return ja({primary:e.value,secondary:t.value,forward:i=>new me(Ri(i.getComponents()),i.mode),backward:(i,s)=>new me(Id(Ri(s.getComponents(i.mode)),i.getComponents()[3]),i.mode)}),[t]}function sre(n){return n!=="hex"}let rre=class{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=dt(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new Qse(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return sre(t)?nre(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):ire(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(i=>i.view)}};const fv=G("hpl");let ore=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(fv()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(fv("c")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(fv("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=vM(new me([t,100,100],"hsv"));const i=oe(t,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}},lre=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new ore(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Qo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=oe(it(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),s=this.value.rawValue,[,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new me([i,r,o,l],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=on(Ro(!1),Rs(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new me([s+t,r,o,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){on(Ro(!1),Rs(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}};const wv=G("svp"),hx=64;let are=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(wv()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=hx,i.width=hx,i.classList.add(wv("c")),this.element.appendChild(i),this.canvasElement=i;const s=e.createElement("div");s.classList.add(wv("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=wie(this.canvasElement);if(!e)return;const i=this.value.rawValue.getComponents("hsv"),s=this.canvasElement.width,r=this.canvasElement.height,o=e.getImageData(0,0,s,r),l=o.data;for(let h=0;h<r;h++)for(let c=0;c<s;c++){const d=oe(c,0,s,0,100),p=oe(h,0,r,100,0),v=eM(i[0],d,p),m=(h*s+c)*4;l[m]=v[0],l[m+1]=v[1],l[m+2]=v[2],l[m+3]=255}e.putImageData(o,0,0);const a=oe(i[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const u=oe(i[2],0,100,100,0);this.markerElem_.style.top=`${u}%`}onValueChange_(){this.update_()}},ure=class{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new are(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Qo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=oe(e.point.x,0,e.bounds.width,0,100),s=oe(e.point.y,0,e.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new me([r,i,s,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){Z2(e.key)&&e.preventDefault();const[t,i,s,r]=this.value.rawValue.getComponents("hsv"),o=Ro(!1),l=on(o,Rs(e)),a=on(o,uh(e));l===0&&a===0||this.value.setRawValue(new me([t,i+l,s+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=Ro(!1),i=on(t,Rs(e)),s=on(t,uh(e));i===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},hre=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new lre(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new ure(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new Wse(e,{value:this.value,viewProps:this.viewProps}),text:new Yh(e,{parser:Fr,props:ve.fromObject({pointerScale:.01,keyScale:.1,formatter:pn(2)}),value:dt(0,{constraint:new Dd({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&ja({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.getComponents()[3],backward:(i,s)=>{const r=i.getComponents();return r[3]=s,new me(r,i.mode)}}),this.textsC_=new rre(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new yse(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}};const _v=G("colsw");let cre=class{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add(_v()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(_v("sw")),this.element.appendChild(i),this.swatchElem_=i;const s=e.createElement("button");s.classList.add(_v("b")),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=nC(e)}onValueChange_(){this.update_()}},pre=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new cre(e,{value:this.value,viewProps:this.viewProps})}},iC=class{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=qg.create(t.expanded),this.swatchC_=new pre(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new Zg(e,{parser:t.parser,props:ve.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new vse(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new Y2(e,{viewProps:this.viewProps}):null;const s=new hre(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),ja({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Gg(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=F2(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!Bg(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}};function dre(n){return Ri(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function mre(n){return n.getComponents("rgb").reduce((e,t,i)=>{const s=Math.floor(i===3?t*255:t)&255;return e<<8|s},0)>>>0}function vre(n){return new me([n>>16&255,n>>8&255,n&255],"rgb")}function fre(n){return new me([n>>24&255,n>>16&255,n>>8&255,oe(n&255,0,255,0,1)],"rgb")}function wre(n){return typeof n!="number"?me.black():vre(n)}function _re(n){return typeof n!="number"?me.black():fre(n)}function qc(n,e){return typeof n!="object"||je(n)?!1:e in n&&typeof n[e]=="number"}function bM(n){return qc(n,"r")&&qc(n,"g")&&qc(n,"b")}function gM(n){return bM(n)&&qc(n,"a")}function CM(n){return bM(n)}function sC(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),i=e.getComponents();for(let s=0;s<t.length;s++)if(t[s]!==i[s])return!1;return!0}function cx(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function bre(n){const e=_M(n);return e?(t,i)=>{Xh(t,e(i))}:null}function gre(n){const e=n?mre:dre;return(t,i)=>{Xh(t,e(i))}}function Cre(n,e,t){const s=Gt(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b),n.writeProperty("a",s.a)}function Pre(n,e,t){const s=Gt(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b)}function yre(n,e){return(t,i)=>{n?Cre(t,i,e):Pre(t,i,e)}}function Ere(n){var e;return!!(!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function xre(n){return n?e=>nC(e,"0x"):e=>tC(e,"0x")}function $re(n){return"color"in n||n.view==="color"}Rt({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!$re(e))return null;const t=Qg(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:Ere(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?_re:wre,equals:sC,writer:n=>gre(n.params.supportsAlpha)},controller:n=>{var e,t;return new iC(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:xre(n.params.supportsAlpha),parser:Wh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function Vre(n,e){if(!CM(n))return Gt(me.black(),e);if(e==="int"){const t=cx(n);return new me(t,"rgb")}if(e==="float"){const t=cx(n);return new Jg(t,"rgb")}return Gt(me.black(),"int")}function kre(n){return gM(n)}function Sre(n){return e=>{const t=Vre(e,n);return Gt(t,"int")}}function Lre(n,e){return t=>n?wM(t,e):fM(t,e)}Rt({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!CM(n))return null;const i=Qg(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{colorType:(t=sM(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>Sre(n.params.colorType),equals:sC,writer:n=>yre(kre(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const i=gM(n.initialValue);return new iC(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:Lre(i,n.params.colorType),parser:Wh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:i,value:n.value,viewProps:n.viewProps})}});Rt({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=Kse(n,sM(e));if(!t)return null;const i=_M(t);if(!i)return null;const s=Qg(e);return s?{initialValue:n,params:Object.assign(Object.assign({},s),{format:t,stringifier:i})}:null},binding:{reader:()=>Use,equals:sC,writer:n=>{const e=bre(n.params.format);if(!e)throw Oo.notBindable();return e}},controller:n=>{var e,t;return new iC(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:Wh("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});let rC=class{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((i,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(i))!==null&&o!==void 0?o:i});return this.asm_.fromComponents(t)}};const px=G("pndtxt");let Are=class{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(px()),this.textViews.forEach(i=>{const s=e.createElement("div");s.classList.add(px("a")),s.appendChild(i.element),this.element.appendChild(s)})}};function Mre(n,e,t){return new Yh(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:dt(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}let oC=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((i,s)=>Mre(e,t,s)),this.acs_.forEach((i,s)=>{ja({primary:this.value,secondary:i.value,forward:r=>t.assembly.toComponents(r)[s],backward:(r,o)=>{const l=t.assembly.toComponents(r);return l[s]=o,t.assembly.fromComponents(l)}})}),this.view=new Are(e,{textViews:this.acs_.map(i=>i.view)})}get textControllers(){return this.acs_}},Tre=class extends Ng{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}};function Dre(n,e){const t=[],i=D2(n,e);i&&t.push(i);const s=O2(n);s&&t.push(s);const r=Wg(n.options);return r&&t.push(r),new Gh(t)}Rt({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=yt(e,i=>Object.assign(Object.assign({},j2(i)),{options:i.optional.custom(Bd),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>A2,constraint:n=>Dre(n.params,n.initialValue),writer:n=>Xh},controller:n=>{const e=n.value,t=n.constraint,i=t&&Pp(t,Nd);if(i)return new ca(n.document,{props:new ve({options:i.values.value("options")}),value:e,viewProps:n.viewProps});const s=R2(n.params,e.rawValue),r=t&&Pp(t,Dd);return r?new ax(n.document,Object.assign(Object.assign({},hse(Object.assign(Object.assign({},s),{keyScale:dt(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:Fr,value:e,viewProps:n.viewProps})):new Yh(n.document,{parser:Fr,props:ve.fromObject(s),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof ax?new Tre(n.controller):n.controller.valueController instanceof ca?new Xg(n.controller):null}});let Mr=class{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(je(e))return!1;const t=e.x,i=e.y;return!(typeof t!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}};const PM={toComponents:n=>n.getComponents(),fromComponents:n=>new Mr(...n)},gl=G("p2d");let Ore=class{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(gl()),t.viewProps.bindClassModifiers(this.element),$s(t.expanded,Ra(this.element,gl(void 0,"expanded")));const i=e.createElement("div");i.classList.add(gl("h")),this.element.appendChild(i);const s=e.createElement("button");s.classList.add(gl("b")),s.appendChild(jd(e,"p2dpad")),t.viewProps.bindDisabled(s),i.appendChild(s),this.buttonElement=s;const r=e.createElement("div");if(r.classList.add(gl("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(gl("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}};const hr=G("p2dp");let Rre=class{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(hr()),t.layout==="popup"&&this.element.classList.add(hr(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(hr("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=e.createElementNS(fi,"svg");s.classList.add(hr("g")),this.padElement.appendChild(s),this.svgElem_=s;const r=e.createElementNS(fi,"line");r.classList.add(hr("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=e.createElementNS(fi,"line");o.classList.add(hr("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const l=e.createElementNS(fi,"line");l.classList.add(hr("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const a=e.createElement("div");a.classList.add(hr("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.props_.get("max"),s=oe(e,-i,+i,0,100),r=oe(t,-i,+i,0,100),o=this.props_.get("invertsY")?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${s}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${s}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}};function dx(n,e,t){return[on(e[0],Rs(n)),on(e[1],uh(n))*(t?1:-1)]}let jre=class{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Rre(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Qo(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.props.get("max"),s=oe(e.point.x,0,e.bounds.width,-i,+i),r=oe(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new Mr(s,r),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){Z2(e.key)&&e.preventDefault();const[t,i]=dx(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(new Mr(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=dx(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}},Nre=class{constructor(e,t){var i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=qg.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new Y2(e,{viewProps:this.viewProps}):null;const r=new jre(e,{layout:t.pickerLayout,props:new ve({invertsY:dt(t.invertsY),max:dt(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.textC_=new oC(e,{assembly:PM,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new Ore(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),ja({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),Gg(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=F2(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!Bg(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}};function Bre(n){return Mr.isObject(n)?new Mr(n.x,n.y):new Mr}function Ire(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function Fre(n,e){return new rC({assembly:PM,components:[_s(Object.assign(Object.assign({},n),n.x),e.x),_s(Object.assign(Object.assign({},n),n.y),e.y)]})}function mx(n,e){var t,i;if(!je(n.min)||!je(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((i=n.max)!==null&&i!==void 0?i:0));const s=T2(n);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function Kre(n,e){var t,i;const s=mx(Do(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),r=mx(Do(n,(i=n.y)!==null&&i!==void 0?i:{}),e.y);return Math.max(s,r)}function Ure(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}Rt({id:"input-point2d",type:"input",accept:(n,e)=>{if(!Mr.isObject(n))return null;const t=yt(e,i=>Object.assign(Object.assign({},hh(i)),{expanded:i.optional.boolean,picker:i.optional.custom(J2),readonly:i.optional.constant(!1),x:i.optional.custom(Pr),y:i.optional.object(Object.assign(Object.assign({},hh(i)),{inverted:i.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>Bre,constraint:n=>Fre(n.params,n.initialValue),equals:Mr.equals,writer:()=>Ire},controller:n=>{var e,t;const i=n.document,s=n.value,r=n.constraint,o=[n.params.x,n.params.y];return new Nre(i,{axes:s.rawValue.getComponents().map((l,a)=>{var u;return jg({constraint:r.components[a],initialValue:l,params:Do(n.params,(u=o[a])!==null&&u!==void 0?u:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:Ure(n.params),max:Kre(n.params,s.rawValue),parser:Fr,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:n.viewProps})}});let ql=class{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(je(e))return!1;const t=e.x,i=e.y,s=e.z;return!(typeof t!="number"||typeof i!="number"||typeof s!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}};const yM={toComponents:n=>n.getComponents(),fromComponents:n=>new ql(...n)};function Hre(n){return ql.isObject(n)?new ql(n.x,n.y,n.z):new ql}function zre(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function qre(n,e){return new rC({assembly:yM,components:[_s(Object.assign(Object.assign({},n),n.x),e.x),_s(Object.assign(Object.assign({},n),n.y),e.y),_s(Object.assign(Object.assign({},n),n.z),e.z)]})}Rt({id:"input-point3d",type:"input",accept:(n,e)=>{if(!ql.isObject(n))return null;const t=yt(e,i=>Object.assign(Object.assign({},hh(i)),{readonly:i.optional.constant(!1),x:i.optional.custom(Pr),y:i.optional.custom(Pr),z:i.optional.custom(Pr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Hre,constraint:n=>qre(n.params,n.initialValue),equals:ql.equals,writer:n=>zre},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z];return new oC(n.document,{assembly:yM,axes:e.rawValue.getComponents().map((s,r)=>{var o;return jg({constraint:t.components[r],initialValue:s,params:Do(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Fr,value:e,viewProps:n.viewProps})}});let Gl=class{constructor(e=0,t=0,i=0,s=0){this.x=e,this.y=t,this.z=i,this.w=s}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(je(e))return!1;const t=e.x,i=e.y,s=e.z,r=e.w;return!(typeof t!="number"||typeof i!="number"||typeof s!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}};const EM={toComponents:n=>n.getComponents(),fromComponents:n=>new Gl(...n)};function Gre(n){return Gl.isObject(n)?new Gl(n.x,n.y,n.z,n.w):new Gl}function Yre(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function Xre(n,e){return new rC({assembly:EM,components:[_s(Object.assign(Object.assign({},n),n.x),e.x),_s(Object.assign(Object.assign({},n),n.y),e.y),_s(Object.assign(Object.assign({},n),n.z),e.z),_s(Object.assign(Object.assign({},n),n.w),e.w)]})}Rt({id:"input-point4d",type:"input",accept:(n,e)=>{if(!Gl.isObject(n))return null;const t=yt(e,i=>Object.assign(Object.assign({},hh(i)),{readonly:i.optional.constant(!1),w:i.optional.custom(Pr),x:i.optional.custom(Pr),y:i.optional.custom(Pr),z:i.optional.custom(Pr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Gre,constraint:n=>Xre(n.params,n.initialValue),equals:Gl.equals,writer:n=>Yre},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z,n.params.w];return new oC(n.document,{assembly:EM,axes:e.rawValue.getComponents().map((s,r)=>{var o;return jg({constraint:t.components[r],initialValue:s,params:Do(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Fr,value:e,viewProps:n.viewProps})}});function Wre(n){const e=[],t=Wg(n.options);return t&&e.push(t),new Gh(e)}Rt({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=yt(e,i=>({readonly:i.optional.constant(!1),options:i.optional.custom(Bd)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>W2,constraint:n=>Wre(n.params),writer:n=>Xh},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&Pp(i,Nd);return s?new ca(e,{props:new ve({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new Zg(e,{parser:r=>r,props:ve.fromObject({formatter:Vf}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof ca?new Xg(n.controller):null}});const Zh={monitor:{defaultInterval:200,defaultRows:3}},vx=G("mll");let Zre=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(vx()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(vx("i")),i.style.height=`calc(var(${Q2("containerUnitSize")}) * ${t.rows})`,i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach(s=>{s!==void 0&&i.push(this.formatter_(s))}),e.textContent=i.join(`
`),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}},lC=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Zre(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}};const fx=G("sgl");let Qre=class{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(fx()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(fx("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}},aC=class{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Qre(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}};Rt({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=yt(e,i=>({readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>X2},controller:n=>{var e;return n.value.rawValue.length===1?new aC(n.document,{formatter:lx,value:n.value,viewProps:n.viewProps}):new lC(n.document,{formatter:lx,rows:(e=n.params.rows)!==null&&e!==void 0?e:Zh.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});let Jre=class extends Ng{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}};const cr=G("grl");let eoe=class{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(cr()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(fi,"svg");i.classList.add(cr("g")),i.style.height=`calc(var(${Q2("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(fi,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=e.createElement("div");r.classList.add(cr("t"),G("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,i=this.props_.get("min"),s=this.props_.get("max"),r=[];this.value.rawValue.forEach((h,c)=>{if(h===void 0)return;const d=oe(c,0,t,0,e.width),p=oe(h,i,s,e.height,0);r.push([d,p].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,l=this.value.rawValue[this.cursor_.rawValue];if(l===void 0){o.classList.remove(cr("t","a"));return}const a=oe(this.cursor_.rawValue,0,t,0,e.width),u=oe(l,i,s,e.height,0);o.style.left=`${a}px`,o.style.top=`${u}px`,o.textContent=`${this.formatter_(l)}`,o.classList.contains(cr("t","a"))||(o.classList.add(cr("t","a"),cr("t","in")),Cp(o),o.classList.remove(cr("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}},xM=class{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=dt(-1),this.view=new eoe(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!Bg(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new Qo(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return Zi(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return Qi(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(oe(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(oe(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}};function kf(n){return je(n.format)?pn(2):n.format}function toe(n){var e;return n.value.rawValue.length===1?new aC(n.document,{formatter:kf(n.params),value:n.value,viewProps:n.viewProps}):new lC(n.document,{formatter:kf(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Zh.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function noe(n){var e,t,i;return new xM(n.document,{formatter:kf(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Zh.monitor.defaultRows,props:ve.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(i=n.params.min)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function wx(n){return n.view==="graph"}Rt({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=yt(e,i=>({format:i.optional.function,max:i.optional.number,min:i.optional.number,readonly:i.required.constant(!0),rows:i.optional.number,view:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>wx(n)?64:1,reader:n=>A2},controller:n=>wx(n.params)?noe(n):toe(n),api:n=>n.controller.valueController instanceof xM?new Jre(n.controller):null});Rt({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=yt(e,i=>({multiline:i.optional.boolean,readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>W2},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new lC(n.document,{formatter:Vf,rows:(e=n.params.rows)!==null&&e!==void 0?e:Zh.monitor.defaultRows,value:t,viewProps:n.viewProps}):new aC(n.document,{formatter:Vf,value:t,viewProps:n.viewProps})}});class ioe extends Od{measureStart(e){this.controller.valueController.measureStart(e)}measureEnd(){return this.controller.valueController.measureEnd()}measure(e,t){this.controller.valueController.measure(e,t)}measureAsync(e,t){return this.controller.valueController.measureAsync(e,t)}get measureHandler(){return this.controller.valueController.measureHandler}set measureHandler(e){this.controller.valueController.measureHandler=e}}class _x extends Fg{constructor(e,t){const i=t.valueController,s=new K2(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:i.viewProps}),this.valueController=i,this.labelController=s}}class soe{measureStart(){const e=performance.now();return()=>performance.now()-e}}function bx(n,e,t,i){function s(r){return r instanceof t?r:new t(function(o){o(r)})}return new(t||(t=Promise))(function(r,o){function l(h){try{u(i.next(h))}catch(c){o(c)}}function a(h){try{u(i.throw(h))}catch(c){o(c)}}function u(h){h.done?r(h.value):s(h.value).then(l,a)}u((i=i.apply(n,[])).next())})}class $M{constructor(){this.map=new Map,this.keySet=new Set}get(e){return this.map.get(e)}getOrCreate(e,t){this.keySet.has(e)||this.keySet.add(e);let i=this.map.get(e);return i==null&&(i=t(),this.map.set(e,i)),i}set(e,t){this.keySet.has(e)||this.keySet.add(e),this.map.set(e,t)}resetUsedSet(){this.keySet.clear()}vaporize(e){for(const[t,i]of this.map.entries())this.keySet.has(t)||(this.map.delete(t),e==null||e([t,i]))}}function roe(n){n.splice(0,n.length)}function Cc(n){let e=0;return n.forEach(t=>e+=t),e}class ooe{constructor(e){this.__recalcForEach=0,this.__countUntilRecalc=0,this.__history=[],this.__index=0,this.__count=0,this.__cache=0,this.__length=e,this.__recalcForEach=e;for(let t=0;t<e;t++)this.__history[t]=0}get mean(){const e=Math.min(this.__count,this.__length);return e===0?0:this.__cache/e}get recalcForEach(){return this.__recalcForEach}set recalcForEach(e){const t=e-this.__recalcForEach;this.__recalcForEach=e,this.__countUntilRecalc=Math.max(0,this.__countUntilRecalc+t)}reset(){this.__index=0,this.__count=0,this.__cache=0,this.__countUntilRecalc=0;for(let e=0;e<this.__length;e++)this.__history[e]=0}push(e){const t=this.__history[this.__index];this.__history[this.__index]=e,this.__count++,this.__index=(this.__index+1)%this.__length,this.__countUntilRecalc===0?this.recalc():(this.__countUntilRecalc--,this.__cache-=t,this.__cache+=e)}recalc(){this.__countUntilRecalc=this.__recalcForEach;const e=this.__history.slice(0,Math.min(this.__count,this.__length)).reduce((t,i)=>t+i,0);this.__cache=e}}function Sf(n,e){if(typeof e!="function")return Sf(n,r=>r<e);const t=e;let i=0,s=n.length;for(;i<s;){const r=i+s>>1,o=n[r];t(o)?i=r+1:s=r}return i}class loe{constructor(e){this.__history=[],this.__sorted=[],this.__index=0,this.__length=e}get median(){return this.percentile(50)}percentile(e){return this.__history.length===0?0:this.__sorted[Math.round(e*.01*(this.__history.length-1))]}reset(){this.__index=0,this.__history=[],this.__sorted=[]}push(e){const t=this.__history[this.__index];if(this.__history[this.__index]=e,this.__index=(this.__index+1)%this.__length,this.__sorted.length===this.__length){const s=Sf(this.__sorted,t);this.__sorted.splice(s,1)}const i=Sf(this.__sorted,e);this.__sorted.splice(i,0,e)}}function Cl(n,e){let t=0;for(let i=0;i<n.length;i++)t+=n[i]*e[i];return t}function uC(n){return Math.min(Math.max(n,0),1)}function aoe(n){return`rgb( ${n.map(t=>uC(t)*256).join(", ")} )`}function uoe(n){const e=[.13572138,4.6153926,-42.66032258,132.13108234],t=[.09140261,2.19418839,4.84296658,-14.18503333],i=[.1066733,12.64194608,-60.58204836,110.36276771],s=[-152.94239396,59.28637943],r=[4.27729857,2.82956604],o=[-89.90310912,27.34824973];n=uC(n);const l=[1,n,n*n,n*n*n],a=[l[2],l[3]].map(h=>h*l[2]),u=[Cl(l,e)+Cl(a,s),Cl(l,t)+Cl(a,r),Cl(l,i)+Cl(a,o)];return aoe(u)}const pr=G("profiler");class hoe{constructor(e,t){this.targetDelta=t.targetDelta,this.deltaUnit=t.deltaUnit,this.fractionDigits=t.fractionDigits,this.calcMode=t.calcMode,this.element=e.createElement("div"),this.element.classList.add(pr()),t.viewProps.bindClassModifiers(this.element),this.svgRootElement_=e.createElementNS("http://www.w3.org/2000/svg","svg"),this.svgRootElement_.classList.add(pr("root")),this.element.appendChild(this.svgRootElement_),this.entryContainerElement_=e.createElementNS("http://www.w3.org/2000/svg","g"),this.entryContainerElement_.classList.add(pr("container")),this.entryContainerElement_.setAttribute("transform","translate( 1, 1 )"),this.svgRootElement_.appendChild(this.entryContainerElement_),this.tooltipElement_=e.createElement("div"),this.tooltipElement_.classList.add(pr("tooltip")),this.tooltipElement_.style.display="none",this.element.appendChild(this.tooltipElement_),this.tooltipInsideElement_=e.createElement("div"),this.tooltipInsideElement_.classList.add(pr("tooltipinside")),this.tooltipElement_.appendChild(this.tooltipInsideElement_),this.labelElement_=e.createElement("div"),this.labelElement_.classList.add(pr("label")),this.labelElement_.textContent=this.deltaToDisplayDelta_(0),this.element.appendChild(this.labelElement_),this.entryElementCacheMap_=new $M,this.hoveringEntry_=null}update(e){const t=this.entryToDelta_(e);this.labelElement_.textContent=this.deltaToDisplayDelta_(t),this.entryElementCacheMap_.resetUsedSet();const i=160/Math.max(this.targetDelta,t);let s=0;for(const r of e.children)this.addEntry_(r,"",this.entryContainerElement_,i).setAttribute("transform",`translate( ${s}, 0 )`),s+=this.entryToDelta_(r)*i;this.entryElementCacheMap_.vaporize(([r,o])=>{o.remove(),this.hoveringEntry_===r&&(this.hoveringEntry_=null)}),this.updateTooltip_()}updateTooltip_(){const e=this.hoveringEntry_;if(e){const t=this.entryElementCacheMap_.get(e),i=t==null?void 0:t.getAttribute("data-delta"),s=this.deltaToDisplayDelta_(parseFloat(i??"0.0")),r=`${e}
${s}`;this.tooltipElement_.style.display="block",this.tooltipInsideElement_.textContent=r}else this.tooltipElement_.style.display="none"}addEntry_(e,t,i,s){const r=`${t}/${e.name}`,o=this.entryElementCacheMap_.getOrCreate(r,()=>{const h=document.createElementNS("http://www.w3.org/2000/svg","g");h.classList.add(pr("entry")),i.appendChild(h),this.entryElementCacheMap_.set(r,h);const c=document.createElementNS("http://www.w3.org/2000/svg","rect");return c.classList.add(pr("entryrect")),h.appendChild(c),c.addEventListener("mouseenter",()=>{this.hoveringEntry_=r,this.updateTooltip_()}),c.addEventListener("mouseleave",()=>{this.hoveringEntry_=null,this.updateTooltip_()}),h}),l=this.entryToDelta_(e);o.setAttribute("data-delta",`${l}`);const a=o.childNodes[0];a.setAttribute("width",`${Math.max(.01,l*s-1)}px`),a.setAttribute("height","9px");const u=.15+.7*uC(l/this.targetDelta);if(a.setAttribute("fill",uoe(u)),e.children.length>0){let h=0;e.children.forEach(c=>{this.addEntry_(c,r,o,s).setAttribute("transform",`translate( ${h}, 10 )`),h+=this.entryToDelta_(c)*s})}return o}entryToDelta_(e){if(this.calcMode==="frame")return e.delta;if(this.calcMode==="mean")return e.deltaMean;if(this.calcMode==="median")return e.deltaMedian;throw new Error('Unreachable! calcMode must be one of "frame", "mean", or "median"')}deltaToDisplayDelta_(e){return`${e.toFixed(this.fractionDigits)} ${this.deltaUnit}`}}class coe{constructor(e,t){this.targetDelta=t.targetDelta,this.bufferSize=t.bufferSize,this.onTick_=this.onTick_.bind(this),this.ticker_=t.ticker,this.ticker_.emitter.on("tick",this.onTick_),this.viewProps=t.viewProps,this.view=new hoe(e,{targetDelta:this.targetDelta,deltaUnit:t.deltaUnit,fractionDigits:t.fractionDigits,calcMode:t.calcMode,viewProps:this.viewProps}),this.viewProps.handleDispose(()=>{this.ticker_.dispose()}),this.measureHandler=t.measureHandler,this.rootCalcCacheStack_=[this.createNewEntryCalcCache_()]}measureStart(e){const i=this.rootCalcCacheStack_[this.rootCalcCacheStack_.length-1].childrenCacheMap.getOrCreate(e,()=>this.createNewEntryCalcCache_());i.childrenCacheMap.resetUsedSet(),roe(i.childrenPromiseDelta),this.rootCalcCacheStack_.push(i),i.measureEnd=this.measureHandler.measureStart()}measureEnd(){return bx(this,void 0,void 0,function*(){const e=this.rootCalcCacheStack_[this.rootCalcCacheStack_.length-1],t=this.rootCalcCacheStack_[this.rootCalcCacheStack_.length-2],i=Promise.resolve(e.measureEnd());e.measureEnd=null,t.childrenPromiseDelta.push(i),this.rootCalcCacheStack_.pop(),e.childrenCacheMap.vaporize();const s=yield Promise.all(e.childrenPromiseDelta),r=Cc(s),o=(yield i)-r;e.meanCalc.push(o),e.medianCalc.push(o),e.latest=o})}measure(e,t){this.measureStart(e),t(),this.measureEnd()}measureAsync(e,t){return bx(this,void 0,void 0,function*(){this.measureStart(e),yield t(),this.measureEnd()})}renderEntry(){return this.renderEntryFromCalcCache_("",this.rootCalcCacheStack_[0])}renderEntryFromCalcCache_(e,t){const i=[];for(const p of t.childrenCacheMap.keySet){const v=t.childrenCacheMap.get(p);i.push(this.renderEntryFromCalcCache_(p,v))}const s=t.latest,r=t.meanCalc.mean,o=t.medianCalc.median,l=Cc(i.map(p=>p.delta)),a=Cc(i.map(p=>p.deltaMean)),u=Cc(i.map(p=>p.deltaMedian)),h=s+l,c=r+a,d=o+u;return{name:e,delta:h,deltaMean:c,deltaMedian:d,selfDelta:s,selfDeltaMean:r,selfDeltaMedian:o,children:i}}onTick_(){this.view.update(this.renderEntry())}createNewEntryCalcCache_(){return{meanCalc:new ooe(this.bufferSize),medianCalc:new loe(this.bufferSize),latest:0,measureEnd:null,childrenCacheMap:new $M,childrenPromiseDelta:[]}}}function poe(n,e){return e===0?new Zie:new Qie(n,e??Zh.monitor.defaultInterval)}function doe(n){switch(n){case"frame":case"mean":case"median":return n;default:return}}function moe(n){if(typeof n=="object"&&n!=null&&"measureStart"in n)return n;typeof n=="object"&&n!=null&&"measure"in n&&console.warn("The API of `ProfilerBladeDefaultMeasureHandler` has been changed in v0.4.0! Please define `measureStart` instead of `measure`. Fallback to the default measure handler.")}Rt({id:"profiler",type:"blade",accept(n){const e=yt(n,t=>({view:t.required.constant("profiler"),targetDelta:t.optional.number,bufferSize:t.optional.number,deltaUnit:t.optional.string,fractionDigits:t.optional.number,calcMode:t.optional.custom(doe),label:t.optional.string,interval:t.optional.number,measureHandler:t.optional.custom(moe)}));return e?{params:e}:null},controller(n){var e,t,i,s,r,o,l;const a=(e=n.params.interval)!==null&&e!==void 0?e:500,u=(t=n.params.targetDelta)!==null&&t!==void 0?t:16.67,h=(i=n.params.bufferSize)!==null&&i!==void 0?i:30,c=(s=n.params.deltaUnit)!==null&&s!==void 0?s:"ms",d=(r=n.params.fractionDigits)!==null&&r!==void 0?r:2,p=(o=n.params.calcMode)!==null&&o!==void 0?o:"mean",v=(l=n.params.measureHandler)!==null&&l!==void 0?l:new soe;return new _x(n.document,{blade:n.blade,labelProps:ve.fromObject({label:n.params.label}),valueController:new coe(n.document,{ticker:poe(n.document,a),targetDelta:u,bufferSize:h,deltaUnit:c,fractionDigits:d,calcMode:p,viewProps:n.viewProps,measureHandler:v})})},api(n){return n.controller instanceof _x?new ioe(n.controller):null}});function Ne(n){return n==null}function hC(n){return n!==null&&typeof n=="object"}function Lf(n){return n!==null&&typeof n=="object"}function voe(n,e){if(n.length!==e.length)return!1;for(let t=0;t<n.length;t++)if(n[t]!==e[t])return!1;return!0}function jo(n,e){return Array.from(new Set([...Object.keys(n),...Object.keys(e)])).reduce((i,s)=>{const r=n[s],o=e[s];return Lf(r)&&Lf(o)?Object.assign(Object.assign({},i),{[s]:jo(r,o)}):Object.assign(Object.assign({},i),{[s]:s in e?o:r})},{})}function foe(n){return hC(n)?"target"in n:!1}const woe={alreadydisposed:()=>"View has been already disposed",invalidparams:n=>`Invalid parameters for '${n.name}'`,nomatchingcontroller:n=>`No matching controller for '${n.key}'`,nomatchingview:n=>`No matching view for '${JSON.stringify(n.params)}'`,notbindable:()=>"Value is not bindable",notcompatible:n=>`Not compatible with  plugin '${n.id}'`,propertynotfound:n=>`Property '${n.name}' not found`,shouldneverhappen:()=>"This error should never happen"};class _n{static alreadyDisposed(){return new _n({type:"alreadydisposed"})}static notBindable(){return new _n({type:"notbindable"})}static notCompatible(e,t){return new _n({type:"notcompatible",context:{id:`${e}.${t}`}})}static propertyNotFound(e){return new _n({type:"propertynotfound",context:{name:e}})}static shouldNeverHappen(){return new _n({type:"shouldneverhappen"})}constructor(e){var t;this.message=(t=woe[e.type](e.context))!==null&&t!==void 0?t:"Unexpected error",this.name=this.constructor.name,this.stack=new Error(this.message).stack,this.type=e.type}toString(){return this.message}}class Ep{constructor(e,t){this.obj_=e,this.key=t}static isBindable(e){return!(e===null||typeof e!="object"&&typeof e!="function")}read(){return this.obj_[this.key]}write(e){this.obj_[this.key]=e}writeProperty(e,t){const i=this.read();if(!Ep.isBindable(i))throw _n.notBindable();if(!(e in i))throw _n.propertyNotFound(e);i[e]=t}}class Vn{constructor(){this.observers_={}}on(e,t){let i=this.observers_[e];return i||(i=this.observers_[e]=[]),i.push({handler:t}),this}off(e,t){const i=this.observers_[e];return i&&(this.observers_[e]=i.filter(s=>s.handler!==t)),this}emit(e,t){const i=this.observers_[e];i&&i.forEach(s=>{s.handler(t)})}}class _oe{constructor(e,t){var i;this.constraint_=t==null?void 0:t.constraint,this.equals_=(i=t==null?void 0:t.equals)!==null&&i!==void 0?i:(s,r)=>s===r,this.emitter=new Vn,this.rawValue_=e}get constraint(){return this.constraint_}get rawValue(){return this.rawValue_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.constraint_?this.constraint_.constrain(e):e,r=this.rawValue_;this.equals_(r,s)&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.rawValue_=s,this.emitter.emit("change",{options:i,previousRawValue:r,rawValue:s,sender:this}))}}class boe{constructor(e){this.emitter=new Vn,this.value_=e}get rawValue(){return this.value_}set rawValue(e){this.setRawValue(e,{forceEmit:!1,last:!0})}setRawValue(e,t){const i=t??{forceEmit:!1,last:!0},s=this.value_;s===e&&!i.forceEmit||(this.emitter.emit("beforechange",{sender:this}),this.value_=e,this.emitter.emit("change",{options:i,previousRawValue:s,rawValue:this.value_,sender:this}))}}class goe{constructor(e){this.emitter=new Vn,this.onValueBeforeChange_=this.onValueBeforeChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.value_=e,this.value_.emitter.on("beforechange",this.onValueBeforeChange_),this.value_.emitter.on("change",this.onValueChange_)}get rawValue(){return this.value_.rawValue}onValueBeforeChange_(e){this.emitter.emit("beforechange",Object.assign(Object.assign({},e),{sender:this}))}onValueChange_(e){this.emitter.emit("change",Object.assign(Object.assign({},e),{sender:this}))}}function mt(n,e){const t=e==null?void 0:e.constraint,i=e==null?void 0:e.equals;return!t&&!i?new boe(n):new _oe(n,e)}function Coe(n){return[new goe(n),(e,t)=>{n.setRawValue(e,t)}]}class H{constructor(e){this.emitter=new Vn,this.valMap_=e;for(const t in this.valMap_)this.valMap_[t].emitter.on("change",()=>{this.emitter.emit("change",{key:t,sender:this})})}static createCore(e){return Object.keys(e).reduce((i,s)=>Object.assign(i,{[s]:mt(e[s])}),{})}static fromObject(e){const t=this.createCore(e);return new H(t)}get(e){return this.valMap_[e].rawValue}set(e,t){this.valMap_[e].rawValue=t}value(e){return this.valMap_[e]}}class Fd{constructor(e){this.values=H.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");return Math.min(Math.max(e,i),t)}}class Poe{constructor(e){this.values=H.fromObject({max:e.max,min:e.min})}constrain(e){const t=this.values.get("max"),i=this.values.get("min");let s=e;return Ne(i)||(s=Math.max(s,i)),Ne(t)||(s=Math.min(s,t)),s}}class yoe{constructor(e,t=0){this.step=e,this.origin=t}constrain(e){const t=this.origin%this.step,i=Math.round((e-t)/this.step);return t+i*this.step}}class Eoe{constructor(e){this.text=e}evaluate(){return Number(this.text)}toString(){return this.text}}const xoe={"**":(n,e)=>Math.pow(n,e),"*":(n,e)=>n*e,"/":(n,e)=>n/e,"%":(n,e)=>n%e,"+":(n,e)=>n+e,"-":(n,e)=>n-e,"<<":(n,e)=>n<<e,">>":(n,e)=>n>>e,">>>":(n,e)=>n>>>e,"&":(n,e)=>n&e,"^":(n,e)=>n^e,"|":(n,e)=>n|e};class $oe{constructor(e,t,i){this.left=t,this.operator=e,this.right=i}evaluate(){const e=xoe[this.operator];if(!e)throw new Error(`unexpected binary operator: '${this.operator}`);return e(this.left.evaluate(),this.right.evaluate())}toString(){return["b(",this.left.toString(),this.operator,this.right.toString(),")"].join(" ")}}const Voe={"+":n=>n,"-":n=>-n,"~":n=>~n};class koe{constructor(e,t){this.operator=e,this.expression=t}evaluate(){const e=Voe[this.operator];if(!e)throw new Error(`unexpected unary operator: '${this.operator}`);return e(this.expression.evaluate())}toString(){return["u(",this.operator,this.expression.toString(),")"].join(" ")}}function cC(n){return(e,t)=>{for(let i=0;i<n.length;i++){const s=n[i](e,t);if(s!=="")return s}return""}}function ch(n,e){var t;const i=n.substr(e).match(/^\s+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Soe(n,e){const t=n.substr(e,1);return t.match(/^[1-9]$/)?t:""}function ph(n,e){var t;const i=n.substr(e).match(/^[0-9]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Loe(n,e){const t=ph(n,e);if(t!=="")return t;const i=n.substr(e,1);if(e+=1,i!=="-"&&i!=="+")return"";const s=ph(n,e);return s===""?"":i+s}function pC(n,e){const t=n.substr(e,1);if(e+=1,t.toLowerCase()!=="e")return"";const i=Loe(n,e);return i===""?"":t+i}function VM(n,e){const t=n.substr(e,1);if(t==="0")return t;const i=Soe(n,e);return e+=i.length,i===""?"":i+ph(n,e)}function Aoe(n,e){const t=VM(n,e);if(e+=t.length,t==="")return"";const i=n.substr(e,1);if(e+=i.length,i!==".")return"";const s=ph(n,e);return e+=s.length,t+i+s+pC(n,e)}function Moe(n,e){const t=n.substr(e,1);if(e+=t.length,t!==".")return"";const i=ph(n,e);return e+=i.length,i===""?"":t+i+pC(n,e)}function Toe(n,e){const t=VM(n,e);return e+=t.length,t===""?"":t+pC(n,e)}const Doe=cC([Aoe,Moe,Toe]);function Ooe(n,e){var t;const i=n.substr(e).match(/^[01]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Roe(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0b")return"";const i=Ooe(n,e);return i===""?"":t+i}function joe(n,e){var t;const i=n.substr(e).match(/^[0-7]+/);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Noe(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0o")return"";const i=joe(n,e);return i===""?"":t+i}function Boe(n,e){var t;const i=n.substr(e).match(/^[0-9a-f]+/i);return(t=i&&i[0])!==null&&t!==void 0?t:""}function Ioe(n,e){const t=n.substr(e,2);if(e+=t.length,t.toLowerCase()!=="0x")return"";const i=Boe(n,e);return i===""?"":t+i}const Foe=cC([Roe,Noe,Ioe]),Koe=cC([Foe,Doe]);function Uoe(n,e){const t=Koe(n,e);return e+=t.length,t===""?null:{evaluable:new Eoe(t),cursor:e}}function Hoe(n,e){const t=n.substr(e,1);if(e+=t.length,t!=="(")return null;const i=SM(n,e);if(!i)return null;e=i.cursor,e+=ch(n,e).length;const s=n.substr(e,1);return e+=s.length,s!==")"?null:{evaluable:i.evaluable,cursor:e}}function zoe(n,e){var t;return(t=Uoe(n,e))!==null&&t!==void 0?t:Hoe(n,e)}function kM(n,e){const t=zoe(n,e);if(t)return t;const i=n.substr(e,1);if(e+=i.length,i!=="+"&&i!=="-"&&i!=="~")return null;const s=kM(n,e);return s?(e=s.cursor,{cursor:e,evaluable:new koe(i,s.evaluable)}):null}function qoe(n,e,t){t+=ch(e,t).length;const i=n.filter(s=>e.startsWith(s,t))[0];return i?(t+=i.length,t+=ch(e,t).length,{cursor:t,operator:i}):null}function Goe(n,e){return(t,i)=>{const s=n(t,i);if(!s)return null;i=s.cursor;let r=s.evaluable;for(;;){const o=qoe(e,t,i);if(!o)break;i=o.cursor;const l=n(t,i);if(!l)return null;i=l.cursor,r=new $oe(o.operator,r,l.evaluable)}return r?{cursor:i,evaluable:r}:null}}const Yoe=[["**"],["*","/","%"],["+","-"],["<<",">>>",">>"],["&"],["^"],["|"]].reduce((n,e)=>Goe(n,e),kM);function SM(n,e){return e+=ch(n,e).length,Yoe(n,e)}function Xoe(n){const e=SM(n,0);return!e||e.cursor+ch(n,e.cursor).length!==n.length?null:e.evaluable}function Kr(n){var e;const t=Xoe(n);return(e=t==null?void 0:t.evaluate())!==null&&e!==void 0?e:null}function LM(n){if(typeof n=="number")return n;if(typeof n=="string"){const e=Kr(n);if(!Ne(e))return e}return 0}function dn(n){return e=>e.toFixed(Math.max(Math.min(n,20),0))}function K(n,e,t,i,s){const r=(n-e)/(t-e);return i+r*(s-i)}function gx(n){return String(n.toFixed(10)).split(".")[1].replace(/0+$/,"").length}function st(n,e,t){return Math.min(Math.max(n,e),t)}function AM(n,e){return(n%e+e)%e}function Woe(n,e){return Ne(n.step)?Math.max(gx(e),2):gx(n.step)}function MM(n){var e;return(e=n.step)!==null&&e!==void 0?e:1}function Zoe(n,e){var t;const i=Math.abs((t=n.step)!==null&&t!==void 0?t:e);return i===0?.1:Math.pow(10,Math.floor(Math.log10(i))-1)}function TM(n,e){return Ne(n.step)?null:new yoe(n.step,e)}function DM(n){return!Ne(n.max)&&!Ne(n.min)?new Fd({max:n.max,min:n.min}):!Ne(n.max)||!Ne(n.min)?new Poe({max:n.max,min:n.min}):null}function OM(n,e){var t,i,s;return{formatter:(t=n.format)!==null&&t!==void 0?t:dn(Woe(n,e)),keyScale:(i=n.keyScale)!==null&&i!==void 0?i:MM(n),pointerScale:(s=n.pointerScale)!==null&&s!==void 0?s:Zoe(n,e)}}function RM(n){return{format:n.optional.function,keyScale:n.optional.number,max:n.optional.number,min:n.optional.number,pointerScale:n.optional.number,step:n.optional.number}}function dC(n){return{constraint:n.constraint,textProps:H.fromObject(OM(n.params,n.initialValue))}}class mC{constructor(e){this.controller=e}get element(){return this.controller.view.element}get disabled(){return this.controller.viewProps.get("disabled")}set disabled(e){this.controller.viewProps.set("disabled",e)}get hidden(){return this.controller.viewProps.get("hidden")}set hidden(e){this.controller.viewProps.set("hidden",e)}dispose(){this.controller.viewProps.set("disposed",!0)}importState(e){return this.controller.importState(e)}exportState(){return this.controller.exportState()}}class Kd{constructor(e){this.target=e}}class jM extends Kd{constructor(e,t,i){super(e),this.value=t,this.last=i??!0}}class Qoe extends Kd{constructor(e,t){super(e),this.expanded=t}}class Joe extends Kd{constructor(e,t){super(e),this.index=t}}class vC extends mC{constructor(e){super(e),this.onValueChange_=this.onValueChange_.bind(this),this.emitter_=new Vn,this.controller.value.emitter.on("change",this.onValueChange_)}get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get key(){return this.controller.value.binding.target.key}get tag(){return this.controller.tag}set tag(e){this.controller.tag=e}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.controller.value.fetch()}onValueChange_(e){const t=this.controller.value;this.emitter_.emit("change",new jM(this,t.binding.target.read(),e.options.last))}}function ele(n,e){const i=Object.keys(e).reduce((s,r)=>{if(s===void 0)return;const o=e[r],l=o(n[r]);return l.succeeded?Object.assign(Object.assign({},s),{[r]:l.value}):void 0},{});return i}function tle(n,e){return n.reduce((t,i)=>{if(t===void 0)return;const s=e(i);if(!(!s.succeeded||s.value===void 0))return[...t,s.value]},[])}function nle(n){return n===null?!1:typeof n=="object"}function hs(n){return e=>t=>{if(!e&&t===void 0)return{succeeded:!1,value:void 0};if(e&&t===void 0)return{succeeded:!0,value:void 0};const i=n(t);return i!==void 0?{succeeded:!0,value:i}:{succeeded:!1,value:void 0}}}function Cx(n){return{custom:e=>hs(e)(n),boolean:hs(e=>typeof e=="boolean"?e:void 0)(n),number:hs(e=>typeof e=="number"?e:void 0)(n),string:hs(e=>typeof e=="string"?e:void 0)(n),function:hs(e=>typeof e=="function"?e:void 0)(n),constant:e=>hs(t=>t===e?e:void 0)(n),raw:hs(e=>e)(n),object:e=>hs(t=>{if(nle(t))return ele(t,e)})(n),array:e=>hs(t=>{if(Array.isArray(t))return tle(t,e)})(n)}}const Af={optional:Cx(!0),required:Cx(!1)};function Et(n,e){const t=e(Af),i=Af.required.object(t)(n);return i.succeeded?i.value:void 0}function Ji(n,e,t,i){if(e&&!e(n))return!1;const s=Et(n,t);return s?i(s):!1}function es(n,e){var t;return jo((t=n==null?void 0:n())!==null&&t!==void 0?t:{},e)}function Gc(n){return"value"in n}function ile(n){if(!hC(n)||!("binding"in n))return!1;const e=n.binding;return foe(e)}const Wn="http://www.w3.org/2000/svg";function xp(n){n.offsetHeight}function sle(n,e){const t=n.style.transition;n.style.transition="none",e(),n.style.transition=t}function fC(n){return n.ontouchstart!==void 0}function rle(n){const e=n.ownerDocument.defaultView;return e&&"document"in e?n.getContext("2d",{willReadFrequently:!0}):null}const ole={check:'<path d="M2 8l4 4l8 -8"/>',dropdown:'<path d="M5 7h6l-3 3 z"/>',p2dpad:'<path d="M8 4v8"/><path d="M4 8h8"/><circle cx="12" cy="12" r="1.2"/>'};function Ud(n,e){const t=n.createElementNS(Wn,"svg");return t.innerHTML=ole[e],t}function NM(n,e,t){n.insertBefore(e,n.children[t])}function wC(n){n.parentElement&&n.parentElement.removeChild(n)}function BM(n){for(;n.children.length>0;)n.removeChild(n.children[0])}function lle(n){for(;n.childNodes.length>0;)n.removeChild(n.childNodes[0])}function IM(n){return n.relatedTarget?n.relatedTarget:"explicitOriginalTarget"in n?n.explicitOriginalTarget:null}function Vs(n,e){n.emitter.on("change",t=>{e(t.rawValue)}),e(n.rawValue)}function ji(n,e,t){Vs(n.value(e),t)}const ale="tp";function Y(n){return(t,i)=>[ale,"-",n,"v",t?`_${t}`:"",i?`-${i}`:""].join("")}const Pu=Y("lbl");function ule(n,e){const t=n.createDocumentFragment();return e.split(`
`).map(s=>n.createTextNode(s)).forEach((s,r)=>{r>0&&t.appendChild(n.createElement("br")),t.appendChild(s)}),t}class hle{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Pu()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Pu("l")),ji(t.props,"label",r=>{Ne(r)?this.element.classList.add(Pu(void 0,"nol")):(this.element.classList.remove(Pu(void 0,"nol")),lle(i),i.appendChild(ule(e,r)))}),this.element.appendChild(i),this.labelElement=i;const s=e.createElement("div");s.classList.add(Pu("v")),this.element.appendChild(s),this.valueElement=s}}class cle{constructor(e,t){this.props=t.props,this.valueController=t.valueController,this.viewProps=t.valueController.viewProps,this.view=new hle(e,{props:t.props,viewProps:this.viewProps}),this.view.valueElement.appendChild(this.valueController.view.element)}importProps(e){return Ji(e,null,t=>({label:t.optional.string}),t=>(this.props.set("label",t.label),!0))}exportProps(){return es(null,{label:this.props.get("label")})}}function ple(){return["veryfirst","first","last","verylast"]}const Px=Y(""),yx={veryfirst:"vfst",first:"fst",last:"lst",verylast:"vlst"};class FM{constructor(e){this.parent_=null,this.blade=e.blade,this.view=e.view,this.viewProps=e.viewProps;const t=this.view.element;this.blade.value("positions").emitter.on("change",()=>{ple().forEach(i=>{t.classList.remove(Px(void 0,yx[i]))}),this.blade.get("positions").forEach(i=>{t.classList.add(Px(void 0,yx[i]))})}),this.viewProps.handleDispose(()=>{wC(t)})}get parent(){return this.parent_}set parent(e){this.parent_=e,this.viewProps.set("parent",this.parent_?this.parent_.viewProps:null)}importState(e){return Ji(e,null,t=>({disabled:t.required.boolean,hidden:t.required.boolean}),t=>(this.viewProps.importState(t),!0))}exportState(){return es(null,Object.assign({},this.viewProps.exportState()))}}class dle extends mC{get label(){return this.controller.labelController.props.get("label")}set label(e){this.controller.labelController.props.set("label",e)}get title(){var e;return(e=this.controller.buttonController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.buttonController.props.set("title",e)}on(e,t){const i=t.bind(this);return this.controller.buttonController.emitter.on(e,()=>{i(new Kd(this))}),this}}function mle(n,e,t){t?n.classList.add(e):n.classList.remove(e)}function Na(n,e){return t=>{mle(n,e,t)}}function _C(n,e){Vs(n,t=>{e.textContent=t??""})}const bv=Y("btn");class vle{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(bv()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("button");i.classList.add(bv("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(bv("t")),_C(t.props.value("title"),s),this.buttonElement.appendChild(s)}}class fle{constructor(e,t){this.emitter=new Vn,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new vle(e,{props:this.props,viewProps:this.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}importProps(e){return Ji(e,null,t=>({title:t.optional.string}),t=>(this.props.set("title",t.title),!0))}exportProps(){return es(null,{title:this.props.get("title")})}onClick_(){this.emitter.emit("click",{sender:this})}}class Ex extends FM{constructor(e,t){const i=new fle(e,{props:t.buttonProps,viewProps:t.viewProps}),s=new cle(e,{blade:t.blade,props:t.labelProps,valueController:i});super({blade:t.blade,view:s.view,viewProps:t.viewProps}),this.buttonController=i,this.labelController=s}importState(e){return Ji(e,t=>super.importState(t)&&this.buttonController.importProps(t)&&this.labelController.importProps(t),()=>({}),()=>!0)}exportState(){return es(()=>super.exportState(),Object.assign(Object.assign({},this.buttonController.exportProps()),this.labelController.exportProps()))}}class wle{constructor(e){const[t,i]=e.split("-"),s=t.split(".");this.major=parseInt(s[0],10),this.minor=parseInt(s[1],10),this.patch=parseInt(s[2],10),this.prerelease=i??null}toString(){const e=[this.major,this.minor,this.patch].join(".");return this.prerelease!==null?[e,this.prerelease].join("-"):e}}const _le=new wle("2.0.1");function jt(n){return Object.assign({core:_le},n)}jt({id:"button",type:"blade",accept(n){const e=Et(n,t=>({title:t.required.string,view:t.required.constant("button"),label:t.optional.string}));return e?{params:e}:null},controller(n){return new Ex(n.document,{blade:n.blade,buttonProps:H.fromObject({title:n.params.title}),labelProps:H.fromObject({label:n.params.label}),viewProps:n.viewProps})},api(n){return n.controller instanceof Ex?new dle(n.controller):null}});function ble(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"button"}))}function gle(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"folder"}))}function Cle(n,e){return n.addBlade(Object.assign(Object.assign({},e),{view:"tab"}))}function Ple(n){return hC(n)?"refresh"in n&&typeof n.refresh=="function":!1}function yle(n,e){if(!Ep.isBindable(n))throw _n.notBindable();return new Ep(n,e)}class Ele{constructor(e,t){this.onRackValueChange_=this.onRackValueChange_.bind(this),this.controller_=e,this.emitter_=new Vn,this.pool_=t,this.controller_.rack.emitter.on("valuechange",this.onRackValueChange_)}get children(){return this.controller_.rack.children.map(e=>this.pool_.createApi(e))}addBinding(e,t,i){const s=i??{},r=this.controller_.element.ownerDocument,o=this.pool_.createBinding(r,yle(e,t),s),l=this.pool_.createBindingApi(o);return this.add(l,s.index)}addFolder(e){return gle(this,e)}addButton(e){return ble(this,e)}addTab(e){return Cle(this,e)}add(e,t){const i=e.controller;return this.controller_.rack.add(i,t),e}remove(e){this.controller_.rack.remove(e.controller)}addBlade(e){const t=this.controller_.element.ownerDocument,i=this.pool_.createBlade(t,e),s=this.pool_.createApi(i);return this.add(s,e.index)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}refresh(){this.children.forEach(e=>{Ple(e)&&e.refresh()})}onRackValueChange_(e){const t=e.bladeController,i=this.pool_.createApi(t),s=ile(t.value)?t.value.binding:null;this.emitter_.emit("change",new jM(i,s?s.target.read():t.value.rawValue,e.options.last))}}class bC extends mC{constructor(e,t){super(e),this.rackApi_=new Ele(e.rackController,t)}refresh(){this.rackApi_.refresh()}}class gC extends FM{constructor(e){super({blade:e.blade,view:e.view,viewProps:e.rackController.viewProps}),this.rackController=e.rackController}importState(e){return Ji(e,t=>super.importState(t),t=>({children:t.required.array(t.required.raw)}),t=>this.rackController.rack.children.every((i,s)=>i.importState(t.children[s])))}exportState(){return es(()=>super.exportState(),{children:this.rackController.rack.children.map(e=>e.exportState())})}}function Mf(n){return"rackController"in n}class xle{constructor(e){this.emitter=new Vn,this.items_=[],this.cache_=new Set,this.onSubListAdd_=this.onSubListAdd_.bind(this),this.onSubListRemove_=this.onSubListRemove_.bind(this),this.extract_=e}get items(){return this.items_}allItems(){return Array.from(this.cache_)}find(e){for(const t of this.allItems())if(e(t))return t;return null}includes(e){return this.cache_.has(e)}add(e,t){if(this.includes(e))throw _n.shouldNeverHappen();const i=t!==void 0?t:this.items_.length;this.items_.splice(i,0,e),this.cache_.add(e);const s=this.extract_(e);s&&(s.emitter.on("add",this.onSubListAdd_),s.emitter.on("remove",this.onSubListRemove_),s.allItems().forEach(r=>{this.cache_.add(r)})),this.emitter.emit("add",{index:i,item:e,root:this,target:this})}remove(e){const t=this.items_.indexOf(e);if(t<0)return;this.items_.splice(t,1),this.cache_.delete(e);const i=this.extract_(e);i&&(i.allItems().forEach(s=>{this.cache_.delete(s)}),i.emitter.off("add",this.onSubListAdd_),i.emitter.off("remove",this.onSubListRemove_)),this.emitter.emit("remove",{index:t,item:e,root:this,target:this})}onSubListAdd_(e){this.cache_.add(e.item),this.emitter.emit("add",{index:e.index,item:e.item,root:this,target:e.target})}onSubListRemove_(e){this.cache_.delete(e.item),this.emitter.emit("remove",{index:e.index,item:e.item,root:this,target:e.target})}}function $le(n,e){for(let t=0;t<n.length;t++){const i=n[t];if(Gc(i)&&i.value===e)return i}return null}function Vle(n){return Mf(n)?n.rackController.rack.bcSet_:null}class kle{constructor(e){var t,i;this.emitter=new Vn,this.onBladePositionsChange_=this.onBladePositionsChange_.bind(this),this.onSetAdd_=this.onSetAdd_.bind(this),this.onSetRemove_=this.onSetRemove_.bind(this),this.onChildDispose_=this.onChildDispose_.bind(this),this.onChildPositionsChange_=this.onChildPositionsChange_.bind(this),this.onChildValueChange_=this.onChildValueChange_.bind(this),this.onChildViewPropsChange_=this.onChildViewPropsChange_.bind(this),this.onRackLayout_=this.onRackLayout_.bind(this),this.onRackValueChange_=this.onRackValueChange_.bind(this),this.blade_=(t=e.blade)!==null&&t!==void 0?t:null,(i=this.blade_)===null||i===void 0||i.value("positions").emitter.on("change",this.onBladePositionsChange_),this.viewProps=e.viewProps,this.bcSet_=new xle(Vle),this.bcSet_.emitter.on("add",this.onSetAdd_),this.bcSet_.emitter.on("remove",this.onSetRemove_)}get children(){return this.bcSet_.items}add(e,t){var i;(i=e.parent)===null||i===void 0||i.remove(e),e.parent=this,this.bcSet_.add(e,t)}remove(e){e.parent=null,this.bcSet_.remove(e)}find(e){return this.bcSet_.allItems().filter(e)}onSetAdd_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("add",{bladeController:e.item,index:e.index,root:t,sender:this}),!t)return;const i=e.item;if(i.viewProps.emitter.on("change",this.onChildViewPropsChange_),i.blade.value("positions").emitter.on("change",this.onChildPositionsChange_),i.viewProps.handleDispose(this.onChildDispose_),Gc(i))i.value.emitter.on("change",this.onChildValueChange_);else if(Mf(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.on("layout",this.onRackLayout_),r.on("valuechange",this.onRackValueChange_)}}}onSetRemove_(e){this.updatePositions_();const t=e.target===e.root;if(this.emitter.emit("remove",{bladeController:e.item,root:t,sender:this}),!t)return;const i=e.item;if(Gc(i))i.value.emitter.off("change",this.onChildValueChange_);else if(Mf(i)){const s=i.rackController.rack;if(s){const r=s.emitter;r.off("layout",this.onRackLayout_),r.off("valuechange",this.onRackValueChange_)}}}updatePositions_(){const e=this.bcSet_.items.filter(s=>!s.viewProps.get("hidden")),t=e[0],i=e[e.length-1];this.bcSet_.items.forEach(s=>{const r=[];s===t&&(r.push("first"),(!this.blade_||this.blade_.get("positions").includes("veryfirst"))&&r.push("veryfirst")),s===i&&(r.push("last"),(!this.blade_||this.blade_.get("positions").includes("verylast"))&&r.push("verylast")),s.blade.set("positions",r)})}onChildPositionsChange_(){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildViewPropsChange_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onChildDispose_(){this.bcSet_.items.filter(t=>t.viewProps.get("disposed")).forEach(t=>{this.bcSet_.remove(t)})}onChildValueChange_(e){const t=$le(this.find(Gc),e.sender);if(!t)throw _n.alreadyDisposed();this.emitter.emit("valuechange",{bladeController:t,options:e.options,sender:this})}onRackLayout_(e){this.updatePositions_(),this.emitter.emit("layout",{sender:this})}onRackValueChange_(e){this.emitter.emit("valuechange",{bladeController:e.bladeController,options:e.options,sender:this})}onBladePositionsChange_(){this.updatePositions_()}}class CC{constructor(e){this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this),this.element=e.element,this.viewProps=e.viewProps;const t=new kle({blade:e.root?void 0:e.blade,viewProps:e.viewProps});t.emitter.on("add",this.onRackAdd_),t.emitter.on("remove",this.onRackRemove_),this.rack=t,this.viewProps.handleDispose(()=>{for(let i=this.rack.children.length-1;i>=0;i--)this.rack.children[i].viewProps.set("disposed",!0)})}onRackAdd_(e){e.root&&NM(this.element,e.bladeController.view.element,e.index)}onRackRemove_(e){e.root&&wC(e.bladeController.view.element)}}function KM(){return new H({positions:mt([],{equals:voe})})}class Qh extends H{constructor(e){super(e)}static create(e){const t={completed:!0,expanded:e,expandedHeight:null,shouldFixHeight:!1,temporaryExpanded:null},i=H.createCore(t);return new Qh(i)}get styleExpanded(){var e;return(e=this.get("temporaryExpanded"))!==null&&e!==void 0?e:this.get("expanded")}get styleHeight(){if(!this.styleExpanded)return"0";const e=this.get("expandedHeight");return this.get("shouldFixHeight")&&!Ne(e)?`${e}px`:"auto"}bindExpandedClass(e,t){const i=()=>{this.styleExpanded?e.classList.add(t):e.classList.remove(t)};ji(this,"expanded",i),ji(this,"temporaryExpanded",i)}cleanUpTransition(){this.set("shouldFixHeight",!1),this.set("expandedHeight",null),this.set("completed",!0)}}function Sle(n,e){let t=0;return sle(e,()=>{n.set("expandedHeight",null),n.set("temporaryExpanded",!0),xp(e),t=e.clientHeight,n.set("temporaryExpanded",null),xp(e)}),t}function xx(n,e){e.style.height=n.styleHeight}function PC(n,e){n.value("expanded").emitter.on("beforechange",()=>{if(n.set("completed",!1),Ne(n.get("expandedHeight"))){const t=Sle(n,e);t>0&&n.set("expandedHeight",t)}n.set("shouldFixHeight",!0),xp(e)}),n.emitter.on("change",()=>{xx(n,e)}),xx(n,e),e.addEventListener("transitionend",t=>{t.propertyName==="height"&&n.cleanUpTransition()})}class Lle extends bC{constructor(e,t){super(e,t),this.emitter_=new Vn,this.controller.foldable.value("expanded").emitter.on("change",i=>{this.emitter_.emit("fold",new Qoe(this,i.sender.rawValue))}),this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)})}get expanded(){return this.controller.foldable.get("expanded")}set expanded(e){this.controller.foldable.set("expanded",e)}get title(){return this.controller.props.get("title")}set title(e){this.controller.props.set("title",e)}get children(){return this.rackApi_.children}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addFolder(e){return this.rackApi_.addFolder(e)}addButton(e){return this.rackApi_.addButton(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){return this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBlade(e){return this.rackApi_.addBlade(e)}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}}const UM=Y("cnt");class Ale{constructor(e,t){var i;this.className_=Y((i=t.viewName)!==null&&i!==void 0?i:"fld"),this.element=e.createElement("div"),this.element.classList.add(this.className_(),UM()),t.viewProps.bindClassModifiers(this.element),this.foldable_=t.foldable,this.foldable_.bindExpandedClass(this.element,this.className_(void 0,"expanded")),ji(this.foldable_,"completed",Na(this.element,this.className_(void 0,"cpl")));const s=e.createElement("button");s.classList.add(this.className_("b")),ji(t.props,"title",u=>{Ne(u)?this.element.classList.add(this.className_(void 0,"not")):this.element.classList.remove(this.className_(void 0,"not"))}),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s;const r=e.createElement("div");r.classList.add(this.className_("i")),this.element.appendChild(r);const o=e.createElement("div");o.classList.add(this.className_("t")),_C(t.props.value("title"),o),this.buttonElement.appendChild(o),this.titleElement=o;const l=e.createElement("div");l.classList.add(this.className_("m")),this.buttonElement.appendChild(l);const a=e.createElement("div");a.classList.add(this.className_("c")),this.element.appendChild(a),this.containerElement=a}}class $x extends gC{constructor(e,t){var i;const s=Qh.create((i=t.expanded)!==null&&i!==void 0?i:!0),r=new Ale(e,{foldable:s,props:t.props,viewName:t.root?"rot":void 0,viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new CC({blade:t.blade,element:r.containerElement,root:t.root,viewProps:t.viewProps}),view:r})),this.onTitleClick_=this.onTitleClick_.bind(this),this.props=t.props,this.foldable=s,PC(this.foldable,this.view.containerElement),this.rackController.rack.emitter.on("add",()=>{this.foldable.cleanUpTransition()}),this.rackController.rack.emitter.on("remove",()=>{this.foldable.cleanUpTransition()}),this.view.buttonElement.addEventListener("click",this.onTitleClick_)}get document(){return this.view.element.ownerDocument}importState(e){return Ji(e,t=>super.importState(t),t=>({expanded:t.required.boolean,title:t.optional.string}),t=>(this.foldable.set("expanded",t.expanded),this.props.set("title",t.title),!0))}exportState(){return es(()=>super.exportState(),{expanded:this.foldable.get("expanded"),title:this.props.get("title")})}onTitleClick_(){this.foldable.set("expanded",!this.foldable.get("expanded"))}}jt({id:"folder",type:"blade",accept(n){const e=Et(n,t=>({title:t.required.string,view:t.required.constant("folder"),expanded:t.optional.boolean}));return e?{params:e}:null},controller(n){return new $x(n.document,{blade:n.blade,expanded:n.params.expanded,props:H.fromObject({title:n.params.title}),viewProps:n.viewProps})},api(n){return n.controller instanceof $x?new Lle(n.controller,n.pool):null}});const Mle=Y("");function Vx(n,e){return Na(n,Mle(void 0,e))}class Jh extends H{constructor(e){var t;super(e),this.onDisabledChange_=this.onDisabledChange_.bind(this),this.onParentChange_=this.onParentChange_.bind(this),this.onParentGlobalDisabledChange_=this.onParentGlobalDisabledChange_.bind(this),[this.globalDisabled_,this.setGlobalDisabled_]=Coe(mt(this.getGlobalDisabled_())),this.value("disabled").emitter.on("change",this.onDisabledChange_),this.value("parent").emitter.on("change",this.onParentChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_)}static create(e){var t,i,s;const r=e??{};return new Jh(H.createCore({disabled:(t=r.disabled)!==null&&t!==void 0?t:!1,disposed:!1,hidden:(i=r.hidden)!==null&&i!==void 0?i:!1,parent:(s=r.parent)!==null&&s!==void 0?s:null}))}get globalDisabled(){return this.globalDisabled_}bindClassModifiers(e){Vs(this.globalDisabled_,Vx(e,"disabled")),ji(this,"hidden",Vx(e,"hidden"))}bindDisabled(e){Vs(this.globalDisabled_,t=>{e.disabled=t})}bindTabIndex(e){Vs(this.globalDisabled_,t=>{e.tabIndex=t?-1:0})}handleDispose(e){this.value("disposed").emitter.on("change",t=>{t&&e()})}importState(e){this.set("disabled",e.disabled),this.set("hidden",e.hidden)}exportState(){return{disabled:this.get("disabled"),hidden:this.get("hidden")}}getGlobalDisabled_(){const e=this.get("parent");return(e?e.globalDisabled.rawValue:!1)||this.get("disabled")}updateGlobalDisabled_(){this.setGlobalDisabled_(this.getGlobalDisabled_())}onDisabledChange_(){this.updateGlobalDisabled_()}onParentGlobalDisabledChange_(){this.updateGlobalDisabled_()}onParentChange_(e){var t;const i=e.previousRawValue;i==null||i.globalDisabled.emitter.off("change",this.onParentGlobalDisabledChange_),(t=this.get("parent"))===null||t===void 0||t.globalDisabled.emitter.on("change",this.onParentGlobalDisabledChange_),this.updateGlobalDisabled_()}}const kx=Y("tbp");class Tle{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(kx()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(kx("c")),this.element.appendChild(i),this.containerElement=i}}const yu=Y("tbi");class Dle{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(yu()),t.viewProps.bindClassModifiers(this.element),ji(t.props,"selected",r=>{r?this.element.classList.add(yu(void 0,"sel")):this.element.classList.remove(yu(void 0,"sel"))});const i=e.createElement("button");i.classList.add(yu("b")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.buttonElement=i;const s=e.createElement("div");s.classList.add(yu("t")),_C(t.props.value("title"),s),this.buttonElement.appendChild(s),this.titleElement=s}}class Ole{constructor(e,t){this.emitter=new Vn,this.onClick_=this.onClick_.bind(this),this.props=t.props,this.viewProps=t.viewProps,this.view=new Dle(e,{props:t.props,viewProps:t.viewProps}),this.view.buttonElement.addEventListener("click",this.onClick_)}onClick_(){this.emitter.emit("click",{sender:this})}}class Tf extends gC{constructor(e,t){const i=new Tle(e,{viewProps:t.viewProps});super(Object.assign(Object.assign({},t),{rackController:new CC({blade:t.blade,element:i.containerElement,viewProps:t.viewProps}),view:i})),this.onItemClick_=this.onItemClick_.bind(this),this.ic_=new Ole(e,{props:t.itemProps,viewProps:Jh.create()}),this.ic_.emitter.on("click",this.onItemClick_),this.props=t.props,ji(this.props,"selected",s=>{this.itemController.props.set("selected",s),this.viewProps.set("hidden",!s)})}get itemController(){return this.ic_}importState(e){return Ji(e,t=>super.importState(t),t=>({selected:t.required.boolean,title:t.required.string}),t=>(this.ic_.props.set("selected",t.selected),this.ic_.props.set("title",t.title),!0))}exportState(){return es(()=>super.exportState(),{selected:this.ic_.props.get("selected"),title:this.ic_.props.get("title")})}onItemClick_(){this.props.set("selected",!0)}}class Rle extends bC{constructor(e,t){super(e,t),this.emitter_=new Vn,this.onSelect_=this.onSelect_.bind(this),this.pool_=t,this.rackApi_.on("change",i=>{this.emitter_.emit("change",i)}),this.controller.tab.selectedIndex.emitter.on("change",this.onSelect_)}get pages(){return this.rackApi_.children}addPage(e){const t=this.controller.view.element.ownerDocument,i=new Tf(t,{blade:KM(),itemProps:H.fromObject({selected:!1,title:e.title}),props:H.fromObject({selected:!1}),viewProps:Jh.create()}),s=this.pool_.createApi(i);return this.rackApi_.add(s,e.index)}removePage(e){this.rackApi_.remove(this.rackApi_.children[e])}on(e,t){const i=t.bind(this);return this.emitter_.on(e,s=>{i(s)}),this}onSelect_(e){this.emitter_.emit("select",new Joe(this,e.rawValue))}}class jle extends bC{get title(){var e;return(e=this.controller.itemController.props.get("title"))!==null&&e!==void 0?e:""}set title(e){this.controller.itemController.props.set("title",e)}get selected(){return this.controller.props.get("selected")}set selected(e){this.controller.props.set("selected",e)}get children(){return this.rackApi_.children}addButton(e){return this.rackApi_.addButton(e)}addFolder(e){return this.rackApi_.addFolder(e)}addTab(e){return this.rackApi_.addTab(e)}add(e,t){this.rackApi_.add(e,t)}remove(e){this.rackApi_.remove(e)}addBinding(e,t,i){return this.rackApi_.addBinding(e,t,i)}addBlade(e){return this.rackApi_.addBlade(e)}}const Sx=-1;class Nle{constructor(){this.onItemSelectedChange_=this.onItemSelectedChange_.bind(this),this.empty=mt(!0),this.selectedIndex=mt(Sx),this.items_=[]}add(e,t){const i=t??this.items_.length;this.items_.splice(i,0,e),e.emitter.on("change",this.onItemSelectedChange_),this.keepSelection_()}remove(e){const t=this.items_.indexOf(e);t<0||(this.items_.splice(t,1),e.emitter.off("change",this.onItemSelectedChange_),this.keepSelection_())}keepSelection_(){if(this.items_.length===0){this.selectedIndex.rawValue=Sx,this.empty.rawValue=!0;return}const e=this.items_.findIndex(t=>t.rawValue);e<0?(this.items_.forEach((t,i)=>{t.rawValue=i===0}),this.selectedIndex.rawValue=0):(this.items_.forEach((t,i)=>{t.rawValue=i===e}),this.selectedIndex.rawValue=e),this.empty.rawValue=!1}onItemSelectedChange_(e){if(e.rawValue){const t=this.items_.findIndex(i=>i===e.sender);this.items_.forEach((i,s)=>{i.rawValue=s===t}),this.selectedIndex.rawValue=t}else this.keepSelection_()}}const Eu=Y("tab");class Ble{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Eu(),UM()),t.viewProps.bindClassModifiers(this.element),Vs(t.empty,Na(this.element,Eu(void 0,"nop")));const i=e.createElement("div");i.classList.add(Eu("t")),this.element.appendChild(i),this.itemsElement=i;const s=e.createElement("div");s.classList.add(Eu("i")),this.element.appendChild(s);const r=e.createElement("div");r.classList.add(Eu("c")),this.element.appendChild(r),this.contentsElement=r}}class Lx extends gC{constructor(e,t){const i=new Nle,s=new Ble(e,{empty:i.empty,viewProps:t.viewProps});super({blade:t.blade,rackController:new CC({blade:t.blade,element:s.contentsElement,viewProps:t.viewProps}),view:s}),this.onRackAdd_=this.onRackAdd_.bind(this),this.onRackRemove_=this.onRackRemove_.bind(this);const r=this.rackController.rack;r.emitter.on("add",this.onRackAdd_),r.emitter.on("remove",this.onRackRemove_),this.tab=i}add(e,t){this.rackController.rack.add(e,t)}remove(e){this.rackController.rack.remove(this.rackController.rack.children[e])}onRackAdd_(e){if(!e.root)return;const t=e.bladeController;NM(this.view.itemsElement,t.itemController.view.element,e.index),t.itemController.viewProps.set("parent",this.viewProps),this.tab.add(t.props.value("selected"))}onRackRemove_(e){if(!e.root)return;const t=e.bladeController;wC(t.itemController.view.element),t.itemController.viewProps.set("parent",null),this.tab.remove(t.props.value("selected"))}}jt({id:"tab",type:"blade",accept(n){const e=Et(n,t=>({pages:t.required.array(t.required.object({title:t.required.string})),view:t.required.constant("tab")}));return!e||e.pages.length===0?null:{params:e}},controller(n){const e=new Lx(n.document,{blade:n.blade,viewProps:n.viewProps});return n.params.pages.forEach(t=>{const i=new Tf(n.document,{blade:KM(),itemProps:H.fromObject({selected:!1,title:t.title}),props:H.fromObject({selected:!1}),viewProps:Jh.create()});e.add(i)}),e},api(n){return n.controller instanceof Lx?new Rle(n.controller,n.pool):n.controller instanceof Tf?new jle(n.controller,n.pool):null}});class yC extends vC{get options(){return this.controller.valueController.props.get("options")}set options(e){this.controller.valueController.props.set("options",e)}}class ec{constructor(e){this.constraints=e}constrain(e){return this.constraints.reduce((t,i)=>i.constrain(t),e)}}function $p(n,e){if(n instanceof e)return n;if(n instanceof ec){const t=n.constraints.reduce((i,s)=>i||(s instanceof e?s:null),null);if(t)return t}return null}class Hd{constructor(e){this.values=H.fromObject({options:e})}constrain(e){const t=this.values.get("options");return t.length===0||t.filter(s=>s.value===e).length>0?e:t[0].value}}function zd(n){var e;const t=Af;if(Array.isArray(n))return(e=Et({items:n},i=>({items:i.required.array(i.required.object({text:i.required.string,value:i.required.raw}))})))===null||e===void 0?void 0:e.items;if(typeof n=="object")return t.required.raw(n).value}function HM(n){if(Array.isArray(n))return n;const e=[];return Object.keys(n).forEach(t=>{e.push({text:t,value:n[t]})}),e}function EC(n){return Ne(n)?null:new Hd(HM(n))}const gv=Y("lst");class Ile{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.element=e.createElement("div"),this.element.classList.add(gv()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("select");i.classList.add(gv("s")),t.viewProps.bindDisabled(i),this.element.appendChild(i),this.selectElement=i;const s=e.createElement("div");s.classList.add(gv("m")),s.appendChild(Ud(e,"dropdown")),this.element.appendChild(s),t.value.emitter.on("change",this.onValueChange_),this.value_=t.value,ji(this.props_,"options",r=>{BM(this.selectElement),r.forEach(o=>{const l=e.createElement("option");l.textContent=o.text,this.selectElement.appendChild(l)}),this.update_()})}update_(){const e=this.props_.get("options").map(t=>t.value);this.selectElement.selectedIndex=e.indexOf(this.value_.rawValue)}onValueChange_(){this.update_()}}class da{constructor(e,t){this.onSelectChange_=this.onSelectChange_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Ile(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.view.selectElement.addEventListener("change",this.onSelectChange_)}onSelectChange_(e){const t=e.currentTarget;this.value.rawValue=this.props.get("options")[t.selectedIndex].value}importProps(e){return Ji(e,null,t=>({options:t.required.custom(zd)}),t=>(this.props.set("options",HM(t.options)),!0))}exportProps(){return es(null,{options:this.props.get("options")})}}const Ax=Y("pop");class Fle{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Ax()),t.viewProps.bindClassModifiers(this.element),Vs(t.shows,Na(this.element,Ax(void 0,"v")))}}class zM{constructor(e,t){this.shows=mt(!1),this.viewProps=t.viewProps,this.view=new Fle(e,{shows:this.shows,viewProps:this.viewProps})}}const Mx=Y("txt");class Kle{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Mx()),t.viewProps.bindClassModifiers(this.element),this.props_=t.props,this.props_.emitter.on("change",this.onChange_);const i=e.createElement("input");i.classList.add(Mx("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onChange_),this.value_=t.value,this.refresh()}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value_.rawValue)}onChange_(){this.refresh()}}class xC{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.parser_=t.parser,this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new Kle(e,{props:t.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Ne(s)||(this.value.rawValue=s),this.view.refresh()}}function Ule(n){return String(n)}function qM(n){return n==="false"?!1:!!n}function Tx(n){return Ule(n)}function Hle(n){return e=>n.reduce((t,i)=>t!==null?t:i(e),null)}const zle=dn(0);function Vp(n){return zle(n)+"%"}function GM(n){return String(n)}function Df(n){return n}function Ba({primary:n,secondary:e,forward:t,backward:i}){let s=!1;function r(o){s||(s=!0,o(),s=!1)}n.emitter.on("change",o=>{r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),e.emitter.on("change",o=>{r(()=>{n.setRawValue(i(n.rawValue,e.rawValue),o.options)}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),o.options)})}),r(()=>{e.setRawValue(t(n.rawValue,e.rawValue),{forceEmit:!1,last:!0})})}function ln(n,e){const t=n*(e.altKey?.1:1)*(e.shiftKey?10:1);return e.upKey?+t:e.downKey?-t:0}function dh(n){return{altKey:n.altKey,downKey:n.key==="ArrowDown",shiftKey:n.shiftKey,upKey:n.key==="ArrowUp"}}function js(n){return{altKey:n.altKey,downKey:n.key==="ArrowLeft",shiftKey:n.shiftKey,upKey:n.key==="ArrowRight"}}function qle(n){return n==="ArrowUp"||n==="ArrowDown"}function YM(n){return qle(n)||n==="ArrowLeft"||n==="ArrowRight"}function Cv(n,e){var t,i;const s=e.ownerDocument.defaultView,r=e.getBoundingClientRect();return{x:n.pageX-(((t=s&&s.scrollX)!==null&&t!==void 0?t:0)+r.left),y:n.pageY-(((i=s&&s.scrollY)!==null&&i!==void 0?i:0)+r.top)}}class Jo{constructor(e){this.lastTouch_=null,this.onDocumentMouseMove_=this.onDocumentMouseMove_.bind(this),this.onDocumentMouseUp_=this.onDocumentMouseUp_.bind(this),this.onMouseDown_=this.onMouseDown_.bind(this),this.onTouchEnd_=this.onTouchEnd_.bind(this),this.onTouchMove_=this.onTouchMove_.bind(this),this.onTouchStart_=this.onTouchStart_.bind(this),this.elem_=e,this.emitter=new Vn,e.addEventListener("touchstart",this.onTouchStart_,{passive:!1}),e.addEventListener("touchmove",this.onTouchMove_,{passive:!0}),e.addEventListener("touchend",this.onTouchEnd_),e.addEventListener("mousedown",this.onMouseDown_)}computePosition_(e){const t=this.elem_.getBoundingClientRect();return{bounds:{width:t.width,height:t.height},point:e?{x:e.x,y:e.y}:null}}onMouseDown_(e){var t;e.preventDefault(),(t=e.currentTarget)===null||t===void 0||t.focus();const i=this.elem_.ownerDocument;i.addEventListener("mousemove",this.onDocumentMouseMove_),i.addEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(Cv(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseMove_(e){this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(Cv(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onDocumentMouseUp_(e){const t=this.elem_.ownerDocument;t.removeEventListener("mousemove",this.onDocumentMouseMove_),t.removeEventListener("mouseup",this.onDocumentMouseUp_),this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(Cv(e,this.elem_)),sender:this,shiftKey:e.shiftKey})}onTouchStart_(e){e.preventDefault();const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("down",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchMove_(e){const t=e.targetTouches.item(0),i=this.elem_.getBoundingClientRect();this.emitter.emit("move",{altKey:e.altKey,data:this.computePosition_(t?{x:t.clientX-i.left,y:t.clientY-i.top}:void 0),sender:this,shiftKey:e.shiftKey}),this.lastTouch_=t}onTouchEnd_(e){var t;const i=(t=e.targetTouches.item(0))!==null&&t!==void 0?t:this.lastTouch_,s=this.elem_.getBoundingClientRect();this.emitter.emit("up",{altKey:e.altKey,data:this.computePosition_(i?{x:i.clientX-s.left,y:i.clientY-s.top}:void 0),sender:this,shiftKey:e.shiftKey})}}const Bn=Y("txt");class Gle{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Bn(),Bn(void 0,"num")),t.arrayPosition&&this.element.classList.add(Bn(void 0,t.arrayPosition)),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(Bn("i")),i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,this.onDraggingChange_=this.onDraggingChange_.bind(this),this.dragging_=t.dragging,this.dragging_.emitter.on("change",this.onDraggingChange_),this.element.classList.add(Bn()),this.inputElement.classList.add(Bn("i"));const s=e.createElement("div");s.classList.add(Bn("k")),this.element.appendChild(s),this.knobElement=s;const r=e.createElementNS(Wn,"svg");r.classList.add(Bn("g")),this.knobElement.appendChild(r);const o=e.createElementNS(Wn,"path");o.classList.add(Bn("gb")),r.appendChild(o),this.guideBodyElem_=o;const l=e.createElementNS(Wn,"path");l.classList.add(Bn("gh")),r.appendChild(l),this.guideHeadElem_=l;const a=e.createElement("div");a.classList.add(Y("tt")()),this.knobElement.appendChild(a),this.tooltipElem_=a,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.refresh()}onDraggingChange_(e){if(e.rawValue===null){this.element.classList.remove(Bn(void 0,"drg"));return}this.element.classList.add(Bn(void 0,"drg"));const t=e.rawValue/this.props_.get("pointerScale"),i=t+(t>0?-1:t<0?1:0),s=st(-i,-4,4);this.guideHeadElem_.setAttributeNS(null,"d",[`M ${i+s},0 L${i},4 L${i+s},8`,`M ${t},-1 L${t},9`].join(" ")),this.guideBodyElem_.setAttributeNS(null,"d",`M 0,4 L${t},4`);const r=this.props_.get("formatter");this.tooltipElem_.textContent=r(this.value.rawValue),this.tooltipElem_.style.left=`${t}px`}refresh(){const e=this.props_.get("formatter");this.inputElement.value=e(this.value.rawValue)}onChange_(){this.refresh()}}class tc{constructor(e,t){var i;this.originRawValue_=0,this.onInputChange_=this.onInputChange_.bind(this),this.onInputKeyDown_=this.onInputKeyDown_.bind(this),this.onInputKeyUp_=this.onInputKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.parser_=t.parser,this.props=t.props,this.sliderProps_=(i=t.sliderProps)!==null&&i!==void 0?i:null,this.value=t.value,this.viewProps=t.viewProps,this.dragging_=mt(null),this.view=new Gle(e,{arrayPosition:t.arrayPosition,dragging:this.dragging_,props:this.props,value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_),this.view.inputElement.addEventListener("keydown",this.onInputKeyDown_),this.view.inputElement.addEventListener("keyup",this.onInputKeyUp_);const s=new Jo(this.view.knobElement);s.emitter.on("down",this.onPointerDown_),s.emitter.on("move",this.onPointerMove_),s.emitter.on("up",this.onPointerUp_)}constrainValue_(e){var t,i;const s=(t=this.sliderProps_)===null||t===void 0?void 0:t.get("min"),r=(i=this.sliderProps_)===null||i===void 0?void 0:i.get("max");let o=e;return s!==void 0&&(o=Math.max(o,s)),r!==void 0&&(o=Math.min(o,r)),o}onInputChange_(e){const i=e.currentTarget.value,s=this.parser_(i);Ne(s)||(this.value.rawValue=this.constrainValue_(s)),this.view.refresh()}onInputKeyDown_(e){const t=ln(this.props.get("keyScale"),dh(e));t!==0&&this.value.setRawValue(this.constrainValue_(this.value.rawValue+t),{forceEmit:!1,last:!1})}onInputKeyUp_(e){ln(this.props.get("keyScale"),dh(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}onPointerDown_(){this.originRawValue_=this.value.rawValue,this.dragging_.rawValue=0}computeDraggingValue_(e){if(!e.point)return null;const t=e.point.x-e.bounds.width/2;return this.constrainValue_(this.originRawValue_+t*this.props.get("pointerScale"))}onPointerMove_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!1,last:!1}),this.dragging_.rawValue=this.value.rawValue-this.originRawValue_)}onPointerUp_(e){const t=this.computeDraggingValue_(e.data);t!==null&&(this.value.setRawValue(t,{forceEmit:!0,last:!0}),this.dragging_.rawValue=null)}}const Pv=Y("sld");class Yle{constructor(e,t){this.onChange_=this.onChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onChange_),this.element=e.createElement("div"),this.element.classList.add(Pv()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Pv("t")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.trackElement=i;const s=e.createElement("div");s.classList.add(Pv("k")),this.trackElement.appendChild(s),this.knobElement=s,t.value.emitter.on("change",this.onChange_),this.value=t.value,this.update_()}update_(){const e=st(K(this.value.rawValue,this.props_.get("min"),this.props_.get("max"),0,100),0,100);this.knobElement.style.width=`${e}%`}onChange_(){this.update_()}}class Xle{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDownOrMove_=this.onPointerDownOrMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.props=t.props,this.view=new Yle(e,{props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Jo(this.view.trackElement),this.ptHandler_.emitter.on("down",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("move",this.onPointerDownOrMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.trackElement.addEventListener("keydown",this.onKeyDown_),this.view.trackElement.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){e.point&&this.value.setRawValue(K(st(e.point.x,0,e.bounds.width),0,e.bounds.width,this.props.get("min"),this.props.get("max")),t)}onPointerDownOrMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=ln(this.props.get("keyScale"),js(e));t!==0&&this.value.setRawValue(this.value.rawValue+t,{forceEmit:!1,last:!1})}onKeyUp_(e){ln(this.props.get("keyScale"),js(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const yv=Y("sldtxt");class Wle{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(yv());const i=e.createElement("div");i.classList.add(yv("s")),this.sliderView_=t.sliderView,i.appendChild(this.sliderView_.element),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(yv("t")),this.textView_=t.textView,s.appendChild(this.textView_.element),this.element.appendChild(s)}}class Dx{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.sliderC_=new Xle(e,{props:t.sliderProps,value:t.value,viewProps:this.viewProps}),this.textC_=new tc(e,{parser:t.parser,props:t.textProps,sliderProps:t.sliderProps,value:t.value,viewProps:t.viewProps}),this.view=new Wle(e,{sliderView:this.sliderC_.view,textView:this.textC_.view})}get sliderController(){return this.sliderC_}get textController(){return this.textC_}importProps(e){return Ji(e,null,t=>({max:t.required.number,min:t.required.number}),t=>{const i=this.sliderC_.props;return i.set("max",t.max),i.set("min",t.min),!0})}exportProps(){const e=this.sliderC_.props;return es(null,{max:e.get("max"),min:e.get("min")})}}function Zle(n){return{sliderProps:new H({keyScale:n.keyScale,max:n.max,min:n.min}),textProps:new H({formatter:mt(n.formatter),keyScale:n.keyScale,pointerScale:mt(n.pointerScale)})}}const Qle={containerUnitSize:"cnt-usz"};function XM(n){return`--${Qle[n]}`}function mh(n){return RM(n)}function yr(n){if(Lf(n))return Et(n,mh)}function bs(n,e){if(!n)return;const t=[],i=TM(n,e);i&&t.push(i);const s=DM(n);return s&&t.push(s),new ec(t)}function WM(n){if(n==="inline"||n==="popup")return n}function nc(n,e){n.write(e)}const Pc=Y("ckb");class Jle{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.element=e.createElement("div"),this.element.classList.add(Pc()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("label");i.classList.add(Pc("l")),this.element.appendChild(i);const s=e.createElement("input");s.classList.add(Pc("i")),s.type="checkbox",i.appendChild(s),this.inputElement=s,t.viewProps.bindDisabled(this.inputElement);const r=e.createElement("div");r.classList.add(Pc("w")),i.appendChild(r);const o=Ud(e,"check");r.appendChild(o),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}update_(){this.inputElement.checked=this.value.rawValue}onValueChange_(){this.update_()}}class eae{constructor(e,t){this.onInputChange_=this.onInputChange_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Jle(e,{value:this.value,viewProps:this.viewProps}),this.view.inputElement.addEventListener("change",this.onInputChange_)}onInputChange_(e){const t=e.currentTarget;this.value.rawValue=t.checked}}function tae(n){const e=[],t=EC(n.options);return t&&e.push(t),new ec(e)}jt({id:"input-bool",type:"input",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Et(e,i=>({options:i.optional.custom(zd),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>qM,constraint:n=>tae(n.params),writer:n=>nc},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&$p(i,Hd);return s?new da(e,{props:new H({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new eae(e,{value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="boolean"?null:n.controller.valueController instanceof da?new yC(n.controller):null}});const oo=Y("col");class nae{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(oo()),t.foldable.bindExpandedClass(this.element,oo(void 0,"expanded")),ji(t.foldable,"completed",Na(this.element,oo(void 0,"cpl")));const i=e.createElement("div");i.classList.add(oo("h")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(oo("s")),i.appendChild(s),this.swatchElement=s;const r=e.createElement("div");if(r.classList.add(oo("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(oo("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}}function iae(n,e,t){const i=st(n/255,0,1),s=st(e/255,0,1),r=st(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u=0,h=0;const c=(l+o)/2;return a!==0&&(h=a/(1-Math.abs(o+l-1)),i===o?u=(s-r)/a:s===o?u=2+(r-i)/a:u=4+(i-s)/a,u=u/6+(u<0?1:0)),[u*360,h*100,c*100]}function sae(n,e,t){const i=(n%360+360)%360,s=st(e/100,0,1),r=st(t/100,0,1),o=(1-Math.abs(2*r-1))*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o/2;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function rae(n,e,t){const i=st(n/255,0,1),s=st(e/255,0,1),r=st(t/255,0,1),o=Math.max(i,s,r),l=Math.min(i,s,r),a=o-l;let u;a===0?u=0:o===i?u=60*(((s-r)/a%6+6)%6):o===s?u=60*((r-i)/a+2):u=60*((i-s)/a+4);const h=o===0?0:a/o,c=o;return[u,h*100,c*100]}function ZM(n,e,t){const i=AM(n,360),s=st(e/100,0,1),r=st(t/100,0,1),o=r*s,l=o*(1-Math.abs(i/60%2-1)),a=r-o;let u,h,c;return i>=0&&i<60?[u,h,c]=[o,l,0]:i>=60&&i<120?[u,h,c]=[l,o,0]:i>=120&&i<180?[u,h,c]=[0,o,l]:i>=180&&i<240?[u,h,c]=[0,l,o]:i>=240&&i<300?[u,h,c]=[l,0,o]:[u,h,c]=[o,0,l],[(u+a)*255,(h+a)*255,(c+a)*255]}function oae(n,e,t){const i=t+e*(100-Math.abs(2*t-100))/200;return[n,i!==0?e*(100-Math.abs(2*t-100))/i:0,t+e*(100-Math.abs(2*t-100))/(2*100)]}function lae(n,e,t){const i=100-Math.abs(t*(200-e)/100-100);return[n,i!==0?e*t/i:0,t*(200-e)/(2*100)]}function Ni(n){return[n[0],n[1],n[2]]}function qd(n,e){return[n[0],n[1],n[2],e]}const aae={hsl:{hsl:(n,e,t)=>[n,e,t],hsv:oae,rgb:sae},hsv:{hsl:lae,hsv:(n,e,t)=>[n,e,t],rgb:ZM},rgb:{hsl:iae,hsv:rae,rgb:(n,e,t)=>[n,e,t]}};function ma(n,e){return[e==="float"?1:n==="rgb"?255:360,e==="float"?1:n==="rgb"?255:100,e==="float"?1:n==="rgb"?255:100]}function uae(n,e){return n===e?e:AM(n,e)}function QM(n,e,t){var i;const s=ma(e,t);return[e==="rgb"?st(n[0],0,s[0]):uae(n[0],s[0]),st(n[1],0,s[1]),st(n[2],0,s[2]),st((i=n[3])!==null&&i!==void 0?i:1,0,1)]}function Ox(n,e,t,i){const s=ma(e,t),r=ma(e,i);return n.map((o,l)=>o/s[l]*r[l])}function JM(n,e,t){const i=Ox(n,e.mode,e.type,"int"),s=aae[e.mode][t.mode](...i);return Ox(s,t.mode,"int",t.type)}class U{static black(){return new U([0,0,0],"rgb")}constructor(e,t){this.type="int",this.mode=t,this.comps_=QM(e,t,this.type)}getComponents(e){return qd(JM(Ni(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const dr=Y("colp");class hae{constructor(e,t){this.alphaViews_=null,this.element=e.createElement("div"),this.element.classList.add(dr()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(dr("hsv"));const s=e.createElement("div");s.classList.add(dr("sv")),this.svPaletteView_=t.svPaletteView,s.appendChild(this.svPaletteView_.element),i.appendChild(s);const r=e.createElement("div");r.classList.add(dr("h")),this.hPaletteView_=t.hPaletteView,r.appendChild(this.hPaletteView_.element),i.appendChild(r),this.element.appendChild(i);const o=e.createElement("div");if(o.classList.add(dr("rgb")),this.textsView_=t.textsView,o.appendChild(this.textsView_.element),this.element.appendChild(o),t.alphaViews){this.alphaViews_={palette:t.alphaViews.palette,text:t.alphaViews.text};const l=e.createElement("div");l.classList.add(dr("a"));const a=e.createElement("div");a.classList.add(dr("ap")),a.appendChild(this.alphaViews_.palette.element),l.appendChild(a);const u=e.createElement("div");u.classList.add(dr("at")),u.appendChild(this.alphaViews_.text.element),l.appendChild(u),this.element.appendChild(l)}}get allFocusableElements(){const e=[this.svPaletteView_.element,this.hPaletteView_.element,this.textsView_.modeSelectElement,...this.textsView_.inputViews.map(t=>t.inputElement)];return this.alphaViews_&&e.push(this.alphaViews_.palette.element,this.alphaViews_.text.inputElement),e}}function cae(n){return n==="int"?"int":n==="float"?"float":void 0}function $C(n){return Et(n,e=>({color:e.optional.object({alpha:e.optional.boolean,type:e.optional.custom(cae)}),expanded:e.optional.boolean,picker:e.optional.custom(WM),readonly:e.optional.constant(!1)}))}function No(n){return n?.1:1}function eT(n){var e;return(e=n.color)===null||e===void 0?void 0:e.type}class VC{constructor(e,t){this.type="float",this.mode=t,this.comps_=QM(e,t,this.type)}getComponents(e){return qd(JM(Ni(this.comps_),{mode:this.mode,type:this.type},{mode:e??this.mode,type:this.type}),this.comps_[3])}toRgbaObject(){const e=this.getComponents("rgb");return{r:e[0],g:e[1],b:e[2],a:e[3]}}}const pae={int:(n,e)=>new U(n,e),float:(n,e)=>new VC(n,e)};function kC(n,e,t){return pae[t](n,e)}function dae(n){return n.type==="float"}function mae(n){return n.type==="int"}function vae(n){const e=n.getComponents(),t=ma(n.mode,"int");return new U([Math.round(K(e[0],0,1,0,t[0])),Math.round(K(e[1],0,1,0,t[1])),Math.round(K(e[2],0,1,0,t[2])),e[3]],n.mode)}function fae(n){const e=n.getComponents(),t=ma(n.mode,"int");return new VC([K(e[0],0,t[0],0,1),K(e[1],0,t[1],0,1),K(e[2],0,t[2],0,1),e[3]],n.mode)}function Yt(n,e){if(n.type===e)return n;if(mae(n)&&e==="float")return fae(n);if(dae(n)&&e==="int")return vae(n);throw _n.shouldNeverHappen()}function wae(n,e){return n.alpha===e.alpha&&n.mode===e.mode&&n.notation===e.notation&&n.type===e.type}function Zn(n,e){const t=n.match(/^(.+)%$/);return Math.min(t?parseFloat(t[1])*.01*e:parseFloat(n),e)}const _ae={deg:n=>n,grad:n=>n*360/400,rad:n=>n*360/(2*Math.PI),turn:n=>n*360};function tT(n){const e=n.match(/^([0-9.]+?)(deg|grad|rad|turn)$/);if(!e)return parseFloat(n);const t=parseFloat(e[1]),i=e[2];return _ae[i](t)}function nT(n){const e=n.match(/^rgb\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Zn(e[1],255),Zn(e[2],255),Zn(e[3],255)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function bae(n){const e=nT(n);return e?new U(e,"rgb"):null}function iT(n){const e=n.match(/^rgba\(\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[Zn(e[1],255),Zn(e[2],255),Zn(e[3],255),Zn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function gae(n){const e=iT(n);return e?new U(e,"rgb"):null}function sT(n){const e=n.match(/^hsl\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[tT(e[1]),Zn(e[2],100),Zn(e[3],100)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function Cae(n){const e=sT(n);return e?new U(e,"hsl"):null}function rT(n){const e=n.match(/^hsla\(\s*([0-9A-Fa-f.]+(?:deg|grad|rad|turn)?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*,\s*([0-9A-Fa-f.]+%?)\s*\)$/);if(!e)return null;const t=[tT(e[1]),Zn(e[2],100),Zn(e[3],100),Zn(e[4],1)];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function Pae(n){const e=rT(n);return e?new U(e,"hsl"):null}function oT(n){const e=n.match(/^#([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16)];const t=n.match(/^(?:#|0x)([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16)]:null}function yae(n){const e=oT(n);return e?new U(e,"rgb"):null}function lT(n){const e=n.match(/^#?([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])([0-9A-Fa-f])$/);if(e)return[parseInt(e[1]+e[1],16),parseInt(e[2]+e[2],16),parseInt(e[3]+e[3],16),K(parseInt(e[4]+e[4],16),0,255,0,1)];const t=n.match(/^(?:#|0x)?([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})([0-9A-Fa-f]{2})$/);return t?[parseInt(t[1],16),parseInt(t[2],16),parseInt(t[3],16),K(parseInt(t[4],16),0,255,0,1)]:null}function Eae(n){const e=lT(n);return e?new U(e,"rgb"):null}function aT(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])?null:t}function xae(n){return e=>{const t=aT(e);return t?kC(t,"rgb",n):null}}function uT(n){const e=n.match(/^\{\s*r\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*g\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*b\s*:\s*([0-9A-Fa-f.]+%?)\s*,\s*a\s*:\s*([0-9A-Fa-f.]+%?)\s*\}$/);if(!e)return null;const t=[parseFloat(e[1]),parseFloat(e[2]),parseFloat(e[3]),parseFloat(e[4])];return isNaN(t[0])||isNaN(t[1])||isNaN(t[2])||isNaN(t[3])?null:t}function $ae(n){return e=>{const t=uT(e);return t?kC(t,"rgb",n):null}}const Vae=[{parser:oT,result:{alpha:!1,mode:"rgb",notation:"hex"}},{parser:lT,result:{alpha:!0,mode:"rgb",notation:"hex"}},{parser:nT,result:{alpha:!1,mode:"rgb",notation:"func"}},{parser:iT,result:{alpha:!0,mode:"rgb",notation:"func"}},{parser:sT,result:{alpha:!1,mode:"hsl",notation:"func"}},{parser:rT,result:{alpha:!0,mode:"hsl",notation:"func"}},{parser:aT,result:{alpha:!1,mode:"rgb",notation:"object"}},{parser:uT,result:{alpha:!0,mode:"rgb",notation:"object"}}];function kae(n){return Vae.reduce((e,{parser:t,result:i})=>e||(t(n)?i:null),null)}function Sae(n,e="int"){const t=kae(n);return t?t.notation==="hex"&&e!=="float"?Object.assign(Object.assign({},t),{type:"int"}):t.notation==="func"?Object.assign(Object.assign({},t),{type:e}):null:null}function ic(n){const e=[yae,Eae,bae,gae,Cae,Pae];e.push(xae("int"),$ae("int"));const t=Hle(e);return i=>{const s=t(i);return s?Yt(s,n):null}}function Lae(n){const e=ic("int");if(typeof n!="string")return U.black();const t=e(n);return t??U.black()}function hT(n){const e=st(Math.floor(n),0,255).toString(16);return e.length===1?`0${e}`:e}function SC(n,e="#"){const t=Ni(n.getComponents("rgb")).map(hT).join("");return`${e}${t}`}function LC(n,e="#"){const t=n.getComponents("rgb"),i=[t[0],t[1],t[2],t[3]*255].map(hT).join("");return`${e}${i}`}function cT(n){const e=dn(0),t=Yt(n,"int");return`rgb(${Ni(t.getComponents("rgb")).map(s=>e(s)).join(", ")})`}function Yc(n){const e=dn(2),t=dn(0);return`rgba(${Yt(n,"int").getComponents("rgb").map((r,o)=>(o===3?e:t)(r)).join(", ")})`}function Aae(n){const e=[dn(0),Vp,Vp],t=Yt(n,"int");return`hsl(${Ni(t.getComponents("hsl")).map((s,r)=>e[r](s)).join(", ")})`}function Mae(n){const e=[dn(0),Vp,Vp,dn(2)];return`hsla(${Yt(n,"int").getComponents("hsl").map((s,r)=>e[r](s)).join(", ")})`}function pT(n,e){const t=dn(e==="float"?2:0),i=["r","g","b"],s=Yt(n,e);return`{${Ni(s.getComponents("rgb")).map((o,l)=>`${i[l]}: ${t(o)}`).join(", ")}}`}function Tae(n){return e=>pT(e,n)}function dT(n,e){const t=dn(2),i=dn(e==="float"?2:0),s=["r","g","b","a"];return`{${Yt(n,e).getComponents("rgb").map((l,a)=>{const u=a===3?t:i;return`${s[a]}: ${u(l)}`}).join(", ")}}`}function Dae(n){return e=>dT(e,n)}const Oae=[{format:{alpha:!1,mode:"rgb",notation:"hex",type:"int"},stringifier:SC},{format:{alpha:!0,mode:"rgb",notation:"hex",type:"int"},stringifier:LC},{format:{alpha:!1,mode:"rgb",notation:"func",type:"int"},stringifier:cT},{format:{alpha:!0,mode:"rgb",notation:"func",type:"int"},stringifier:Yc},{format:{alpha:!1,mode:"hsl",notation:"func",type:"int"},stringifier:Aae},{format:{alpha:!0,mode:"hsl",notation:"func",type:"int"},stringifier:Mae},...["int","float"].reduce((n,e)=>[...n,{format:{alpha:!1,mode:"rgb",notation:"object",type:e},stringifier:Tae(e)},{format:{alpha:!0,mode:"rgb",notation:"object",type:e},stringifier:Dae(e)}],[])];function mT(n){return Oae.reduce((e,t)=>e||(wae(t.format,n)?t.stringifier:null),null)}const xu=Y("apl");class Rae{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(xu()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(xu("b")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(xu("c")),i.appendChild(s),this.colorElem_=s;const r=e.createElement("div");r.classList.add(xu("m")),this.element.appendChild(r),this.markerElem_=r;const o=e.createElement("div");o.classList.add(xu("p")),this.markerElem_.appendChild(o),this.previewElem_=o,this.update_()}update_(){const e=this.value.rawValue,t=e.getComponents("rgb"),i=new U([t[0],t[1],t[2],0],"rgb"),s=new U([t[0],t[1],t[2],255],"rgb"),r=["to right",Yc(i),Yc(s)];this.colorElem_.style.background=`linear-gradient(${r.join(",")})`,this.previewElem_.style.backgroundColor=Yc(e);const o=K(t[3],0,1,0,100);this.markerElem_.style.left=`${o}%`}onValueChange_(){this.update_()}}class jae{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Rae(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Jo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=e.point.x/e.bounds.width,s=this.value.rawValue,[r,o,l]=s.getComponents("hsv");this.value.setRawValue(new U([r,o,l,i],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=ln(No(!0),js(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new U([s,r,o,l+t],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){ln(No(!0),js(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const Pl=Y("coltxt");function Nae(n){const e=n.createElement("select"),t=[{text:"RGB",value:"rgb"},{text:"HSL",value:"hsl"},{text:"HSV",value:"hsv"},{text:"HEX",value:"hex"}];return e.appendChild(t.reduce((i,s)=>{const r=n.createElement("option");return r.textContent=s.text,r.value=s.value,i.appendChild(r),i},n.createDocumentFragment())),e}class Bae{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(Pl()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(Pl("m")),this.modeElem_=Nae(e),this.modeElem_.classList.add(Pl("ms")),i.appendChild(this.modeSelectElement),t.viewProps.bindDisabled(this.modeElem_);const s=e.createElement("div");s.classList.add(Pl("mm")),s.appendChild(Ud(e,"dropdown")),i.appendChild(s),this.element.appendChild(i);const r=e.createElement("div");r.classList.add(Pl("w")),this.element.appendChild(r),this.inputsElem_=r,this.inputViews_=t.inputViews,this.applyInputViews_(),Vs(t.mode,o=>{this.modeElem_.value=o})}get modeSelectElement(){return this.modeElem_}get inputViews(){return this.inputViews_}set inputViews(e){this.inputViews_=e,this.applyInputViews_()}applyInputViews_(){BM(this.inputsElem_);const e=this.element.ownerDocument;this.inputViews_.forEach(t=>{const i=e.createElement("div");i.classList.add(Pl("c")),i.appendChild(t.element),this.inputsElem_.appendChild(i)})}}function Iae(n){return dn(n==="float"?2:0)}function Fae(n,e,t){const i=ma(n,e)[t];return new Fd({min:0,max:i})}function Kae(n,e,t){return new tc(n,{arrayPosition:t===0?"fst":t===2?"lst":"mid",parser:e.parser,props:H.fromObject({formatter:Iae(e.colorType),keyScale:No(!1),pointerScale:e.colorType==="float"?.01:1}),value:mt(0,{constraint:Fae(e.colorMode,e.colorType,t)}),viewProps:e.viewProps})}function Uae(n,e){const t={colorMode:e.colorMode,colorType:e.colorType,parser:Kr,viewProps:e.viewProps};return[0,1,2].map(i=>{const s=Kae(n,t,i);return Ba({primary:e.value,secondary:s.value,forward(r){return Yt(r,e.colorType).getComponents(e.colorMode)[i]},backward(r,o){const l=e.colorMode,u=Yt(r,e.colorType).getComponents(l);u[i]=o;const h=kC(qd(Ni(u),u[3]),l,e.colorType);return Yt(h,"int")}}),s})}function Hae(n,e){const t=new xC(n,{parser:ic("int"),props:H.fromObject({formatter:SC}),value:mt(U.black()),viewProps:e.viewProps});return Ba({primary:e.value,secondary:t.value,forward:i=>new U(Ni(i.getComponents()),i.mode),backward:(i,s)=>new U(qd(Ni(s.getComponents(i.mode)),i.getComponents()[3]),i.mode)}),[t]}function zae(n){return n!=="hex"}class qae{constructor(e,t){this.onModeSelectChange_=this.onModeSelectChange_.bind(this),this.colorType_=t.colorType,this.value=t.value,this.viewProps=t.viewProps,this.colorMode=mt(this.value.rawValue.mode),this.ccs_=this.createComponentControllers_(e),this.view=new Bae(e,{mode:this.colorMode,inputViews:[this.ccs_[0].view,this.ccs_[1].view,this.ccs_[2].view],viewProps:this.viewProps}),this.view.modeSelectElement.addEventListener("change",this.onModeSelectChange_)}createComponentControllers_(e){const t=this.colorMode.rawValue;return zae(t)?Uae(e,{colorMode:t,colorType:this.colorType_,value:this.value,viewProps:this.viewProps}):Hae(e,{value:this.value,viewProps:this.viewProps})}onModeSelectChange_(e){const t=e.currentTarget;this.colorMode.rawValue=t.value,this.ccs_=this.createComponentControllers_(this.view.element.ownerDocument),this.view.inputViews=this.ccs_.map(i=>i.view)}}const Ev=Y("hpl");class Gae{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(Ev()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("div");i.classList.add(Ev("c")),this.element.appendChild(i);const s=e.createElement("div");s.classList.add(Ev("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=this.value.rawValue,[t]=e.getComponents("hsv");this.markerElem_.style.backgroundColor=cT(new U([t,100,100],"hsv"));const i=K(t,0,360,0,100);this.markerElem_.style.left=`${i}%`}onValueChange_(){this.update_()}}class Yae{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Gae(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Jo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=K(st(e.point.x,0,e.bounds.width),0,e.bounds.width,0,360),s=this.value.rawValue,[,r,o,l]=s.getComponents("hsv");this.value.setRawValue(new U([i,r,o,l],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){const t=ln(No(!1),js(e));if(t===0)return;const i=this.value.rawValue,[s,r,o,l]=i.getComponents("hsv");this.value.setRawValue(new U([s+t,r,o,l],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){ln(No(!1),js(e))!==0&&this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}const xv=Y("svp"),Rx=64;class Xae{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),this.value=t.value,this.value.emitter.on("change",this.onValueChange_),this.element=e.createElement("div"),this.element.classList.add(xv()),t.viewProps.bindClassModifiers(this.element),t.viewProps.bindTabIndex(this.element);const i=e.createElement("canvas");i.height=Rx,i.width=Rx,i.classList.add(xv("c")),this.element.appendChild(i),this.canvasElement=i;const s=e.createElement("div");s.classList.add(xv("m")),this.element.appendChild(s),this.markerElem_=s,this.update_()}update_(){const e=rle(this.canvasElement);if(!e)return;const i=this.value.rawValue.getComponents("hsv"),s=this.canvasElement.width,r=this.canvasElement.height,o=e.getImageData(0,0,s,r),l=o.data;for(let h=0;h<r;h++)for(let c=0;c<s;c++){const d=K(c,0,s,0,100),p=K(h,0,r,100,0),v=ZM(i[0],d,p),m=(h*s+c)*4;l[m]=v[0],l[m+1]=v[1],l[m+2]=v[2],l[m+3]=255}e.putImageData(o,0,0);const a=K(i[1],0,100,0,100);this.markerElem_.style.left=`${a}%`;const u=K(i[2],0,100,100,0);this.markerElem_.style.top=`${u}%`}onValueChange_(){this.update_()}}class Wae{constructor(e,t){this.onKeyDown_=this.onKeyDown_.bind(this),this.onKeyUp_=this.onKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.view=new Xae(e,{value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Jo(this.view.element),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.element.addEventListener("keydown",this.onKeyDown_),this.view.element.addEventListener("keyup",this.onKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=K(e.point.x,0,e.bounds.width,0,100),s=K(e.point.y,0,e.bounds.height,100,0),[r,,,o]=this.value.rawValue.getComponents("hsv");this.value.setRawValue(new U([r,i,s,o],"hsv"),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onKeyDown_(e){YM(e.key)&&e.preventDefault();const[t,i,s,r]=this.value.rawValue.getComponents("hsv"),o=No(!1),l=ln(o,js(e)),a=ln(o,dh(e));l===0&&a===0||this.value.setRawValue(new U([t,i+l,s+a,r],"hsv"),{forceEmit:!1,last:!1})}onKeyUp_(e){const t=No(!1),i=ln(t,js(e)),s=ln(t,dh(e));i===0&&s===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class Zae{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.hPaletteC_=new Yae(e,{value:this.value,viewProps:this.viewProps}),this.svPaletteC_=new Wae(e,{value:this.value,viewProps:this.viewProps}),this.alphaIcs_=t.supportsAlpha?{palette:new jae(e,{value:this.value,viewProps:this.viewProps}),text:new tc(e,{parser:Kr,props:H.fromObject({pointerScale:.01,keyScale:.1,formatter:dn(2)}),value:mt(0,{constraint:new Fd({min:0,max:1})}),viewProps:this.viewProps})}:null,this.alphaIcs_&&Ba({primary:this.value,secondary:this.alphaIcs_.text.value,forward:i=>i.getComponents()[3],backward:(i,s)=>{const r=i.getComponents();return r[3]=s,new U(r,i.mode)}}),this.textsC_=new qae(e,{colorType:t.colorType,value:this.value,viewProps:this.viewProps}),this.view=new hae(e,{alphaViews:this.alphaIcs_?{palette:this.alphaIcs_.palette.view,text:this.alphaIcs_.text.view}:null,hPaletteView:this.hPaletteC_.view,supportsAlpha:t.supportsAlpha,svPaletteView:this.svPaletteC_.view,textsView:this.textsC_.view,viewProps:this.viewProps})}get textsController(){return this.textsC_}}const $v=Y("colsw");class Qae{constructor(e,t){this.onValueChange_=this.onValueChange_.bind(this),t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.element=e.createElement("div"),this.element.classList.add($v()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add($v("sw")),this.element.appendChild(i),this.swatchElem_=i;const s=e.createElement("button");s.classList.add($v("b")),t.viewProps.bindDisabled(s),this.element.appendChild(s),this.buttonElement=s,this.update_()}update_(){const e=this.value.rawValue;this.swatchElem_.style.backgroundColor=LC(e)}onValueChange_(){this.update_()}}class Jae{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Qae(e,{value:this.value,viewProps:this.viewProps})}}class AC{constructor(e,t){this.onButtonBlur_=this.onButtonBlur_.bind(this),this.onButtonClick_=this.onButtonClick_.bind(this),this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Qh.create(t.expanded),this.swatchC_=new Jae(e,{value:this.value,viewProps:this.viewProps});const i=this.swatchC_.view.buttonElement;i.addEventListener("blur",this.onButtonBlur_),i.addEventListener("click",this.onButtonClick_),this.textC_=new xC(e,{parser:t.parser,props:H.fromObject({formatter:t.formatter}),value:this.value,viewProps:this.viewProps}),this.view=new nae(e,{foldable:this.foldable_,pickerLayout:t.pickerLayout}),this.view.swatchElement.appendChild(this.swatchC_.view.element),this.view.textElement.appendChild(this.textC_.view.element),this.popC_=t.pickerLayout==="popup"?new zM(e,{viewProps:this.viewProps}):null;const s=new Zae(e,{colorType:t.colorType,supportsAlpha:t.supportsAlpha,value:this.value,viewProps:this.viewProps});s.view.allFocusableElements.forEach(r=>{r.addEventListener("blur",this.onPopupChildBlur_),r.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=s,this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(s.view.element),Ba({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:r=>r,backward:(r,o)=>o})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),PC(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=IM(e);i&&t.contains(i)||i&&i===this.swatchC_.view.buttonElement&&!fC(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.swatchC_.view.buttonElement.focus()}}function eue(n){return Ni(n.getComponents("rgb")).reduce((e,t)=>e<<8|Math.floor(t)&255,0)}function tue(n){return n.getComponents("rgb").reduce((e,t,i)=>{const s=Math.floor(i===3?t*255:t)&255;return e<<8|s},0)>>>0}function nue(n){return new U([n>>16&255,n>>8&255,n&255],"rgb")}function iue(n){return new U([n>>24&255,n>>16&255,n>>8&255,K(n&255,0,255,0,1)],"rgb")}function sue(n){return typeof n!="number"?U.black():nue(n)}function rue(n){return typeof n!="number"?U.black():iue(n)}function Xc(n,e){return typeof n!="object"||Ne(n)?!1:e in n&&typeof n[e]=="number"}function vT(n){return Xc(n,"r")&&Xc(n,"g")&&Xc(n,"b")}function fT(n){return vT(n)&&Xc(n,"a")}function wT(n){return vT(n)}function MC(n,e){if(n.mode!==e.mode||n.type!==e.type)return!1;const t=n.getComponents(),i=e.getComponents();for(let s=0;s<t.length;s++)if(t[s]!==i[s])return!1;return!0}function jx(n){return"a"in n?[n.r,n.g,n.b,n.a]:[n.r,n.g,n.b]}function oue(n){const e=mT(n);return e?(t,i)=>{nc(t,e(i))}:null}function lue(n){const e=n?tue:eue;return(t,i)=>{nc(t,e(i))}}function aue(n,e,t){const s=Yt(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b),n.writeProperty("a",s.a)}function uue(n,e,t){const s=Yt(e,t).toRgbaObject();n.writeProperty("r",s.r),n.writeProperty("g",s.g),n.writeProperty("b",s.b)}function hue(n,e){return(t,i)=>{n?aue(t,i,e):uue(t,i,e)}}function cue(n){var e;return!!(!((e=n==null?void 0:n.color)===null||e===void 0)&&e.alpha)}function pue(n){return n?e=>LC(e,"0x"):e=>SC(e,"0x")}function due(n){return"color"in n||n.view==="color"}jt({id:"input-color-number",type:"input",accept:(n,e)=>{if(typeof n!="number"||!due(e))return null;const t=$C(e);return t?{initialValue:n,params:Object.assign(Object.assign({},t),{supportsAlpha:cue(e)})}:null},binding:{reader:n=>n.params.supportsAlpha?rue:sue,equals:MC,writer:n=>lue(n.params.supportsAlpha)},controller:n=>{var e,t;return new AC(n.document,{colorType:"int",expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:pue(n.params.supportsAlpha),parser:ic("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.supportsAlpha,value:n.value,viewProps:n.viewProps})}});function mue(n,e){if(!wT(n))return Yt(U.black(),e);if(e==="int"){const t=jx(n);return new U(t,"rgb")}if(e==="float"){const t=jx(n);return new VC(t,"rgb")}return Yt(U.black(),"int")}function vue(n){return fT(n)}function fue(n){return e=>{const t=mue(e,n);return Yt(t,"int")}}function wue(n,e){return t=>n?dT(t,e):pT(t,e)}jt({id:"input-color-object",type:"input",accept:(n,e)=>{var t;if(!wT(n))return null;const i=$C(e);return i?{initialValue:n,params:Object.assign(Object.assign({},i),{colorType:(t=eT(e))!==null&&t!==void 0?t:"int"})}:null},binding:{reader:n=>fue(n.params.colorType),equals:MC,writer:n=>hue(vue(n.initialValue),n.params.colorType)},controller:n=>{var e,t;const i=fT(n.initialValue);return new AC(n.document,{colorType:n.params.colorType,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:wue(i,n.params.colorType),parser:ic("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:i,value:n.value,viewProps:n.viewProps})}});jt({id:"input-color-string",type:"input",accept:(n,e)=>{if(typeof n!="string"||e.view==="text")return null;const t=Sae(n,eT(e));if(!t)return null;const i=mT(t);if(!i)return null;const s=$C(e);return s?{initialValue:n,params:Object.assign(Object.assign({},s),{format:t,stringifier:i})}:null},binding:{reader:()=>Lae,equals:MC,writer:n=>{const e=oue(n.params.format);if(!e)throw _n.notBindable();return e}},controller:n=>{var e,t;return new AC(n.document,{colorType:n.params.format.type,expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,formatter:n.params.stringifier,parser:ic("int"),pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",supportsAlpha:n.params.format.alpha,value:n.value,viewProps:n.viewProps})}});class TC{constructor(e){this.components=e.components,this.asm_=e.assembly}constrain(e){const t=this.asm_.toComponents(e).map((i,s)=>{var r,o;return(o=(r=this.components[s])===null||r===void 0?void 0:r.constrain(i))!==null&&o!==void 0?o:i});return this.asm_.fromComponents(t)}}const Nx=Y("pndtxt");class _ue{constructor(e,t){this.textViews=t.textViews,this.element=e.createElement("div"),this.element.classList.add(Nx()),this.textViews.forEach(i=>{const s=e.createElement("div");s.classList.add(Nx("a")),s.appendChild(i.element),this.element.appendChild(s)})}}function bue(n,e,t){return new tc(n,{arrayPosition:t===0?"fst":t===e.axes.length-1?"lst":"mid",parser:e.parser,props:e.axes[t].textProps,value:mt(0,{constraint:e.axes[t].constraint}),viewProps:e.viewProps})}class DC{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.acs_=t.axes.map((i,s)=>bue(e,t,s)),this.acs_.forEach((i,s)=>{Ba({primary:this.value,secondary:i.value,forward:r=>t.assembly.toComponents(r)[s],backward:(r,o)=>{const l=t.assembly.toComponents(r);return l[s]=o,t.assembly.fromComponents(l)}})}),this.view=new _ue(e,{textViews:this.acs_.map(i=>i.view)})}get textControllers(){return this.acs_}}class gue extends vC{get max(){return this.controller.valueController.sliderController.props.get("max")}set max(e){this.controller.valueController.sliderController.props.set("max",e)}get min(){return this.controller.valueController.sliderController.props.get("min")}set min(e){this.controller.valueController.sliderController.props.set("min",e)}}function Cue(n,e){const t=[],i=TM(n,e);i&&t.push(i);const s=DM(n);s&&t.push(s);const r=EC(n.options);return r&&t.push(r),new ec(t)}jt({id:"input-number",type:"input",accept:(n,e)=>{if(typeof n!="number")return null;const t=Et(e,i=>Object.assign(Object.assign({},RM(i)),{options:i.optional.custom(zd),readonly:i.optional.constant(!1)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>LM,constraint:n=>Cue(n.params,n.initialValue),writer:n=>nc},controller:n=>{const e=n.value,t=n.constraint,i=t&&$p(t,Hd);if(i)return new da(n.document,{props:new H({options:i.values.value("options")}),value:e,viewProps:n.viewProps});const s=OM(n.params,e.rawValue),r=t&&$p(t,Fd);return r?new Dx(n.document,Object.assign(Object.assign({},Zle(Object.assign(Object.assign({},s),{keyScale:mt(s.keyScale),max:r.values.value("max"),min:r.values.value("min")}))),{parser:Kr,value:e,viewProps:n.viewProps})):new tc(n.document,{parser:Kr,props:H.fromObject(s),value:e,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="number"?null:n.controller.valueController instanceof Dx?new gue(n.controller):n.controller.valueController instanceof da?new yC(n.controller):null}});class Tr{constructor(e=0,t=0){this.x=e,this.y=t}getComponents(){return[this.x,this.y]}static isObject(e){if(Ne(e))return!1;const t=e.x,i=e.y;return!(typeof t!="number"||typeof i!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y}toObject(){return{x:this.x,y:this.y}}}const _T={toComponents:n=>n.getComponents(),fromComponents:n=>new Tr(...n)},yl=Y("p2d");class Pue{constructor(e,t){this.element=e.createElement("div"),this.element.classList.add(yl()),t.viewProps.bindClassModifiers(this.element),Vs(t.expanded,Na(this.element,yl(void 0,"expanded")));const i=e.createElement("div");i.classList.add(yl("h")),this.element.appendChild(i);const s=e.createElement("button");s.classList.add(yl("b")),s.appendChild(Ud(e,"p2dpad")),t.viewProps.bindDisabled(s),i.appendChild(s),this.buttonElement=s;const r=e.createElement("div");if(r.classList.add(yl("t")),i.appendChild(r),this.textElement=r,t.pickerLayout==="inline"){const o=e.createElement("div");o.classList.add(yl("p")),this.element.appendChild(o),this.pickerElement=o}else this.pickerElement=null}}const mr=Y("p2dp");class yue{constructor(e,t){this.onFoldableChange_=this.onFoldableChange_.bind(this),this.onPropsChange_=this.onPropsChange_.bind(this),this.onValueChange_=this.onValueChange_.bind(this),this.props_=t.props,this.props_.emitter.on("change",this.onPropsChange_),this.element=e.createElement("div"),this.element.classList.add(mr()),t.layout==="popup"&&this.element.classList.add(mr(void 0,"p")),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("div");i.classList.add(mr("p")),t.viewProps.bindTabIndex(i),this.element.appendChild(i),this.padElement=i;const s=e.createElementNS(Wn,"svg");s.classList.add(mr("g")),this.padElement.appendChild(s),this.svgElem_=s;const r=e.createElementNS(Wn,"line");r.classList.add(mr("ax")),r.setAttributeNS(null,"x1","0"),r.setAttributeNS(null,"y1","50%"),r.setAttributeNS(null,"x2","100%"),r.setAttributeNS(null,"y2","50%"),this.svgElem_.appendChild(r);const o=e.createElementNS(Wn,"line");o.classList.add(mr("ax")),o.setAttributeNS(null,"x1","50%"),o.setAttributeNS(null,"y1","0"),o.setAttributeNS(null,"x2","50%"),o.setAttributeNS(null,"y2","100%"),this.svgElem_.appendChild(o);const l=e.createElementNS(Wn,"line");l.classList.add(mr("l")),l.setAttributeNS(null,"x1","50%"),l.setAttributeNS(null,"y1","50%"),this.svgElem_.appendChild(l),this.lineElem_=l;const a=e.createElement("div");a.classList.add(mr("m")),this.padElement.appendChild(a),this.markerElem_=a,t.value.emitter.on("change",this.onValueChange_),this.value=t.value,this.update_()}get allFocusableElements(){return[this.padElement]}update_(){const[e,t]=this.value.rawValue.getComponents(),i=this.props_.get("max"),s=K(e,-i,+i,0,100),r=K(t,-i,+i,0,100),o=this.props_.get("invertsY")?100-r:r;this.lineElem_.setAttributeNS(null,"x2",`${s}%`),this.lineElem_.setAttributeNS(null,"y2",`${o}%`),this.markerElem_.style.left=`${s}%`,this.markerElem_.style.top=`${o}%`}onValueChange_(){this.update_()}onPropsChange_(){this.update_()}onFoldableChange_(){this.update_()}}function Bx(n,e,t){return[ln(e[0],js(n)),ln(e[1],dh(n))*(t?1:-1)]}class Eue{constructor(e,t){this.onPadKeyDown_=this.onPadKeyDown_.bind(this),this.onPadKeyUp_=this.onPadKeyUp_.bind(this),this.onPointerDown_=this.onPointerDown_.bind(this),this.onPointerMove_=this.onPointerMove_.bind(this),this.onPointerUp_=this.onPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.view=new yue(e,{layout:t.layout,props:this.props,value:this.value,viewProps:this.viewProps}),this.ptHandler_=new Jo(this.view.padElement),this.ptHandler_.emitter.on("down",this.onPointerDown_),this.ptHandler_.emitter.on("move",this.onPointerMove_),this.ptHandler_.emitter.on("up",this.onPointerUp_),this.view.padElement.addEventListener("keydown",this.onPadKeyDown_),this.view.padElement.addEventListener("keyup",this.onPadKeyUp_)}handlePointerEvent_(e,t){if(!e.point)return;const i=this.props.get("max"),s=K(e.point.x,0,e.bounds.width,-i,+i),r=K(this.props.get("invertsY")?e.bounds.height-e.point.y:e.point.y,0,e.bounds.height,-i,+i);this.value.setRawValue(new Tr(s,r),t)}onPointerDown_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerMove_(e){this.handlePointerEvent_(e.data,{forceEmit:!1,last:!1})}onPointerUp_(e){this.handlePointerEvent_(e.data,{forceEmit:!0,last:!0})}onPadKeyDown_(e){YM(e.key)&&e.preventDefault();const[t,i]=Bx(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(new Tr(this.value.rawValue.x+t,this.value.rawValue.y+i),{forceEmit:!1,last:!1})}onPadKeyUp_(e){const[t,i]=Bx(e,[this.props.get("xKeyScale"),this.props.get("yKeyScale")],this.props.get("invertsY"));t===0&&i===0||this.value.setRawValue(this.value.rawValue,{forceEmit:!0,last:!0})}}class xue{constructor(e,t){var i,s;this.onPopupChildBlur_=this.onPopupChildBlur_.bind(this),this.onPopupChildKeydown_=this.onPopupChildKeydown_.bind(this),this.onPadButtonBlur_=this.onPadButtonBlur_.bind(this),this.onPadButtonClick_=this.onPadButtonClick_.bind(this),this.value=t.value,this.viewProps=t.viewProps,this.foldable_=Qh.create(t.expanded),this.popC_=t.pickerLayout==="popup"?new zM(e,{viewProps:this.viewProps}):null;const r=new Eue(e,{layout:t.pickerLayout,props:new H({invertsY:mt(t.invertsY),max:mt(t.max),xKeyScale:t.axes[0].textProps.value("keyScale"),yKeyScale:t.axes[1].textProps.value("keyScale")}),value:this.value,viewProps:this.viewProps});r.view.allFocusableElements.forEach(o=>{o.addEventListener("blur",this.onPopupChildBlur_),o.addEventListener("keydown",this.onPopupChildKeydown_)}),this.pickerC_=r,this.textC_=new DC(e,{assembly:_T,axes:t.axes,parser:t.parser,value:this.value,viewProps:this.viewProps}),this.view=new Pue(e,{expanded:this.foldable_.value("expanded"),pickerLayout:t.pickerLayout,viewProps:this.viewProps}),this.view.textElement.appendChild(this.textC_.view.element),(i=this.view.buttonElement)===null||i===void 0||i.addEventListener("blur",this.onPadButtonBlur_),(s=this.view.buttonElement)===null||s===void 0||s.addEventListener("click",this.onPadButtonClick_),this.popC_?(this.view.element.appendChild(this.popC_.view.element),this.popC_.view.element.appendChild(this.pickerC_.view.element),Ba({primary:this.foldable_.value("expanded"),secondary:this.popC_.shows,forward:o=>o,backward:(o,l)=>l})):this.view.pickerElement&&(this.view.pickerElement.appendChild(this.pickerC_.view.element),PC(this.foldable_,this.view.pickerElement))}get textController(){return this.textC_}onPadButtonBlur_(e){if(!this.popC_)return;const t=this.view.element,i=e.relatedTarget;(!i||!t.contains(i))&&(this.popC_.shows.rawValue=!1)}onPadButtonClick_(){this.foldable_.set("expanded",!this.foldable_.get("expanded")),this.foldable_.get("expanded")&&this.pickerC_.view.allFocusableElements[0].focus()}onPopupChildBlur_(e){if(!this.popC_)return;const t=this.popC_.view.element,i=IM(e);i&&t.contains(i)||i&&i===this.view.buttonElement&&!fC(t.ownerDocument)||(this.popC_.shows.rawValue=!1)}onPopupChildKeydown_(e){this.popC_?e.key==="Escape"&&(this.popC_.shows.rawValue=!1):this.view.pickerElement&&e.key==="Escape"&&this.view.buttonElement.focus()}}function $ue(n){return Tr.isObject(n)?new Tr(n.x,n.y):new Tr}function Vue(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y)}function kue(n,e){return new TC({assembly:_T,components:[bs(Object.assign(Object.assign({},n),n.x),e.x),bs(Object.assign(Object.assign({},n),n.y),e.y)]})}function Ix(n,e){var t,i;if(!Ne(n.min)||!Ne(n.max))return Math.max(Math.abs((t=n.min)!==null&&t!==void 0?t:0),Math.abs((i=n.max)!==null&&i!==void 0?i:0));const s=MM(n);return Math.max(Math.abs(s)*10,Math.abs(e)*10)}function Sue(n,e){var t,i;const s=Ix(jo(n,(t=n.x)!==null&&t!==void 0?t:{}),e.x),r=Ix(jo(n,(i=n.y)!==null&&i!==void 0?i:{}),e.y);return Math.max(s,r)}function Lue(n){if(!("y"in n))return!1;const e=n.y;return e&&"inverted"in e?!!e.inverted:!1}jt({id:"input-point2d",type:"input",accept:(n,e)=>{if(!Tr.isObject(n))return null;const t=Et(e,i=>Object.assign(Object.assign({},mh(i)),{expanded:i.optional.boolean,picker:i.optional.custom(WM),readonly:i.optional.constant(!1),x:i.optional.custom(yr),y:i.optional.object(Object.assign(Object.assign({},mh(i)),{inverted:i.optional.boolean}))}));return t?{initialValue:n,params:t}:null},binding:{reader:()=>$ue,constraint:n=>kue(n.params,n.initialValue),equals:Tr.equals,writer:()=>Vue},controller:n=>{var e,t;const i=n.document,s=n.value,r=n.constraint,o=[n.params.x,n.params.y];return new xue(i,{axes:s.rawValue.getComponents().map((l,a)=>{var u;return dC({constraint:r.components[a],initialValue:l,params:jo(n.params,(u=o[a])!==null&&u!==void 0?u:{})})}),expanded:(e=n.params.expanded)!==null&&e!==void 0?e:!1,invertsY:Lue(n.params),max:Sue(n.params,s.rawValue),parser:Kr,pickerLayout:(t=n.params.picker)!==null&&t!==void 0?t:"popup",value:s,viewProps:n.viewProps})}});class Yl{constructor(e=0,t=0,i=0){this.x=e,this.y=t,this.z=i}getComponents(){return[this.x,this.y,this.z]}static isObject(e){if(Ne(e))return!1;const t=e.x,i=e.y,s=e.z;return!(typeof t!="number"||typeof i!="number"||typeof s!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z}toObject(){return{x:this.x,y:this.y,z:this.z}}}const bT={toComponents:n=>n.getComponents(),fromComponents:n=>new Yl(...n)};function Aue(n){return Yl.isObject(n)?new Yl(n.x,n.y,n.z):new Yl}function Mue(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z)}function Tue(n,e){return new TC({assembly:bT,components:[bs(Object.assign(Object.assign({},n),n.x),e.x),bs(Object.assign(Object.assign({},n),n.y),e.y),bs(Object.assign(Object.assign({},n),n.z),e.z)]})}jt({id:"input-point3d",type:"input",accept:(n,e)=>{if(!Yl.isObject(n))return null;const t=Et(e,i=>Object.assign(Object.assign({},mh(i)),{readonly:i.optional.constant(!1),x:i.optional.custom(yr),y:i.optional.custom(yr),z:i.optional.custom(yr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Aue,constraint:n=>Tue(n.params,n.initialValue),equals:Yl.equals,writer:n=>Mue},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z];return new DC(n.document,{assembly:bT,axes:e.rawValue.getComponents().map((s,r)=>{var o;return dC({constraint:t.components[r],initialValue:s,params:jo(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Kr,value:e,viewProps:n.viewProps})}});class Xl{constructor(e=0,t=0,i=0,s=0){this.x=e,this.y=t,this.z=i,this.w=s}getComponents(){return[this.x,this.y,this.z,this.w]}static isObject(e){if(Ne(e))return!1;const t=e.x,i=e.y,s=e.z,r=e.w;return!(typeof t!="number"||typeof i!="number"||typeof s!="number"||typeof r!="number")}static equals(e,t){return e.x===t.x&&e.y===t.y&&e.z===t.z&&e.w===t.w}toObject(){return{x:this.x,y:this.y,z:this.z,w:this.w}}}const gT={toComponents:n=>n.getComponents(),fromComponents:n=>new Xl(...n)};function Due(n){return Xl.isObject(n)?new Xl(n.x,n.y,n.z,n.w):new Xl}function Oue(n,e){n.writeProperty("x",e.x),n.writeProperty("y",e.y),n.writeProperty("z",e.z),n.writeProperty("w",e.w)}function Rue(n,e){return new TC({assembly:gT,components:[bs(Object.assign(Object.assign({},n),n.x),e.x),bs(Object.assign(Object.assign({},n),n.y),e.y),bs(Object.assign(Object.assign({},n),n.z),e.z),bs(Object.assign(Object.assign({},n),n.w),e.w)]})}jt({id:"input-point4d",type:"input",accept:(n,e)=>{if(!Xl.isObject(n))return null;const t=Et(e,i=>Object.assign(Object.assign({},mh(i)),{readonly:i.optional.constant(!1),w:i.optional.custom(yr),x:i.optional.custom(yr),y:i.optional.custom(yr),z:i.optional.custom(yr)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>Due,constraint:n=>Rue(n.params,n.initialValue),equals:Xl.equals,writer:n=>Oue},controller:n=>{const e=n.value,t=n.constraint,i=[n.params.x,n.params.y,n.params.z,n.params.w];return new DC(n.document,{assembly:gT,axes:e.rawValue.getComponents().map((s,r)=>{var o;return dC({constraint:t.components[r],initialValue:s,params:jo(n.params,(o=i[r])!==null&&o!==void 0?o:{})})}),parser:Kr,value:e,viewProps:n.viewProps})}});function jue(n){const e=[],t=EC(n.options);return t&&e.push(t),new ec(e)}jt({id:"input-string",type:"input",accept:(n,e)=>{if(typeof n!="string")return null;const t=Et(e,i=>({readonly:i.optional.constant(!1),options:i.optional.custom(zd)}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>GM,constraint:n=>jue(n.params),writer:n=>nc},controller:n=>{const e=n.document,t=n.value,i=n.constraint,s=i&&$p(i,Hd);return s?new da(e,{props:new H({options:s.values.value("options")}),value:t,viewProps:n.viewProps}):new xC(e,{parser:r=>r,props:H.fromObject({formatter:Df}),value:t,viewProps:n.viewProps})},api(n){return typeof n.controller.value.rawValue!="string"?null:n.controller.valueController instanceof da?new yC(n.controller):null}});const Gd={monitor:{defaultInterval:200,defaultRows:3}},Fx=Y("mll");class Nue{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(Fx()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("textarea");i.classList.add(Fx("i")),i.style.height=`calc(var(${XM("containerUnitSize")}) * ${t.rows})`,i.readOnly=!0,t.viewProps.bindDisabled(i),this.element.appendChild(i),this.textareaElem_=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.textareaElem_,t=e.scrollTop===e.scrollHeight-e.clientHeight,i=[];this.value.rawValue.forEach(s=>{s!==void 0&&i.push(this.formatter_(s))}),e.textContent=i.join(`
`),t&&(e.scrollTop=e.scrollHeight)}onValueUpdate_(){this.update_()}}class OC{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Nue(e,{formatter:t.formatter,rows:t.rows,value:this.value,viewProps:this.viewProps})}}const Kx=Y("sgl");class Bue{constructor(e,t){this.onValueUpdate_=this.onValueUpdate_.bind(this),this.formatter_=t.formatter,this.element=e.createElement("div"),this.element.classList.add(Kx()),t.viewProps.bindClassModifiers(this.element);const i=e.createElement("input");i.classList.add(Kx("i")),i.readOnly=!0,i.type="text",t.viewProps.bindDisabled(i),this.element.appendChild(i),this.inputElement=i,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}update_(){const e=this.value.rawValue,t=e[e.length-1];this.inputElement.value=t!==void 0?this.formatter_(t):""}onValueUpdate_(){this.update_()}}class RC{constructor(e,t){this.value=t.value,this.viewProps=t.viewProps,this.view=new Bue(e,{formatter:t.formatter,value:this.value,viewProps:this.viewProps})}}jt({id:"monitor-bool",type:"monitor",accept:(n,e)=>{if(typeof n!="boolean")return null;const t=Et(e,i=>({readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>qM},controller:n=>{var e;return n.value.rawValue.length===1?new RC(n.document,{formatter:Tx,value:n.value,viewProps:n.viewProps}):new OC(n.document,{formatter:Tx,rows:(e=n.params.rows)!==null&&e!==void 0?e:Gd.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}});class Iue extends vC{get max(){return this.controller.valueController.props.get("max")}set max(e){this.controller.valueController.props.set("max",e)}get min(){return this.controller.valueController.props.get("min")}set min(e){this.controller.valueController.props.set("min",e)}}const vr=Y("grl");class Fue{constructor(e,t){this.onCursorChange_=this.onCursorChange_.bind(this),this.onValueUpdate_=this.onValueUpdate_.bind(this),this.element=e.createElement("div"),this.element.classList.add(vr()),t.viewProps.bindClassModifiers(this.element),this.formatter_=t.formatter,this.props_=t.props,this.cursor_=t.cursor,this.cursor_.emitter.on("change",this.onCursorChange_);const i=e.createElementNS(Wn,"svg");i.classList.add(vr("g")),i.style.height=`calc(var(${XM("containerUnitSize")}) * ${t.rows})`,this.element.appendChild(i),this.svgElem_=i;const s=e.createElementNS(Wn,"polyline");this.svgElem_.appendChild(s),this.lineElem_=s;const r=e.createElement("div");r.classList.add(vr("t"),Y("tt")()),this.element.appendChild(r),this.tooltipElem_=r,t.value.emitter.on("change",this.onValueUpdate_),this.value=t.value,this.update_()}get graphElement(){return this.svgElem_}update_(){const e=this.svgElem_.getBoundingClientRect(),t=this.value.rawValue.length-1,i=this.props_.get("min"),s=this.props_.get("max"),r=[];this.value.rawValue.forEach((h,c)=>{if(h===void 0)return;const d=K(c,0,t,0,e.width),p=K(h,i,s,e.height,0);r.push([d,p].join(","))}),this.lineElem_.setAttributeNS(null,"points",r.join(" "));const o=this.tooltipElem_,l=this.value.rawValue[this.cursor_.rawValue];if(l===void 0){o.classList.remove(vr("t","a"));return}const a=K(this.cursor_.rawValue,0,t,0,e.width),u=K(l,i,s,e.height,0);o.style.left=`${a}px`,o.style.top=`${u}px`,o.textContent=`${this.formatter_(l)}`,o.classList.contains(vr("t","a"))||(o.classList.add(vr("t","a"),vr("t","in")),xp(o),o.classList.remove(vr("t","in")))}onValueUpdate_(){this.update_()}onCursorChange_(){this.update_()}}class CT{constructor(e,t){if(this.onGraphMouseMove_=this.onGraphMouseMove_.bind(this),this.onGraphMouseLeave_=this.onGraphMouseLeave_.bind(this),this.onGraphPointerDown_=this.onGraphPointerDown_.bind(this),this.onGraphPointerMove_=this.onGraphPointerMove_.bind(this),this.onGraphPointerUp_=this.onGraphPointerUp_.bind(this),this.props=t.props,this.value=t.value,this.viewProps=t.viewProps,this.cursor_=mt(-1),this.view=new Fue(e,{cursor:this.cursor_,formatter:t.formatter,rows:t.rows,props:this.props,value:this.value,viewProps:this.viewProps}),!fC(e))this.view.element.addEventListener("mousemove",this.onGraphMouseMove_),this.view.element.addEventListener("mouseleave",this.onGraphMouseLeave_);else{const i=new Jo(this.view.element);i.emitter.on("down",this.onGraphPointerDown_),i.emitter.on("move",this.onGraphPointerMove_),i.emitter.on("up",this.onGraphPointerUp_)}}importProps(e){return Ji(e,null,t=>({max:t.required.number,min:t.required.number}),t=>(this.props.set("max",t.max),this.props.set("min",t.min),!0))}exportProps(){return es(null,{max:this.props.get("max"),min:this.props.get("min")})}onGraphMouseLeave_(){this.cursor_.rawValue=-1}onGraphMouseMove_(e){const t=this.view.element.getBoundingClientRect();this.cursor_.rawValue=Math.floor(K(e.offsetX,0,t.width,0,this.value.rawValue.length))}onGraphPointerDown_(e){this.onGraphPointerMove_(e)}onGraphPointerMove_(e){if(!e.data.point){this.cursor_.rawValue=-1;return}this.cursor_.rawValue=Math.floor(K(e.data.point.x,0,e.data.bounds.width,0,this.value.rawValue.length))}onGraphPointerUp_(){this.cursor_.rawValue=-1}}function Of(n){return Ne(n.format)?dn(2):n.format}function Kue(n){var e;return n.value.rawValue.length===1?new RC(n.document,{formatter:Of(n.params),value:n.value,viewProps:n.viewProps}):new OC(n.document,{formatter:Of(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Gd.monitor.defaultRows,value:n.value,viewProps:n.viewProps})}function Uue(n){var e,t,i;return new CT(n.document,{formatter:Of(n.params),rows:(e=n.params.rows)!==null&&e!==void 0?e:Gd.monitor.defaultRows,props:H.fromObject({max:(t=n.params.max)!==null&&t!==void 0?t:100,min:(i=n.params.min)!==null&&i!==void 0?i:0}),value:n.value,viewProps:n.viewProps})}function Ux(n){return n.view==="graph"}jt({id:"monitor-number",type:"monitor",accept:(n,e)=>{if(typeof n!="number")return null;const t=Et(e,i=>({format:i.optional.function,max:i.optional.number,min:i.optional.number,readonly:i.required.constant(!0),rows:i.optional.number,view:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>Ux(n)?64:1,reader:n=>LM},controller:n=>Ux(n.params)?Uue(n):Kue(n),api:n=>n.controller.valueController instanceof CT?new Iue(n.controller):null});jt({id:"monitor-string",type:"monitor",accept:(n,e)=>{if(typeof n!="string")return null;const t=Et(e,i=>({multiline:i.optional.boolean,readonly:i.required.constant(!0),rows:i.optional.number}));return t?{initialValue:n,params:t}:null},binding:{reader:n=>GM},controller:n=>{var e;const t=n.value;return t.rawValue.length>1||n.params.multiline?new OC(n.document,{formatter:Df,rows:(e=n.params.rows)!==null&&e!==void 0?e:Gd.monitor.defaultRows,value:t,viewProps:n.viewProps}):new RC(n.document,{formatter:Df,value:t,viewProps:n.viewProps})}});class Hx{constructor(){this.drawer=e=>`L ${e[0]} ${e[1]}`}}class Hue{constructor(){this.drawer=(e,t,i)=>{const[s,r]=this.controlPoint(i[t-1],i[t-2],e),[o,l]=this.controlPoint(e,i[t-1],i[t+1],!0);return`C ${s},${r} ${o},${l} ${e[0]},${e[1]}`}}controlPoint(e,t,i,s){const r=t||e,o=i||e,l=.2,a=o[0]-r[0],u=o[1]-r[1],h=Math.sqrt(Math.pow(a,2)+Math.pow(u,2))*l,c=Math.atan2(u,a)+(s?Math.PI:0),d=e[0]+Math.cos(c)*h,p=e[1]+Math.sin(c)*h;return[d,p]}}const zx=Y("wfm");class zue{constructor(e,t){switch(this.element=e.createElement("div"),this.element.classList.add(zx()),t.viewProps.bindClassModifiers(this.element),this.svgElem=e.createElementNS(Wn,"svg"),this.svgElem.classList.add(zx("g")),this.element.appendChild(this.svgElem),this.pathElem=e.createElementNS(Wn,"path"),this.svgElem.appendChild(this.pathElem),this.props=t.props,this.value=t.value,this.value.emitter.on("change",this.onValueChange_.bind(this)),this.props.get("lineStyle")){case"linear":this.lineDrawerProvider=new Hx;break;case"bezier":this.lineDrawerProvider=new Hue;break;default:this.lineDrawerProvider=new Hx;break}this.refresh(),t.viewProps.handleDispose(()=>{this.value.emitter.off("change",this.onValueChange_)})}svgPath(e,t){return e.reduce((s,r,o,l)=>o===0?`M ${r[0]},${r[1]}`:`${s} ${t(r,o,l)}`,"")}refresh(){var e,t;const i=this.svgElem.getBoundingClientRect(),s=this.value.rawValue[0];if(s){const r=(e=this.props.get("min"))!==null&&e!==void 0?e:Math.min(...s)-1,o=(t=this.props.get("max"))!==null&&t!==void 0?t:Math.max(...s)+1,l=o-r,a=[],u=s.length-1,h=s.length>32?0:i.width/(s.length-1),c=l>50?0:i.height/l;this.element.style.backgroundSize=`${h}px ${c}px`,s.forEach((p,v)=>{if(p===void 0)return;const m=K(v,0,u,0,i.width),f=K(p,r,o,i.height,0);a.push([Math.floor(m),Math.floor(f)])});const d=this.svgPath(a,this.lineDrawerProvider.drawer);this.pathElem.setAttributeNS(null,"d",d)}}onValueChange_(){this.refresh()}}class que{constructor(e,t){this.value=t.value,this.props=t.props,this.viewProps=t.viewProps,this.viewProps.handleDispose(()=>{}),this.view=new zue(e,{value:this.value,viewProps:this.viewProps,props:this.props})}}function Gue(n){return"view"in n&&n.view==="waveform"}function qx(n){return typeof n=="object"?"length"in n:!1}jt({id:"monitor-waveform",type:"monitor",accept:(n,e)=>{if(!qx(n))return null;const t=Et(e,i=>({max:i.optional.number,min:i.optional.number,style:i.optional.custom(s=>s==="linear"||s==="bezier"?s:void 0),view:i.optional.string}));return t?{initialValue:n,params:t}:null},binding:{defaultBufferSize:n=>Gue(n)?64:1,reader:n=>e=>qx(e)?e:[]},controller:n=>{var e,t,i;return new que(n.document,{props:H.fromObject({max:(e="max"in n.params?n.params.max:null)!==null&&e!==void 0?e:null,min:(t="min"in n.params?n.params.min:null)!==null&&t!==void 0?t:null,lineStyle:(i="style"in n.params?n.params.style:null)!==null&&i!==void 0?i:"linear"}),value:n.value,viewProps:n.viewProps})}});const Yue=n=>({style:n&4}),Gx=n=>({style:n[2]});function Yx(n,e,t){const i=n.slice();return i[7]=e[t],i}function Xx(n,e,t){const i=n.slice();return i[7]=e[t],i}function Wx(n){let e,t,i;function s(o){n[4](o)}let r={key:n[7],label:n[7]};return n[0]!==void 0&&(r.object=n[0]),e=new x_({props:r}),R.push(()=>xe(e,"object",s)),{c(){fe(e.$$.fragment)},l(o){we(e.$$.fragment,o)},m(o,l){_e(e,o,l),i=!0},p(o,l){const a={};l&1&&(a.key=o[7]),l&1&&(a.label=o[7]),!t&&l&1&&(t=!0,a.object=o[0],Ee(()=>t=!1)),e.$set(a)},i(o){i||(b(e.$$.fragment,o),i=!0)},o(o){y(e.$$.fragment,o),i=!1},d(o){be(e,o)}}}function Xue(n){let e,t,i=Dr(Object.keys(n[0])),s=[];for(let o=0;o<i.length;o+=1)s[o]=Wx(Xx(n,i,o));const r=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=D()},l(o){for(let l=0;l<s.length;l+=1)s[l].l(o);e=D()},m(o,l){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(o,l);k(o,e,l),t=!0},p(o,l){if(l&1){i=Dr(Object.keys(o[0]));let a;for(a=0;a<i.length;a+=1){const u=Xx(o,i,a);s[a]?(s[a].p(u,l),b(s[a],1)):(s[a]=Wx(u),s[a].c(),b(s[a],1),s[a].m(e.parentNode,e))}for(Bi(),a=i.length;a<s.length;a+=1)r(a);Ii()}},i(o){if(!t){for(let l=0;l<i.length;l+=1)b(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&P(e),s$(s,o)}}}function Zx(n){let e,t,i;function s(o){n[5](o)}let r={key:n[7],label:n[7]};return n[1]!==void 0&&(r.object=n[1]),e=new x_({props:r}),R.push(()=>xe(e,"object",s)),{c(){fe(e.$$.fragment)},l(o){we(e.$$.fragment,o)},m(o,l){_e(e,o,l),i=!0},p(o,l){const a={};l&2&&(a.key=o[7]),l&2&&(a.label=o[7]),!t&&l&2&&(t=!0,a.object=o[1],Ee(()=>t=!1)),e.$set(a)},i(o){i||(b(e.$$.fragment,o),i=!0)},o(o){y(e.$$.fragment,o),i=!1},d(o){be(e,o)}}}function Wue(n){let e,t,i=Dr(Object.keys(n[1])),s=[];for(let o=0;o<i.length;o+=1)s[o]=Zx(Yx(n,i,o));const r=o=>y(s[o],1,1,()=>{s[o]=null});return{c(){for(let o=0;o<s.length;o+=1)s[o].c();e=D()},l(o){for(let l=0;l<s.length;l+=1)s[l].l(o);e=D()},m(o,l){for(let a=0;a<s.length;a+=1)s[a]&&s[a].m(o,l);k(o,e,l),t=!0},p(o,l){if(l&2){i=Dr(Object.keys(o[1]));let a;for(a=0;a<i.length;a+=1){const u=Yx(o,i,a);s[a]?(s[a].p(u,l),b(s[a],1)):(s[a]=Zx(u),s[a].c(),b(s[a],1),s[a].m(e.parentNode,e))}for(Bi(),a=i.length;a<s.length;a+=1)r(a);Ii()}},i(o){if(!t){for(let l=0;l<i.length;l+=1)b(s[l]);t=!0}},o(o){s=s.filter(Boolean);for(let l=0;l<s.length;l+=1)y(s[l]);t=!1},d(o){o&&P(e),s$(s,o)}}}function Zue(n){let e,t,i,s;return e=new Pf({props:{title:"Numeric",$$slots:{default:[Xue]},$$scope:{ctx:n}}}),i=new Pf({props:{title:"Colors",$$slots:{default:[Wue]},$$scope:{ctx:n}}}),{c(){fe(e.$$.fragment),t=wi(),fe(i.$$.fragment)},l(r){we(e.$$.fragment,r),t=_i(r),we(i.$$.fragment,r)},m(r,o){_e(e,r,o),k(r,t,o),_e(i,r,o),s=!0},p(r,o){const l={};o&65&&(l.$$scope={dirty:o,ctx:r}),e.$set(l);const a={};o&66&&(a.$$scope={dirty:o,ctx:r}),i.$set(a)},i(r){s||(b(e.$$.fragment,r),b(i.$$.fragment,r),s=!0)},o(r){y(e.$$.fragment,r),y(i.$$.fragment,r),s=!1},d(r){r&&P(t),be(e,r),be(i,r)}}}function Que(n){let e,t,i;e=new $ne({props:{title:"CSS variables",$$slots:{default:[Zue]},$$scope:{ctx:n}}});const s=n[3].default,r=mn(s,n,n[6],Gx);return{c(){fe(e.$$.fragment),t=wi(),r&&r.c()},l(o){we(e.$$.fragment,o),t=_i(o),r&&r.l(o)},m(o,l){_e(e,o,l),k(o,t,l),r&&r.m(o,l),i=!0},p(o,[l]){const a={};l&67&&(a.$$scope={dirty:l,ctx:o}),e.$set(a),r&&r.p&&(!i||l&68)&&vn(r,s,o,o[6],i?wn(s,o[6],l,Yue):fn(o[6]),Gx)},i(o){i||(b(e.$$.fragment,o),b(r,o),i=!0)},o(o){y(e.$$.fragment,o),y(r,o),i=!1},d(o){o&&P(t),be(e,o),r&&r.d(o)}}}function Jue(n,e,t){let i,{$$slots:s={},$$scope:r}=e,o={"--treeview-list-gap":"0.25rem","--treeview-toggle-button-size":"1.25rem","--treeview-icon-size":"0.75rem","--treeview-toggle-icon-size":"1rem","--treeview-button-border-radius":"2px"},l={"--treeview-icon-bg-color":"rgba(0,0,0,0.1)","--treeview-icon-color":"#555","--treeview-node-bg-color":"#eee","--treeview-node-hovered-bg-color":"#666","--treeview-node-active-bg-color":"#222","--treeview-toggle-button-bg-color":"#eee"};function a(h){o=h,t(0,o)}function u(h){l=h,t(1,l)}return n.$$set=h=>{"$$scope"in h&&t(6,r=h.$$scope)},n.$$.update=()=>{n.$$.dirty&3&&t(2,i=Object.entries({...o,...l}).map(([h,c])=>`${h}:${c}`).join(";")),n.$$.dirty&4&&console.log(i)},[o,l,i,s,a,u,r]}class ehe extends Lt{constructor(e){super(),At(this,e,Jue,Que,St,{})}}function the(n){let e,t,i,s,r,o,l,a;function u(c){n[1](c)}let h={style:n[6],nodes:c$};return n[0]!==void 0&&(h.select=n[0]),t=new _D({props:h}),R.push(()=>xe(t,"select",u)),t.$on("select",n[2]),t.$on("deselect",n[3]),t.$on("reparent",n[4]),t.$on("toggle",n[5]),{c(){e=Ue("main"),fe(t.$$.fragment),s=wi(),r=Ue("div"),o=wi(),l=Ue("div"),this.h()},l(c){e=He(c,"MAIN",{class:!0});var d=ke(e);we(t.$$.fragment,d),s=_i(d),r=He(d,"DIV",{id:!0}),ke(r).forEach(P),o=_i(d),l=He(d,"DIV",{id:!0}),ke(l).forEach(P),d.forEach(P),this.h()},h(){X(r,"id","dogs"),X(l,"id","treadmill"),X(e,"class","svelte-jzgqpb")},m(c,d){k(c,e,d),_e(t,e,null),ii(e,s),ii(e,r),ii(e,o),ii(e,l),a=!0},p(c,d){const p={};d&64&&(p.style=c[6]),!i&&d&1&&(i=!0,p.select=c[0],Ee(()=>i=!1)),t.$set(p)},i(c){a||(b(t.$$.fragment,c),a=!0)},o(c){y(t.$$.fragment,c),a=!1},d(c){c&&P(e),be(t)}}}function nhe(n){let e,t;return e=new ehe({props:{$$slots:{default:[the,({style:i})=>({6:i}),({style:i})=>i?64:0]},$$scope:{ctx:n}}}),{c(){fe(e.$$.fragment)},l(i){we(e.$$.fragment,i)},m(i,s){_e(e,i,s),t=!0},p(i,[s]){const r={};s&193&&(r.$$scope={dirty:s,ctx:i}),e.$set(r)},i(i){t||(b(e.$$.fragment,i),t=!0)},o(i){y(e.$$.fragment,i),t=!1},d(i){be(e,i)}}}function ihe(n,e,t){let i;function s(u){i=u,t(0,i)}return[i,s,u=>console.log("select",u),u=>console.log("deselect",u),u=>console.log("reparent",u),u=>console.log("toggle",u)]}class iye extends Lt{constructor(e){super(),At(this,e,ihe,nhe,St,{})}}export{iye as component};
